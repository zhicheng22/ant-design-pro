(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[53],{"+VLl":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("lSNA"),i=n.n(r),o=n("J4zp"),a=n.n(o),s=n("Hel2"),u=Math.PI/3,c=[0,u,2*u,3*u,4*u,5*u];function l(e){return e[0]}function p(e){return e[1]}var f=function(){var e,t,n,r=0,i=0,o=1,a=1,s=l,f=p;function h(e){var r,i={},o=[],a=e.length;for(r=0;r<a;++r)if(!isNaN(c=+s.call(null,u=e[r],r,e))&&!isNaN(l=+f.call(null,u,r,e))){var u,c,l,p=Math.round(l/=n),h=Math.round(c=c/t-(1&p)/2),d=l-p;if(3*Math.abs(d)>1){var m=c-h,g=h+(c<h?-1:1)/2,v=p+(l<p?-1:1),y=c-g,_=l-v;m*m+d*d>y*y+_*_&&(h=g+(1&p?1:-1)/2,p=v)}var b=h+"-"+p,x=i[b];x?x.push(u):(o.push(x=i[b]=[u]),x.x=(h+(1&p)/2)*t,x.y=p*n)}return o}function d(e){var t=0,n=0;return c.map((function(r){var i=Math.sin(r)*e,o=-Math.cos(r)*e,a=i-t,s=o-n;return t=i,n=o,[a,s]}))}return h.hexagon=function(t){return"m"+d(null==t?e:+t).join("l")+"z"},h.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/t),l=u*n;l<a+e;l+=n,++u)for(var p=c*t+(1&u)*t/2;p<o+t/2;p+=t)s.push([p,l]);return s},h.mesh=function(){var t=d(e).slice(0,4).join("l");return h.centers().map((function(e){return"M"+e+"m"+t})).join("")},h.x=function(e){return arguments.length?(s=e,h):s},h.y=function(e){return arguments.length?(f=e,h):f},h.radius=function(r){return arguments.length?(e=+r,t=2*e*Math.sin(u),n=1.5*e,h):e},h.size=function(e){return arguments.length?(r=i=0,o=+e[0],a=+e[1],h):[o-r,a-i]},h.extent=function(e){return arguments.length?(r=+e[0][0],i=+e[0][1],o=+e[1][0],a=+e[1][1],h):[[r,i],[o,a]]},h.radius(1)};function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=6378e3;function g(e,t){var n=e.dataArray,r=t.size,o=void 0===r?10:r,u=t.method,c=void 0===u?"sum":u,l=o/(2*Math.PI*m)*(256<<20)/2,p=n.map((function(e){var t=Object(s["d"])(e.coordinates),n=a()(t,2),r=n[0],i=n[1];return d({},e,{coordinates:[r,i]})})),h=f().radius(l).x((function(e){return e.coordinates[0]})).y((function(e){return e.coordinates[1]})),g=h(p),v={dataArray:g.map((function(e,n){var r;if(t.field&&c){var o=s["c"].getColumn(e,t.field);e[c]=s["c"].statMap[c](o)}return r={},i()(r,t.method,e[c]),i()(r,"count",e.length),i()(r,"rawData",e),i()(r,"coordinates",[e.x,e.y]),i()(r,"_id",n),r})),radius:l,xOffset:l,yOffset:l,type:"hexagon"};return v}},"+em5":function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r,i,o,a,s,u,c=n("lSNA"),l=n.n(c),p=n("yG8O"),f=n.n(p),h=n("lwsE"),d=n.n(h),m=n("W8MJ"),g=n.n(m),v=n("U+yc"),y=n.n(v),_=(n("1ABj"),n("gQMU")),b=n.n(_),x=n("J2iB"),w=n.n(x),S=n("u6S6"),E=n.n(S),T=n("4cb6"),k=n("h1nZ"),A=n("bB6j"),C=n("bPkA");function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",O=(r=Object(T["injectable"])(),i=Object(T["inject"])(A["a"].IShaderModuleService),r((u=function(){function e(){d()(this,e),f()(this,"shaderModuleService",s,this),this.rendererService=void 0,this.config=void 0,this.quad=P,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return g()(e,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(e){this.name=e}},{key:"getType",value:function(){return C["a"].PostProcessing}},{key:"init",value:function(e,t){this.config=t,this.rendererService=e.getContainer().get(A["a"].IRendererService);var n=this.rendererService,r=n.createAttribute,i=n.createBuffer,o=n.createModel,a=this.setupShaders(),s=a.vs,u=a.fs,c=a.uniforms;this.model=o({vs:s,fs:u,attributes:{a_Position:r({buffer:i({data:[-4,-4,4,-4,0,4],type:k["gl"].FLOAT}),size:2})},uniforms:M({u_Texture:null},c,{},this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(e){var t=this,n=e.multiPassRenderer.getPostProcessor(),r=this.rendererService,i=r.useFramebuffer,o=r.getViewportSize,a=r.clear,s=o(),u=s.width,c=s.height;i(this.renderToScreen?null:n.getWriteFBO(),(function(){a({framebuffer:n.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),t.model.draw({uniforms:M({u_Texture:n.getReadFBO(),u_ViewportSize:[u,c]},t.convertOptionsToUniforms(t.optionsToUpdate))})}))}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(e){this.enabled=e}},{key:"setRenderToScreen",value:function(e){this.renderToScreen=e}},{key:"updateOptions",value:function(e){this.optionsToUpdate=M({},this.optionsToUpdate,{},e)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(e){var t={};return Object.keys(e).forEach((function(n){w()(e[n])||(t["u_".concat(b()(E()(n)))]=e[n])})),t}}]),e}(),a=u,s=y()(a.prototype,"shaderModuleService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=a))||o)},"/33/":function(e,t){},"/Uc5":function(e,t){},"/rf6":function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function i(e,t,n){switch(void 0===n&&(n={}),e){case"Point":return o(t).geometry;case"LineString":return c(t).geometry;case"Polygon":return s(t).geometry;case"MultiPoint":return h(t).geometry;case"MultiLineString":return f(t).geometry;case"MultiPolygon":return d(t).geometry;default:throw new Error(e+" is invalid")}}function o(e,t,n){void 0===n&&(n={});var i={type:"Point",coordinates:e};return r(i,t,n)}function a(e,t,n){return void 0===n&&(n={}),p(e.map((function(e){return o(e,t)})),n)}function s(e,t,n){void 0===n&&(n={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}var u={type:"Polygon",coordinates:e};return r(u,t,n)}function u(e,t,n){return void 0===n&&(n={}),p(e.map((function(e){return s(e,t)})),n)}function c(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:e};return r(i,t,n)}function l(e,t,n){return void 0===n&&(n={}),p(e.map((function(e){return c(e,t)})),n)}function p(e,t){void 0===t&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function f(e,t,n){void 0===n&&(n={});var i={type:"MultiLineString",coordinates:e};return r(i,t,n)}function h(e,t,n){void 0===n&&(n={});var i={type:"MultiPoint",coordinates:e};return r(i,t,n)}function d(e,t,n){void 0===n&&(n={});var i={type:"MultiPolygon",coordinates:e};return r(i,t,n)}function m(e,t,n){void 0===n&&(n={});var i={type:"GeometryCollection",geometries:e};return r(i,t,n)}function g(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n}function v(e,n){void 0===n&&(n="kilometers");var r=t.factors[n];if(!r)throw new Error(n+" units is invalid");return e*r}function y(e,n){void 0===n&&(n="kilometers");var r=t.factors[n];if(!r)throw new Error(n+" units is invalid");return e/r}function _(e,t){return x(y(e,t))}function b(e){var t=e%360;return t<0&&(t+=360),t}function x(e){var t=e%(2*Math.PI);return 180*t/Math.PI}function w(e){var t=e%360;return t*Math.PI/180}function S(e,t,n){if(void 0===t&&(t="kilometers"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("length must be a positive number");return v(y(e,t),n)}function E(e,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("area must be a positive number");var i=t.areaFactors[n];if(!i)throw new Error("invalid original units");var o=t.areaFactors[r];if(!o)throw new Error("invalid final units");return e/i*o}function T(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}function k(e){return!!e&&e.constructor===Object}function A(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!T(e))throw new Error("bbox must only contain numbers")}))}function C(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function I(){throw new Error("method has been renamed to `radiansToDegrees`")}function M(){throw new Error("method has been renamed to `degreesToRadians`")}function P(){throw new Error("method has been renamed to `lengthToDegrees`")}function O(){throw new Error("method has been renamed to `lengthToRadians`")}function L(){throw new Error("method has been renamed to `radiansToLength`")}function R(){throw new Error("method has been renamed to `bearingToAzimuth`")}function D(){throw new Error("method has been renamed to `convertLength`")}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=i,t.point=o,t.points=a,t.polygon=s,t.polygons=u,t.lineString=c,t.lineStrings=l,t.featureCollection=p,t.multiLineString=f,t.multiPoint=h,t.multiPolygon=d,t.geometryCollection=m,t.round=g,t.radiansToLength=v,t.lengthToRadians=y,t.lengthToDegrees=_,t.bearingToAzimuth=b,t.radiansToDegrees=x,t.degreesToRadians=w,t.convertLength=S,t.convertArea=E,t.isNumber=T,t.isObject=k,t.validateBBox=A,t.validateId=C,t.radians2degrees=I,t.degrees2radians=M,t.distanceToDegrees=P,t.distanceToRadians=O,t.radiansToDistance=L,t.bearingToAngle=R,t.convertDistance=D},"0eqD":function(e,t){},"0gSV":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("GXnB"),i=n("Ztfv");function o(e,t){return function(n,o,a){var s=new r.Metadata(e,t);"number"===typeof a?i.tagParameter(n,o,a,s):i.tagProperty(n,o,s)}}t.tagged=o},"1+5i":function(e,t,n){var r=n("w/wX"),i=n("sEf8"),o=n("mdPL"),a=o&&o.isSet,s=a?i(a):r;e.exports=s},"1ABj":function(e,t){function n(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}e.exports=n},"1gqn":function(e,t){e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},"1jvM":function(e,t){},"2ajD":function(e,t){function n(e){return e!==e}e.exports=n},"3DfO":function(e,t){function n(e){return null==e}e.exports=n},"3cYt":function(e,t){function n(e){return function(t){return null==e?void 0:e[t]}}e.exports=n},"406g":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("z4Hk"),i=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new r.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=i},"4U9+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)((0,l.default)(e)&&e.length>=1,"Must merge at least 1 JSON schema."),a.default.apply(void 0,[{}].concat(g(e),[function(e,t,n){if(!(0,u.default)(e)){if("required"===n)return(0,f.default)(e.concat(t));if((0,d.default)(e)){if(!(0,d.default)(t))throw new Error('Failed to merge schemas because "'+n+'" has different values.')}else i.default.deepEqual(e,t,'Failed to merge schemas because "'+n+'" has different values: '+JSON.stringify(e)+" and "+JSON.stringify(t)+".")}}]))};var r=n("9lTW"),i=m(r),o=n("qd8s"),a=m(o),s=n("3DfO"),u=m(s),c=n("WFAs"),l=m(c),p=n("w26f"),f=m(p),h=n("zZPE"),d=m(h);function m(e){return e&&e.__esModule?e:{default:e}}function g(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}e.exports=t["default"]},"4ZJM":function(e,t,n){(function(t,n){e.exports=n()})(0,(function(){"use strict";var e,t,n;function r(r,i){if(e)if(t){var o="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",a={};e(a),n=i(a),n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"}))}else t=i;else e=i}return r(["exports"],(function(e){function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=r;function r(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=r}r.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},r.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},r.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},r.prototype.solveCurveX=function(e,t){var n,r,i,o,a;for(void 0===t&&(t=1e-6),i=e,a=0;a<8;a++){if(o=this.sampleCurveX(i)-e,Math.abs(o)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=e)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-e)<t)return i;e>o?n=i:r=i,i=.5*(r-n)+n}return i},r.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var i=o;function o(e,t){this.x=e,this.y=t}function a(e,t,r,i){var o=new n(e,t,r,i);return function(e){return o.solve(e)}}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=r,this},_rotateAround:function(e,t){var n=Math.cos(e),r=Math.sin(e),i=t.y+r*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-r*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(e){return e instanceof o?e:Array.isArray(e)?new o(e[0],e[1]):e};var s=a(.25,.1,.25,1);function u(e,t,n){return Math.min(n,Math.max(t,e))}function c(e,t,n){var r=n-t,i=((e-t)%r+r)%r+t;return i===t?n:i}function l(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];for(var r=0,i=t;r<i.length;r+=1){var o=i[r];for(var a in o)e[a]=o[a]}return e}var p=1;function f(){return p++}function h(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function d(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function m(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function g(e,t){return-1!==e.indexOf(t,e.length-t.length)}function v(e,t,n){var r={};for(var i in e)r[i]=t.call(n||this,e[i],i,e);return r}function y(e,t,n){var r={};for(var i in e)t.call(n||this,e[i],i,e)&&(r[i]=e[i]);return r}function _(e){return Array.isArray(e)?e.map(_):"object"==typeof e&&e?v(e,_):e}var b={};function x(e){b[e]||("undefined"!=typeof console&&console.warn(e),b[e]=!0)}function w(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function S(e){for(var t=0,n=0,r=e.length,i=r-1,o=void 0,a=void 0;n<r;i=n++)t+=((a=e[i]).x-(o=e[n]).x)*(o.y+a.y);return t}function E(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function T(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(e,n,r,i){var o=r||i;return t[n]=!o||o.toLowerCase(),""})),t["max-age"]){var n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t}var k=null;function A(e){if(null==k){var t=e.navigator?e.navigator.userAgent:null;k=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return k}function C(e){try{var t=self[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}var I,M,P,O,L=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),R=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,D=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,z={now:L,frame:function(e){var t=R(e);return{cancel:function(){return D(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var n=self.document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("failed to create canvas 2d context");return n.width=e.width,n.height=e.height,r.drawImage(e,0,0,e.width,e.height),r.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return I||(I=self.document.createElement("a")),I.href=e,I.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==M&&(M=self.matchMedia("(prefers-reduced-motion: reduce)")),M.matches)}},N={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},j={supported:!1,testSupport:function(e){!F&&O&&(B?U(e):P=e)}},F=!1,B=!1;function U(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,O),e.isContextLost())return;j.supported=!0}catch(e){}e.deleteTexture(t),F=!0}self.document&&((O=self.document.createElement("img")).onload=function(){P&&U(P),P=null,B=!0},O.onerror=function(){F=!0,P=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var V="01",G=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function q(e){return 0===e.indexOf("mapbox:")}G.prototype._createSkuToken=function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",V,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},G.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},G.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},G.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var n=Y(e);return n.path="/styles/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||t)},G.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var n=Y(e);return n.path="/fonts/v1"+n.path,this._makeAPIURL(n,this._customAccessToken||t)},G.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var n=Y(e);return n.path="/v4/"+n.authority+".json",n.params.push("secure"),this._makeAPIURL(n,this._customAccessToken||t)},G.prototype.normalizeSpriteURL=function(e,t,n,r){var i=Y(e);return q(e)?(i.path="/styles/v1"+i.path+"/sprite"+t+n,this._makeAPIURL(i,this._customAccessToken||r)):(i.path+=""+t+n,X(i))},G.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var n=Y(e);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,(z.devicePixelRatio>=2||512===t?"@2x":"")+(j.supported?".webp":"$1")),n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/v4"+n.path;var r=this._customAccessToken||function(e){for(var t=0,n=e;t<n.length;t+=1){var r=n[t].match(/^access_token=(.*)$/);if(r)return r[1]}return null}(n.params)||N.ACCESS_TOKEN;return N.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&n.params.push("sku="+this._skuToken),this._makeAPIURL(n,r)},G.prototype.canonicalizeTileURL=function(e,t){var n=Y(e);if(!n.path.match(/(^\/v4\/)/)||!n.path.match(/\.[\w]+$/))return e;var r="mapbox://tiles/";r+=n.path.replace("/v4/","");var i=n.params;return t&&(i=i.filter((function(e){return!e.match(/^access_token=/)}))),i.length&&(r+="?"+i.join("&")),r},G.prototype.canonicalizeTileset=function(e,t){for(var n=!!t&&q(t),r=[],i=0,o=e.tiles||[];i<o.length;i+=1){var a=o[i];H(a)?r.push(this.canonicalizeTileURL(a,n)):r.push(a)}return r},G.prototype._makeAPIURL=function(e,t){var n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",r=Y(N.API_URL);if(e.protocol=r.protocol,e.authority=r.authority,"/"!==r.path&&(e.path=""+r.path+e.path),!N.REQUIRE_ACCESS_TOKEN)return X(e);if(!(t=t||N.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+n);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+n);return e.params=e.params.filter((function(e){return-1===e.indexOf("access_token")})),e.params.push("access_token="+t),X(e)};var Z=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function H(e){return Z.test(e)}var W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Y(e){var t=e.match(W);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function X(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function K(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(t[1]).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(e){return null}}var J=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};J.prototype.getStorageKey=function(e){var t,n=K(N.ACCESS_TOKEN);return t=n&&n.u?self.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))}))):N.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},J.prototype.fetchEventData=function(){var e=C("localStorage"),t=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{var r=self.localStorage.getItem(t);r&&(this.eventData=JSON.parse(r));var i=self.localStorage.getItem(n);i&&(this.anonId=i)}catch(e){x("Unable to read from LocalStorage")}},J.prototype.saveEventData=function(){var e=C("localStorage"),t=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{self.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){x("Unable to write to LocalStorage")}},J.prototype.processRequests=function(e){},J.prototype.postEvent=function(e,t,n,r){var i=this;if(N.EVENTS_URL){var o=Y(N.EVENTS_URL);o.params.push("access_token="+(r||N.ACCESS_TOKEN||""));var a={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.9.1",skuId:V,userId:this.anonId},s=t?l(a,t):a,u={url:X(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=xe(u,(function(e){i.pendingRequest=null,n(e),i.saveEventData(),i.processRequests(r)}))}},J.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var Q,$,ee=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(e,t,n,r){this.skuToken=n,(N.EVENTS_URL&&r||N.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return q(e)||H(e)})))&&this.queueRequest({id:t,timestamp:Date.now()},r)},t.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var n=this.queue.shift(),r=n.id,i=n.timestamp;r&&this.success[r]||(this.anonId||this.fetchEventData(),d(this.anonId)||(this.anonId=h()),this.postEvent(i,{skuToken:this.skuToken},(function(e){e||r&&(t.success[r]=!0)}),e))}},t}(J),te=new(function(e){function t(t){e.call(this,"appUserTurnstile"),this._customAccessToken=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(e,t){N.EVENTS_URL&&N.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return q(e)||H(e)}))&&this.queueRequest(Date.now(),t)},t.prototype.processRequests=function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var n=K(N.ACCESS_TOKEN),r=n?n.u:N.ACCESS_TOKEN,i=r!==this.eventData.tokenU;d(this.anonId)||(this.anonId=h(),i=!0);var o=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),s=new Date(o),u=(o-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||a.getDate()!==s.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(o,{"enabled.telemetry":!1},(function(e){e||(t.eventData.lastSuccess=o,t.eventData.tokenU=r)}),e)}},t}(J)),ne=te.postTurnstileEvent.bind(te),re=new ee,ie=re.postMapLoadEvent.bind(re),oe="mapbox-tiles",ae=500,se=50,ue=42e4;function ce(){self.caches&&!Q&&(Q=self.caches.open(oe))}function le(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var pe,fe=1/0;function he(){return null==pe&&(pe=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),pe}var de={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(de);var me,ge,ve=function(e){function t(t,n,r){401===n&&H(r)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,t),this.status=n,this.url=r,this.name=this.constructor.name,this.message=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),ye=E()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},_e=function(e,t){if(!(/^file:/.test(n=e.url)||/^file:/.test(ye())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return function(e,t){var n,r=new self.AbortController,i=new self.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:ye(),signal:r.signal}),o=!1,a=!1,s=(n=i.url).indexOf("sku=")>0&&H(n);"json"===e.type&&i.headers.set("Accept","application/json");var u=function(n,r,o){if(!a){if(n&&"SecurityError"!==n.message&&x(n),r&&o)return c(r);var u=Date.now();self.fetch(i).then((function(n){if(n.ok){var r=s?n.clone():null;return c(n,r,u)}return t(new ve(n.statusText,n.status,e.url))})).catch((function(e){20!==e.code&&t(new Error(e.message))}))}},c=function(n,r,s){("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then((function(e){a||(r&&s&&function(e,t,n){if(ce(),Q){var r={status:t.status,statusText:t.statusText,headers:new self.Headers};t.headers.forEach((function(e,t){return r.headers.set(t,e)}));var i=T(t.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&r.headers.set("Expires",new Date(n+1e3*i["max-age"]).toUTCString()),new Date(r.headers.get("Expires")).getTime()-n<ue||function(e,t){if(void 0===$)try{new Response(new ReadableStream),$=!0}catch(e){$=!1}$?t(e.body):e.blob().then(t)}(t,(function(t){var n=new self.Response(t,r);ce(),Q&&Q.then((function(t){return t.put(le(e.url),n)})).catch((function(e){return x(e.message)}))})))}}(i,r,s),o=!0,t(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((function(e){a||t(new Error(e.message))}))};return s?function(e,t){if(ce(),!Q)return t(null);var n=le(e.url);Q.then((function(e){e.match(n).then((function(r){var i=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),n=T(e.headers.get("Cache-Control")||"");return t>Date.now()&&!n["no-cache"]}(r);e.delete(n),i&&e.put(n,r.clone()),t(null,r,i)})).catch(t)})).catch(t)}(i,u):u(null,null),{cancel:function(){a=!0,o||r.abort()}}}(e,t);if(E()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var n;return function(e,t){var n=new self.XMLHttpRequest;for(var r in n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer"),e.headers)n.setRequestHeader(r,e.headers[r]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){var r=n.response;if("json"===e.type)try{r=JSON.parse(n.response)}catch(e){return t(e)}t(null,r,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else t(new ve(n.statusText,n.status,e.url))},n.send(e.body),{cancel:function(){return n.abort()}}}(e,t)},be=function(e,t){return _e(l(e,{type:"arrayBuffer"}),t)},xe=function(e,t){return _e(l(e,{method:"POST"}),t)};me=[],ge=0;var we=function e(t,n){if(j.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ge>=N.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:t,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return me.push(r),r}ge++;var i=!1,o=function(){if(!i)for(i=!0,ge--;me.length&&ge<N.MAX_PARALLEL_IMAGE_REQUESTS;){var t=me.shift();t.cancelled||(t.cancel=e(t.requestParameters,t.callback).cancel)}},a=be(t,(function(e,t,r,i){o(),e?n(e):t&&(he()?function(e,t){var n=new self.Blob([new Uint8Array(e)],{type:"image/png"});self.createImageBitmap(n).then((function(e){t(null,e)})).catch((function(e){t(new Error("Could not load image because of "+e.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(t,n):function(e,t,n,r){var i=new self.Image,o=self.URL;i.onload=function(){t(null,i),o.revokeObjectURL(i.src)},i.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var a=new self.Blob([new Uint8Array(e)],{type:"image/png"});i.cacheControl=n,i.expires=r,i.src=e.byteLength?o.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(t,n,r,i))}));return{cancel:function(){a.cancel(),o()}}};function Se(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t))}function Ee(e,t,n){if(n&&n[e]){var r=n[e].indexOf(t);-1!==r&&n[e].splice(r,1)}}var Te=function(e,t){void 0===t&&(t={}),l(this,t),this.type=e},ke=function(e){function t(t,n){void 0===n&&(n={}),e.call(this,"error",l({error:t},n))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Te),Ae=function(){};Ae.prototype.on=function(e,t){return this._listeners=this._listeners||{},Se(e,t,this._listeners),this},Ae.prototype.off=function(e,t){return Ee(e,t,this._listeners),Ee(e,t,this._oneTimeListeners),this},Ae.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},Se(e,t,this._oneTimeListeners),this},Ae.prototype.fire=function(e,t){"string"==typeof e&&(e=new Te(e,t||{}));var n=e.type;if(this.listens(n)){e.target=this;for(var r=0,i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];r<i.length;r+=1)i[r].call(this,e);for(var o=0,a=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];o<a.length;o+=1){var s=a[o];Ee(n,s,this._oneTimeListeners),s.call(this,e)}var u=this._eventedParent;u&&(l(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),u.fire(e))}else e instanceof ke&&console.error(e.error);return this},Ae.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ae.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ie=function(e,t,n,r){this.message=(e?e+": ":"")+n,r&&(this.identifier=r),null!=t&&t.__line__&&(this.line=t.__line__)};function Me(e){var t=e.value;return t?[new Ie(e.key,t,"constants have been deprecated as of v8")]:[]}function Pe(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];for(var r=0,i=t;r<i.length;r+=1){var o=i[r];for(var a in o)e[a]=o[a]}return e}function Oe(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Le(e){if(Array.isArray(e))return e.map(Le);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var n in e)t[n]=Le(e[n]);return t}return Oe(e)}var Re=function(e){function t(t,n){e.call(this,n),this.message=n,this.key=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),De=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var n=0,r=t;n<r.length;n+=1){var i=r[n];this.bindings[i[0]]=i[1]}};De.prototype.concat=function(e){return new De(this,e)},De.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},De.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var ze={kind:"null"},Ne={kind:"number"},je={kind:"string"},Fe={kind:"boolean"},Be={kind:"color"},Ue={kind:"object"},Ve={kind:"value"},Ge={kind:"collator"},qe={kind:"formatted"},Ze={kind:"resolvedImage"};function He(e,t){return{kind:"array",itemType:e,N:t}}function We(e){if("array"===e.kind){var t=We(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var Ye=[ze,Ne,je,Fe,Be,qe,Ue,He(Ve),Ze];function Xe(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Xe(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var n=0,r=Ye;n<r.length;n+=1)if(!Xe(r[n],t))return null}return"Expected "+We(e)+" but found "+We(t)+" instead."}var Ke=t((function(e,t){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(e){return(e=Math.round(e))<0?0:e>255?255:e}function i(e){return r("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function o(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function a(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}try{t.parseCSSColor=function(e){var t,s=e.replace(/ /g,"").toLowerCase();if(s in n)return n[s].slice();if("#"===s[0])return 4===s.length?(t=parseInt(s.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===s.length&&(t=parseInt(s.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var u=s.indexOf("("),c=s.indexOf(")");if(-1!==u&&c+1===s.length){var l=s.substr(0,u),p=s.substr(u+1,c-(u+1)).split(","),f=1;switch(l){case"rgba":if(4!==p.length)return null;f=o(p.pop());case"rgb":return 3!==p.length?null:[i(p[0]),i(p[1]),i(p[2]),f];case"hsla":if(4!==p.length)return null;f=o(p.pop());case"hsl":if(3!==p.length)return null;var h=(parseFloat(p[0])%360+360)%360/360,d=o(p[1]),m=o(p[2]),g=m<=.5?m*(d+1):m+d-m*d,v=2*m-g;return[r(255*a(v,g,h+1/3)),r(255*a(v,g,h)),r(255*a(v,g,h-1/3)),f];default:return null}}return null}}catch(e){}})).parseCSSColor,Je=function(e,t,n,r){void 0===r&&(r=1),this.r=e,this.g=t,this.b=n,this.a=r};Je.parse=function(e){if(e){if(e instanceof Je)return e;if("string"==typeof e){var t=Ke(e);if(t)return new Je(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Je.prototype.toString=function(){var e=this.toArray(),t=e[1],n=e[2],r=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(n)+","+r+")"},Je.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Je.black=new Je(0,0,0,1),Je.white=new Je(1,1,1,1),Je.transparent=new Je(0,0,0,0),Je.red=new Je(1,0,0,1);var Qe=function(e,t,n){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Qe.prototype.compare=function(e,t){return this.collator.compare(e,t)},Qe.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var $e=function(e,t,n,r,i){this.text=e,this.image=t,this.scale=n,this.fontStack=r,this.textColor=i},et=function(e){this.sections=e};et.fromString=function(e){return new et([new $e(e,null,null,null,null)])},et.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length}))},et.factory=function(e){return e instanceof et?e:et.fromString(e)},et.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(e){return e.text})).join("")},et.prototype.serialize=function(){for(var e=["format"],t=0,n=this.sections;t<n.length;t+=1){var r=n[t];if(r.image)e.push(["image",r.image.name]);else{e.push(r.text);var i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),r.textColor&&(i["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(i)}}return e};var tt=function(e){this.name=e.name,this.available=e.available};function nt(e,t,n,r){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[e,t,n,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[e,t,n,r]:[e,t,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function rt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Je)return!0;if(e instanceof Qe)return!0;if(e instanceof et)return!0;if(e instanceof tt)return!0;if(Array.isArray(e)){for(var t=0,n=e;t<n.length;t+=1)if(!rt(n[t]))return!1;return!0}if("object"==typeof e){for(var r in e)if(!rt(e[r]))return!1;return!0}return!1}function it(e){if(null===e)return ze;if("string"==typeof e)return je;if("boolean"==typeof e)return Fe;if("number"==typeof e)return Ne;if(e instanceof Je)return Be;if(e instanceof Qe)return Ge;if(e instanceof et)return qe;if(e instanceof tt)return Ze;if(Array.isArray(e)){for(var t,n=e.length,r=0,i=e;r<i.length;r+=1){var o=it(i[r]);if(t){if(t===o)continue;t=Ve;break}t=o}return He(t||Ve,n)}return Ue}function ot(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Je||e instanceof et||e instanceof tt?e.toString():JSON.stringify(e)}tt.prototype.toString=function(){return this.name},tt.fromString=function(e){return e?new tt({name:e,available:!1}):null},tt.prototype.serialize=function(){return["image",this.name]};var at=function(e,t){this.type=e,this.value=t};at.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!rt(e[1]))return t.error("invalid value");var n=e[1],r=it(n),i=t.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new at(r,n)},at.prototype.evaluate=function(){return this.value},at.prototype.eachChild=function(){},at.prototype.outputDefined=function(){return!0},at.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Je?["rgba"].concat(this.value.toArray()):this.value instanceof et?this.value.serialize():this.value};var st=function(e){this.name="ExpressionEvaluationError",this.message=e};st.prototype.toJSON=function(){return this.message};var ut={string:je,number:Ne,boolean:Fe,object:Ue},ct=function(e,t){this.type=e,this.args=t};ct.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var n,r=1,i=e[0];if("array"===i){var o,a;if(e.length>2){var s=e[1];if("string"!=typeof s||!(s in ut)||"object"===s)return t.error('The item type argument of "array" must be one of string, number, boolean',1);o=ut[s],r++}else o=Ve;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],r++}n=He(o,a)}else n=ut[i];for(var u=[];r<e.length;r++){var c=t.parse(e[r],r,Ve);if(!c)return null;u.push(c)}return new ct(n,u)},ct.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var n=this.args[t].evaluate(e);if(!Xe(this.type,it(n)))return n;if(t===this.args.length-1)throw new st("Expected value to be of type "+We(this.type)+", but found "+We(it(n))+" instead.")}return null},ct.prototype.eachChild=function(e){this.args.forEach(e)},ct.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},ct.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var n=e.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){t.push(n.kind);var r=e.N;("number"==typeof r||this.args.length>1)&&t.push(r)}}return t.concat(this.args.map((function(e){return e.serialize()})))};var lt=function(e){this.type=qe,this.sections=e};lt.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var n=e[1];if(!Array.isArray(n)&&"object"==typeof n)return t.error("First argument must be an image or text section.");for(var r=[],i=!1,o=1;o<=e.length-1;++o){var a=e[o];if(i&&"object"==typeof a&&!Array.isArray(a)){i=!1;var s=null;if(a["font-scale"]&&!(s=t.parse(a["font-scale"],1,Ne)))return null;var u=null;if(a["text-font"]&&!(u=t.parse(a["text-font"],1,He(je))))return null;var c=null;if(a["text-color"]&&!(c=t.parse(a["text-color"],1,Be)))return null;var l=r[r.length-1];l.scale=s,l.font=u,l.textColor=c}else{var p=t.parse(e[o],1,Ve);if(!p)return null;var f=p.type.kind;if("string"!==f&&"value"!==f&&"null"!==f&&"resolvedImage"!==f)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:p,scale:null,font:null,textColor:null})}}return new lt(r)},lt.prototype.evaluate=function(e){return new et(this.sections.map((function(t){var n=t.content.evaluate(e);return it(n)===Ze?new $e("",n,null,null,null):new $e(ot(n),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))},lt.prototype.eachChild=function(e){for(var t=0,n=this.sections;t<n.length;t+=1){var r=n[t];e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}},lt.prototype.outputDefined=function(){return!1},lt.prototype.serialize=function(){for(var e=["format"],t=0,n=this.sections;t<n.length;t+=1){var r=n[t];e.push(r.content.serialize());var i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),r.textColor&&(i["text-color"]=r.textColor.serialize()),e.push(i)}return e};var pt=function(e){this.type=Ze,this.input=e};pt.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var n=t.parse(e[1],1,je);return n?new pt(n):t.error("No image name provided.")},pt.prototype.evaluate=function(e){var t=this.input.evaluate(e),n=tt.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n},pt.prototype.eachChild=function(e){e(this.input)},pt.prototype.outputDefined=function(){return!1},pt.prototype.serialize=function(){return["image",this.input.serialize()]};var ft={"to-boolean":Fe,"to-color":Be,"to-number":Ne,"to-string":je},ht=function(e,t){this.type=e,this.args=t};ht.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var n=e[0];if(("to-boolean"===n||"to-string"===n)&&2!==e.length)return t.error("Expected one argument.");for(var r=ft[n],i=[],o=1;o<e.length;o++){var a=t.parse(e[o],o,Ve);if(!a)return null;i.push(a)}return new ht(r,i)},ht.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,n,r=0,i=this.args;r<i.length;r+=1){if(n=null,(t=i[r].evaluate(e))instanceof Je)return t;if("string"==typeof t){var o=e.parseColor(t);if(o)return o}else if(Array.isArray(t)&&!(n=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":nt(t[0],t[1],t[2],t[3])))return new Je(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new st(n||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){for(var a=null,s=0,u=this.args;s<u.length;s+=1){if(null===(a=u[s].evaluate(e)))return 0;var c=Number(a);if(!isNaN(c))return c}throw new st("Could not convert "+JSON.stringify(a)+" to number.")}return"formatted"===this.type.kind?et.fromString(ot(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?tt.fromString(ot(this.args[0].evaluate(e))):ot(this.args[0].evaluate(e))},ht.prototype.eachChild=function(e){this.args.forEach(e)},ht.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},ht.prototype.serialize=function(){if("formatted"===this.type.kind)return new lt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new pt(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild((function(t){e.push(t.serialize())})),e};var dt=["Unknown","Point","LineString","Polygon"],mt=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};mt.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},mt.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?dt[this.feature.type]:this.feature.type:null},mt.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},mt.prototype.canonicalID=function(){return this.canonical},mt.prototype.properties=function(){return this.feature&&this.feature.properties||{}},mt.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Je.parse(e)),t};var gt=function(e,t,n,r){this.name=e,this.type=t,this._evaluate=n,this.args=r};gt.prototype.evaluate=function(e){return this._evaluate(e,this.args)},gt.prototype.eachChild=function(e){this.args.forEach(e)},gt.prototype.outputDefined=function(){return!1},gt.prototype.serialize=function(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))},gt.parse=function(e,t){var n,r=e[0],i=gt.definitions[r];if(!i)return t.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter((function(t){var n=t[0];return!Array.isArray(n)||n.length===e.length-1})),u=null,c=0,l=s;c<l.length;c+=1){var p=l[c],f=p[0],h=p[1];u=new Zt(t.registry,t.path,null,t.scope);for(var d=[],m=!1,g=1;g<e.length;g++){var v=e[g],y=Array.isArray(f)?f[g-1]:f.type,_=u.parse(v,1+d.length,y);if(!_){m=!0;break}d.push(_)}if(!m)if(Array.isArray(f)&&f.length!==d.length)u.error("Expected "+f.length+" arguments, but found "+d.length+" instead.");else{for(var b=0;b<d.length;b++){var x=Array.isArray(f)?f[b]:f.type,w=d[b];u.concat(b+1).checkSubtype(x,w.type)}if(0===u.errors.length)return new gt(r,o,h,d)}}if(1===s.length)(n=t.errors).push.apply(n,u.errors);else{for(var S=(s.length?s:a).map((function(e){var t;return t=e[0],Array.isArray(t)?"("+t.map(We).join(", ")+")":"("+We(t.type)+"...)"})).join(" | "),E=[],T=1;T<e.length;T++){var k=t.parse(e[T],1+E.length);if(!k)return null;E.push(We(k.type))}t.error("Expected arguments of type "+S+", but found ("+E.join(", ")+") instead.")}return null},gt.register=function(e,t){for(var n in gt.definitions=t,t)e[n]=gt};var vt=function(e,t,n){this.type=Ge,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t};vt.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var n=e[1];if("object"!=typeof n||Array.isArray(n))return t.error("Collator options argument must be an object.");var r=t.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Fe);if(!r)return null;var i=t.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Fe);if(!i)return null;var o=null;return n.locale&&!(o=t.parse(n.locale,1,je))?null:new vt(r,i,o)},vt.prototype.evaluate=function(e){return new Qe(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},vt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},vt.prototype.outputDefined=function(){return!1},vt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var yt=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};yt.prototype.setNorthEast=function(e){return this._ne=e instanceof _t?new _t(e.lng,e.lat):_t.convert(e),this},yt.prototype.setSouthWest=function(e){return this._sw=e instanceof _t?new _t(e.lng,e.lat):_t.convert(e),this},yt.prototype.extend=function(e){var t,n,r=this._sw,i=this._ne;if(e instanceof _t)t=e,n=e;else{if(!(e instanceof yt))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(yt.convert(e)):this.extend(_t.convert(e)):this;if(n=e._ne,!(t=e._sw)||!n)return this}return r||i?(r.lng=Math.min(t.lng,r.lng),r.lat=Math.min(t.lat,r.lat),i.lng=Math.max(n.lng,i.lng),i.lat=Math.max(n.lat,i.lat)):(this._sw=new _t(t.lng,t.lat),this._ne=new _t(n.lng,n.lat)),this},yt.prototype.getCenter=function(){return new _t((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},yt.prototype.getSouthWest=function(){return this._sw},yt.prototype.getNorthEast=function(){return this._ne},yt.prototype.getNorthWest=function(){return new _t(this.getWest(),this.getNorth())},yt.prototype.getSouthEast=function(){return new _t(this.getEast(),this.getSouth())},yt.prototype.getWest=function(){return this._sw.lng},yt.prototype.getSouth=function(){return this._sw.lat},yt.prototype.getEast=function(){return this._ne.lng},yt.prototype.getNorth=function(){return this._ne.lat},yt.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},yt.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},yt.prototype.isEmpty=function(){return!(this._sw&&this._ne)},yt.prototype.contains=function(e){var t=_t.convert(e),n=t.lng,r=t.lat,i=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&i},yt.convert=function(e){return!e||e instanceof yt?e:new yt(e)};var _t=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};_t.prototype.wrap=function(){return new _t(c(this.lng,-180,180),this.lat)},_t.prototype.toArray=function(){return[this.lng,this.lat]},_t.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},_t.prototype.distanceTo=function(e){var t=Math.PI/180,n=this.lat*t,r=e.lat*t,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(i,1))},_t.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return new yt(new _t(this.lng-n,this.lat-t),new _t(this.lng+n,this.lat+t))},_t.convert=function(e){if(e instanceof _t)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new _t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new _t(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var bt=2*Math.PI*6371008.8;function xt(e){return bt*Math.cos(e*Math.PI/180)}function wt(e){return(180+e)/360}function St(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Et(e,t){return e/xt(t)}function Tt(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var kt=function(e,t,n){void 0===n&&(n=0),this.x=+e,this.y=+t,this.z=+n};kt.fromLngLat=function(e,t){void 0===t&&(t=0);var n=_t.convert(e);return new kt(wt(n.lng),St(n.lat),Et(t,n.lat))},kt.prototype.toLngLat=function(){return new _t(360*this.x-180,Tt(this.y))},kt.prototype.toAltitude=function(){return this.z*xt(Tt(this.y))},kt.prototype.meterInMercatorCoordinateUnits=function(){return 1/bt*(e=Tt(this.y),1/Math.cos(e*Math.PI/180));var e};var At=8192;function Ct(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function It(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Mt(e,t){var n=kt.fromLngLat({lng:e[0],lat:e[1]},0),r=Math.pow(2,t.z);return[Math.round(n.x*r*At),Math.round(n.y*r*At)]}function Pt(e,t,n){return t[1]>e[1]!=n[1]>e[1]&&e[0]<(n[0]-t[0])*(e[1]-t[1])/(n[1]-t[1])+t[0]}function Ot(e,t){for(var n,r,i,o,a,s,u,c=!1,l=0,p=t.length;l<p;l++)for(var f=t[l],h=0,d=f.length;h<d-1;h++){if((o=(n=e)[0]-(r=f[h])[0])*(u=n[1]-(i=f[h+1])[1])-(s=n[0]-i[0])*(a=n[1]-r[1])==0&&o*s<=0&&a*u<=0)return!1;Pt(e,f[h],f[h+1])&&(c=!c)}return c}function Lt(e,t){for(var n=0;n<t.length;n++)if(Ot(e,t[n]))return!0;return!1}function Rt(e,t,n,r){var i=r[0]-n[0],o=r[1]-n[1];return((e[0]-n[0])*o-i*(e[1]-n[1]))*((t[0]-n[0])*o-i*(t[1]-n[1]))<0}function Dt(e,t,n){for(var r=0,i=n;r<i.length;r+=1)for(var o=i[r],a=0;a<o.length-1;++a)if(0!=(p=[(l=o[a+1])[0]-(c=o[a])[0],l[1]-c[1]])[0]*(f=[(u=t)[0]-(s=e)[0],u[1]-s[1]])[1]-p[1]*f[0]&&Rt(s,u,c,l)&&Rt(c,l,s,u))return!0;var s,u,c,l,p,f;return!1}function zt(e,t){for(var n=0;n<e.length;++n)if(!Ot(e[n],t))return!1;for(var r=0;r<e.length-1;++r)if(Dt(e[r],e[r+1],t))return!1;return!0}function Nt(e,t){for(var n=0;n<t.length;n++)if(zt(e,t[n]))return!0;return!1}function jt(e,t,n){for(var r=[],i=0;i<e.length;i++){for(var o=[],a=0;a<e[i].length;a++){var s=Mt(e[i][a],n);Ct(t,s),o.push(s)}r.push(o)}return r}function Ft(e,t,n){for(var r=[],i=0;i<e.length;i++){var o=jt(e[i],t,n);r.push(o)}return r}var Bt=function(e,t){this.type=Fe,this.geojson=e,this.geometries=t};function Ut(e){if(e instanceof gt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Bt)return!1;var t=!0;return e.eachChild((function(e){t&&!Ut(e)&&(t=!1)})),t}function Vt(e){if(e instanceof gt&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild((function(e){t&&!Vt(e)&&(t=!1)})),t}function Gt(e,t){if(e instanceof gt&&t.indexOf(e.name)>=0)return!1;var n=!0;return e.eachChild((function(e){n&&!Gt(e,t)&&(n=!1)})),n}Bt.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(rt(e[1])){var n=e[1];if("FeatureCollection"===n.type)for(var r=0;r<n.features.length;++r){var i=n.features[r].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Bt(n,n.features[r].geometry)}else if("Feature"===n.type){var o=n.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Bt(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new Bt(n,n)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Bt.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){for(var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=e.canonicalID(),o=[i.x*At,i.y*At],a=[],s=0,u=e.geometry();s<u.length;s+=1)for(var c=0,l=u[s];c<l.length;c+=1){var p=l[c],f=[p.x+o[0],p.y+o[1]];Ct(n,f),a.push(f)}if("Polygon"===t.type){var h=jt(t.coordinates,r,i);if(!It(n,r))return!1;for(var d=0,m=a;d<m.length;d+=1)if(!Ot(m[d],h))return!1}if("MultiPolygon"===t.type){var g=Ft(t.coordinates,r,i);if(!It(n,r))return!1;for(var v=0,y=a;v<y.length;v+=1)if(!Lt(y[v],g))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){for(var n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=e.canonicalID(),o=[i.x*At,i.y*At],a=[],s=0,u=e.geometry();s<u.length;s+=1){for(var c=[],l=0,p=u[s];l<p.length;l+=1){var f=p[l],h=[f.x+o[0],f.y+o[1]];Ct(n,h),c.push(h)}a.push(c)}if("Polygon"===t.type){var d=jt(t.coordinates,r,i);if(!It(n,r))return!1;for(var m=0,g=a;m<g.length;m+=1)if(!zt(g[m],d))return!1}if("MultiPolygon"===t.type){var v=Ft(t.coordinates,r,i);if(!It(n,r))return!1;for(var y=0,_=a;y<_.length;y+=1)if(!Nt(_[y],v))return!1}return!0}(e,this.geometries)}return!1},Bt.prototype.eachChild=function(){},Bt.prototype.outputDefined=function(){return!0},Bt.prototype.serialize=function(){return["within",this.geojson]};var qt=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};qt.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var n=e[1];return t.scope.has(n)?new qt(n,t.scope.get(n)):t.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},qt.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},qt.prototype.eachChild=function(){},qt.prototype.outputDefined=function(){return!1},qt.prototype.serialize=function(){return["var",this.name]};var Zt=function(e,t,n,r,i){void 0===t&&(t=[]),void 0===r&&(r=new De),void 0===i&&(i=[]),this.registry=e,this.path=t,this.key=t.map((function(e){return"["+e+"]"})).join(""),this.scope=r,this.errors=i,this.expectedType=n};function Ht(e,t){for(var n,r=e.length-1,i=0,o=r,a=0;i<=o;)if((n=e[a=Math.floor((i+o)/2)])<=t){if(a===r||t<e[a+1])return a;i=a+1}else{if(!(n>t))throw new st("Input is not a number.");o=a-1}return 0}Zt.prototype.parse=function(e,t,n,r,i){return void 0===i&&(i={}),t?this.concat(t,n,r)._parse(e,i):this._parse(e,i)},Zt.prototype._parse=function(e,t){function n(e,t,n){return"assert"===n?new ct(t,[e]):"coerce"===n?new ht(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=e[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[r];if(i){var o=i.parse(e,this);if(!o)return null;if(this.expectedType){var a=this.expectedType,s=o.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind&&"array"!==a.kind||"value"!==s.kind)if("color"!==a.kind&&"formatted"!==a.kind&&"resolvedImage"!==a.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(a,s))return null}else o=n(o,a,t.typeAnnotation||"coerce");else o=n(o,a,t.typeAnnotation||"assert")}if(!(o instanceof at)&&"resolvedImage"!==o.type.kind&&function e(t){if(t instanceof qt)return e(t.boundExpression);if(t instanceof gt&&"error"===t.name)return!1;if(t instanceof vt)return!1;if(t instanceof Bt)return!1;var n=t instanceof ht||t instanceof ct,r=!0;return t.eachChild((function(t){r=n?r&&e(t):r&&t instanceof at})),!!r&&Ut(t)&&Gt(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var u=new mt;try{o=new at(o.type,o.evaluate(u))}catch(e){return this.error(e.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Zt.prototype.concat=function(e,t,n){var r="number"==typeof e?this.path.concat(e):this.path,i=n?this.scope.concat(n):this.scope;return new Zt(this.registry,r,t||null,i,this.errors)},Zt.prototype.error=function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];var r=""+this.key+t.map((function(e){return"["+e+"]"})).join("");this.errors.push(new Re(r,e))},Zt.prototype.checkSubtype=function(e,t){var n=Xe(e,t);return n&&this.error(n),n};var Wt=function(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var r=0,i=n;r<i.length;r+=1){var o=i[r],a=o[1];this.labels.push(o[0]),this.outputs.push(a)}};Wt.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var n=t.parse(e[1],1,Ne);if(!n)return null;var r=[],i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(var o=1;o<e.length;o+=2){var a=1===o?-1/0:e[o],s=e[o+1],u=o,c=o+1;if("number"!=typeof a)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(r.length&&r[r.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var l=t.parse(s,c,i);if(!l)return null;i=i||l.type,r.push([a,l])}return new Wt(i,n,r)},Wt.prototype.evaluate=function(e){var t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);var r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);var i=t.length;return r>=t[i-1]?n[i-1].evaluate(e):n[Ht(t,r)].evaluate(e)},Wt.prototype.eachChild=function(e){e(this.input);for(var t=0,n=this.outputs;t<n.length;t+=1)e(n[t])},Wt.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))},Wt.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Yt=Xt;function Xt(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=n,this.p2y=r}function Kt(e,t,n){return e*(1-n)+t*n}Xt.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},Xt.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},Xt.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},Xt.prototype.solveCurveX=function(e,t){var n,r,i,o,a;for(void 0===t&&(t=1e-6),i=e,a=0;a<8;a++){if(o=this.sampleCurveX(i)-e,Math.abs(o)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=o/s}if((i=e)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){if(o=this.sampleCurveX(i),Math.abs(o-e)<t)return i;e>o?n=i:r=i,i=.5*(r-n)+n}return i},Xt.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var Jt=Object.freeze({__proto__:null,number:Kt,color:function(e,t,n){return new Je(Kt(e.r,t.r,n),Kt(e.g,t.g,n),Kt(e.b,t.b,n),Kt(e.a,t.a,n))},array:function(e,t,n){return e.map((function(e,r){return Kt(e,t[r],n)}))}}),Qt=.95047,$t=1,en=1.08883,tn=4/29,nn=6/29,rn=3*nn*nn,on=nn*nn*nn,an=Math.PI/180,sn=180/Math.PI;function un(e){return e>on?Math.pow(e,1/3):e/rn+tn}function cn(e){return e>nn?e*e*e:rn*(e-tn)}function ln(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function pn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function fn(e){var t=pn(e.r),n=pn(e.g),r=pn(e.b),i=un((.4124564*t+.3575761*n+.1804375*r)/Qt),o=un((.2126729*t+.7151522*n+.072175*r)/$t);return{l:116*o-16,a:500*(i-o),b:200*(o-un((.0193339*t+.119192*n+.9503041*r)/en)),alpha:e.a}}function hn(e){var t=(e.l+16)/116,n=isNaN(e.a)?t:t+e.a/500,r=isNaN(e.b)?t:t-e.b/200;return t=$t*cn(t),n=Qt*cn(n),r=en*cn(r),new Je(ln(3.2404542*n-1.5371385*t-.4985314*r),ln(-.969266*n+1.8760108*t+.041556*r),ln(.0556434*n-.2040259*t+1.0572252*r),e.alpha)}function dn(e,t,n){var r=t-e;return e+n*(r>180||r<-180?r-360*Math.round(r/360):r)}var mn={forward:fn,reverse:hn,interpolate:function(e,t,n){return{l:Kt(e.l,t.l,n),a:Kt(e.a,t.a,n),b:Kt(e.b,t.b,n),alpha:Kt(e.alpha,t.alpha,n)}}},gn={forward:function(e){var t=fn(e),n=t.l,r=t.a,i=t.b,o=Math.atan2(i,r)*sn;return{h:o<0?o+360:o,c:Math.sqrt(r*r+i*i),l:n,alpha:e.a}},reverse:function(e){var t=e.h*an,n=e.c;return hn({l:e.l,a:Math.cos(t)*n,b:Math.sin(t)*n,alpha:e.alpha})},interpolate:function(e,t,n){return{h:dn(e.h,t.h,n),c:Kt(e.c,t.c,n),l:Kt(e.l,t.l,n),alpha:Kt(e.alpha,t.alpha,n)}}},vn=Object.freeze({__proto__:null,lab:mn,hcl:gn}),yn=function(e,t,n,r,i){this.type=e,this.operator=t,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(var o=0,a=i;o<a.length;o+=1){var s=a[o],u=s[1];this.labels.push(s[0]),this.outputs.push(u)}};function _n(e,t,n,r){var i=r-n,o=e-n;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}yn.interpolationFactor=function(e,t,n,r){var i=0;if("exponential"===e.name)i=_n(t,e.base,n,r);else if("linear"===e.name)i=_n(t,1,n,r);else if("cubic-bezier"===e.name){var o=e.controlPoints;i=new Yt(o[0],o[1],o[2],o[3]).solve(_n(t,1,n,r))}return i},yn.parse=function(e,t){var n=e[0],r=e[1],i=e[2],o=e.slice(3);if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some((function(e){return"number"!=typeof e||e<0||e>1})))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(i=t.parse(i,2,Ne)))return null;var u=[],c=null;"interpolate-hcl"===n||"interpolate-lab"===n?c=Be:t.expectedType&&"value"!==t.expectedType.kind&&(c=t.expectedType);for(var l=0;l<o.length;l+=2){var p=o[l],f=o[l+1],h=l+3,d=l+4;if("number"!=typeof p)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(u.length&&u[u.length-1][0]>=p)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',h);var m=t.parse(f,d,c);if(!m)return null;c=c||m.type,u.push([p,m])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new yn(c,n,r,i,u):t.error("Type "+We(c)+" is not interpolatable.")},yn.prototype.evaluate=function(e){var t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);var r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);var i=t.length;if(r>=t[i-1])return n[i-1].evaluate(e);var o=Ht(t,r),a=yn.interpolationFactor(this.interpolation,r,t[o],t[o+1]),s=n[o].evaluate(e),u=n[o+1].evaluate(e);return"interpolate"===this.operator?Jt[this.type.kind.toLowerCase()](s,u,a):"interpolate-hcl"===this.operator?gn.reverse(gn.interpolate(gn.forward(s),gn.forward(u),a)):mn.reverse(mn.interpolate(mn.forward(s),mn.forward(u),a))},yn.prototype.eachChild=function(e){e(this.input);for(var t=0,n=this.outputs;t<n.length;t+=1)e(n[t])},yn.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))},yn.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],n=0;n<this.labels.length;n++)t.push(this.labels[n],this.outputs[n].serialize());return t};var bn=function(e,t){this.type=e,this.args=t};bn.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var n=null,r=t.expectedType;r&&"value"!==r.kind&&(n=r);for(var i=[],o=0,a=e.slice(1);o<a.length;o+=1){var s=t.parse(a[o],1+i.length,n,void 0,{typeAnnotation:"omit"});if(!s)return null;n=n||s.type,i.push(s)}var u=r&&i.some((function(e){return Xe(r,e.type)}));return new bn(u?Ve:n,i)},bn.prototype.evaluate=function(e){for(var t,n=null,r=0,i=0,o=this.args;i<o.length&&(r++,(n=o[i].evaluate(e))&&n instanceof tt&&!n.available&&(t||(t=n.name),n=null,r===this.args.length&&(n=t)),null===n);i+=1);return n},bn.prototype.eachChild=function(e){this.args.forEach(e)},bn.prototype.outputDefined=function(){return this.args.every((function(e){return e.outputDefined()}))},bn.prototype.serialize=function(){var e=["coalesce"];return this.eachChild((function(t){e.push(t.serialize())})),e};var xn=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};xn.prototype.evaluate=function(e){return this.result.evaluate(e)},xn.prototype.eachChild=function(e){for(var t=0,n=this.bindings;t<n.length;t+=1)e(n[t][1]);e(this.result)},xn.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var n=[],r=1;r<e.length-1;r+=2){var i=e[r];if("string"!=typeof i)return t.error("Expected string, but found "+typeof i+" instead.",r);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=t.parse(e[r+1],r+1);if(!o)return null;n.push([i,o])}var a=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return a?new xn(n,a):null},xn.prototype.outputDefined=function(){return this.result.outputDefined()},xn.prototype.serialize=function(){for(var e=["let"],t=0,n=this.bindings;t<n.length;t+=1){var r=n[t];e.push(r[0],r[1].serialize())}return e.push(this.result.serialize()),e};var wn=function(e,t,n){this.type=e,this.index=t,this.input=n};wn.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1,Ne),r=t.parse(e[2],2,He(t.expectedType||Ve));return n&&r?new wn(r.type.itemType,n,r):null},wn.prototype.evaluate=function(e){var t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new st("Array index out of bounds: "+t+" < 0.");if(t>=n.length)throw new st("Array index out of bounds: "+t+" > "+(n.length-1)+".");if(t!==Math.floor(t))throw new st("Array index must be an integer, but found "+t+" instead.");return n[t]},wn.prototype.eachChild=function(e){e(this.index),e(this.input)},wn.prototype.outputDefined=function(){return!1},wn.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Sn=function(e,t){this.type=Fe,this.needle=e,this.haystack=t};Sn.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var n,r=t.parse(e[1],1,Ve),i=t.parse(e[2],2,Ve);return r&&i?"boolean"!==(n=r.type).kind&&"string"!==n.kind&&"number"!==n.kind&&"null"!==n.kind&&"value"!==n.kind?t.error("Expected first argument to be of type boolean, string, number or null, but found "+We(r.type)+" instead"):new Sn(r,i):null},Sn.prototype.evaluate=function(e){var t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(null==t||!n)return!1;if(!function(e){return"boolean"==typeof e||"string"==typeof e||"number"==typeof e}(t))throw new st("Expected first argument to be of type boolean, string or number, but found "+We(it(t))+" instead.");if(!function(e){return Array.isArray(e)||"string"==typeof e}(n))throw new st("Expected second argument to be of type array or string, but found "+We(it(n))+" instead.");return n.indexOf(t)>=0},Sn.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Sn.prototype.outputDefined=function(){return!0},Sn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var En=function(e,t,n,r,i,o){this.inputType=e,this.type=t,this.input=n,this.cases=r,this.outputs=i,this.otherwise=o};En.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var n,r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var i={},o=[],a=2;a<e.length-1;a+=2){var s=e[a],u=e[a+1];Array.isArray(s)||(s=[s]);var c=t.concat(a);if(0===s.length)return c.error("Expected at least one branch label.");for(var l=0,p=s;l<p.length;l+=1){var f=p[l];if("number"!=typeof f&&"string"!=typeof f)return c.error("Branch labels must be numbers or strings.");if("number"==typeof f&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof f&&Math.floor(f)!==f)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,it(f)))return null}else n=it(f);if(void 0!==i[String(f)])return c.error("Branch labels must be unique.");i[String(f)]=o.length}var h=t.parse(u,a,r);if(!h)return null;r=r||h.type,o.push(h)}var d=t.parse(e[1],1,Ve);if(!d)return null;var m=t.parse(e[e.length-1],e.length-1,r);return m?"value"!==d.type.kind&&t.concat(1).checkSubtype(n,d.type)?null:new En(n,r,d,i,o,m):null},En.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(it(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},En.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},En.prototype.outputDefined=function(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()},En.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],n=[],r={},i=0,o=Object.keys(this.cases).sort();i<o.length;i+=1){var a=o[i];void 0===(p=r[this.cases[a]])?(r[this.cases[a]]=n.length,n.push([this.cases[a],[a]])):n[p][1].push(a)}for(var s=function(t){return"number"===e.inputType.kind?Number(t):t},u=0,c=n;u<c.length;u+=1){var l=c[u],p=l[0],f=l[1];t.push(1===f.length?s(f[0]):f.map(s)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Tn=function(e,t,n){this.type=e,this.branches=t,this.otherwise=n};function kn(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function An(e,t,n,r){return 0===r.compare(t,n)}function Cn(e,t,n){var r="=="!==e&&"!="!==e;return function(){function i(e,t,n){this.type=Fe,this.lhs=e,this.rhs=t,this.collator=n,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return i.parse=function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var n=e[0],o=t.parse(e[1],1,Ve);if(!o)return null;if(!kn(n,o.type))return t.concat(1).error('"'+n+"\" comparisons are not supported for type '"+We(o.type)+"'.");var a=t.parse(e[2],2,Ve);if(!a)return null;if(!kn(n,a.type))return t.concat(2).error('"'+n+"\" comparisons are not supported for type '"+We(a.type)+"'.");if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot compare types '"+We(o.type)+"' and '"+We(a.type)+"'.");r&&("value"===o.type.kind&&"value"!==a.type.kind?o=new ct(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new ct(o.type,[a])));var s=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,Ge)))return null}return new i(o,a,s)},i.prototype.evaluate=function(i){var o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){var s=it(o),u=it(a);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new st('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var c=it(o),l=it(a);if("string"!==c.kind||"string"!==l.kind)return t(i,o,a)}return this.collator?n(i,o,a,this.collator.evaluate(i)):t(i,o,a)},i.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var t=[e];return this.eachChild((function(e){t.push(e.serialize())})),t},i}()}Tn.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var r=[],i=1;i<e.length-1;i+=2){var o=t.parse(e[i],i,Fe);if(!o)return null;var a=t.parse(e[i+1],i+1,n);if(!a)return null;r.push([o,a]),n=n||a.type}var s=t.parse(e[e.length-1],e.length-1,n);return s?new Tn(n,r,s):null},Tn.prototype.evaluate=function(e){for(var t=0,n=this.branches;t<n.length;t+=1){var r=n[t],i=r[1];if(r[0].evaluate(e))return i.evaluate(e)}return this.otherwise.evaluate(e)},Tn.prototype.eachChild=function(e){for(var t=0,n=this.branches;t<n.length;t+=1){var r=n[t],i=r[1];e(r[0]),e(i)}e(this.otherwise)},Tn.prototype.outputDefined=function(){return this.branches.every((function(e){return e[1].outputDefined()}))&&this.otherwise.outputDefined()},Tn.prototype.serialize=function(){var e=["case"];return this.eachChild((function(t){e.push(t.serialize())})),e};var In=Cn("==",(function(e,t,n){return t===n}),An),Mn=Cn("!=",(function(e,t,n){return t!==n}),(function(e,t,n,r){return!An(0,t,n,r)})),Pn=Cn("<",(function(e,t,n){return t<n}),(function(e,t,n,r){return r.compare(t,n)<0})),On=Cn(">",(function(e,t,n){return t>n}),(function(e,t,n,r){return r.compare(t,n)>0})),Ln=Cn("<=",(function(e,t,n){return t<=n}),(function(e,t,n,r){return r.compare(t,n)<=0})),Rn=Cn(">=",(function(e,t,n){return t>=n}),(function(e,t,n,r){return r.compare(t,n)>=0})),Dn=function(e,t,n,r,i){this.type=je,this.number=e,this.locale=t,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i};Dn.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var n=t.parse(e[1],1,Ne);if(!n)return null;var r=e[2];if("object"!=typeof r||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");var i=null;if(r.locale&&!(i=t.parse(r.locale,1,je)))return null;var o=null;if(r.currency&&!(o=t.parse(r.currency,1,je)))return null;var a=null;if(r["min-fraction-digits"]&&!(a=t.parse(r["min-fraction-digits"],1,Ne)))return null;var s=null;return r["max-fraction-digits"]&&!(s=t.parse(r["max-fraction-digits"],1,Ne))?null:new Dn(n,i,o,a,s)},Dn.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Dn.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Dn.prototype.outputDefined=function(){return!1},Dn.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var zn=function(e){this.type=Ne,this.input=e};zn.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var n=t.parse(e[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?t.error("Expected argument of type string or array, but found "+We(n.type)+" instead."):new zn(n):null},zn.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new st("Expected value to be of type string or array, but found "+We(it(t))+" instead.")},zn.prototype.eachChild=function(e){e(this.input)},zn.prototype.outputDefined=function(){return!1},zn.prototype.serialize=function(){var e=["length"];return this.eachChild((function(t){e.push(t.serialize())})),e};var Nn={"==":In,"!=":Mn,">":On,"<":Pn,">=":Rn,"<=":Ln,array:ct,at:wn,boolean:ct,case:Tn,coalesce:bn,collator:vt,format:lt,image:pt,in:Sn,interpolate:yn,"interpolate-hcl":yn,"interpolate-lab":yn,length:zn,let:xn,literal:at,match:En,number:ct,"number-format":Dn,object:ct,step:Wt,string:ct,"to-boolean":ht,"to-color":ht,"to-number":ht,"to-string":ht,var:qt,within:Bt};function jn(e,t){var n=t[0],r=t[1],i=t[2],o=t[3];n=n.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);var a=o?o.evaluate(e):1,s=nt(n,r,i,a);if(s)throw new st(s);return new Je(n/255*a,r/255*a,i/255*a,a)}function Fn(e,t){return e in t}function Bn(e,t){var n=t[e];return void 0===n?null:n}function Un(e){return{type:e}}function Vn(e){return{result:"success",value:e}}function Gn(e){return{result:"error",value:e}}function qn(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function Zn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Hn(e){return!!e.expression&&e.expression.interpolated}function Wn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Yn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Xn(e){return e}function Kn(e,t,n){return void 0!==e?e:void 0!==t?t:void 0!==n?n:void 0}function Jn(e,t,n,r,i){return Kn(typeof n===i?r[n]:void 0,e.default,t.default)}function Qn(e,t,n){if("number"!==Wn(n))return Kn(e.default,t.default);var r=e.stops.length;if(1===r)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];var i=Ht(e.stops.map((function(e){return e[0]})),n);return e.stops[i][1]}function $n(e,t,n){var r=void 0!==e.base?e.base:1;if("number"!==Wn(n))return Kn(e.default,t.default);var i=e.stops.length;if(1===i)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[i-1][0])return e.stops[i-1][1];var o=Ht(e.stops.map((function(e){return e[0]})),n),a=function(e,t,n,r){var i=r-n,o=e-n;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}(n,r,e.stops[o][0],e.stops[o+1][0]),s=e.stops[o][1],u=e.stops[o+1][1],c=Jt[t.type]||Xn;if(e.colorSpace&&"rgb"!==e.colorSpace){var l=vn[e.colorSpace];c=function(e,t){return l.reverse(l.interpolate(l.forward(e),l.forward(t),a))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=s.evaluate.apply(void 0,e),r=u.evaluate.apply(void 0,e);if(void 0!==n&&void 0!==r)return c(n,r,a)}}:c(s,u,a)}function er(e,t,n){return"color"===t.type?n=Je.parse(n):"formatted"===t.type?n=et.fromString(n.toString()):"resolvedImage"===t.type?n=tt.fromString(n.toString()):Wn(n)===t.type||"enum"===t.type&&t.values[n]||(n=void 0),Kn(n,e.default,t.default)}gt.register(Nn,{error:[{kind:"error"},[je],function(e,t){throw new st(t[0].evaluate(e))}],typeof:[je,[Ve],function(e,t){return We(it(t[0].evaluate(e)))}],"to-rgba":[He(Ne,4),[Be],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[Be,[Ne,Ne,Ne],jn],rgba:[Be,[Ne,Ne,Ne,Ne],jn],has:{type:Fe,overloads:[[[je],function(e,t){return Fn(t[0].evaluate(e),e.properties())}],[[je,Ue],function(e,t){var n=t[1];return Fn(t[0].evaluate(e),n.evaluate(e))}]]},get:{type:Ve,overloads:[[[je],function(e,t){return Bn(t[0].evaluate(e),e.properties())}],[[je,Ue],function(e,t){var n=t[1];return Bn(t[0].evaluate(e),n.evaluate(e))}]]},"feature-state":[Ve,[je],function(e,t){return Bn(t[0].evaluate(e),e.featureState||{})}],properties:[Ue,[],function(e){return e.properties()}],"geometry-type":[je,[],function(e){return e.geometryType()}],id:[Ve,[],function(e){return e.id()}],zoom:[Ne,[],function(e){return e.globals.zoom}],"heatmap-density":[Ne,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Ne,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ve,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[Ne,Un(Ne),function(e,t){for(var n=0,r=0,i=t;r<i.length;r+=1)n+=i[r].evaluate(e);return n}],"*":[Ne,Un(Ne),function(e,t){for(var n=1,r=0,i=t;r<i.length;r+=1)n*=i[r].evaluate(e);return n}],"-":{type:Ne,overloads:[[[Ne,Ne],function(e,t){var n=t[1];return t[0].evaluate(e)-n.evaluate(e)}],[[Ne],function(e,t){return-t[0].evaluate(e)}]]},"/":[Ne,[Ne,Ne],function(e,t){var n=t[1];return t[0].evaluate(e)/n.evaluate(e)}],"%":[Ne,[Ne,Ne],function(e,t){var n=t[1];return t[0].evaluate(e)%n.evaluate(e)}],ln2:[Ne,[],function(){return Math.LN2}],pi:[Ne,[],function(){return Math.PI}],e:[Ne,[],function(){return Math.E}],"^":[Ne,[Ne,Ne],function(e,t){var n=t[1];return Math.pow(t[0].evaluate(e),n.evaluate(e))}],sqrt:[Ne,[Ne],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[Ne,[Ne],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[Ne,[Ne],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[Ne,[Ne],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[Ne,[Ne],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[Ne,[Ne],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[Ne,[Ne],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[Ne,[Ne],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[Ne,[Ne],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[Ne,[Ne],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[Ne,Un(Ne),function(e,t){return Math.min.apply(Math,t.map((function(t){return t.evaluate(e)})))}],max:[Ne,Un(Ne),function(e,t){return Math.max.apply(Math,t.map((function(t){return t.evaluate(e)})))}],abs:[Ne,[Ne],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[Ne,[Ne],function(e,t){var n=t[0].evaluate(e);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ne,[Ne],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[Ne,[Ne],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[Fe,[je,Ve],function(e,t){var n=t[0],r=t[1];return e.properties()[n.value]===r.value}],"filter-id-==":[Fe,[Ve],function(e,t){var n=t[0];return e.id()===n.value}],"filter-type-==":[Fe,[je],function(e,t){var n=t[0];return e.geometryType()===n.value}],"filter-<":[Fe,[je,Ve],function(e,t){var n=t[0],r=t[1],i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i<o}],"filter-id-<":[Fe,[Ve],function(e,t){var n=t[0],r=e.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[Fe,[je,Ve],function(e,t){var n=t[0],r=t[1],i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i>o}],"filter-id->":[Fe,[Ve],function(e,t){var n=t[0],r=e.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[Fe,[je,Ve],function(e,t){var n=t[0],r=t[1],i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i<=o}],"filter-id-<=":[Fe,[Ve],function(e,t){var n=t[0],r=e.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[Fe,[je,Ve],function(e,t){var n=t[0],r=t[1],i=e.properties()[n.value],o=r.value;return typeof i==typeof o&&i>=o}],"filter-id->=":[Fe,[Ve],function(e,t){var n=t[0],r=e.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[Fe,[Ve],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Fe,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[Fe,[He(je)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Fe,[He(Ve)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Fe,[je,He(Ve)],function(e,t){var n=t[0];return t[1].value.indexOf(e.properties()[n.value])>=0}],"filter-in-large":[Fe,[je,He(Ve)],function(e,t){var n=t[0],r=t[1];return function(e,t,n,r){for(;n<=r;){var i=n+r>>1;if(t[i]===e)return!0;t[i]>e?r=i-1:n=i+1}return!1}(e.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:Fe,overloads:[[[Fe,Fe],function(e,t){var n=t[1];return t[0].evaluate(e)&&n.evaluate(e)}],[Un(Fe),function(e,t){for(var n=0,r=t;n<r.length;n+=1)if(!r[n].evaluate(e))return!1;return!0}]]},any:{type:Fe,overloads:[[[Fe,Fe],function(e,t){var n=t[1];return t[0].evaluate(e)||n.evaluate(e)}],[Un(Fe),function(e,t){for(var n=0,r=t;n<r.length;n+=1)if(r[n].evaluate(e))return!0;return!1}]]},"!":[Fe,[Fe],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Fe,[je],function(e,t){var n=e.globals&&e.globals.isSupportedScript;return!n||n(t[0].evaluate(e))}],upcase:[je,[je],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[je,[je],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[je,Un(Ve),function(e,t){return t.map((function(t){return ot(t.evaluate(e))})).join("")}],"resolved-locale":[je,[Ge],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var tr=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new mt,this._defaultValue=t?function(e){return"color"===e.type&&Yn(e.default)?new Je(0,0,0,0):"color"===e.type?Je.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null};function nr(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Nn}function rr(e,t){var n=new Zt(Nn,[],t?function(e){var t={color:Be,string:je,number:Ne,enum:je,boolean:Fe,formatted:qe,resolvedImage:Ze};return"array"===e.type?He(t[e.value]||Ve,e.length):t[e.type]}(t):void 0),r=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return r?Vn(new tr(r,t)):Gn(n.errors)}tr.prototype.evaluateWithoutErrorHandling=function(e,t,n,r,i,o){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)},tr.prototype.evaluate=function(e,t,n,r,i,o){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new st("Expected value to be one of "+Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var ir=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Vt(t.expression)};ir.prototype.evaluateWithoutErrorHandling=function(e,t,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,i,o)},ir.prototype.evaluate=function(e,t,n,r,i,o){return this._styleExpression.evaluate(e,t,n,r,i,o)};var or=function(e,t,n,r){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Vt(t.expression),this.interpolationType=r};function ar(e,t){if("error"===(e=rr(e,t)).result)return e;var n=e.value.expression,r=Ut(n);if(!r&&!qn(t))return Gn([new Re("","data expressions not supported")]);var i=Gt(n,["zoom"]);if(!i&&!Zn(t))return Gn([new Re("","zoom expressions not supported")]);var o=function e(t){var n=null;if(t instanceof xn)n=e(t.result);else if(t instanceof bn)for(var r=0,i=t.args;r<i.length&&!(n=e(i[r]));r+=1);else(t instanceof Wt||t instanceof yn)&&t.input instanceof gt&&"zoom"===t.input.name&&(n=t);return n instanceof Re||t.eachChild((function(t){var r=e(t);r instanceof Re?n=r:!n&&r?n=new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&r&&n!==r&&(n=new Re("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}(n);return o||i?o instanceof Re?Gn([o]):o instanceof yn&&!Hn(t)?Gn([new Re("",'"interpolate" expressions cannot be used with this property')]):Vn(o?new or(r?"camera":"composite",e.value,o.labels,o instanceof yn?o.interpolation:void 0):new ir(r?"constant":"source",e.value)):Gn([new Re("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}or.prototype.evaluateWithoutErrorHandling=function(e,t,n,r,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,i,o)},or.prototype.evaluate=function(e,t,n,r,i,o){return this._styleExpression.evaluate(e,t,n,r,i,o)},or.prototype.interpolationFactor=function(e,t,n){return this.interpolationType?yn.interpolationFactor(this.interpolationType,e,t,n):0};var sr=function(e,t){this._parameters=e,this._specification=t,Pe(this,function e(t,n){var r,i,o,a="color"===n.type,s=t.stops&&"object"==typeof t.stops[0][0],u=s||!(s||void 0!==t.property),c=t.type||(Hn(n)?"exponential":"interval");if(a&&((t=Pe({},t)).stops&&(t.stops=t.stops.map((function(e){return[e[0],Je.parse(e[1])]}))),t.default=Je.parse(t.default?t.default:n.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!vn[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===c)r=$n;else if("interval"===c)r=Qn;else if("categorical"===c){r=Jn,i=Object.create(null);for(var l=0,p=t.stops;l<p.length;l+=1){var f=p[l];i[f[0]]=f[1]}o=typeof t.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');r=er}if(s){for(var h={},d=[],m=0;m<t.stops.length;m++){var g=t.stops[m],v=g[0].zoom;void 0===h[v]&&(h[v]={zoom:v,type:t.type,property:t.property,default:t.default,stops:[]},d.push(v)),h[v].stops.push([g[0].value,g[1]])}for(var y=[],_=0,b=d;_<b.length;_+=1){var x=b[_];y.push([h[x].zoom,e(h[x],n)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:yn.interpolationFactor.bind(void 0,w),zoomStops:y.map((function(e){return e[0]})),evaluate:function(e,r){var i=e.zoom;return $n({stops:y,base:t.base},n,i).evaluate(i,r)}}}if(u){var S="exponential"===c?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:yn.interpolationFactor.bind(void 0,S),zoomStops:t.stops.map((function(e){return e[0]})),evaluate:function(e){return r(t,n,e.zoom,i,o)}}}return{kind:"source",evaluate:function(e,a){var s=a&&a.properties?a.properties[t.property]:void 0;return void 0===s?Kn(t.default,n.default):r(t,n,s,i,o)}}}(this._parameters,this._specification))};function ur(e){var t=e.key,n=e.value,r=e.valueSpec||{},i=e.objectElementValidators||{},o=e.style,a=e.styleSpec,s=[],u=Wn(n);if("object"!==u)return[new Ie(t,n,"object expected, "+u+" found")];for(var c in n){var l=c.split(".")[0],p=r[l]||r["*"],f=void 0;if(i[l])f=i[l];else if(r[l])f=Lr;else if(i["*"])f=i["*"];else{if(!r["*"]){s.push(new Ie(t,n[c],'unknown property "'+c+'"'));continue}f=Lr}s=s.concat(f({key:(t?t+".":t)+c,value:n[c],valueSpec:p,style:o,styleSpec:a,object:n,objectKey:c},n))}for(var h in r)i[h]||r[h].required&&void 0===r[h].default&&void 0===n[h]&&s.push(new Ie(t,n,'missing required property "'+h+'"'));return s}function cr(e){var t=e.value,n=e.valueSpec,r=e.style,i=e.styleSpec,o=e.key,a=e.arrayElementValidator||Lr;if("array"!==Wn(t))return[new Ie(o,t,"array expected, "+Wn(t)+" found")];if(n.length&&t.length!==n.length)return[new Ie(o,t,"array length "+n.length+" expected, length "+t.length+" found")];if(n["min-length"]&&t.length<n["min-length"])return[new Ie(o,t,"array length at least "+n["min-length"]+" expected, length "+t.length+" found")];var s={type:n.value,values:n.values};i.$version<7&&(s.function=n.function),"object"===Wn(n.value)&&(s=n.value);for(var u=[],c=0;c<t.length;c++)u=u.concat(a({array:t,arrayIndex:c,value:t[c],valueSpec:s,style:r,styleSpec:i,key:o+"["+c+"]"}));return u}function lr(e){var t=e.key,n=e.value,r=e.valueSpec,i=Wn(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new Ie(t,n,"number expected, "+i+" found")]:"minimum"in r&&n<r.minimum?[new Ie(t,n,n+" is less than the minimum value "+r.minimum)]:"maximum"in r&&n>r.maximum?[new Ie(t,n,n+" is greater than the maximum value "+r.maximum)]:[]}function pr(e){var t,n,r,i=e.valueSpec,o=Oe(e.value.type),a={},s="categorical"!==o&&void 0===e.value.property,u=!s,c="array"===Wn(e.value.stops)&&"array"===Wn(e.value.stops[0])&&"object"===Wn(e.value.stops[0][0]),l=ur({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===o)return[new Ie(e.key,e.value,'identity function may not have a "stops" property')];var t=[],n=e.value;return t=t.concat(cr({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:p})),"array"===Wn(n)&&0===n.length&&t.push(new Ie(e.key,n,"array must have at least one stop")),t},default:function(e){return Lr({key:e.key,value:e.value,valueSpec:i,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===o&&s&&l.push(new Ie(e.key,e.value,'missing required property "property"')),"identity"===o||e.value.stops||l.push(new Ie(e.key,e.value,'missing required property "stops"')),"exponential"===o&&e.valueSpec.expression&&!Hn(e.valueSpec)&&l.push(new Ie(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(u&&!qn(e.valueSpec)?l.push(new Ie(e.key,e.value,"property functions not supported")):s&&!Zn(e.valueSpec)&&l.push(new Ie(e.key,e.value,"zoom functions not supported"))),"categorical"!==o&&!c||void 0!==e.value.property||l.push(new Ie(e.key,e.value,'"property" property is required')),l;function p(e){var t=[],o=e.value,s=e.key;if("array"!==Wn(o))return[new Ie(s,o,"array expected, "+Wn(o)+" found")];if(2!==o.length)return[new Ie(s,o,"array length 2 expected, length "+o.length+" found")];if(c){if("object"!==Wn(o[0]))return[new Ie(s,o,"object expected, "+Wn(o[0])+" found")];if(void 0===o[0].zoom)return[new Ie(s,o,"object stop key must have zoom")];if(void 0===o[0].value)return[new Ie(s,o,"object stop key must have value")];if(r&&r>Oe(o[0].zoom))return[new Ie(s,o[0].zoom,"stop zoom values must appear in ascending order")];Oe(o[0].zoom)!==r&&(r=Oe(o[0].zoom),n=void 0,a={}),t=t.concat(ur({key:s+"[0]",value:o[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:lr,value:f}}))}else t=t.concat(f({key:s+"[0]",value:o[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},o));return nr(Le(o[1]))?t.concat([new Ie(s+"[1]",o[1],"expressions are not allowed in function stops.")]):t.concat(Lr({key:s+"[1]",value:o[1],valueSpec:i,style:e.style,styleSpec:e.styleSpec}))}function f(e,r){var s=Wn(e.value),u=Oe(e.value),c=null!==e.value?e.value:r;if(t){if(s!==t)return[new Ie(e.key,c,s+" stop domain type must match previous stop domain type "+t)]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Ie(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==o){var l="number expected, "+s+" found";return qn(i)&&void 0===o&&(l+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(e.key,c,l)]}return"categorical"!==o||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==o&&"number"===s&&void 0!==n&&u<n?[new Ie(e.key,c,"stop domain values must appear in ascending order")]:(n=u,"categorical"===o&&u in a?[new Ie(e.key,c,"stop domain values must be unique")]:(a[u]=!0,[])):[new Ie(e.key,c,"integer expected, found "+u)]}}function fr(e){var t=("property"===e.expressionContext?ar:rr)(Le(e.value),e.valueSpec);if("error"===t.result)return t.value.map((function(t){return new Ie(""+e.key+t.key,e.value,t.message)}));var n=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!n.outputDefined())return[new Ie(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Vt(n))return[new Ie(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Vt(n))return[new Ie(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!Gt(n,["zoom","feature-state"]))return[new Ie(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Ut(n))return[new Ie(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hr(e){var t=e.key,n=e.value,r=e.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(Oe(n))&&i.push(new Ie(t,n,"expected one of ["+r.values.join(", ")+"], "+JSON.stringify(n)+" found")):-1===Object.keys(r.values).indexOf(Oe(n))&&i.push(new Ie(t,n,"expected one of ["+Object.keys(r.values).join(", ")+"], "+JSON.stringify(n)+" found")),i}function dr(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,n=e.slice(1);t<n.length;t+=1){var r=n[t];if(!dr(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}sr.deserialize=function(e){return new sr(e._parameters,e._specification)},sr.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var mr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gr(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};dr(e)||(e=yr(e));var t=rr(e,mr);if("error"===t.result)throw new Error(t.value.map((function(e){return e.key+": "+e.message})).join(", "));return{filter:function(e,n,r){return t.value.evaluate(e,n,{},r)},needGeometry:Array.isArray(e)&&0!==e.length&&"within"===e[0]}}function vr(e,t){return e<t?-1:e>t?1:0}function yr(e){if(!e)return!0;var t,n=e[0];return e.length<=1?"any"!==n:"=="===n?_r(e[1],e[2],"=="):"!="===n?wr(_r(e[1],e[2],"==")):"<"===n||">"===n||"<="===n||">="===n?_r(e[1],e[2],n):"any"===n?(t=e.slice(1),["any"].concat(t.map(yr))):"all"===n?["all"].concat(e.slice(1).map(yr)):"none"===n?["all"].concat(e.slice(1).map(yr).map(wr)):"in"===n?br(e[1],e.slice(2)):"!in"===n?wr(br(e[1],e.slice(2))):"has"===n?xr(e[1]):"!has"!==n||wr(xr(e[1]))}function _r(e,t,n){switch(e){case"$type":return["filter-type-"+n,t];case"$id":return["filter-id-"+n,t];default:return["filter-"+n,e,t]}}function br(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((function(e){return typeof e!=typeof t[0]}))?["filter-in-large",e,["literal",t.sort(vr)]]:["filter-in-small",e,["literal",t]]}}function xr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function wr(e){return["!",e]}function Sr(e){return dr(Le(e.value))?fr(Pe({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){var n=t.value,r=t.key;if("array"!==Wn(n))return[new Ie(r,n,"array expected, "+Wn(n)+" found")];var i,o=t.styleSpec,a=[];if(n.length<1)return[new Ie(r,n,"filter array must have at least 1 element")];switch(a=a.concat(hr({key:r+"[0]",value:n[0],valueSpec:o.filter_operator,style:t.style,styleSpec:t.styleSpec})),Oe(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&"$type"===Oe(n[1])&&a.push(new Ie(r,n,'"$type" cannot be use with operator "'+n[0]+'"'));case"==":case"!=":3!==n.length&&a.push(new Ie(r,n,'filter array for operator "'+n[0]+'" must have 3 elements'));case"in":case"!in":n.length>=2&&"string"!==(i=Wn(n[1]))&&a.push(new Ie(r+"[1]",n[1],"string expected, "+i+" found"));for(var s=2;s<n.length;s++)i=Wn(n[s]),"$type"===Oe(n[1])?a=a.concat(hr({key:r+"["+s+"]",value:n[s],valueSpec:o.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new Ie(r+"["+s+"]",n[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var u=1;u<n.length;u++)a=a.concat(e({key:r+"["+u+"]",value:n[u],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":i=Wn(n[1]),2!==n.length?a.push(new Ie(r,n,'filter array for "'+n[0]+'" operator must have 2 elements')):"string"!==i&&a.push(new Ie(r+"[1]",n[1],"string expected, "+i+" found"))}return a}(e)}function Er(e,t){var n=e.key,r=e.style,i=e.styleSpec,o=e.value,a=e.objectKey,s=i[t+"_"+e.layerType];if(!s)return[];var u=a.match(/^(.*)-transition$/);if("paint"===t&&u&&s[u[1]]&&s[u[1]].transition)return Lr({key:n,value:o,valueSpec:i.transition,style:r,styleSpec:i});var c,l=e.valueSpec||s[a];if(!l)return[new Ie(n,o,'unknown property "'+a+'"')];if("string"===Wn(o)&&qn(l)&&!l.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new Ie(n,o,'"'+a+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(c[1])+" }`.")];var p=[];return"symbol"===e.layerType&&("text-field"===a&&r&&!r.glyphs&&p.push(new Ie(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Yn(Le(o))&&"identity"===Oe(o.type)&&p.push(new Ie(n,o,'"text-font" does not support identity functions'))),p.concat(Lr({key:e.key,value:o,valueSpec:l,style:r,styleSpec:i,expressionContext:"property",propertyType:t,propertyKey:a}))}function Tr(e){return Er(e,"paint")}function kr(e){return Er(e,"layout")}function Ar(e){var t=[],n=e.value,r=e.key,i=e.style,o=e.styleSpec;n.type||n.ref||t.push(new Ie(r,n,'either "type" or "ref" is required'));var a,s=Oe(n.type),u=Oe(n.ref);if(n.id)for(var c=Oe(n.id),l=0;l<e.arrayIndex;l++){var p=i.layers[l];Oe(p.id)===c&&t.push(new Ie(r,n.id,'duplicate layer id "'+n.id+'", previously used at line '+p.id.__line__))}if("ref"in n)["type","source","source-layer","filter","layout"].forEach((function(e){e in n&&t.push(new Ie(r,n[e],'"'+e+'" is prohibited for ref layers'))})),i.layers.forEach((function(e){Oe(e.id)===u&&(a=e)})),a?a.ref?t.push(new Ie(r,n.ref,"ref cannot reference another ref layer")):s=Oe(a.type):t.push(new Ie(r,n.ref,'ref layer "'+u+'" not found'));else if("background"!==s)if(n.source){var f=i.sources&&i.sources[n.source],h=f&&Oe(f.type);f?"vector"===h&&"raster"===s?t.push(new Ie(r,n.source,'layer "'+n.id+'" requires a raster source')):"raster"===h&&"raster"!==s?t.push(new Ie(r,n.source,'layer "'+n.id+'" requires a vector source')):"vector"!==h||n["source-layer"]?"raster-dem"===h&&"hillshade"!==s?t.push(new Ie(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]||"geojson"===h&&f.lineMetrics||t.push(new Ie(r,n,'layer "'+n.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Ie(r,n,'layer "'+n.id+'" must specify a "source-layer"')):t.push(new Ie(r,n.source,'source "'+n.source+'" not found'))}else t.push(new Ie(r,n,'missing required property "source"'));return t=t.concat(ur({key:r,value:n,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Lr({key:r+".type",value:n.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,object:n,objectKey:"type"})},filter:Sr,layout:function(e){return ur({layer:n,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return kr(Pe({layerType:s},e))}}})},paint:function(e){return ur({layer:n,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Tr(Pe({layerType:s},e))}}})}}}))}function Cr(e){var t=e.value,n=e.key,r=Wn(t);return"string"!==r?[new Ie(n,t,"string expected, "+r+" found")]:[]}var Ir={promoteId:function(e){var t=e.key,n=e.value;if("string"===Wn(n))return Cr({key:t,value:n});var r=[];for(var i in n)r.push.apply(r,Cr({key:t+"."+i,value:n[i]}));return r}};function Mr(e){var t=e.value,n=e.key,r=e.styleSpec,i=e.style;if(!t.type)return[new Ie(n,t,'"type" is required')];var o,a=Oe(t.type);switch(a){case"vector":case"raster":case"raster-dem":return ur({key:n,value:t,valueSpec:r["source_"+a.replace("-","_")],style:e.style,styleSpec:r,objectElementValidators:Ir});case"geojson":if(o=ur({key:n,value:t,valueSpec:r.source_geojson,style:i,styleSpec:r,objectElementValidators:Ir}),t.cluster)for(var s in t.clusterProperties){var u=t.clusterProperties[s],c=u[0],l="string"==typeof c?[c,["accumulated"],["get",s]]:c;o.push.apply(o,fr({key:n+"."+s+".map",value:u[1],expressionContext:"cluster-map"})),o.push.apply(o,fr({key:n+"."+s+".reduce",value:l,expressionContext:"cluster-reduce"}))}return o;case"video":return ur({key:n,value:t,valueSpec:r.source_video,style:i,styleSpec:r});case"image":return ur({key:n,value:t,valueSpec:r.source_image,style:i,styleSpec:r});case"canvas":return[new Ie(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hr({key:n+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:r})}}function Pr(e){var t=e.value,n=e.styleSpec,r=n.light,i=e.style,o=[],a=Wn(t);if(void 0===t)return o;if("object"!==a)return o.concat([new Ie("light",t,"object expected, "+a+" found")]);for(var s in t){var u=s.match(/^(.*)-transition$/);o=o.concat(u&&r[u[1]]&&r[u[1]].transition?Lr({key:s,value:t[s],valueSpec:n.transition,style:i,styleSpec:n}):r[s]?Lr({key:s,value:t[s],valueSpec:r[s],style:i,styleSpec:n}):[new Ie(s,t[s],'unknown property "'+s+'"')])}return o}var Or={"*":function(){return[]},array:cr,boolean:function(e){var t=e.value,n=e.key,r=Wn(t);return"boolean"!==r?[new Ie(n,t,"boolean expected, "+r+" found")]:[]},number:lr,color:function(e){var t=e.key,n=e.value,r=Wn(n);return"string"!==r?[new Ie(t,n,"color expected, "+r+" found")]:null===Ke(n)?[new Ie(t,n,'color expected, "'+n+'" found')]:[]},constants:Me,enum:hr,filter:Sr,function:pr,layer:Ar,object:ur,source:Mr,light:Pr,string:Cr,formatted:function(e){return 0===Cr(e).length?[]:fr(e)},resolvedImage:function(e){return 0===Cr(e).length?[]:fr(e)}};function Lr(e){var t=e.value,n=e.valueSpec,r=e.styleSpec;return n.expression&&Yn(Oe(t))?pr(e):n.expression&&nr(Le(t))?fr(e):n.type&&Or[n.type]?Or[n.type](e):ur(Pe({},e,{valueSpec:n.type?r[n.type]:n}))}function Rr(e){var t=e.value,n=e.key,r=Cr(e);return r.length||(-1===t.indexOf("{fontstack}")&&r.push(new Ie(n,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&r.push(new Ie(n,t,'"glyphs" url must include a "{range}" token'))),r}function Dr(e,t){void 0===t&&(t=Ce);var n=[];return n=n.concat(Lr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Rr,"*":function(){return[]}}})),e.constants&&(n=n.concat(Me({key:"constants",value:e.constants,style:e,styleSpec:t}))),zr(n)}function zr(e){return[].concat(e).sort((function(e,t){return e.line-t.line}))}function Nr(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return zr(e.apply(this,t))}}Dr.source=Nr(Mr),Dr.light=Nr(Pr),Dr.layer=Nr(Ar),Dr.filter=Nr(Sr),Dr.paintProperty=Nr(Tr),Dr.layoutProperty=Nr(kr);var jr=Dr,Fr=jr.light,Br=jr.paintProperty,Ur=jr.layoutProperty;function Vr(e,t){var n=!1;if(t&&t.length)for(var r=0,i=t;r<i.length;r+=1)e.fire(new ke(new Error(i[r].message))),n=!0;return n}var Gr=Zr,qr=3;function Zr(e,t,n){var r=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(n=i[2]);for(var o=0;o<this.d*this.d;o++){var a=i[qr+o],s=i[qr+o+1];r.push(a===s?null:i.subarray(a,s))}var u=i[qr+r.length+1];this.keys=i.subarray(i[qr+r.length],u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=t+2*n;for(var c=0;c<this.d*this.d;c++)r.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;var l=n/t*e;this.min=-l,this.max=e+l}Zr.prototype.insert=function(e,t,n,r,i){this._forEachCell(t,n,r,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Zr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Zr.prototype._insertCell=function(e,t,n,r,i,o){this.cells[i].push(o)},Zr.prototype.query=function(e,t,n,r,i){var o=this.min,a=this.max;if(e<=o&&t<=o&&a<=n&&a<=r&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,n,r,this._queryCell,s,{},i),s},Zr.prototype._queryCell=function(e,t,n,r,i,o,a,s){var u=this.cells[i];if(null!==u)for(var c=this.keys,l=this.bboxes,p=0;p<u.length;p++){var f=u[p];if(void 0===a[f]){var h=4*f;(s?s(l[h+0],l[h+1],l[h+2],l[h+3]):e<=l[h+2]&&t<=l[h+3]&&n>=l[h+0]&&r>=l[h+1])?(a[f]=!0,o.push(c[f])):a[f]=!1}}},Zr.prototype._forEachCell=function(e,t,n,r,i,o,a,s){for(var u=this._convertToCellCoord(e),c=this._convertToCellCoord(t),l=this._convertToCellCoord(n),p=this._convertToCellCoord(r),f=u;f<=l;f++)for(var h=c;h<=p;h++){var d=this.d*h+f;if((!s||s(this._convertFromCellCoord(f),this._convertFromCellCoord(h),this._convertFromCellCoord(f+1),this._convertFromCellCoord(h+1)))&&i.call(this,e,t,n,r,d,o,a,s))return}},Zr.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Zr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Zr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=qr+this.cells.length+1+1,n=0,r=0;r<this.cells.length;r++)n+=this.cells[r].length;var i=new Int32Array(t+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=t,a=0;a<e.length;a++){var s=e[a];i[qr+a]=o,i.set(s,o),o+=s.length}return i[qr+e.length]=o,i.set(this.keys,o),i[qr+e.length+1]=o+=this.keys.length,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};var Hr=self.ImageData,Wr=self.ImageBitmap,Yr={};function Xr(e,t,n){void 0===n&&(n={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Yr[e]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}for(var Kr in Xr("Object",Object),Gr.serialize=function(e,t){var n=e.toArrayBuffer();return t&&t.push(n),{buffer:n}},Gr.deserialize=function(e){return new Gr(e.buffer)},Xr("Grid",Gr),Xr("Color",Je),Xr("Error",Error),Xr("ResolvedImage",tt),Xr("StylePropertyFunction",sr),Xr("StyleExpression",tr,{omit:["_evaluator"]}),Xr("ZoomDependentExpression",or),Xr("ZoomConstantExpression",ir),Xr("CompoundExpression",gt,{omit:["_evaluate"]}),Nn)Nn[Kr]._classRegistryKey||Xr("Expression_"+Kr,Nn[Kr]);function Jr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Qr(e){return Wr&&e instanceof Wr}function $r(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Jr(e)||Qr(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var n=e;return t&&t.push(n.buffer),n}if(e instanceof Hr)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var r=[],i=0,o=e;i<o.length;i+=1)r.push($r(o[i],t));return r}if("object"==typeof e){var a=e.constructor,s=a._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var u=a.serialize?a.serialize(e,t):{};if(!a.serialize){for(var c in e)if(e.hasOwnProperty(c)&&!(Yr[s].omit.indexOf(c)>=0)){var l=e[c];u[c]=Yr[s].shallow.indexOf(c)>=0?l:$r(l,t)}e instanceof Error&&(u.message=e.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof e)}function ei(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Jr(e)||Qr(e)||ArrayBuffer.isView(e)||e instanceof Hr)return e;if(Array.isArray(e))return e.map(ei);if("object"==typeof e){var t=e.$name||"Object",n=Yr[t].klass;if(!n)throw new Error("can't deserialize unregistered class "+t);if(n.deserialize)return n.deserialize(e);for(var r=Object.create(n.prototype),i=0,o=Object.keys(e);i<o.length;i+=1){var a=o[i];if("$name"!==a){var s=e[a];r[a]=Yr[t].shallow.indexOf(a)>=0?s:ei(s)}}return r}throw new Error("can't deserialize object of type "+typeof e)}var ti=function(){this.first=!0};ti.prototype.update=function(e,t){var n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=n,!0))};var ni={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function ri(e){for(var t=0,n=e;t<n.length;t+=1)if(ii(n[t].charCodeAt(0)))return!0;return!1}function ii(e){return!(746!==e&&747!==e&&(e<4352||!(ni["Bopomofo Extended"](e)||ni.Bopomofo(e)||ni["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||ni["CJK Compatibility Ideographs"](e)||ni["CJK Compatibility"](e)||ni["CJK Radicals Supplement"](e)||ni["CJK Strokes"](e)||!(!ni["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||ni["CJK Unified Ideographs Extension A"](e)||ni["CJK Unified Ideographs"](e)||ni["Enclosed CJK Letters and Months"](e)||ni["Hangul Compatibility Jamo"](e)||ni["Hangul Jamo Extended-A"](e)||ni["Hangul Jamo Extended-B"](e)||ni["Hangul Jamo"](e)||ni["Hangul Syllables"](e)||ni.Hiragana(e)||ni["Ideographic Description Characters"](e)||ni.Kanbun(e)||ni["Kangxi Radicals"](e)||ni["Katakana Phonetic Extensions"](e)||ni.Katakana(e)&&12540!==e||!(!ni["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!ni["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||ni["Unified Canadian Aboriginal Syllabics"](e)||ni["Unified Canadian Aboriginal Syllabics Extended"](e)||ni["Vertical Forms"](e)||ni["Yijing Hexagram Symbols"](e)||ni["Yi Syllables"](e)||ni["Yi Radicals"](e))))}function oi(e){return!(ii(e)||function(e){return!!(ni["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||ni["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||ni["Letterlike Symbols"](e)||ni["Number Forms"](e)||ni["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||ni["Control Pictures"](e)&&9251!==e||ni["Optical Character Recognition"](e)||ni["Enclosed Alphanumerics"](e)||ni["Geometric Shapes"](e)||ni["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ni["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ni["CJK Symbols and Punctuation"](e)||ni.Katakana(e)||ni["Private Use Area"](e)||ni["CJK Compatibility Forms"](e)||ni["Small Form Variants"](e)||ni["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function ai(e){return e>=1424&&e<=2303||ni["Arabic Presentation Forms-A"](e)||ni["Arabic Presentation Forms-B"](e)}function si(e,t){return!(!t&&ai(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||ni.Khmer(e))}function ui(e){for(var t=0,n=e;t<n.length;t+=1)if(ai(n[t].charCodeAt(0)))return!0;return!1}var ci=null,li="unavailable",pi=null,fi=function(e){ci&&ci(e)};function hi(){di.fire(new Te("pluginStateChange",{pluginStatus:li,pluginURL:pi}))}var di=new Ae,mi=function(){return li},gi=function(){if("deferred"!==li||!pi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");li="loading",hi(),pi&&be({url:pi},(function(e){e?fi(e):(li="loaded",hi())}))},vi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===li||null!=vi.applyArabicShaping},isLoading:function(){return"loading"===li},setState:function(e){li=e.pluginStatus,pi=e.pluginURL},isParsed:function(){return null!=vi.applyArabicShaping&&null!=vi.processBidirectionalText&&null!=vi.processStyledBidirectionalText},getPluginURL:function(){return pi}},yi=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ti,this.transition={})};yi.prototype.isSupportedScript=function(e){return function(e,t){for(var n=0,r=e;n<r.length;n+=1)if(!si(r[n].charCodeAt(0),t))return!1;return!0}(e,vi.isLoaded())},yi.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},yi.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*t}};var _i=function(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Yn(e))return new sr(e,t);if(nr(e)){var n=ar(e,t);if("error"===n.result)throw new Error(n.value.map((function(e){return e.key+": "+e.message})).join(", "));return n.value}var r=e;return"string"==typeof e&&"color"===t.type&&(r=Je.parse(e)),{kind:"constant",evaluate:function(){return r}}}(void 0===t?e.specification.default:t,e.specification)};_i.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},_i.prototype.possiblyEvaluate=function(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)};var bi=function(e){this.property=e,this.value=new _i(e,void 0)};bi.prototype.transitioned=function(e,t){return new wi(this.property,this.value,t,l({},e.transition,this.transition),e.now)},bi.prototype.untransitioned=function(){return new wi(this.property,this.value,null,{},0)};var xi=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};xi.prototype.getValue=function(e){return _(this._values[e].value.value)},xi.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new bi(this._values[e].property)),this._values[e].value=new _i(this._values[e].property,null===t?void 0:_(t))},xi.prototype.getTransition=function(e){return _(this._values[e].transition)},xi.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new bi(this._values[e].property)),this._values[e].transition=_(t)||void 0},xi.prototype.serialize=function(){for(var e={},t=0,n=Object.keys(this._values);t<n.length;t+=1){var r=n[t],i=this.getValue(r);void 0!==i&&(e[r]=i);var o=this.getTransition(r);void 0!==o&&(e[r+"-transition"]=o)}return e},xi.prototype.transitioned=function(e,t){for(var n=new Si(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].transitioned(e,t._values[o])}return n},xi.prototype.untransitioned=function(){for(var e=new Si(this._properties),t=0,n=Object.keys(this._values);t<n.length;t+=1){var r=n[t];e._values[r]=this._values[r].untransitioned()}return e};var wi=function(e,t,n,r,i){this.property=e,this.value=t,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,e.specification.transition&&(r.delay||r.duration)&&(this.prior=n)};wi.prototype.possiblyEvaluate=function(e,t,n){var r=e.now||0,i=this.value.possiblyEvaluate(e,t,n),o=this.prior;if(o){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return o.possiblyEvaluate(e,t,n);var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,n),i,function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}(a))}return i};var Si=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Si.prototype.possiblyEvaluate=function(e,t){for(var n=new ki(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].possiblyEvaluate(e,t)}return n},Si.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var Ei=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Ei.prototype.getValue=function(e){return _(this._values[e].value)},Ei.prototype.setValue=function(e,t){this._values[e]=new _i(this._values[e].property,null===t?void 0:_(t))},Ei.prototype.serialize=function(){for(var e={},t=0,n=Object.keys(this._values);t<n.length;t+=1){var r=n[t],i=this.getValue(r);void 0!==i&&(e[r]=i)}return e},Ei.prototype.possiblyEvaluate=function(e,t){for(var n=new ki(this._properties),r=0,i=Object.keys(this._values);r<i.length;r+=1){var o=i[r];n._values[o]=this._values[o].possiblyEvaluate(e,t)}return n};var Ti=function(e,t,n){this.property=e,this.value=t,this.parameters=n};Ti.prototype.isConstant=function(){return"constant"===this.value.kind},Ti.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},Ti.prototype.evaluate=function(e,t,n,r){return this.property.evaluate(this.value,this.parameters,e,t,n,r)};var ki=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ki.prototype.get=function(e){return this._values[e]};var Ai=function(e){this.specification=e};Ai.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Ai.prototype.interpolate=function(e,t,n){var r=Jt[this.specification.type];return r?r(e,t,n):e};var Ci=function(e,t){this.specification=e,this.overrides=t};Ci.prototype.possiblyEvaluate=function(e,t,n,r){return new Ti(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},n,r)}:e.expression,t)},Ci.prototype.interpolate=function(e,t,n){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Ti(this,{kind:"constant",value:void 0},e.parameters);var r=Jt[this.specification.type];return r?new Ti(this,{kind:"constant",value:r(e.value.value,t.value.value,n)},e.parameters):e},Ci.prototype.evaluate=function(e,t,n,r,i,o){return"constant"===e.kind?e.value:e.evaluate(t,n,r,i,o)};var Ii=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(e,t,n,r){if(void 0===e.value)return new Ti(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){var i=e.expression.evaluate(t,null,{},n,r),o="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,a=this._calculate(o,o,o,t);return new Ti(this,{kind:"constant",value:a},t)}if("camera"===e.expression.kind){var s=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Ti(this,{kind:"constant",value:s},t)}return new Ti(this,e.expression,t)},t.prototype.evaluate=function(e,t,n,r,i,o){if("source"===e.kind){var a=e.evaluate(t,n,r,i,o);return this._calculate(a,a,a,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},n,r),e.evaluate({zoom:Math.floor(t.zoom)},n,r),e.evaluate({zoom:Math.floor(t.zoom)+1},n,r),t):e.value},t.prototype._calculate=function(e,t,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}},t.prototype.interpolate=function(e){return e},t}(Ci),Mi=function(e){this.specification=e};Mi.prototype.possiblyEvaluate=function(e,t,n,r){if(void 0!==e.value){if("constant"===e.expression.kind){var i=e.expression.evaluate(t,null,{},n,r);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new yi(Math.floor(t.zoom-1),t)),e.expression.evaluate(new yi(Math.floor(t.zoom),t)),e.expression.evaluate(new yi(Math.floor(t.zoom+1),t)),t)}},Mi.prototype._calculate=function(e,t,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}},Mi.prototype.interpolate=function(e){return e};var Pi=function(e){this.specification=e};Pi.prototype.possiblyEvaluate=function(e,t,n,r){return!!e.expression.evaluate(t,null,{},n,r)},Pi.prototype.interpolate=function(){return!1};var Oi=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var n=e[t];n.specification.overridable&&this.overridableProperties.push(t);var r=this.defaultPropertyValues[t]=new _i(n,void 0),i=this.defaultTransitionablePropertyValues[t]=new bi(n);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=r.possiblyEvaluate({})}};Xr("DataDrivenProperty",Ci),Xr("DataConstantProperty",Ai),Xr("CrossFadedDataDrivenProperty",Ii),Xr("CrossFadedProperty",Mi),Xr("ColorRampProperty",Pi);var Li=function(e){function t(t,n){if(e.call(this),this.id=t.id,this.type=t.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new Ei(n.layout)),n.paint)){for(var r in this._transitionablePaint=new xi(n.paint),t.paint)this.setPaintProperty(r,t.paint[r],{validate:!1});for(var i in t.layout)this.setLayoutProperty(i,t.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(e,t,n){void 0===n&&(n={}),null!=t&&this._validate(Ur,"layers."+this.id+".layout."+e,e,t,n)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)},t.prototype.getPaintProperty=function(e){return g(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-"-transition".length)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(e,t,n){if(void 0===n&&(n={}),null!=t&&this._validate(Br,"layers."+this.id+".paint."+e,e,t,n))return!1;if(g(e,"-transition"))return this._transitionablePaint.setTransition(e.slice(0,-"-transition".length),t||void 0),!1;var r=this._transitionablePaint._values[e],i="cross-faded-data-driven"===r.property.specification["property-type"],o=r.value.isDataDriven(),a=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||o||i||this._handleOverridablePaintPropertyUpdate(e,a,s)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){},t.prototype._handleOverridablePaintPropertyUpdate=function(e,t,n){return!1},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,t)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),y(e,(function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)}))},t.prototype._validate=function(e,t,n,r,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&Vr(this,e.call(jr,{key:t,layerType:this.type,objectKey:n,value:r,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof Ti&&qn(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1},t}(Ae),Ri={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Di=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},zi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ni(e,t){void 0===t&&(t=1);var n=0,r=0;return{members:e.map((function(e){var i=Ri[e.type].BYTES_PER_ELEMENT,o=n=ji(n,Math.max(t,i)),a=e.components||1;return r=Math.max(r,i),n+=i*a,{name:e.name,type:e.type,components:a,offset:o}})),size:ji(n,Math.max(r,t)),alignment:t}}function ji(e,t){return Math.ceil(e/t)*t}zi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},zi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},zi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},zi.prototype.clear=function(){this.length=0},zi.prototype.resize=function(e){this.reserve(e),this.length=e},zi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},zi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Fi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var n=this.length;return this.resize(n+1),this.emplace(n,e,t)},t.prototype.emplace=function(e,t,n){var r=2*e;return this.int16[r+0]=t,this.int16[r+1]=n,e},t}(zi);Fi.prototype.bytesPerElement=4,Xr("StructArrayLayout2i4",Fi);var Bi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)},t.prototype.emplace=function(e,t,n,r,i){var o=4*e;return this.int16[o+0]=t,this.int16[o+1]=n,this.int16[o+2]=r,this.int16[o+3]=i,e},t}(zi);Bi.prototype.bytesPerElement=8,Xr("StructArrayLayout4i8",Bi);var Ui=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i,o)},t.prototype.emplace=function(e,t,n,r,i,o,a){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,e},t}(zi);Ui.prototype.bytesPerElement=12,Xr("StructArrayLayout2i4i12",Ui);var Vi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i,o)},t.prototype.emplace=function(e,t,n,r,i,o,a){var s=4*e,u=8*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.uint8[u+4]=r,this.uint8[u+5]=i,this.uint8[u+6]=o,this.uint8[u+7]=a,e},t}(zi);Vi.prototype.bytesPerElement=8,Xr("StructArrayLayout2i4ub8",Vi);var Gi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o,a,s,u,c){var l=this.length;return this.resize(l+1),this.emplace(l,e,t,n,r,i,o,a,s,u,c)},t.prototype.emplace=function(e,t,n,r,i,o,a,s,u,c,l){var p=9*e,f=18*e;return this.uint16[p+0]=t,this.uint16[p+1]=n,this.uint16[p+2]=r,this.uint16[p+3]=i,this.uint16[p+4]=o,this.uint16[p+5]=a,this.uint16[p+6]=s,this.uint16[p+7]=u,this.uint8[f+16]=c,this.uint8[f+17]=l,e},t}(zi);Gi.prototype.bytesPerElement=18,Xr("StructArrayLayout8ui2ub18",Gi);var qi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o,a,s,u,c,l,p){var f=this.length;return this.resize(f+1),this.emplace(f,e,t,n,r,i,o,a,s,u,c,l,p)},t.prototype.emplace=function(e,t,n,r,i,o,a,s,u,c,l,p,f){var h=12*e;return this.int16[h+0]=t,this.int16[h+1]=n,this.int16[h+2]=r,this.int16[h+3]=i,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=u,this.int16[h+8]=c,this.int16[h+9]=l,this.int16[h+10]=p,this.int16[h+11]=f,e},t}(zi);qi.prototype.bytesPerElement=24,Xr("StructArrayLayout4i4ui4i24",qi);var Zi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)},t.prototype.emplace=function(e,t,n,r){var i=3*e;return this.float32[i+0]=t,this.float32[i+1]=n,this.float32[i+2]=r,e},t}(zi);Zi.prototype.bytesPerElement=12,Xr("StructArrayLayout3f12",Zi);var Hi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.uint32[1*e+0]=t,e},t}(zi);Hi.prototype.bytesPerElement=4,Xr("StructArrayLayout1ul4",Hi);var Wi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o,a,s,u,c,l){var p=this.length;return this.resize(p+1),this.emplace(p,e,t,n,r,i,o,a,s,u,c,l)},t.prototype.emplace=function(e,t,n,r,i,o,a,s,u,c,l,p){var f=12*e,h=6*e;return this.int16[f+0]=t,this.int16[f+1]=n,this.int16[f+2]=r,this.int16[f+3]=i,this.int16[f+4]=o,this.int16[f+5]=a,this.uint32[h+3]=s,this.uint16[f+8]=u,this.uint16[f+9]=c,this.int16[f+10]=l,this.int16[f+11]=p,e},t}(zi);Wi.prototype.bytesPerElement=24,Xr("StructArrayLayout6i1ul2ui2i24",Wi);var Yi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i,o)},t.prototype.emplace=function(e,t,n,r,i,o,a){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,e},t}(zi);Yi.prototype.bytesPerElement=12,Xr("StructArrayLayout2i2i2i12",Yi);var Xi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)},t.prototype.emplace=function(e,t,n,r,i){var o=12*e,a=3*e;return this.uint8[o+0]=t,this.uint8[o+1]=n,this.float32[a+1]=r,this.float32[a+2]=i,e},t}(zi);Xi.prototype.bytesPerElement=12,Xr("StructArrayLayout2ub2f12",Xi);var Ki=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g){var v=this.length;return this.resize(v+1),this.emplace(v,e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g)},t.prototype.emplace=function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g,v){var y=24*e,_=12*e,b=48*e;return this.int16[y+0]=t,this.int16[y+1]=n,this.uint16[y+2]=r,this.uint16[y+3]=i,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[y+10]=u,this.uint16[y+11]=c,this.uint16[y+12]=l,this.float32[_+7]=p,this.float32[_+8]=f,this.uint8[b+36]=h,this.uint8[b+37]=d,this.uint8[b+38]=m,this.uint32[_+10]=g,this.int16[y+22]=v,e},t}(zi);Ki.prototype.bytesPerElement=48,Xr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ki);var Ji=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g,v,y,_,b,x,w,S,E,T){var k=this.length;return this.resize(k+1),this.emplace(k,e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g,v,y,_,b,x,w,S,E,T)},t.prototype.emplace=function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g,v,y,_,b,x,w,S,E,T,k){var A=30*e,C=15*e;return this.int16[A+0]=t,this.int16[A+1]=n,this.int16[A+2]=r,this.int16[A+3]=i,this.int16[A+4]=o,this.int16[A+5]=a,this.int16[A+6]=s,this.int16[A+7]=u,this.uint16[A+8]=c,this.uint16[A+9]=l,this.uint16[A+10]=p,this.uint16[A+11]=f,this.uint16[A+12]=h,this.uint16[A+13]=d,this.uint16[A+14]=m,this.uint16[A+15]=g,this.uint16[A+16]=v,this.uint16[A+17]=y,this.uint16[A+18]=_,this.uint16[A+19]=b,this.uint16[A+20]=x,this.uint16[A+21]=w,this.uint32[C+11]=S,this.float32[C+12]=E,this.float32[C+13]=T,this.float32[C+14]=k,e},t}(zi);Ji.prototype.bytesPerElement=60,Xr("StructArrayLayout8i14ui1ul3f60",Ji);var Qi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.float32[1*e+0]=t,e},t}(zi);Qi.prototype.bytesPerElement=4,Xr("StructArrayLayout1f4",Qi);var $i=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)},t.prototype.emplace=function(e,t,n,r){var i=3*e;return this.int16[i+0]=t,this.int16[i+1]=n,this.int16[i+2]=r,e},t}(zi);$i.prototype.bytesPerElement=6,Xr("StructArrayLayout3i6",$i);var eo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)},t.prototype.emplace=function(e,t,n,r){var i=4*e;return this.uint32[2*e+0]=t,this.uint16[i+2]=n,this.uint16[i+3]=r,e},t}(zi);eo.prototype.bytesPerElement=8,Xr("StructArrayLayout1ul2ui8",eo);var to=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n){var r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)},t.prototype.emplace=function(e,t,n,r){var i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=n,this.uint16[i+2]=r,e},t}(zi);to.prototype.bytesPerElement=6,Xr("StructArrayLayout3ui6",to);var no=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var n=this.length;return this.resize(n+1),this.emplace(n,e,t)},t.prototype.emplace=function(e,t,n){var r=2*e;return this.uint16[r+0]=t,this.uint16[r+1]=n,e},t}(zi);no.prototype.bytesPerElement=4,Xr("StructArrayLayout2ui4",no);var ro=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)},t.prototype.emplace=function(e,t){return this.uint16[1*e+0]=t,e},t}(zi);ro.prototype.bytesPerElement=2,Xr("StructArrayLayout1ui2",ro);var io=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var n=this.length;return this.resize(n+1),this.emplace(n,e,t)},t.prototype.emplace=function(e,t,n){var r=2*e;return this.float32[r+0]=t,this.float32[r+1]=n,e},t}(zi);io.prototype.bytesPerElement=8,Xr("StructArrayLayout2f8",io);var oo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,n,r){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)},t.prototype.emplace=function(e,t,n,r,i){var o=4*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=r,this.float32[o+3]=i,e},t}(zi);oo.prototype.bytesPerElement=16,Xr("StructArrayLayout4f16",oo);var ao=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return n.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},n.x1.get=function(){return this._structArray.int16[this._pos2+2]},n.y1.get=function(){return this._structArray.int16[this._pos2+3]},n.x2.get=function(){return this._structArray.int16[this._pos2+4]},n.y2.get=function(){return this._structArray.int16[this._pos2+5]},n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.radius.get=function(){return this._structArray.int16[this._pos2+10]},n.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},n.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,n),t}(Di);ao.prototype.size=24;var so=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new ao(this,e)},t}(Wi);Xr("CollisionBoxArray",so);var uo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},n.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},n.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},n.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},n.segment.get=function(){return this._structArray.uint16[this._pos2+10]},n.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},n.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},n.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},n.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},n.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},n.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},n.placedOrientation.set=function(e){this._structArray.uint8[this._pos1+37]=e},n.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},n.hidden.set=function(e){this._structArray.uint8[this._pos1+38]=e},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},n.crossTileID.set=function(e){this._structArray.uint32[this._pos4+10]=e},n.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,n),t}(Di);uo.prototype.size=48;var co=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new uo(this,e)},t}(Ki);Xr("PlacedSymbolArray",co);var lo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0}};return n.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},n.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},n.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},n.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},n.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},n.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},n.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},n.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},n.key.get=function(){return this._structArray.uint16[this._pos2+8]},n.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},n.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},n.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},n.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},n.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},n.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},n.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},n.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},n.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},n.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},n.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},n.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},n.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},n.crossTileID.get=function(){return this._structArray.uint32[this._pos4+11]},n.crossTileID.set=function(e){this._structArray.uint32[this._pos4+11]=e},n.textBoxScale.get=function(){return this._structArray.float32[this._pos4+12]},n.textOffset0.get=function(){return this._structArray.float32[this._pos4+13]},n.textOffset1.get=function(){return this._structArray.float32[this._pos4+14]},Object.defineProperties(t.prototype,n),t}(Di);lo.prototype.size=60;var po=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new lo(this,e)},t}(Ji);Xr("SymbolInstanceArray",po);var fo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t}(Qi);Xr("GlyphOffsetArray",fo);var ho=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t}($i);Xr("SymbolLineVertexArray",ho);var mo=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return n.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},n.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},n.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,n),t}(Di);mo.prototype.size=8;var go=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(e){return new mo(this,e)},t}(eo);Xr("FeatureIndexArray",go);var vo=Ni([{name:"a_pos",components:2,type:"Int16"}],4).members,yo=function(e){void 0===e&&(e=[]),this.segments=e};function _o(e,t){return 256*(e=u(Math.floor(e),0,255))+u(Math.floor(t),0,255)}yo.prototype.prepareSegment=function(e,t,n,r){var i=this.segments[this.segments.length-1];return e>yo.MAX_VERTEX_ARRAY_LENGTH&&x("Max vertices per segment is "+yo.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!i||i.vertexLength+e>yo.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i},yo.prototype.get=function(){return this.segments},yo.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var n=t[e];for(var r in n.vaos)n.vaos[r].destroy()}},yo.simpleSegment=function(e,t,n,r){return new yo([{vertexOffset:e,primitiveOffset:t,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])},yo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xr("SegmentVector",yo);var bo=Ni([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),xo=t((function(e){e.exports=function(e,t){var n,r,i,o,a,s,u,c;for(r=e.length-(n=3&e.length),i=t,a=3432918353,s=461845907,c=0;c<r;)u=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(c+2))<<16;case 2:u^=(255&e.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),wo=t((function(e){e.exports=function(e,t){for(var n,r=e.length,i=t^r,o=0;r>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++o;switch(r){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),So=xo,Eo=wo;So.murmur3=xo,So.murmur2=Eo;var To=function(){this.ids=[],this.positions=[],this.indexed=!1};To.prototype.add=function(e,t,n,r){this.ids.push(Ao(e)),this.positions.push(t,n,r)},To.prototype.getPositions=function(e){for(var t=Ao(e),n=0,r=this.ids.length-1;n<r;){var i=n+r>>1;this.ids[i]>=t?r=i:n=i+1}for(var o=[];this.ids[n]===t;)o.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return o},To.serialize=function(e,t){var n=new Float64Array(e.ids),r=new Uint32Array(e.positions);return function e(t,n,r,i){if(!(r>=i)){for(var o=t[r+i>>1],a=r-1,s=i+1;;){do{a++}while(t[a]<o);do{s--}while(t[s]>o);if(a>=s)break;Co(t,a,s),Co(n,3*a,3*s),Co(n,3*a+1,3*s+1),Co(n,3*a+2,3*s+2)}e(t,n,r,s),e(t,n,s+1,i)}}(n,r,0,n.length-1),t&&t.push(n.buffer,r.buffer),{ids:n,positions:r}},To.deserialize=function(e){var t=new To;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ko=Math.pow(2,53)-1;function Ao(e){var t=+e;return!isNaN(t)&&t<=ko?t:So(String(e))}function Co(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}Xr("FeaturePositionMap",To);var Io=function(e,t){this.gl=e.gl,this.location=t},Mo=function(e){function t(t,n){e.call(this,t,n),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))},t}(Io),Po=function(e){function t(t,n){e.call(this,t,n),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))},t}(Io),Oo=function(e){function t(t,n){e.call(this,t,n),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))},t}(Io),Lo=function(e){function t(t,n){e.call(this,t,n),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))},t}(Io),Ro=function(e){function t(t,n){e.call(this,t,n),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))},t}(Io),Do=function(e){function t(t,n){e.call(this,t,n),this.current=Je.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))},t}(Io),zo=new Float32Array(16),No=function(e){function t(t,n){e.call(this,t,n),this.current=zo}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(var t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}},t}(Io);function jo(e){return[_o(255*e.r,255*e.g),_o(255*e.b,255*e.a)]}var Fo=function(e,t,n){this.value=e,this.uniformNames=t.map((function(e){return"u_"+e})),this.type=n};Fo.prototype.setUniform=function(e,t,n){e.set(n.constantOr(this.value))},Fo.prototype.getBinding=function(e,t,n){return"color"===this.type?new Do(e,t):new Po(e,t)};var Bo=function(e,t){this.uniformNames=t.map((function(e){return"u_"+e})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Bo.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Bo.prototype.setUniform=function(e,t,n,r){var i="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&e.set(i)},Bo.prototype.getBinding=function(e,t,n){return"u_pattern"===n.substr(0,9)?new Ro(e,t):new Po(e,t)};var Uo=function(e,t,n,r){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=t.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new r};Uo.prototype.populatePaintArray=function(e,t,n,r,i){var o=this.paintVertexArray.length,a=this.expression.evaluate(new yi(0),t,{},r,[],i);this.paintVertexArray.resize(e),this._setPaintValue(o,e,a)},Uo.prototype.updatePaintArray=function(e,t,n,r){var i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(e,t,i)},Uo.prototype._setPaintValue=function(e,t,n){if("color"===this.type)for(var r=jo(n),i=e;i<t;i++)this.paintVertexArray.emplace(i,r[0],r[1]);else{for(var o=e;o<t;o++)this.paintVertexArray.emplace(o,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}},Uo.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Uo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Vo=function(e,t,n,r,i,o){this.expression=e,this.uniformNames=t.map((function(e){return"u_"+e+"_t"})),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((function(e){return{name:"a_"+e,type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new o};Vo.prototype.populatePaintArray=function(e,t,n,r,i){var o=this.expression.evaluate(new yi(this.zoom),t,{},r,[],i),a=this.expression.evaluate(new yi(this.zoom+1),t,{},r,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,o,a)},Vo.prototype.updatePaintArray=function(e,t,n,r){var i=this.expression.evaluate({zoom:this.zoom},n,r),o=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(e,t,i,o)},Vo.prototype._setPaintValue=function(e,t,n,r){if("color"===this.type)for(var i=jo(n),o=jo(r),a=e;a<t;a++)this.paintVertexArray.emplace(a,i[0],i[1],o[0],o[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}},Vo.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Vo.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Vo.prototype.setUniform=function(e,t){var n=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,r=u(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(r)},Vo.prototype.getBinding=function(e,t,n){return new Po(e,t)};var Go=function(e,t,n,r,i,o){this.expression=e,this.type=t,this.useIntegerZoom=n,this.zoom=r,this.layerId=o,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i};Go.prototype.populatePaintArray=function(e,t,n){var r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(r,e,t.patterns&&t.patterns[this.layerId],n)},Go.prototype.updatePaintArray=function(e,t,n,r,i){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],i)},Go.prototype._setPaintValues=function(e,t,n,r){if(r&&n){var i=r[n.min],o=r[n.mid],a=r[n.max];if(i&&o&&a)for(var s=e;s<t;s++)this.zoomInPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],o.pixelRatio,i.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,o.tl[0],o.tl[1],o.br[0],o.br[1],a.tl[0],a.tl[1],a.br[0],a.br[1],o.pixelRatio,a.pixelRatio)}},Go.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,bo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,bo.members,this.expression.isStateDependent))},Go.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var qo=function(e,t,n,r){this.binders={},this.layoutAttributes=r,this._buffers=[];var i=[];for(var o in e.paint._values)if(n(o)){var a=e.paint.get(o);if(a instanceof Ti&&qn(a.property.specification)){var s=Ho(o,e.type),u=a.value,c=a.property.specification.type,l=a.property.useIntegerZoom,p=a.property.specification["property-type"],f="cross-faded"===p||"cross-faded-data-driven"===p;if("constant"===u.kind)this.binders[o]=f?new Bo(u.value,s):new Fo(u.value,s,c),i.push("/u_"+o);else if("source"===u.kind||f){var h=Wo(o,c,"source");this.binders[o]=f?new Go(u,c,l,t,h,e.id):new Uo(u,s,c,h),i.push("/a_"+o)}else{var d=Wo(o,c,"composite");this.binders[o]=new Vo(u,s,c,l,t,d),i.push("/z_"+o)}}}this.cacheKey=i.sort().join("")};qo.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Uo||t instanceof Vo?t.maxValue:0},qo.prototype.populatePaintArrays=function(e,t,n,r,i){for(var o in this.binders){var a=this.binders[o];(a instanceof Uo||a instanceof Vo||a instanceof Go)&&a.populatePaintArray(e,t,n,r,i)}},qo.prototype.setConstantPatternPositions=function(e,t){for(var n in this.binders){var r=this.binders[n];r instanceof Bo&&r.setConstantPatternPositions(e,t)}},qo.prototype.updatePaintArrays=function(e,t,n,r,i){var o=!1;for(var a in e)for(var s=0,u=t.getPositions(a);s<u.length;s+=1){var c=u[s],l=n.feature(c.index);for(var p in this.binders){var f=this.binders[p];if((f instanceof Uo||f instanceof Vo||f instanceof Go)&&!0===f.expression.isStateDependent){var h=r.paint.get(p);f.expression=h.value,f.updatePaintArray(c.start,c.end,l,e[a],i),o=!0}}}return o},qo.prototype.defines=function(){var e=[];for(var t in this.binders){var n=this.binders[t];(n instanceof Fo||n instanceof Bo)&&e.push.apply(e,n.uniformNames.map((function(e){return"#define HAS_UNIFORM_"+e})))}return e},qo.prototype.getPaintVertexBuffers=function(){return this._buffers},qo.prototype.getUniforms=function(e,t){var n=[];for(var r in this.binders){var i=this.binders[r];if(i instanceof Fo||i instanceof Bo||i instanceof Vo)for(var o=0,a=i.uniformNames;o<a.length;o+=1){var s=a[o];if(t[s]){var u=i.getBinding(e,t[s],s);n.push({name:s,property:r,binding:u})}}}return n},qo.prototype.setUniforms=function(e,t,n,r){for(var i=0,o=t;i<o.length;i+=1){var a=o[i],s=a.name,u=a.property;this.binders[u].setUniform(a.binding,r,n.get(u),s)}},qo.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var n=this.binders[t];if(e&&n instanceof Go){var r=2===e.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;r&&this._buffers.push(r)}else(n instanceof Uo||n instanceof Vo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}},qo.prototype.upload=function(e){for(var t in this.binders){var n=this.binders[t];(n instanceof Uo||n instanceof Vo||n instanceof Go)&&n.upload(e)}this.updatePaintBuffers()},qo.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Uo||t instanceof Vo||t instanceof Go)&&t.destroy()}};var Zo=function(e,t,n,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var i=0,o=t;i<o.length;i+=1){var a=o[i];this.programConfigurations[a.id]=new qo(a,n,r,e)}this.needsUpload=!1,this._featureMap=new To,this._bufferOffset=0};function Ho(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Wo(e,t,n){var r={color:{source:io,composite:oo},number:{source:Qi,composite:io}},i=function(e){return{"line-pattern":{source:Gi,composite:Gi},"fill-pattern":{source:Gi,composite:Gi},"fill-extrusion-pattern":{source:Gi,composite:Gi}}[e]}(e);return i&&i[n]||r[t][n]}Zo.prototype.populatePaintArrays=function(e,t,n,r,i,o){for(var a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,r,i,o);void 0!==t.id&&this._featureMap.add(t.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Zo.prototype.updatePaintArrays=function(e,t,n,r){for(var i=0,o=n;i<o.length;i+=1){var a=o[i];this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,r)||this.needsUpload}},Zo.prototype.get=function(e){return this.programConfigurations[e]},Zo.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Zo.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Xr("ConstantBinder",Fo),Xr("CrossFadedConstantBinder",Bo),Xr("SourceExpressionBinder",Uo),Xr("CrossFadedCompositeBinder",Go),Xr("CompositeExpressionBinder",Vo),Xr("ProgramConfiguration",qo,{omit:["_buffers"]}),Xr("ProgramConfigurationSet",Zo);var Yo={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function Xo(e){for(var t=At/e.extent,n=e.loadGeometry(),r=0;r<n.length;r++)for(var i=n[r],o=0;o<i.length;o++){var a=i[o];a.x=Math.round(a.x*t),a.y=Math.round(a.y*t),(a.x<Yo.min||a.x>Yo.max||a.y<Yo.min||a.y>Yo.max)&&(x("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a.x=u(a.x,Yo.min,Yo.max),a.y=u(a.y,Yo.min,Yo.max))}return n}function Ko(e,t,n,r,i){e.emplaceBack(2*t+(r+1)/2,2*n+(i+1)/2)}var Jo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Fi,this.indexArray=new to,this.segments=new yo,this.programConfigurations=new Zo(vo,e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};function Qo(e,t){for(var n=0;n<e.length;n++)if(sa(t,e[n]))return!0;for(var r=0;r<t.length;r++)if(sa(e,t[r]))return!0;return!!na(e,t)}function $o(e,t,n){return!!sa(e,t)||!!ia(t,e,n)}function ea(e,t){if(1===e.length)return aa(t,e[0]);for(var n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.length;i++)if(sa(e,r[i]))return!0;for(var o=0;o<e.length;o++)if(aa(t,e[o]))return!0;for(var a=0;a<t.length;a++)if(na(e,t[a]))return!0;return!1}function ta(e,t,n){if(e.length>1){if(na(e,t))return!0;for(var r=0;r<t.length;r++)if(ia(t[r],e,n))return!0}for(var i=0;i<e.length;i++)if(ia(e[i],t,n))return!0;return!1}function na(e,t){if(0===e.length||0===t.length)return!1;for(var n=0;n<e.length-1;n++)for(var r=e[n],i=e[n+1],o=0;o<t.length-1;o++)if(ra(r,i,t[o],t[o+1]))return!0;return!1}function ra(e,t,n,r){return w(e,n,r)!==w(t,n,r)&&w(e,t,n)!==w(e,t,r)}function ia(e,t,n){var r=n*n;if(1===t.length)return e.distSqr(t[0])<r;for(var i=1;i<t.length;i++)if(oa(e,t[i-1],t[i])<r)return!0;return!1}function oa(e,t,n){var r=t.distSqr(n);if(0===r)return e.distSqr(t);var i=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;return e.distSqr(i<0?t:i>1?n:n.sub(t)._mult(i)._add(t))}function aa(e,t){for(var n,r,i,o=!1,a=0;a<e.length;a++)for(var s=0,u=(n=e[a]).length-1;s<n.length;u=s++)(r=n[s]).y>t.y!=(i=n[u]).y>t.y&&t.x<(i.x-r.x)*(t.y-r.y)/(i.y-r.y)+r.x&&(o=!o);return o}function sa(e,t){for(var n=!1,r=0,i=e.length-1;r<e.length;i=r++){var o=e[r],a=e[i];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n}function ua(e,t,n){var r=n[0],i=n[2];if(e.x<r.x&&t.x<r.x||e.x>i.x&&t.x>i.x||e.y<r.y&&t.y<r.y||e.y>i.y&&t.y>i.y)return!1;var o=w(e,t,n[0]);return o!==w(e,t,n[1])||o!==w(e,t,n[2])||o!==w(e,t,n[3])}function ca(e,t,n){var r=t.paint.get(e).value;return"constant"===r.kind?r.value:n.programConfigurations.get(t.id).getMaxValue(e)}function la(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function pa(e,t,n,r,o){if(!t[0]&&!t[1])return e;var a=i.convert(t)._mult(o);"viewport"===n&&a._rotate(-r);for(var s=[],u=0;u<e.length;u++)s.push(e[u].sub(a));return s}Jo.prototype.populate=function(e,t,n){var r=this.layers[0],i=[],o=null;"circle"===r.type&&(o=r.layout.get("circle-sort-key"));for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=u.feature,l=u.id,p=u.index,f=u.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:c.type,id:l,properties:c.properties,geometry:h?Xo(c):[]};if(this.layers[0]._featureFilter.filter(new yi(this.zoom),d,n)){h||(d.geometry=Xo(c));var m=o?o.evaluate(d,{},n):void 0;i.push({id:l,properties:c.properties,type:c.type,sourceLayerIndex:f,index:p,geometry:d.geometry,patterns:{},sortKey:m})}}o&&i.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=0,v=i;g<v.length;g+=1){var y=v[g],_=y.geometry,b=y.index,x=y.sourceLayerIndex,w=e[b].feature;this.addFeature(y,_,b,n),t.featureIndex.insert(w,_,b,x,this.index)}},Jo.prototype.update=function(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)},Jo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Jo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Jo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Jo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Jo.prototype.addFeature=function(e,t,n,r){for(var i=0,o=t;i<o.length;i+=1)for(var a=0,s=o[i];a<s.length;a+=1){var u=s[a],c=u.x,l=u.y;if(!(c<0||c>=At||l<0||l>=At)){var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),f=p.vertexLength;Ko(this.layoutVertexArray,c,l,-1,-1),Ko(this.layoutVertexArray,c,l,1,-1),Ko(this.layoutVertexArray,c,l,1,1),Ko(this.layoutVertexArray,c,l,-1,1),this.indexArray.emplaceBack(f,f+1,f+2),this.indexArray.emplaceBack(f,f+3,f+2),p.vertexLength+=4,p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},r)},Xr("CircleBucket",Jo,{omit:["layers"]});var fa,ha=new Oi({"circle-sort-key":new Ci(Ce.layout_circle["circle-sort-key"])}),da={paint:new Oi({"circle-radius":new Ci(Ce.paint_circle["circle-radius"]),"circle-color":new Ci(Ce.paint_circle["circle-color"]),"circle-blur":new Ci(Ce.paint_circle["circle-blur"]),"circle-opacity":new Ci(Ce.paint_circle["circle-opacity"]),"circle-translate":new Ai(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new Ai(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ai(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ai(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ci(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ci(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ci(Ce.paint_circle["circle-stroke-opacity"])}),layout:ha},ma="undefined"!=typeof Float32Array?Float32Array:Array;function ga(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,n=arguments.length;n--;)t+=e[n]*e[n];return Math.sqrt(t)}),fa=new ma(3),ma!=Float32Array&&(fa[0]=0,fa[1]=0,fa[2]=0),function(){var e=new ma(4);ma!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var va=(function(){var e=new ma(2);ma!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(t){e.call(this,t,da)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new Jo(e)},t.prototype.queryRadius=function(e){var t=e;return ca("circle-radius",this,t)+ca("circle-stroke-width",this,t)+la(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(e,t,n,r,i,o,a,s){for(var u=pa(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,a),c=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n),l="map"===this.paint.get("circle-pitch-alignment"),p=l?u:function(e,t){return e.map((function(e){return ya(e,t)}))}(u,s),f=l?c*a:c,h=0,d=r;h<d.length;h+=1)for(var m=0,g=d[h];m<g.length;m+=1){var v=g[m],y=l?v:ya(v,s),_=f,b=ga([],[v.x,v.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=o.cameraToCenterDistance/b[3]),$o(p,y,_))return!0}return!1},t}(Li));function ya(e,t){var n=ga([],[e.x,e.y,0,1],t);return new i(n[0]/n[3],n[1]/n[3])}var _a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Jo);function ba(e,t,n,r){var i=t.width,o=t.height;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*o*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(i*o*n);return e.width=i,e.height=o,e.data=r,e}function xa(e,t,n){var r=t.width,i=t.height;if(r!==e.width||i!==e.height){var o=ba({},{width:r,height:i},n);wa(e,o,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,r),height:Math.min(e.height,i)},n),e.width=r,e.height=i,e.data=o.data}}function wa(e,t,n,r,i,o){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var a=e.data,s=t.data,u=0;u<i.height;u++)for(var c=((n.y+u)*e.width+n.x)*o,l=((r.y+u)*t.width+r.x)*o,p=0;p<i.width*o;p++)s[l+p]=a[c+p];return t}Xr("HeatmapBucket",_a,{omit:["layers"]});var Sa=function(e,t){ba(this,e,1,t)};Sa.prototype.resize=function(e){xa(this,e,1)},Sa.prototype.clone=function(){return new Sa({width:this.width,height:this.height},new Uint8Array(this.data))},Sa.copy=function(e,t,n,r,i){wa(e,t,n,r,i,1)};var Ea=function(e,t){ba(this,e,4,t)};Ea.prototype.resize=function(e){xa(this,e,4)},Ea.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Ea.prototype.clone=function(){return new Ea({width:this.width,height:this.height},new Uint8Array(this.data))},Ea.copy=function(e,t,n,r,i){wa(e,t,n,r,i,4)},Xr("AlphaImage",Sa),Xr("RGBAImage",Ea);var Ta={paint:new Oi({"heatmap-radius":new Ci(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ci(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ai(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pi(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ai(Ce.paint_heatmap["heatmap-opacity"])})};function ka(e,t){for(var n=new Uint8Array(1024),r={},i=0,o=0;i<256;i++,o+=4){r[t]=i/255;var a=e.evaluate(r);n[o+0]=Math.floor(255*a.r/a.a),n[o+1]=Math.floor(255*a.g/a.a),n[o+2]=Math.floor(255*a.b/a.a),n[o+3]=Math.floor(255*a.a)}return new Ea({width:256,height:1},n)}var Aa=function(e){function t(t){e.call(this,t,Ta),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new _a(e)},t.prototype._handleSpecialPaintPropertyUpdate=function(e){"heatmap-color"===e&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ka(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(Li),Ca={paint:new Oi({"hillshade-illumination-direction":new Ai(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ai(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ai(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ai(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ai(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ai(Ce.paint_hillshade["hillshade-accent-color"])})},Ia=function(e){function t(t){e.call(this,t,Ca)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(Li),Ma=Ni([{name:"a_pos",components:2,type:"Int16"}],4).members,Pa=La,Oa=La;function La(e,t,n){n=n||2;var r,i,o,a,s,u,c,l=t&&t.length,p=l?t[0]*n:e.length,f=Ra(e,0,p,n,!0),h=[];if(!f||f.next===f.prev)return h;if(l&&(f=function(e,t,n,r){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=Ra(e,t[i]*r,i<o-1?t[i+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(Za(a));for(s.sort(Ua),i=0;i<s.length;i++)Va(s[i],n),n=Da(n,n.next);return n}(e,t,f,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var d=n;d<p;d+=n)(s=e[d])<r&&(r=s),(u=e[d+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return za(f,h,n,r,i,c),h}function Ra(e,t,n,r,i){var o,a;if(i===is(e,t,n,r)>0)for(o=t;o<n;o+=r)a=ts(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=ts(o,e[o],e[o+1],a);return a&&Xa(a,a.next)&&(ns(a),a=a.next),a}function Da(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Xa(r,r.next)&&0!==Ya(r.prev,r,r.next))r=r.next;else{if(ns(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function za(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=qa(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(e,r,i,o);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?ja(e,r,i,o):Na(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),ns(e),e=u.next,c=u.next;else if((e=u)===c){a?1===a?za(e=Fa(Da(e),t,n),t,n,r,i,o,2):2===a&&Ba(e,t,n,r,i,o):za(Da(e),t,n,r,i,o,1);break}}}function Na(e){var t=e.prev,n=e,r=e.next;if(Ya(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Ha(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Ya(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ja(e,t,n,r){var i=e.prev,o=e,a=e.next;if(Ya(i,o,a)>=0)return!1;for(var s=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,u=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,c=qa(i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,t,n,r),l=qa(s,u,t,n,r),p=e.prevZ,f=e.nextZ;p&&p.z>=c&&f&&f.z<=l;){if(p!==e.prev&&p!==e.next&&Ha(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ya(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&Ha(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Ya(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=c;){if(p!==e.prev&&p!==e.next&&Ha(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Ya(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=l;){if(f!==e.prev&&f!==e.next&&Ha(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Ya(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Fa(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!Xa(i,o)&&Ka(i,r,r.next,o)&&$a(i,o)&&$a(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),ns(r),ns(r.next),r=e=o),r=r.next}while(r!==e);return Da(r)}function Ba(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Wa(a,s)){var u=es(a,s);return a=Da(a,a.next),u=Da(u,u.next),za(a,t,n,r,i,o),void za(u,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function Ua(e,t){return e.x-t.x}function Va(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,p=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&Ha(o<p?i:a,o,l,p,o<p?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),$a(r,e)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&Ga(n,r)))&&(n=r,f=u)),r=r.next}while(r!==c);return n}(e,t)){var n=es(t,e);Da(t,t.next),Da(n,n.next)}}function Ga(e,t){return Ya(e.prev,e,t.prev)<0&&Ya(t.next,e,e.next)<0}function qa(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Za(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Ha(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Wa(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ka(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&($a(e,t)&&$a(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Ya(e.prev,e,t.prev)||Ya(e,t.prev,t))||Xa(e,t)&&Ya(e.prev,e,e.next)>0&&Ya(t.prev,t,t.next)>0)}function Ya(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Xa(e,t){return e.x===t.x&&e.y===t.y}function Ka(e,t,n,r){var i=Qa(Ya(e,t,n)),o=Qa(Ya(e,t,r)),a=Qa(Ya(n,r,e)),s=Qa(Ya(n,r,t));return i!==o&&a!==s||!(0!==i||!Ja(e,n,t))||!(0!==o||!Ja(e,r,t))||!(0!==a||!Ja(n,e,r))||!(0!==s||!Ja(n,t,r))}function Ja(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Qa(e){return e>0?1:e<0?-1:0}function $a(e,t){return Ya(e.prev,e,e.next)<0?Ya(e,t,e.next)>=0&&Ya(e,e.prev,t)>=0:Ya(e,t,e.prev)<0||Ya(e,e.next,t)<0}function es(e,t){var n=new rs(e.i,e.x,e.y),r=new rs(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function ts(e,t,n,r){var i=new rs(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ns(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function rs(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function is(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}function os(e,t,n,r,i){!function e(t,n,r,i,o){for(;i>r;){if(i-r>600){var a=i-r+1,s=n-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(s-a/2<0?-1:1);e(t,n,Math.max(r,Math.floor(n-s*c/a+l)),Math.min(i,Math.floor(n+(a-s)*c/a+l)),o)}var p=t[n],f=r,h=i;for(as(t,r,n),o(t[i],p)>0&&as(t,r,i);f<h;){for(as(t,f,h),f++,h--;o(t[f],p)<0;)f++;for(;o(t[h],p)>0;)h--}0===o(t[r],p)?as(t,r,h):as(t,++h,i),h<=n&&(r=h+1),n<=h&&(i=h-1)}}(e,t,n||0,r||e.length-1,i||ss)}function as(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function ss(e,t){return e<t?-1:e>t?1:0}function us(e,t){var n=e.length;if(n<=1)return[e];for(var r,i,o=[],a=0;a<n;a++){var s=S(e[a]);0!==s&&(e[a].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(r&&o.push(r),r=[e[a]]):r.push(e[a]))}if(r&&o.push(r),t>1)for(var u=0;u<o.length;u++)o[u].length<=t||(os(o[u],t,1,o[u].length-1,cs),o[u]=o[u].slice(0,t));return o}function cs(e,t){return t.area-e.area}function ls(e,t,n){for(var r=n.patternDependencies,i=!1,o=0,a=t;o<a.length;o+=1){var s=a[o].paint.get(e+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,r[u.to]=!0,r[u.from]=!0)}return i}function ps(e,t,n,r,i){for(var o=i.patternDependencies,a=0,s=t;a<s.length;a+=1){var u=s[a],c=u.paint.get(e+"-pattern").value;if("constant"!==c.kind){var l=c.evaluate({zoom:r-1},n,{},i.availableImages),p=c.evaluate({zoom:r},n,{},i.availableImages),f=c.evaluate({zoom:r+1},n,{},i.availableImages);p=p&&p.name?p.name:p,f=f&&f.name?f.name:f,o[l=l&&l.name?l.name:l]=!0,o[p]=!0,o[f]=!0,n.patterns[u.id]={min:l,mid:p,max:f}}}return n}La.deviation=function(e,t,n,r){var i=t&&t.length,o=Math.abs(is(e,0,i?t[0]*n:e.length,n));if(i)for(var a=0,s=t.length;a<s;a++)o-=Math.abs(is(e,t[a]*n,a<s-1?t[a+1]*n:e.length,n));var u=0;for(a=0;a<r.length;a+=3){var c=r[a]*n,l=r[a+1]*n,p=r[a+2]*n;u+=Math.abs((e[c]-e[p])*(e[l+1]-e[c+1])-(e[c]-e[l])*(e[p+1]-e[c+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},La.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&n.holes.push(r+=e[i-1].length)}return n},Pa.default=Oa;var fs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Fi,this.indexArray=new to,this.indexArray2=new no,this.programConfigurations=new Zo(Ma,e.layers,e.zoom),this.segments=new yo,this.segments2=new yo,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};fs.prototype.populate=function(e,t,n){this.hasPattern=ls("fill",this.layers,t);for(var r=this.layers[0].layout.get("fill-sort-key"),i=[],o=0,a=e;o<a.length;o+=1){var s=a[o],u=s.feature,c=s.id,l=s.index,p=s.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,h={type:u.type,id:c,properties:u.properties,geometry:f?Xo(u):[]};if(this.layers[0]._featureFilter.filter(new yi(this.zoom),h,n)){f||(h.geometry=Xo(u));var d=r?r.evaluate(h,{},n,t.availableImages):void 0;i.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:p,index:l,geometry:h.geometry,patterns:{},sortKey:d})}}r&&i.sort((function(e,t){return e.sortKey-t.sortKey}));for(var m=0,g=i;m<g.length;m+=1){var v=g[m],y=v.geometry,_=v.index,b=v.sourceLayerIndex;if(this.hasPattern){var x=ps("fill",this.layers,v,this.zoom,t);this.patternFeatures.push(x)}else this.addFeature(v,y,_,n,{});t.featureIndex.insert(e[_].feature,y,_,b,this.index)}},fs.prototype.update=function(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)},fs.prototype.addFeatures=function(e,t,n){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var o=i[r];this.addFeature(o,o.geometry,o.index,t,n)}},fs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},fs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},fs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ma),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},fs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},fs.prototype.addFeature=function(e,t,n,r,i){for(var o=0,a=us(t,500);o<a.length;o+=1){for(var s=a[o],u=0,c=0,l=s;c<l.length;c+=1)u+=l[c].length;for(var p=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray),f=p.vertexLength,h=[],d=[],m=0,g=s;m<g.length;m+=1){var v=g[m];if(0!==v.length){v!==s[0]&&d.push(h.length/2);var y=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),_=y.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(_+v.length-1,_),h.push(v[0].x),h.push(v[0].y);for(var b=1;b<v.length;b++)this.layoutVertexArray.emplaceBack(v[b].x,v[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),h.push(v[b].x),h.push(v[b].y);y.vertexLength+=v.length,y.primitiveLength+=v.length}}for(var x=Pa(h,d),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(f+x[w],f+x[w+1],f+x[w+2]);p.vertexLength+=u,p.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,r)},Xr("FillBucket",fs,{omit:["layers","patternFeatures"]});var hs=new Oi({"fill-sort-key":new Ci(Ce.layout_fill["fill-sort-key"])}),ds={paint:new Oi({"fill-antialias":new Ai(Ce.paint_fill["fill-antialias"]),"fill-opacity":new Ci(Ce.paint_fill["fill-opacity"]),"fill-color":new Ci(Ce.paint_fill["fill-color"]),"fill-outline-color":new Ci(Ce.paint_fill["fill-outline-color"]),"fill-translate":new Ai(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new Ai(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ii(Ce.paint_fill["fill-pattern"])}),layout:hs},ms=function(e){function t(t){e.call(this,t,ds)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(t,n){e.prototype.recalculate.call(this,t,n);var r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new fs(e)},t.prototype.queryRadius=function(){return la(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(e,t,n,r,i,o,a){return ea(pa(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,a),r)},t.prototype.isTileClipped=function(){return!0},t}(Li),gs=Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,vs=ys;function ys(e,t,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=i,e.readFields(_s,this,t)}function _s(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;){var r=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[r]=i}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function bs(e){for(var t,n,r=0,i=0,o=e.length,a=o-1;i<o;a=i++)r+=((n=e[a]).x-(t=e[i]).x)*(t.y+n.y);return r}ys.types=["Unknown","Point","LineString","Polygon"],ys.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,r=1,o=0,a=0,s=0,u=[];e.pos<n;){if(o<=0){var c=e.readVarint();r=7&c,o=c>>3}if(o--,1===r||2===r)a+=e.readSVarint(),s+=e.readSVarint(),1===r&&(t&&u.push(t),t=[]),t.push(new i(a,s));else{if(7!==r)throw new Error("unknown command "+r);t&&t.push(t[0].clone())}}return t&&u.push(t),u},ys.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(r<=0){var l=e.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=e.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=e.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[a,u,s,c]},ys.prototype.toGeoJSON=function(e,t,n){var r,i,o=this.extent*Math.pow(2,n),a=this.extent*e,s=this.extent*t,u=this.loadGeometry(),c=ys.types[this.type];function l(e){for(var t=0;t<e.length;t++){var n=e[t];e[t]=[360*(n.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(r=0;r<u.length;r++)p[r]=u[r][0];l(u=p);break;case 2:for(r=0;r<u.length;r++)l(u[r]);break;case 3:for(u=function(e){var t=e.length;if(t<=1)return[e];for(var n,r,i=[],o=0;o<t;o++){var a=bs(e[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[e[o]]):n.push(e[o]))}return n&&i.push(n),i}(u),r=0;r<u.length;r++)for(i=0;i<u[r].length;i++)l(u[r][i])}1===u.length?u=u[0]:c="Multi"+c;var f={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f};var xs=ws;function ws(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Ss,this,t),this.length=this._features.length}function Ss(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){for(var t=null,n=e.readVarint()+e.pos;e.pos<n;){var r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}return t}(n))}function Es(e,t,n){if(3===e){var r=new xs(n,n.readVarint()+n.pos);r.length&&(t[r.name]=r)}}ws.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new vs(this._pbf,t,this.extent,this._keys,this._values)};var Ts={VectorTile:function(e,t){this.layers=e.readFields(Es,{},t)},VectorTileFeature:vs,VectorTileLayer:xs},ks=Ts.VectorTileFeature.types,As=Math.pow(2,13);function Cs(e,t,n,r,i,o,a,s){e.emplaceBack(t,n,2*Math.floor(r*As)+a,i*As*2,o*As*2,Math.round(s))}var Is=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ui,this.indexArray=new to,this.programConfigurations=new Zo(gs,e.layers,e.zoom),this.segments=new yo,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};function Ms(e,t){return e.x===t.x&&(e.x<0||e.x>At)||e.y===t.y&&(e.y<0||e.y>At)}Is.prototype.populate=function(e,t,n){this.features=[],this.hasPattern=ls("fill-extrusion",this.layers,t);for(var r=0,i=e;r<i.length;r+=1){var o=i[r],a=o.feature,s=o.id,u=o.index,c=o.sourceLayerIndex,l=this.layers[0]._featureFilter.needGeometry,p={type:a.type,id:s,properties:a.properties,geometry:l?Xo(a):[]};if(this.layers[0]._featureFilter.filter(new yi(this.zoom),p,n)){var f={id:s,sourceLayerIndex:c,index:u,geometry:l?p.geometry:Xo(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(f.id=a.id),this.hasPattern?this.features.push(ps("fill-extrusion",this.layers,f,this.zoom,t)):this.addFeature(f,f.geometry,u,n,{}),t.featureIndex.insert(a,f.geometry,u,c,this.index,!0)}}},Is.prototype.addFeatures=function(e,t,n){for(var r=0,i=this.features;r<i.length;r+=1){var o=i[r];this.addFeature(o,o.geometry,o.index,t,n)}},Is.prototype.update=function(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)},Is.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Is.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Is.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gs),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Is.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Is.prototype.addFeature=function(e,t,n,r,i){for(var o=0,a=us(t,500);o<a.length;o+=1){for(var s=a[o],u=0,c=0,l=s;c<l.length;c+=1)u+=l[c].length;for(var p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),f=0,h=s;f<h.length;f+=1){var d=h[f];if(0!==d.length&&!((O=d).every((function(e){return e.x<0}))||O.every((function(e){return e.x>At}))||O.every((function(e){return e.y<0}))||O.every((function(e){return e.y>At}))))for(var m=0,g=0;g<d.length;g++){var v=d[g];if(g>=1){var y=d[g-1];if(!Ms(v,y)){p.vertexLength+4>yo.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=v.sub(y)._perp()._unit(),b=y.dist(v);m+b>32768&&(m=0),Cs(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,m),Cs(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,m),Cs(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,0,m+=b),Cs(this.layoutVertexArray,y.x,y.y,_.x,_.y,0,1,m);var x=p.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),p.vertexLength+=4,p.primitiveLength+=2}}}}if(p.vertexLength+u>yo.MAX_VERTEX_ARRAY_LENGTH&&(p=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),"Polygon"===ks[e.type]){for(var w=[],S=[],E=p.vertexLength,T=0,k=s;T<k.length;T+=1){var A=k[T];if(0!==A.length){A!==s[0]&&S.push(w.length/2);for(var C=0;C<A.length;C++){var I=A[C];Cs(this.layoutVertexArray,I.x,I.y,0,0,1,1,0),w.push(I.x),w.push(I.y)}}}for(var M=Pa(w,S),P=0;P<M.length;P+=3)this.indexArray.emplaceBack(E+M[P],E+M[P+2],E+M[P+1]);p.primitiveLength+=M.length/3,p.vertexLength+=u}}var O;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,r)},Xr("FillExtrusionBucket",Is,{omit:["layers","features"]});var Ps={paint:new Oi({"fill-extrusion-opacity":new Ai(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ci(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ai(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ai(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ii(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ci(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ci(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ai(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Os=function(e){function t(t){e.call(this,t,Ps)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(e){return new Is(e)},t.prototype.queryRadius=function(){return la(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(e,t,n,r,o,a,s,u){var c=pa(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),l=this.paint.get("fill-extrusion-height").evaluate(t,n),p=this.paint.get("fill-extrusion-base").evaluate(t,n),f=function(e,t,n,r){for(var o=[],a=0,s=e;a<s.length;a+=1){var u=s[a],c=[u.x,u.y,0,1];ga(c,c,t),o.push(new i(c[0]/c[3],c[1]/c[3]))}return o}(c,u),h=function(e,t,n,r){for(var o=[],a=[],s=r[8]*t,u=r[9]*t,c=r[10]*t,l=r[11]*t,p=r[8]*n,f=r[9]*n,h=r[10]*n,d=r[11]*n,m=0,g=e;m<g.length;m+=1){for(var v=[],y=[],_=0,b=g[m];_<b.length;_+=1){var x=b[_],w=x.x,S=x.y,E=r[0]*w+r[4]*S+r[12],T=r[1]*w+r[5]*S+r[13],k=r[2]*w+r[6]*S+r[14],A=r[3]*w+r[7]*S+r[15],C=k+c,I=A+l,M=E+p,P=T+f,O=k+h,L=A+d,R=new i((E+s)/I,(T+u)/I);R.z=C/I,v.push(R);var D=new i(M/L,P/L);D.z=O/L,y.push(D)}o.push(v),a.push(y)}return[o,a]}(r,p,l,u);return function(e,t,n){var r=1/0;ea(n,t)&&(r=Rs(n,t[0]));for(var i=0;i<t.length;i++)for(var o=t[i],a=e[i],s=0;s<o.length-1;s++){var u=o[s],c=[u,o[s+1],a[s+1],a[s],u];Qo(n,c)&&(r=Math.min(r,Rs(n,c)))}return r!==1/0&&r}(h[0],h[1],f)},t}(Li);function Ls(e,t){return e.x*t.x+e.y*t.y}function Rs(e,t){if(1===e.length){for(var n,r,i=0,o=t[i++];!n||o.equals(n);)if(!(n=t[i++]))return 1/0;for(;!r||o.equals(r)||n.equals(r);)if(!(r=t[i++]))return 1/0;var a=e[0],s=n.sub(o),u=r.sub(o),c=a.sub(o),l=Ls(s,s),p=Ls(s,u),f=Ls(u,u),h=Ls(c,s),d=Ls(c,u),m=l*f-p*p,g=(f*h-p*d)/m,v=(l*d-p*h)/m;return o.z*(1-g-v)+n.z*g+r.z*v}for(var y=1/0,_=0,b=t;_<b.length;_+=1)y=Math.min(y,b[_].z);return y}var Ds=Ni([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,zs=Ts.VectorTileFeature.types,Ns=Math.cos(Math.PI/180*37.5),js=Math.pow(2,14)/.5,Fs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Vi,this.indexArray=new to,this.programConfigurations=new Zo(Ds,e.layers,e.zoom),this.segments=new yo,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))};Fs.prototype.populate=function(e,t,n){this.hasPattern=ls("line",this.layers,t);for(var r=this.layers[0].layout.get("line-sort-key"),i=[],o=0,a=e;o<a.length;o+=1){var s=a[o],u=s.feature,c=s.id,l=s.index,p=s.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,h={type:u.type,id:c,properties:u.properties,geometry:f?Xo(u):[]};if(this.layers[0]._featureFilter.filter(new yi(this.zoom),h,n)){f||(h.geometry=Xo(u));var d=r?r.evaluate(h,{},n):void 0;i.push({id:c,properties:u.properties,type:u.type,sourceLayerIndex:p,index:l,geometry:h.geometry,patterns:{},sortKey:d})}}r&&i.sort((function(e,t){return e.sortKey-t.sortKey}));for(var m=0,g=i;m<g.length;m+=1){var v=g[m],y=v.geometry,_=v.index,b=v.sourceLayerIndex;if(this.hasPattern){var x=ps("line",this.layers,v,this.zoom,t);this.patternFeatures.push(x)}else this.addFeature(v,y,_,n,{});t.featureIndex.insert(e[_].feature,y,_,b,this.index)}},Fs.prototype.update=function(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)},Fs.prototype.addFeatures=function(e,t,n){for(var r=0,i=this.patternFeatures;r<i.length;r+=1){var o=i[r];this.addFeature(o,o.geometry,o.index,t,n)}},Fs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Fs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ds),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Fs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Fs.prototype.addFeature=function(e,t,n,r,i){for(var o=this.layers[0].layout,a=o.get("line-join").evaluate(e,{}),s=o.get("line-cap"),u=o.get("line-miter-limit"),c=o.get("line-round-limit"),l=0,p=t;l<p.length;l+=1)this.addLine(p[l],e,a,s,u,c,n,r,i)},Fs.prototype.addLine=function(e,t,n,r,i,o,a,s,u){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+t.properties.mapbox_clip_start,this.clipEnd=+t.properties.mapbox_clip_end;for(var c=0;c<e.length-1;c++)this.totalDistance+=e[c].dist(e[c+1]);this.updateScaledDistance()}for(var l="Polygon"===zs[t.type],p=e.length;p>=2&&e[p-1].equals(e[p-2]);)p--;for(var f=0;f<p-1&&e[f].equals(e[f+1]);)f++;if(!(p<(l?3:2))){"bevel"===n&&(i=1.05);var h,d=this.overscaling<=16?15*At/(512*this.overscaling):0,m=this.segments.prepareSegment(10*p,this.layoutVertexArray,this.indexArray),g=void 0,v=void 0,y=void 0,_=void 0;this.e1=this.e2=-1,l&&(_=e[f].sub(h=e[p-2])._unit()._perp());for(var b=f;b<p;b++)if(!(v=b===p-1?l?e[f+1]:void 0:e[b+1])||!e[b].equals(v)){_&&(y=_),h&&(g=h),h=e[b],_=v?v.sub(h)._unit()._perp():y;var x=(y=y||_).add(_);0===x.x&&0===x.y||x._unit();var w=y.x*_.x+y.y*_.y,S=x.x*_.x+x.y*_.y,E=0!==S?1/S:1/0,T=2*Math.sqrt(2-2*S),k=S<Ns&&g&&v,A=y.x*_.y-y.y*_.x>0;if(k&&b>f){var C=h.dist(g);if(C>2*d){var I=h.sub(h.sub(g)._mult(d/C)._round());this.updateDistance(g,I),this.addCurrentVertex(I,y,0,0,m),g=I}}var M=g&&v,P=M?n:l?"butt":r;if(M&&"round"===P&&(E<o?P="miter":E<=2&&(P="fakeround")),"miter"===P&&E>i&&(P="bevel"),"bevel"===P&&(E>2&&(P="flipbevel"),E<i&&(P="miter")),g&&this.updateDistance(g,h),"miter"===P)x._mult(E),this.addCurrentVertex(h,x,0,0,m);else if("flipbevel"===P){if(E>100)x=_.mult(-1);else{var O=E*y.add(_).mag()/y.sub(_).mag();x._perp()._mult(O*(A?-1:1))}this.addCurrentVertex(h,x,0,0,m),this.addCurrentVertex(h,x.mult(-1),0,0,m)}else if("bevel"===P||"fakeround"===P){var L=-Math.sqrt(E*E-1),R=A?L:0,D=A?0:L;if(g&&this.addCurrentVertex(h,y,R,D,m),"fakeround"===P)for(var z=Math.round(180*T/Math.PI/20),N=1;N<z;N++){var j=N/z;if(.5!==j){var F=j-.5;j+=j*F*(j-1)*((1.0904+w*(w*(3.55645-1.43519*w)-3.2452))*F*F+(.848013+w*(.215638*w-1.06021)))}var B=_.sub(y)._mult(j)._add(y)._unit()._mult(A?-1:1);this.addHalfVertex(h,B.x,B.y,!1,A,0,m)}v&&this.addCurrentVertex(h,_,-R,-D,m)}else if("butt"===P)this.addCurrentVertex(h,x,0,0,m);else if("square"===P){var U=g?1:-1;this.addCurrentVertex(h,x,U,U,m)}else"round"===P&&(g&&(this.addCurrentVertex(h,y,0,0,m),this.addCurrentVertex(h,y,1,1,m,!0)),v&&(this.addCurrentVertex(h,_,-1,-1,m,!0),this.addCurrentVertex(h,_,0,0,m)));if(k&&b<p-1){var V=h.dist(v);if(V>2*d){var G=h.add(v.sub(h)._mult(d/V)._round());this.updateDistance(h,G),this.addCurrentVertex(G,_,0,0,m),h=G}}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,u,s)}},Fs.prototype.addCurrentVertex=function(e,t,n,r,i,o){void 0===o&&(o=!1);var a=t.y*r-t.x,s=-t.y-t.x*r;this.addHalfVertex(e,t.x+t.y*n,t.y-t.x*n,o,!1,n,i),this.addHalfVertex(e,a,s,o,!0,-r,i),this.distance>js/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,n,r,i,o))},Fs.prototype.addHalfVertex=function(e,t,n,r,i,o,a){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((e.x<<1)+(r?1:0),(e.y<<1)+(i?1:0),Math.round(63*t)+128,Math.round(63*n)+128,1+(0===o?0:o<0?-1:1)|(63&s)<<2,s>>6);var u=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),a.primitiveLength++),i?this.e2=u:this.e1=u},Fs.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(js-1):this.distance},Fs.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Xr("LineBucket",Fs,{omit:["layers","patternFeatures"]});var Bs=new Oi({"line-cap":new Ai(Ce.layout_line["line-cap"]),"line-join":new Ci(Ce.layout_line["line-join"]),"line-miter-limit":new Ai(Ce.layout_line["line-miter-limit"]),"line-round-limit":new Ai(Ce.layout_line["line-round-limit"]),"line-sort-key":new Ci(Ce.layout_line["line-sort-key"])}),Us={paint:new Oi({"line-opacity":new Ci(Ce.paint_line["line-opacity"]),"line-color":new Ci(Ce.paint_line["line-color"]),"line-translate":new Ai(Ce.paint_line["line-translate"]),"line-translate-anchor":new Ai(Ce.paint_line["line-translate-anchor"]),"line-width":new Ci(Ce.paint_line["line-width"]),"line-gap-width":new Ci(Ce.paint_line["line-gap-width"]),"line-offset":new Ci(Ce.paint_line["line-offset"]),"line-blur":new Ci(Ce.paint_line["line-blur"]),"line-dasharray":new Mi(Ce.paint_line["line-dasharray"]),"line-pattern":new Ii(Ce.paint_line["line-pattern"]),"line-gradient":new Pi(Ce.paint_line["line-gradient"])}),layout:Bs},Vs=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(t,n){return n=new yi(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),e.prototype.possiblyEvaluate.call(this,t,n)},t.prototype.evaluate=function(t,n,r,i){return n=l({},n,{zoom:Math.floor(n.zoom)}),e.prototype.evaluate.call(this,t,n,r,i)},t}(Ci))(Us.paint.properties["line-width"].specification);Vs.useIntegerZoom=!0;var Gs=function(e){function t(t){e.call(this,t,Us)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(e){"line-gradient"===e&&this._updateGradient()},t.prototype._updateGradient=function(){this.gradient=ka(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(t,n){e.prototype.recalculate.call(this,t,n),this.paint._values["line-floorwidth"]=Vs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new Fs(e)},t.prototype.queryRadius=function(e){var t=e,n=qs(ca("line-width",this,t),ca("line-gap-width",this,t)),r=ca("line-offset",this,t);return n/2+Math.abs(r)+la(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(e,t,n,r,o,a,s){var u=pa(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),c=s/2*qs(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),l=this.paint.get("line-offset").evaluate(t,n);return l&&(r=function(e,t){for(var n=[],r=new i(0,0),o=0;o<e.length;o++){for(var a=e[o],s=[],u=0;u<a.length;u++){var c=a[u],l=a[u+1],p=0===u?r:c.sub(a[u-1])._unit()._perp(),f=u===a.length-1?r:l.sub(c)._unit()._perp(),h=p._add(f)._unit();h._mult(1/(h.x*f.x+h.y*f.y)),s.push(h._mult(t)._add(c))}n.push(s)}return n}(r,l*s)),function(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];if(e.length>=3)for(var o=0;o<i.length;o++)if(sa(e,i[o]))return!0;if(ta(e,i,n))return!0}return!1}(u,r,c)},t.prototype.isTileClipped=function(){return!0},t}(Li);function qs(e,t){return t>0?t+2*e:e}var Zs=Ni([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hs=Ni([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ws=(Ni([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ni([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ys=(Ni([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Xs=Ni([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);function Ks(e,t,n){return e.sections.forEach((function(e){e.text=function(e,t,n){var r=t.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?e=e.toLocaleUpperCase():"lowercase"===r&&(e=e.toLocaleLowerCase()),vi.applyArabicShaping&&(e=vi.applyArabicShaping(e)),e}(e.text,t,n)})),e}Ni([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ni([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"}]),Ni([{type:"Float32",name:"offsetX"}]),Ni([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Js={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Qs=24,$s=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,p=n?i-1:0,f=n?-1:1,h=e[t+p];for(p+=f,o=h&(1<<-l)-1,h>>=-l,l+=s;l>0;o=256*o+e[t+p],p+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+p],p+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),o-=c}return(h?-1:1)*a*Math.pow(2,o-r)},eu=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,p=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,d=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+p>=1?f/u:f*Math.pow(2,1-p))*u>=2&&(a++,u/=2),a+p>=l?(s=0,a=l):a+p>=1?(s=(t*u-1)*Math.pow(2,i),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;e[n+h]=255&s,h+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+h]=255&a,h+=d,a/=256,c-=8);e[n+h-d]|=128*m},tu=nu;function nu(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}nu.Varint=0,nu.Fixed64=1,nu.Bytes=2,nu.Fixed32=5;var ru="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function iu(e){return e.type===nu.Bytes?e.readVarint()+e.pos:e.pos+1}function ou(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function au(e,t,n){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=e;i--)n.buf[i+r]=n.buf[i]}function su(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function uu(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function cu(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function lu(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function pu(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function fu(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function hu(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function du(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function mu(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function gu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function vu(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function yu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}nu.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,e(i,t,this),this.pos===o&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=gu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=yu(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=gu(this.buf,this.pos)+4294967296*gu(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=gu(this.buf,this.pos)+4294967296*yu(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=$s(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=$s(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,r=this.buf;return t=127&(n=r[this.pos++]),n<128?t:(t|=(127&(n=r[this.pos++]))<<7,n<128?t:(t|=(127&(n=r[this.pos++]))<<14,n<128?t:(t|=(127&(n=r[this.pos++]))<<21,n<128?t:function(e,t,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return ou(e,r,t);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return ou(e,r,t);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return ou(e,r,t);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return ou(e,r,t);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return ou(e,r,t);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return ou(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ru?function(e,t,n){return ru.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var r="",i=t;i<n;){var o,a,s,u=e[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(a=e[i+2],128==(192&(o=e[i+1]))&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(a=e[i+2],s=e[i+3],128==(192&(o=e[i+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==nu.Bytes)return e.push(this.readVarint(t));var n=iu(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==nu.Bytes)return e.push(this.readSVarint());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==nu.Bytes)return e.push(this.readBoolean());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==nu.Bytes)return e.push(this.readFloat());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==nu.Bytes)return e.push(this.readDouble());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==nu.Bytes)return e.push(this.readFixed32());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==nu.Bytes)return e.push(this.readSFixed32());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==nu.Bytes)return e.push(this.readFixed64());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==nu.Bytes)return e.push(this.readSFixed64());var t=iu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===nu.Varint)for(;this.buf[this.pos++]>127;);else if(t===nu.Bytes)this.pos=this.readVarint()+this.pos;else if(t===nu.Fixed32)this.pos+=4;else{if(t!==nu.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),vu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),vu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),vu(this.buf,-1&e,this.pos),vu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),vu(this.buf,-1&e,this.pos),vu(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,r;if(e>=0?(n=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,n.buf[n.pos]=127&(e>>>=7)}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var r,i,o=0;o<t.length;o++){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):i=r;continue}if(r<56320){e[n++]=239,e[n++]=191,e[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(e[n++]=239,e[n++]=191,e[n++]=189,i=null);r<128?e[n++]=r:(r<2048?e[n++]=r>>6|192:(r<65536?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&au(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),eu(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),eu(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var r=this.pos-n;r>=128&&au(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,n){this.writeTag(e,nu.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,su,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,uu,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,pu,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,cu,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,lu,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,fu,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,hu,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,du,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,mu,t)},writeBytesField:function(e,t){this.writeTag(e,nu.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,nu.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,nu.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,nu.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,nu.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,nu.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,nu.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,nu.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,nu.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,nu.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var _u=3;function bu(e,t,n){1===e&&n.readMessage(xu,t)}function xu(e,t,n){if(3===e){var r=n.readMessage(wu,{}),i=r.width,o=r.height,a=r.left,s=r.top,u=r.advance;t.push({id:r.id,bitmap:new Sa({width:i+2*_u,height:o+2*_u},r.bitmap),metrics:{width:i,height:o,left:a,top:s,advance:u}})}}function wu(e,t,n){1===e?t.id=n.readVarint():2===e?t.bitmap=n.readBytes():3===e?t.width=n.readVarint():4===e?t.height=n.readVarint():5===e?t.left=n.readSVarint():6===e?t.top=n.readSVarint():7===e&&(t.advance=n.readVarint())}var Su=_u;function Eu(e){for(var t=0,n=0,r=0,i=e;r<i.length;r+=1){var o=i[r];t+=o.w*o.h,n=Math.max(n,o.w)}e.sort((function(e,t){return t.h-e.h}));for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}],s=0,u=0,c=0,l=e;c<l.length;c+=1)for(var p=l[c],f=a.length-1;f>=0;f--){var h=a[f];if(!(p.w>h.w||p.h>h.h)){if(p.x=h.x,p.y=h.y,u=Math.max(u,p.y+p.h),s=Math.max(s,p.x+p.w),p.w===h.w&&p.h===h.h){var d=a.pop();f<a.length&&(a[f]=d)}else p.h===h.h?(h.x+=p.w,h.w-=p.w):p.w===h.w?(h.y+=p.h,h.h-=p.h):(a.push({x:h.x+p.w,y:h.y,w:h.w-p.w,h:p.h}),h.y+=p.h,h.h-=p.h);break}}return{w:s,h:u,fill:t/(s*u)||0}}var Tu=1,ku=function(e,t){var n=t.pixelRatio,r=t.version,i=t.stretchX,o=t.stretchY,a=t.content;this.paddedRect=e,this.pixelRatio=n,this.stretchX=i,this.stretchY=o,this.content=a,this.version=r},Au={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Au.tl.get=function(){return[this.paddedRect.x+Tu,this.paddedRect.y+Tu]},Au.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-Tu,this.paddedRect.y+this.paddedRect.h-Tu]},Au.tlbr.get=function(){return this.tl.concat(this.br)},Au.displaySize.get=function(){return[(this.paddedRect.w-2*Tu)/this.pixelRatio,(this.paddedRect.h-2*Tu)/this.pixelRatio]},Object.defineProperties(ku.prototype,Au);var Cu=function(e,t){var n={},r={};this.haveRenderCallbacks=[];var i=[];this.addImages(e,n,i),this.addImages(t,r,i);var o=Eu(i),a=new Ea({width:o.w||1,height:o.h||1});for(var s in e){var u=e[s],c=n[s].paddedRect;Ea.copy(u.data,a,{x:0,y:0},{x:c.x+Tu,y:c.y+Tu},u.data)}for(var l in t){var p=t[l],f=r[l].paddedRect,h=f.x+Tu,d=f.y+Tu,m=p.data.width,g=p.data.height;Ea.copy(p.data,a,{x:0,y:0},{x:h,y:d},p.data),Ea.copy(p.data,a,{x:0,y:g-1},{x:h,y:d-1},{width:m,height:1}),Ea.copy(p.data,a,{x:0,y:0},{x:h,y:d+g},{width:m,height:1}),Ea.copy(p.data,a,{x:m-1,y:0},{x:h-1,y:d},{width:1,height:g}),Ea.copy(p.data,a,{x:0,y:0},{x:h+m,y:d},{width:1,height:g})}this.image=a,this.iconPositions=n,this.patternPositions=r};Cu.prototype.addImages=function(e,t,n){for(var r in e){var i=e[r],o={x:0,y:0,w:i.data.width+2*Tu,h:i.data.height+2*Tu};n.push(o),t[r]=new ku(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}},Cu.prototype.patchUpdatedImages=function(e,t){for(var n in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),t),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),t)},Cu.prototype.patchUpdatedImage=function(e,t,n){if(e&&t&&e.version!==t.version){e.version=t.version;var r=e.tl;n.update(t.data,void 0,{x:r[0],y:r[1]})}},Xr("ImagePosition",ku),Xr("ImageAtlas",Cu);var Iu={horizontal:1,vertical:2,horizontalOnly:3},Mu=-17,Pu=function(){this.scale=1,this.fontStack="",this.imageName=null};Pu.forText=function(e,t){var n=new Pu;return n.scale=e||1,n.fontStack=t,n},Pu.forImage=function(e){var t=new Pu;return t.imageName=e,t};var Ou=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Lu(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m){var g,v=Ou.fromFeature(e,i);p===Iu.vertical&&v.verticalizePunctuation();var y=vi.processBidirectionalText,_=vi.processStyledBidirectionalText;if(y&&1===v.sections.length){g=[];for(var b=0,x=y(v.toString(),Bu(v,c,o,t,r,h,d));b<x.length;b+=1){var w=x[b],S=new Ou;S.text=w,S.sections=v.sections;for(var E=0;E<w.length;E++)S.sectionIndex.push(0);g.push(S)}}else if(_){g=[];for(var T=0,k=_(v.text,v.sectionIndex,Bu(v,c,o,t,r,h,d));T<k.length;T+=1){var A=k[T],C=new Ou;C.text=A[0],C.sectionIndex=A[1],C.sections=v.sections,g.push(C)}}else g=function(e,t){for(var n=[],r=e.text,i=0,o=0,a=t;o<a.length;o+=1){var s=a[o];n.push(e.substring(i,s)),i=s}return i<r.length&&n.push(e.substring(i,r.length)),n}(v,Bu(v,c,o,t,r,h,d));var I=[],M={positionedLines:I,text:v.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(e,t,n,r,i,o,a,s,u,c,l,p){for(var f=0,h=Mu,d=0,m=0,g="right"===s?1:"left"===s?0:.5,v=0,y=0,_=i;y<_.length;y+=1){var b=_[y];b.trim();var x=b.getMaxScale(),w=(x-1)*Qs,S={positionedGlyphs:[],lineOffset:0};e.positionedLines[v]=S;var E=S.positionedGlyphs,T=0;if(b.length()){for(var k=0;k<b.length();k++){var A=b.getSection(k),C=b.getSectionIndex(k),I=b.getCharCode(k),M=0,P=null,O=null,L=null,R=Qs,D=!(u===Iu.horizontal||!l&&!ii(I)||l&&(Ru[I]||(q=I,ni.Arabic(q)||ni["Arabic Supplement"](q)||ni["Arabic Extended-A"](q)||ni["Arabic Presentation Forms-A"](q)||ni["Arabic Presentation Forms-B"](q))));if(A.imageName){var z=r[A.imageName];if(!z)continue;L=A.imageName,e.iconsInText=e.iconsInText||!0,O=z.paddedRect;var N=z.displaySize;A.scale=A.scale*Qs/p,M=w+(Qs-N[1]*A.scale),R=(P={width:N[0],height:N[1],left:Tu,top:-Su,advance:D?N[1]:N[0]}).advance;var j=D?N[0]*A.scale-Qs*x:N[1]*A.scale-Qs*x;j>0&&j>T&&(T=j)}else{var F=n[A.fontStack],B=F&&F[I];if(B&&B.rect)O=B.rect,P=B.metrics;else{var U=t[A.fontStack],V=U&&U[I];if(!V)continue;P=V.metrics}M=(x-A.scale)*Qs}D?(e.verticalizable=!0,E.push({glyph:I,imageName:L,x:f,y:h+M,vertical:D,scale:A.scale,fontStack:A.fontStack,sectionIndex:C,metrics:P,rect:O}),f+=R*A.scale+c):(E.push({glyph:I,imageName:L,x:f,y:h+M,vertical:D,scale:A.scale,fontStack:A.fontStack,sectionIndex:C,metrics:P,rect:O}),f+=P.advance*A.scale+c)}0!==E.length&&(d=Math.max(f-c,d),Vu(E,0,E.length-1,g,T)),f=0;var G=o*x+T;S.lineOffset=Math.max(T,w),h+=G,m=Math.max(G,m),++v}else h+=o,++v}var q,Z=h-Mu,H=Uu(a),W=H.horizontalAlign,Y=H.verticalAlign;(function(e,t,n,r,i,o,a,s,u){var c,l=(t-n)*i;c=o!==a?-s*r-Mu:(-r*u+.5)*a;for(var p=0,f=e;p<f.length;p+=1)for(var h=0,d=f[p].positionedGlyphs;h<d.length;h+=1){var m=d[h];m.x+=l,m.y+=c}})(e.positionedLines,g,W,Y,d,m,o,Z,i.length),e.top+=-Y*Z,e.bottom=e.top+Z,e.left+=-W*d,e.right=e.left+d}(M,t,n,r,g,a,s,u,p,c,f,m),!function(e){for(var t=0,n=e;t<n.length;t+=1)if(0!==n[t].positionedGlyphs.length)return!1;return!0}(I)&&M}Ou.fromFeature=function(e,t){for(var n=new Ou,r=0;r<e.sections.length;r++){var i=e.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,t)}return n},Ou.prototype.length=function(){return this.text.length},Ou.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Ou.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Ou.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Ou.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n+1)||null,i=e.charCodeAt(n-1)||null;t+=r&&oi(r)&&!Js[e[n+1]]||i&&oi(i)&&!Js[e[n-1]]||!Js[e[n]]?e[n]:Js[e[n]]}return t}(this.text)},Ou.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Ru[this.text.charCodeAt(t)];t++)e++;for(var n=this.text.length,r=this.text.length-1;r>=0&&r>=e&&Ru[this.text.charCodeAt(r)];r--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)},Ou.prototype.substring=function(e,t){var n=new Ou;return n.text=this.text.substring(e,t),n.sectionIndex=this.sectionIndex.slice(e,t),n.sections=this.sections,n},Ou.prototype.toString=function(){return this.text},Ou.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce((function(t,n){return Math.max(t,e.sections[n].scale)}),0)},Ou.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(Pu.forText(e.scale,e.fontStack||t));for(var n=this.sections.length-1,r=0;r<e.text.length;++r)this.sectionIndex.push(n)},Ou.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Pu.forImage(t)),this.sectionIndex.push(this.sections.length-1)):x("Reached maximum number of images 6401")}else x("Can't add FormattedSection with an empty image.")},Ou.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Ru={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Du={};function zu(e,t,n,r,i,o){if(t.imageName){var a=r[t.imageName];return a?a.displaySize[0]*t.scale*Qs/o+i:0}var s=n[t.fontStack],u=s&&s[e];return u?u.metrics.advance*t.scale+i:0}function Nu(e,t,n,r){var i=Math.pow(e-t,2);return r?e<t?i/2:2*i:i+Math.abs(n)*n}function ju(e,t,n){var r=0;return 10===e&&(r-=1e4),n&&(r+=150),40!==e&&65288!==e||(r+=50),41!==t&&65289!==t||(r+=50),r}function Fu(e,t,n,r,i,o){for(var a=null,s=Nu(t,n,i,o),u=0,c=r;u<c.length;u+=1){var l=c[u],p=Nu(t-l.x,n,i,o)+l.badness;p<=s&&(a=l,s=p)}return{index:e,x:t,priorBreak:a,badness:s}}function Bu(e,t,n,r,i,o,a){if("point"!==o)return[];if(!e)return[];for(var s,u=[],c=function(e,t,n,r,i,o){for(var a=0,s=0;s<e.length();s++){var u=e.getSection(s);a+=zu(e.getCharCode(s),u,r,i,t,o)}return a/Math.max(1,Math.ceil(a/n))}(e,t,n,r,i,a),l=e.text.indexOf("\u200b")>=0,p=0,f=0;f<e.length();f++){var h=e.getSection(f),d=e.getCharCode(f);if(Ru[d]||(p+=zu(d,h,r,i,t,a)),f<e.length()-1){var m=!((s=d)<11904||!(ni["Bopomofo Extended"](s)||ni.Bopomofo(s)||ni["CJK Compatibility Forms"](s)||ni["CJK Compatibility Ideographs"](s)||ni["CJK Compatibility"](s)||ni["CJK Radicals Supplement"](s)||ni["CJK Strokes"](s)||ni["CJK Symbols and Punctuation"](s)||ni["CJK Unified Ideographs Extension A"](s)||ni["CJK Unified Ideographs"](s)||ni["Enclosed CJK Letters and Months"](s)||ni["Halfwidth and Fullwidth Forms"](s)||ni.Hiragana(s)||ni["Ideographic Description Characters"](s)||ni["Kangxi Radicals"](s)||ni["Katakana Phonetic Extensions"](s)||ni.Katakana(s)||ni["Vertical Forms"](s)||ni["Yi Radicals"](s)||ni["Yi Syllables"](s)));(Du[d]||m||h.imageName)&&u.push(Fu(f+1,p,c,u,ju(d,e.getCharCode(f+1),m&&l),!1))}}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(Fu(e.length(),p,c,u,0,!0))}function Uu(e){var t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Vu(e,t,n,r,i){if(r||i)for(var o=e[n],a=(e[n].x+o.metrics.advance*o.scale)*r,s=t;s<=n;s++)e[s].x-=a,e[s].y+=i}function Gu(e,t,n,r,i,o){var a,s=e.image;if(s.content){var u=s.content,c=s.pixelRatio||1;a=[u[0]/c,u[1]/c,s.displaySize[0]-u[2]/c,s.displaySize[1]-u[3]/c]}var l,p,f,h,d=t.left*o,m=t.right*o;"width"===n||"both"===n?(h=i[0]+d-r[3],p=i[0]+m+r[1]):p=(h=i[0]+(d+m-s.displaySize[0])/2)+s.displaySize[0];var g=t.top*o,v=t.bottom*o;return"height"===n||"both"===n?(l=i[1]+g-r[0],f=i[1]+v+r[2]):f=(l=i[1]+(g+v-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:l,right:p,bottom:f,left:h,collisionPadding:a}}Du[10]=!0,Du[32]=!0,Du[38]=!0,Du[40]=!0,Du[41]=!0,Du[43]=!0,Du[45]=!0,Du[47]=!0,Du[173]=!0,Du[183]=!0,Du[8203]=!0,Du[8208]=!0,Du[8211]=!0,Du[8231]=!0;var qu=function(e){function t(t,n,r,i){e.call(this,t,n),this.angle=r,void 0!==i&&(this.segment=i)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(i);Xr("Anchor",qu);var Zu=128;function Hu(e,t){var n=t.expression;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new yi(e+1))};if("source"===n.kind)return{kind:"source"};for(var r=n.zoomStops,i=n.interpolationType,o=0;o<r.length&&r[o]<=e;)o++;for(var a=o=Math.max(0,o-1);a<r.length&&r[a]<e+1;)a++;a=Math.min(r.length-1,a);var s=r[o],u=r[a];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:u,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:u,minSize:n.evaluate(new yi(s)),maxSize:n.evaluate(new yi(u)),interpolationType:i}}function Wu(e,t,n){var r=t.uSize,i=n.lowerSize;return"source"===e.kind?i/Zu:"composite"===e.kind?Kt(i/Zu,n.upperSize/Zu,t.uSizeT):r}function Yu(e,t){var n=0,r=0;if("constant"===e.kind)r=e.layoutSize;else if("source"!==e.kind){var i=e.interpolationType,o=i?u(yn.interpolationFactor(i,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?r=Kt(e.minSize,e.maxSize,o):n=o}return{uSizeT:n,uSize:r}}var Xu=Object.freeze({__proto__:null,getSizeData:Hu,evaluateSizeForFeature:Wu,evaluateSizeForZoom:Yu,SIZE_PACK_FACTOR:Zu});function Ku(e,t,n,r,i){if(void 0===t.segment)return!0;for(var o=t,a=t.segment+1,s=0;s>-n/2;){if(--a<0)return!1;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;for(var u=[],c=0;s<n/2;){var l=e[a],p=e[a+1];if(!p)return!1;var f=e[a-1].angleTo(l)-l.angleTo(p);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:f}),c+=f;s-u[0].distance>r;)c-=u.shift().angleDelta;if(c>i)return!1;a++,s+=l.dist(p)}return!0}function Ju(e){for(var t=0,n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function Qu(e,t,n){return e?.6*t*n:0}function $u(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function ec(e,t,n,r,i,o){for(var a=Qu(n,i,o),s=$u(n,r)*o,u=0,c=Ju(e)/2,l=0;l<e.length-1;l++){var p=e[l],f=e[l+1],h=p.dist(f);if(u+h>c){var d=(c-u)/h,m=Kt(p.x,f.x,d),g=Kt(p.y,f.y,d),v=new qu(m,g,f.angleTo(p),l);return v._round(),!a||Ku(e,v,s,a,t)?v:void 0}u+=h}}function tc(e,t,n,r,i,o,a,s,u){var c=Qu(r,o,a),l=$u(r,i),p=l*a,f=0===e[0].x||e[0].x===u||0===e[0].y||e[0].y===u;return t-p<t/4&&(t=p+t/4),function e(t,n,r,i,o,a,s,u,c){for(var l=a/2,p=Ju(t),f=0,h=n-r,d=[],m=0;m<t.length-1;m++){for(var g=t[m],v=t[m+1],y=g.dist(v),_=v.angleTo(g);h+r<f+y;){var b=((h+=r)-f)/y,x=Kt(g.x,v.x,b),w=Kt(g.y,v.y,b);if(x>=0&&x<c&&w>=0&&w<c&&h-l>=0&&h+l<=p){var S=new qu(x,w,_,m);S._round(),i&&!Ku(t,S,a,i,o)||d.push(S)}}f+=y}return u||d.length||s||(d=e(t,f/2,r,i,o,a,s,!0,c)),d}(e,f?t/2*s%t:(l/2+2*o)*a*s%t,t,c,n,p,f,!1,u)}var nc=Tu;function rc(e,t,n,r){var o=[],a=e.image,s=a.pixelRatio,u=a.paddedRect.w-2*nc,c=a.paddedRect.h-2*nc,l=e.right-e.left,p=e.bottom-e.top,f=a.stretchX||[[0,u]],h=a.stretchY||[[0,c]],d=function(e,t){return e+t[1]-t[0]},m=f.reduce(d,0),g=h.reduce(d,0),v=u-m,y=c-g,_=0,b=m,x=0,w=g,S=0,E=v,T=0,k=y;if(a.content&&r){var A=a.content;_=ic(f,0,A[0]),x=ic(h,0,A[1]),b=ic(f,A[0],A[2]),w=ic(h,A[1],A[3]),S=A[0]-_,T=A[1]-x,E=A[2]-A[0]-b,k=A[3]-A[1]-w}var C=function(r,o,u,c){var f=ac(r.stretch-_,b,l,e.left),h=sc(r.fixed-S,E,r.stretch,m),d=ac(o.stretch-x,w,p,e.top),v=sc(o.fixed-T,k,o.stretch,g),y=ac(u.stretch-_,b,l,e.left),A=sc(u.fixed-S,E,u.stretch,m),C=ac(c.stretch-x,w,p,e.top),I=sc(c.fixed-T,k,c.stretch,g),M=new i(f,d),P=new i(y,d),O=new i(y,C),L=new i(f,C),R=new i(h/s,v/s),D=new i(A/s,I/s),z=t*Math.PI/180;if(z){var N=Math.sin(z),j=Math.cos(z),F=[j,-N,N,j];M._matMult(F),P._matMult(F),L._matMult(F),O._matMult(F)}var B=r.stretch+r.fixed,U=o.stretch+o.fixed;return{tl:M,tr:P,bl:L,br:O,tex:{x:a.paddedRect.x+nc+B,y:a.paddedRect.y+nc+U,w:u.stretch+u.fixed-B,h:c.stretch+c.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:D,minFontScaleX:E/s/l,minFontScaleY:k/s/p,isSDF:n}};if(r&&(a.stretchX||a.stretchY))for(var I=oc(f,v,m),M=oc(h,y,g),P=0;P<I.length-1;P++)for(var O=I[P],L=I[P+1],R=0;R<M.length-1;R++)o.push(C(O,M[R],L,M[R+1]));else o.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:c+1}));return o}function ic(e,t,n){for(var r=0,i=0,o=e;i<o.length;i+=1){var a=o[i];r+=Math.max(t,Math.min(n,a[1]))-Math.max(t,Math.min(n,a[0]))}return r}function oc(e,t,n){for(var r=[{fixed:-nc,stretch:0}],i=0,o=e;i<o.length;i+=1){var a=o[i],s=a[0],u=a[1],c=r[r.length-1];r.push({fixed:s-c.stretch,stretch:c.stretch}),r.push({fixed:s-c.stretch,stretch:c.stretch+(u-s)})}return r.push({fixed:t+nc,stretch:n}),r}function ac(e,t,n,r){return e/t*n+r}function sc(e,t,n,r){return e-t*n/r}var uc=function(e,t,n,r,o,a,s,u,c,l,p,f){var h=s.top*u-c,d=s.bottom*u+c,m=s.left*u-c,g=s.right*u+c,v=s.collisionPadding;if(v&&(m-=v[0]*u,h-=v[1]*u,g+=v[2]*u,d+=v[3]*u),this.boxStartIndex=e.length,l){var y=d-h,_=g-m;y>0&&(y=Math.max(10*u,y),this._addLineCollisionCircles(e,t,n,n.segment,_,y,r,o,a,p))}else{if(f){var b=new i(m,h),x=new i(g,h),w=new i(m,d),S=new i(g,d),E=f*Math.PI/180;b._rotate(E),x._rotate(E),w._rotate(E),S._rotate(E),m=Math.min(b.x,x.x,w.x,S.x),g=Math.max(b.x,x.x,w.x,S.x),h=Math.min(b.y,x.y,w.y,S.y),d=Math.max(b.y,x.y,w.y,S.y)}e.emplaceBack(n.x,n.y,m,h,g,d,r,o,a,0,0)}this.boxEndIndex=e.length};uc.prototype._addLineCollisionCircles=function(e,t,n,r,i,o,a,s,u,c){var l=o/2,p=Math.floor(i/l)||1,f=1+.4*Math.log(c)/Math.LN2,h=Math.floor(p*f/2),d=-o/2,m=n,g=r+1,v=d,y=-i/2,_=y-i/4;do{if(--g<0){if(v>y)return;g=0;break}v-=t[g].dist(m),m=t[g]}while(v>_);for(var b=t[g].dist(t[g+1]),x=-h;x<p+h;x++){var w=x*l,S=y+w;if(w<0&&(S+=w),w>i&&(S+=w-i),!(S<v)){for(;v+b<S;){if(v+=b,1+ ++g>=t.length)return;b=t[g].dist(t[g+1])}var E=S-v,T=t[g],k=t[g+1].sub(T)._unit()._mult(E)._add(T)._round(),A=Math.abs(S-d)<l?0:.8*(S-d);e.emplaceBack(k.x,k.y,-o/2,-o/2,o/2,o/2,a,s,u,o/2,A)}}};var cc=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=lc),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)};function lc(e,t){return e<t?-1:e>t?1:0}function pc(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!1);for(var r=1/0,o=1/0,a=-1/0,s=-1/0,u=e[0],c=0;c<u.length;c++){var l=u[c];(!c||l.x<r)&&(r=l.x),(!c||l.y<o)&&(o=l.y),(!c||l.x>a)&&(a=l.x),(!c||l.y>s)&&(s=l.y)}var p=Math.min(a-r,s-o),f=p/2,h=new cc([],fc);if(0===p)return new i(r,o);for(var d=r;d<a;d+=p)for(var m=o;m<s;m+=p)h.push(new hc(d+f,m+f,f,e));for(var g=function(e){for(var t=0,n=0,r=0,i=e[0],o=0,a=i.length,s=a-1;o<a;s=o++){var u=i[o],c=i[s],l=u.x*c.y-c.x*u.y;n+=(u.x+c.x)*l,r+=(u.y+c.y)*l,t+=3*l}return new hc(n/t,r/t,0,e)}(e),v=h.length;h.length;){var y=h.pop();(y.d>g.d||!g.d)&&(g=y,n&&console.log("found best %d after %d probes",Math.round(1e4*y.d)/1e4,v)),y.max-g.d<=t||(h.push(new hc(y.p.x-(f=y.h/2),y.p.y-f,f,e)),h.push(new hc(y.p.x+f,y.p.y-f,f,e)),h.push(new hc(y.p.x-f,y.p.y+f,f,e)),h.push(new hc(y.p.x+f,y.p.y+f,f,e)),v+=4)}return n&&(console.log("num probes: "+v),console.log("best distance: "+g.d)),g.p}function fc(e,t){return t.max-e.max}function hc(e,t,n,r){this.p=new i(e,t),this.h=n,this.d=function(e,t){for(var n=!1,r=1/0,i=0;i<t.length;i++)for(var o=t[i],a=0,s=o.length,u=s-1;a<s;u=a++){var c=o[a],l=o[u];c.y>e.y!=l.y>e.y&&e.x<(l.x-c.x)*(e.y-c.y)/(l.y-c.y)+c.x&&(n=!n),r=Math.min(r,oa(e,c,l))}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}cc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},cc.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},cc.prototype.peek=function(){return this.data[0]},cc.prototype._up=function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var i=e-1>>1,o=t[i];if(n(r,o)>=0)break;t[e]=o,e=i}t[e]=r},cc.prototype._down=function(e){for(var t=this.data,n=this.compare,r=this.length>>1,i=t[e];e<r;){var o=1+(e<<1),a=t[o],s=o+1;if(s<this.length&&n(t[s],a)<0&&(o=s,a=t[s]),n(a,i)>=0)break;t[e]=a,e=o}t[e]=i};var dc=7,mc=Number.POSITIVE_INFINITY;function gc(e,t){return t[1]!==mc?function(e,t,n){var r=0,i=0;switch(t=Math.abs(t),n=Math.abs(n),e){case"top-right":case"top-left":case"top":i=n-dc;break;case"bottom-right":case"bottom-left":case"bottom":i=-n+dc}switch(e){case"top-right":case"bottom-right":case"right":r=-t;break;case"top-left":case"bottom-left":case"left":r=t}return[r,i]}(e,t[0],t[1]):function(e,t){var n=0,r=0;t<0&&(t=0);var i=t/Math.sqrt(2);switch(e){case"top-right":case"top-left":r=i-dc;break;case"bottom-right":case"bottom-left":r=-i+dc;break;case"bottom":r=-t+dc;break;case"top":r=t-dc}switch(e){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=t;break;case"right":n=-t}return[n,r]}(e,t[0])}function vc(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}var yc=255,_c=yc*Zu;function bc(e,t,n,r,o,a,s,u,c,l,p,f,h,d,m){var g=function(e,t,n,r,o,a,s,u){for(var c=r.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,l=[],p=0,f=t.positionedLines;p<f.length;p+=1)for(var h=f[p],d=0,m=h.positionedGlyphs;d<m.length;d+=1){var g=m[d];if(g.rect){var v=g.rect||{},y=Su+1,_=!0,b=1,x=0,w=(o||u)&&g.vertical,S=g.metrics.advance*g.scale/2;if(u&&t.verticalizable&&(x=h.lineOffset/2-(g.imageName?-(Qs-g.metrics.width*g.scale)/2:(g.scale-1)*Qs)),g.imageName){var E=s[g.imageName];_=E.sdf,y=Tu/(b=E.pixelRatio)}var T=o?[g.x+S,g.y]:[0,0],k=o?[0,0]:[g.x+S+n[0],g.y+n[1]-x],A=[0,0];w&&(A=k,k=[0,0]);var C=(g.metrics.left-y)*g.scale-S+k[0],I=(-g.metrics.top-y)*g.scale+k[1],M=C+v.w*g.scale/b,P=I+v.h*g.scale/b,O=new i(C,I),L=new i(M,I),R=new i(C,P),D=new i(M,P);if(w){var z=new i(-S,S-Mu),N=-Math.PI/2,j=Qs/2-S,F=new i(5-Mu-j,-(g.imageName?j:0)),B=new(Function.prototype.bind.apply(i,[null].concat(A)));O._rotateAround(N,z)._add(F)._add(B),L._rotateAround(N,z)._add(F)._add(B),R._rotateAround(N,z)._add(F)._add(B),D._rotateAround(N,z)._add(F)._add(B)}if(c){var U=Math.sin(c),V=Math.cos(c),G=[V,-U,U,V];O._matMult(G),L._matMult(G),R._matMult(G),D._matMult(G)}var q=new i(0,0),Z=new i(0,0);l.push({tl:O,tr:L,bl:R,br:D,tex:v,writingMode:t.writingMode,glyphOffset:T,sectionIndex:g.sectionIndex,isSDF:_,pixelOffsetTL:q,pixelOffsetBR:Z,minFontScaleX:0,minFontScaleY:0})}}return l}(0,n,u,o,a,s,r,e.allowVerticalPlacement),v=e.textSizeData,y=null;"source"===v.kind?(y=[Zu*o.layout.get("text-size").evaluate(s,{})])[0]>_c&&x(e.layerIds[0]+': Value for "text-size" is >= '+yc+'. Reduce your "text-size".'):"composite"===v.kind&&((y=[Zu*d.compositeTextSizes[0].evaluate(s,{},m),Zu*d.compositeTextSizes[1].evaluate(s,{},m)])[0]>_c||y[1]>_c)&&x(e.layerIds[0]+': Value for "text-size" is >= '+yc+'. Reduce your "text-size".'),e.addSymbols(e.text,g,y,u,a,s,l,t,c.lineStartIndex,c.lineLength,h,m);for(var _=0,b=p;_<b.length;_+=1)f[b[_]]=e.text.placedSymbolArray.length-1;return 4*g.length}function xc(e){for(var t in e)return e[t];return null}function wc(e,t,n,r){var i=e.compareText;if(t in i){for(var o=i[t],a=o.length-1;a>=0;a--)if(r.dist(o[a])<n)return!0}else i[t]=[];return i[t].push(r),!1}var Sc=Ts.VectorTileFeature.types,Ec=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Tc(e,t,n,r,i,o,a,s,u,c,l,p,f){var h=s?Math.min(_c,Math.round(s[0])):0,d=s?Math.min(_c,Math.round(s[1])):0;e.emplaceBack(t,n,Math.round(32*r),Math.round(32*i),o,a,(h<<1)+(u?1:0),d,16*c,16*l,256*p,256*f)}function kc(e,t,n){e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n)}function Ac(e){for(var t=0,n=e.sections;t<n.length;t+=1)if(ui(n[t].text))return!0;return!1}var Cc=function(e){this.layoutVertexArray=new qi,this.indexArray=new to,this.programConfigurations=e,this.segments=new yo,this.dynamicLayoutVertexArray=new Zi,this.opacityVertexArray=new Hi,this.placedSymbolArray=new co};Cc.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Cc.prototype.upload=function(e,t,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zs.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Hs.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ec,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(e))},Cc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Xr("SymbolBuffers",Cc);var Ic=function(e,t,n){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new n,this.segments=new yo,this.collisionVertexArray=new Xi};Ic.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ws.members,!0)},Ic.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Xr("CollisionBuffers",Ic);var Mc=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[];var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Hu(this.zoom,t["text-size"]),this.iconSizeData=Hu(this.zoom,t["icon-size"]);var n=this.layers[0].layout,r=n.get("symbol-sort-key"),i=n.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==i&&void 0!==r.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement")),"point"===n.get("symbol-placement")&&(this.writingModes=n.get("text-writing-mode").map((function(e){return Iu[e]}))),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.sourceID=e.sourceID};Mc.prototype.createArrays=function(){this.text=new Cc(new Zo(Zs.members,this.layers,this.zoom,(function(e){return/^text/.test(e)}))),this.icon=new Cc(new Zo(Zs.members,this.layers,this.zoom,(function(e){return/^icon/.test(e)}))),this.glyphOffsetArray=new fo,this.lineVertexArray=new ho,this.symbolInstances=new po},Mc.prototype.calculateGlyphDependencies=function(e,t,n,r,i){for(var o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,(n||r)&&i){var a=Js[e.charAt(o)];a&&(t[a.charCodeAt(0)]=!0)}},Mc.prototype.populate=function(e,t,n){var r=this.layers[0],i=r.layout,o=i.get("text-font"),a=i.get("text-field"),s=i.get("icon-image"),u=("constant"!==a.value.kind||a.value.value instanceof et&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,l=i.get("symbol-sort-key");if(this.features=[],u||c){for(var p=t.iconDependencies,f=t.glyphDependencies,h=t.availableImages,d=new yi(this.zoom),m=0,g=e;m<g.length;m+=1){var v=g[m],y=v.feature,_=v.id,b=v.index,x=v.sourceLayerIndex,w=r._featureFilter.needGeometry,S={type:y.type,id:_,properties:y.properties,geometry:w?Xo(y):[]};if(r._featureFilter.filter(d,S,n)){w||(S.geometry=Xo(y));var E=void 0;if(u){var T=r.getValueAndResolveTokens("text-field",S,n,h),k=et.factory(T);Ac(k)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===mi()||this.hasRTLText&&vi.isParsed())&&(E=Ks(k,r,S))}var A=void 0;if(c){var C=r.getValueAndResolveTokens("icon-image",S,n,h);A=C instanceof tt?C:tt.fromString(C)}if(E||A){var I=this.sortFeaturesByKey?l.evaluate(S,{},n):void 0,M={id:_,text:E,icon:A,index:b,sourceLayerIndex:x,geometry:Xo(y),properties:y.properties,type:Sc[y.type],sortKey:I};if(this.features.push(M),A&&(p[A.name]=!0),E){var P=o.evaluate(S,{},n).join(","),O="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Iu.vertical)>=0;for(var L=0,R=E.sections;L<R.length;L+=1){var D=R[L];if(D.image)p[D.image.name]=!0;else{var z=ri(E.toString()),N=D.fontStack||P,j=f[N]=f[N]||{};this.calculateGlyphDependencies(D.text,j,O,this.allowVerticalPlacement,z)}}}}}}"line"===i.get("symbol-placement")&&(this.features=function(e){var t={},n={},r=[],i=0;function o(t){r.push(e[t]),i++}function a(e,t,i){var o=n[e];return delete n[e],n[t]=o,r[o].geometry[0].pop(),r[o].geometry[0]=r[o].geometry[0].concat(i[0]),o}function s(e,n,i){var o=t[n];return delete t[n],t[e]=o,r[o].geometry[0].shift(),r[o].geometry[0]=i[0].concat(r[o].geometry[0]),o}function u(e,t,n){var r=n?t[0][t[0].length-1]:t[0][0];return e+":"+r.x+":"+r.y}for(var c=0;c<e.length;c++){var l=e[c],p=l.geometry,f=l.text?l.text.toString():null;if(f){var h=u(f,p),d=u(f,p,!0);if(h in n&&d in t&&n[h]!==t[d]){var m=s(h,d,p),g=a(h,d,r[m].geometry);delete t[h],delete n[d],n[u(f,r[g].geometry,!0)]=g,r[m].geometry=null}else h in n?a(h,d,p):d in t?s(h,d,p):(o(c),t[h]=i-1,n[d]=i-1)}else o(c)}return r.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}},Mc.prototype.update=function(e,t,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,n))},Mc.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},Mc.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Mc.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e),this.textCollisionCircle.upload(e),this.iconCollisionCircle.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Mc.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy(),this.textCollisionCircle.destroy(),this.iconCollisionCircle.destroy()},Mc.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Mc.prototype.addToLineVertexArray=function(e,t){var n=this.lineVertexArray.length;if(void 0!==e.segment){for(var r=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]),o={},a=e.segment+1;a<t.length;a++)o[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:r},a<t.length-1&&(r+=t[a+1].dist(t[a]));for(var s=e.segment||0;s>=0;s--)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=t[s-1].dist(t[s]));for(var u=0;u<t.length;u++){var c=o[u];this.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}},Mc.prototype.addSymbols=function(e,t,n,r,i,o,a,s,u,c,l,p){for(var f=e.indexArray,h=e.layoutVertexArray,d=e.segments.prepareSegment(4*t.length,h,f,o.sortKey),m=this.glyphOffsetArray.length,g=d.vertexLength,v=this.allowVerticalPlacement&&a===Iu.vertical?Math.PI/2:0,y=o.text&&o.text.sections,_=0;_<t.length;_++){var b=t[_],x=b.tl,w=b.tr,S=b.bl,E=b.br,T=b.tex,k=b.pixelOffsetTL,A=b.pixelOffsetBR,C=b.minFontScaleX,I=b.minFontScaleY,M=b.glyphOffset,P=b.isSDF,O=b.sectionIndex,L=d.vertexLength,R=M[1];Tc(h,s.x,s.y,x.x,R+x.y,T.x,T.y,n,P,k.x,k.y,C,I),Tc(h,s.x,s.y,w.x,R+w.y,T.x+T.w,T.y,n,P,A.x,k.y,C,I),Tc(h,s.x,s.y,S.x,R+S.y,T.x,T.y+T.h,n,P,k.x,A.y,C,I),Tc(h,s.x,s.y,E.x,R+E.y,T.x+T.w,T.y+T.h,n,P,A.x,A.y,C,I),kc(e.dynamicLayoutVertexArray,s,v),f.emplaceBack(L,L+1,L+2),f.emplaceBack(L+1,L+2,L+3),d.vertexLength+=4,d.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(M[0]),_!==t.length-1&&O===t[_+1].sectionIndex||e.programConfigurations.populatePaintArrays(h.length,o,o.index,{},p,y&&y[O])}e.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,g,u,c,s.segment,n?n[0]:0,n?n[1]:0,r[0],r[1],a,0,!1,0,l)},Mc.prototype._addCollisionDebugVertex=function(e,t,n,r,i,o){return t.emplaceBack(0,0),e.emplaceBack(n.x,n.y,r,i,Math.round(o.x),Math.round(o.y))},Mc.prototype.addCollisionDebugVertices=function(e,t,n,r,o,a,s,u){var c=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),l=c.vertexLength,p=o.layoutVertexArray,f=o.collisionVertexArray,h=s.anchorX,d=s.anchorY;if(this._addCollisionDebugVertex(p,f,a,h,d,new i(e,t)),this._addCollisionDebugVertex(p,f,a,h,d,new i(n,t)),this._addCollisionDebugVertex(p,f,a,h,d,new i(n,r)),this._addCollisionDebugVertex(p,f,a,h,d,new i(e,r)),c.vertexLength+=4,u){var m=o.indexArray;m.emplaceBack(l,l+1,l+2),m.emplaceBack(l,l+2,l+3),c.primitiveLength+=2}else{var g=o.indexArray;g.emplaceBack(l,l+1),g.emplaceBack(l+1,l+2),g.emplaceBack(l+2,l+3),g.emplaceBack(l+3,l),c.primitiveLength+=4}},Mc.prototype.addDebugCollisionBoxes=function(e,t,n,r){for(var i=e;i<t;i++){var o=this.collisionBoxArray.get(i),a=o.radius>0;this.addCollisionDebugVertices(o.x1,o.y1,o.x2,o.y2,a?r?this.textCollisionCircle:this.iconCollisionCircle:r?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,n,a)}},Mc.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ic(Yi,Ys.members,no),this.iconCollisionBox=new Ic(Yi,Ys.members,no),this.textCollisionCircle=new Ic(Yi,Xs.members,to),this.iconCollisionCircle=new Ic(Yi,Xs.members,to);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Mc.prototype._deserializeCollisionBoxesForSymbol=function(e,t,n,r,i,o,a,s,u){for(var c={},l=t;l<n;l++){var p=e.get(l);if(0===p.radius){c.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},c.textFeatureIndex=p.featureIndex;break}c.textCircles||(c.textCircles=[],c.textFeatureIndex=p.featureIndex),c.textCircles.push(p.anchorPointX,p.anchorPointY,p.radius,p.signedDistanceFromAnchor,1)}for(var f=r;f<i;f++){var h=e.get(f);if(0===h.radius){c.verticalTextBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},c.verticalTextFeatureIndex=h.featureIndex;break}}for(var d=o;d<a;d++){var m=e.get(d);if(0===m.radius){c.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},c.iconFeatureIndex=m.featureIndex;break}}for(var g=s;g<u;g++){var v=e.get(g);if(0===v.radius){c.verticalIconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},c.verticalIconFeatureIndex=v.featureIndex;break}}return c},Mc.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}},Mc.prototype.hasTextData=function(){return this.text.segments.get().length>0},Mc.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Mc.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox&&this.textCollisionCircle&&this.iconCollisionCircle},Mc.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Mc.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Mc.prototype.hasTextCollisionCircleData=function(){return this.hasDebugData()&&this.textCollisionCircle.segments.get().length>0},Mc.prototype.hasIconCollisionCircleData=function(){return this.hasDebugData()&&this.iconCollisionCircle.segments.get().length>0},Mc.prototype.addIndicesForPlacedSymbol=function(e,t){for(var n=e.placedSymbolArray.get(t),r=n.vertexStartIndex+4*n.numGlyphs,i=n.vertexStartIndex;i<r;i+=4)e.indexArray.emplaceBack(i,i+1,i+2),e.indexArray.emplaceBack(i+1,i+2,i+3)},Mc.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),n=Math.cos(e),r=[],i=[],o=[],a=0;a<this.symbolInstances.length;++a){o.push(a);var s=this.symbolInstances.get(a);r.push(0|Math.round(t*s.anchorX+n*s.anchorY)),i.push(s.featureIndex)}return o.sort((function(e,t){return r[e]-r[t]||i[t]-i[e]})),o},Mc.prototype.addToSortKeyRanges=function(e,t){var n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Mc.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var n=0,r=this.symbolInstanceIndexes;n<r.length;n+=1){var i=this.symbolInstances.get(r[n]);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((function(e,n,r){e>=0&&r.indexOf(e)===n&&t.addIndicesForPlacedSymbol(t.text,e)})),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Xr("SymbolBucket",Mc,{omit:["layers","collisionBoxArray","features","compareText"]}),Mc.MAX_GLYPHS=65535,Mc.addDynamicAttributes=kc;var Pc=new Oi({"symbol-placement":new Ai(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new Ai(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ai(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ci(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ai(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ai(Ce.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ai(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ai(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ai(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ci(Ce.layout_symbol["icon-size"]),"icon-text-fit":new Ai(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ai(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ci(Ce.layout_symbol["icon-image"]),"icon-rotate":new Ci(Ce.layout_symbol["icon-rotate"]),"icon-padding":new Ai(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new Ai(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new Ci(Ce.layout_symbol["icon-offset"]),"icon-anchor":new Ci(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ai(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ai(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ai(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new Ci(Ce.layout_symbol["text-field"]),"text-font":new Ci(Ce.layout_symbol["text-font"]),"text-size":new Ci(Ce.layout_symbol["text-size"]),"text-max-width":new Ci(Ce.layout_symbol["text-max-width"]),"text-line-height":new Ai(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new Ci(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new Ci(Ce.layout_symbol["text-justify"]),"text-radial-offset":new Ci(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ai(Ce.layout_symbol["text-variable-anchor"]),"text-anchor":new Ci(Ce.layout_symbol["text-anchor"]),"text-max-angle":new Ai(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new Ai(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new Ci(Ce.layout_symbol["text-rotate"]),"text-padding":new Ai(Ce.layout_symbol["text-padding"]),"text-keep-upright":new Ai(Ce.layout_symbol["text-keep-upright"]),"text-transform":new Ci(Ce.layout_symbol["text-transform"]),"text-offset":new Ci(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new Ai(Ce.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ai(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new Ai(Ce.layout_symbol["text-optional"])}),Oc={paint:new Oi({"icon-opacity":new Ci(Ce.paint_symbol["icon-opacity"]),"icon-color":new Ci(Ce.paint_symbol["icon-color"]),"icon-halo-color":new Ci(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ci(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ci(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new Ai(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ai(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ci(Ce.paint_symbol["text-opacity"]),"text-color":new Ci(Ce.paint_symbol["text-color"],{runtimeType:Be,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new Ci(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new Ci(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new Ci(Ce.paint_symbol["text-halo-blur"]),"text-translate":new Ai(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new Ai(Ce.paint_symbol["text-translate-anchor"])}),layout:Pc},Lc=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ze,this.defaultValue=e};Lc.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Lc.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Lc.prototype.outputDefined=function(){return!1},Lc.prototype.serialize=function(){return null},Xr("FormatSectionOverride",Lc,{omit:["defaultValue"]});var Rc=function(e){function t(t){e.call(this,t,Oc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(t,n){if(e.prototype.recalculate.call(this,t,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var r=this.layout.get("text-writing-mode");if(r){for(var i=[],o=0,a=r;o<a.length;o+=1){var s=a[o];i.indexOf(s)<0&&i.push(s)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(e,t,n,r){var i=this.layout.get(e).evaluate(t,{},n,r),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||nr(o.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,(function(t,n){return n in e?String(e[n]):""}))}(t.properties,i)},t.prototype.createBucket=function(e){return new Mc(e)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var e=0,n=Oc.paint.overridableProperties;e<n.length;e+=1){var r=n[e];if(t.hasPaintOverride(this.layout,r)){var i,o=this.paint.get(r),a=new Lc(o),s=new tr(a,o.property.specification);i="constant"===o.value.kind||"source"===o.value.kind?new ir("source",s):new or("composite",s,o.value.zoomStops,o.value._interpolationType),this.paint._values[r]=new Ti(o.property,i,o.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(e,n,r){return!(!this.layout||n.isDataDriven()||r.isDataDriven())&&t.hasPaintOverride(this.layout,e)},t.hasPaintOverride=function(e,t){var n=e.get("text-field"),r=Oc.paint.properties[t],i=!1,o=function(e){for(var t=0,n=e;t<n.length;t+=1)if(r.overrides&&r.overrides.hasOverride(n[t]))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof et)o(n.value.value.sections);else if("source"===n.value.kind){var a=function e(t){i||(t instanceof at&&it(t.value)===qe?o(t.value.sections):t instanceof lt?o(t.sections):t.eachChild(e))},s=n.value;s._styleExpression&&a(s._styleExpression.expression)}return i},t}(Li),Dc={paint:new Oi({"background-color":new Ai(Ce.paint_background["background-color"]),"background-pattern":new Mi(Ce.paint_background["background-pattern"]),"background-opacity":new Ai(Ce.paint_background["background-opacity"])})},zc=function(e){function t(t){e.call(this,t,Dc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Li),Nc={paint:new Oi({"raster-opacity":new Ai(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ai(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ai(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ai(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new Ai(Ce.paint_raster["raster-saturation"]),"raster-contrast":new Ai(Ce.paint_raster["raster-contrast"]),"raster-resampling":new Ai(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new Ai(Ce.paint_raster["raster-fade-duration"])})},jc=function(e){function t(t){e.call(this,t,Nc)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Li),Fc=function(e){function t(t){e.call(this,t,{}),this.implementation=t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},t.prototype.onRemove=function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},t}(Li),Bc={circle:va,heatmap:Aa,hillshade:Ia,fill:ms,"fill-extrusion":Os,line:Gs,symbol:Rc,background:zc,raster:jc},Uc=self.HTMLImageElement,Vc=self.HTMLCanvasElement,Gc=self.HTMLVideoElement,qc=self.ImageData,Zc=self.ImageBitmap,Hc=function(e,t,n,r){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(t,r)};Hc.prototype.update=function(e,t,n){var r=e.width,i=e.height,o=!(this.size&&this.size[0]===r&&this.size[1]===i||n),a=this.context,s=a.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),o)this.size=[r,i],e instanceof Uc||e instanceof Vc||e instanceof Gc||e instanceof qc||Zc&&e instanceof Zc?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,r,i,0,this.format,s.UNSIGNED_BYTE,e.data);else{var u=n||{x:0,y:0},c=u.x,l=u.y;e instanceof Uc||e instanceof Vc||e instanceof Gc||e instanceof qc||Zc&&e instanceof Zc?s.texSubImage2D(s.TEXTURE_2D,0,c,l,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,c,l,r,i,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},Hc.prototype.bind=function(e,t,n){var r=this.context.gl;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),e!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||e),this.filter=e),t!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,t),this.wrap=t)},Hc.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Hc.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Wc=function(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};Wc.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){e._triggered=!1,e._callback()}),0))},Wc.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Yc=function(e,t,n){this.target=e,this.parent=t,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},m(["receive","process"],this),this.invoker=new Wc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=E()?e:self};function Xc(e,t,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[e*r-2*Math.PI*6378137/2,t*r-2*Math.PI*6378137/2]}Yc.prototype.send=function(e,t,n,r,i){var o=this;void 0===i&&(i=!1);var a=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[a]=n);var s=A(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:e,hasCallback:!!n,targetMapId:r,mustQueue:i,sourceMapId:this.mapId,data:$r(t,s)},s),{cancel:function(){n&&delete o.callbacks[a],o.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:o.mapId})}}},Yc.prototype.receive=function(e){var t=e.data,n=t.id;if(n&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[n];var r=this.cancelCallbacks[n];delete this.cancelCallbacks[n],r&&r()}else E()||t.mustQueue?(this.tasks[n]=t,this.taskQueue.push(n),this.invoker.trigger()):this.processTask(n,t)},Yc.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Yc.prototype.processTask=function(e,t){var n=this;if("<response>"===t.type){var r=this.callbacks[e];delete this.callbacks[e],r&&(t.error?r(ei(t.error)):r(null,ei(t.data)))}else{var i=!1,o=A(this.globalScope)?void 0:[],a=t.hasCallback?function(t,r){i=!0,delete n.cancelCallbacks[e],n.target.postMessage({id:e,type:"<response>",sourceMapId:n.mapId,error:t?$r(t):null,data:$r(r,o)},o)}:function(e){i=!0},s=null,u=ei(t.data);if(this.parent[t.type])s=this.parent[t.type](t.sourceMapId,u,a);else if(this.parent.getWorkerSource){var c=t.type.split(".");s=this.parent.getWorkerSource(t.sourceMapId,c[0],u.source)[c[1]](u,a)}else a(new Error("Could not find function "+t.type));!i&&s&&s.cancel&&(this.cancelCallbacks[e]=s.cancel)}},Yc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Kc=function(e,t,n){this.z=e,this.x=t,this.y=n,this.key=$c(0,e,e,t,n)};Kc.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Kc.prototype.url=function(e,t){var n,r,i,o,a,s=(r=this.y,i=this.z,o=Xc(256*(n=this.x),256*(r=Math.pow(2,i)-r-1),i),a=Xc(256*(n+1),256*(r+1),i),o[0]+","+o[1]+","+a[0]+","+a[1]),u=function(e,t,n){for(var r,i="",o=e;o>0;o--)i+=(t&(r=1<<o-1)?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)},Kc.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new i((e.x*t-this.x)*At,(e.y*t-this.y)*At)},Kc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Jc=function(e,t){this.wrap=e,this.canonical=t,this.key=$c(e,t.z,t.z,t.x,t.y)},Qc=function(e,t,n,r,i){this.overscaledZ=e,this.wrap=t,this.canonical=new Kc(n,+r,+i),this.key=$c(t,e,n,r,i)};function $c(e,t,n,r,i){(e*=2)<0&&(e=-1*e-1);var o=1<<n;return(o*o*e+o*i+r).toString(36)+n.toString(36)+t.toString(36)}Qc.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Qc.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Qc(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qc(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Qc.prototype.calculateScaledKey=function(e,t){var n=this.canonical.z-e;return e>this.canonical.z?$c(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):$c(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)},Qc.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Qc.prototype.children=function(e){if(this.overscaledZ>=e)return[new Qc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new Qc(t,this.wrap,t,n,r),new Qc(t,this.wrap,t,n+1,r),new Qc(t,this.wrap,t,n,r+1),new Qc(t,this.wrap,t,n+1,r+1)]},Qc.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Qc.prototype.wrapped=function(){return new Qc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Qc.prototype.unwrapTo=function(e){return new Qc(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Qc.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Qc.prototype.toUnwrapped=function(){return new Jc(this.wrap,this.canonical)},Qc.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Qc.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new kt(e.x-this.wrap,e.y))},Xr("CanonicalTileID",Kc),Xr("OverscaledTileID",Qc,{omit:["posMatrix"]});var el=function(e,t,n){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return x('"'+n+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var r=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=n||"mapbox";for(var i=0;i<r;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(r,i)]=this.data[this._idx(r-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,r)]=this.data[this._idx(i,r-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(r,-1)]=this.data[this._idx(r-1,0)],this.data[this._idx(-1,r)]=this.data[this._idx(0,r-1)],this.data[this._idx(r,r)]=this.data[this._idx(r-1,r-1)]};el.prototype.get=function(e,t){var n=new Uint8Array(this.data.buffer),r=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])},el.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},el.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},el.prototype._unpackMapbox=function(e,t,n){return(256*e*256+256*t+n)/10-1e4},el.prototype._unpackTerrarium=function(e,t,n){return 256*e+t+n/256-32768},el.prototype.getPixels=function(){return new Ea({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},el.prototype.backfillBorder=function(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var r=t*this.dim,i=t*this.dim+this.dim,o=n*this.dim,a=n*this.dim+this.dim;switch(t){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:o=a-1;break;case 1:a=o+1}for(var s=-t*this.dim,u=-n*this.dim,c=o;c<a;c++)for(var l=r;l<i;l++)this.data[this._idx(l,c)]=e.data[this._idx(l+s,c+u)]},Xr("DEMData",el);var tl=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var n=e[t];this._stringToNumber[n]=t,this._numberToString[t]=n}};tl.prototype.encode=function(e){return this._stringToNumber[e]},tl.prototype.decode=function(e){return this._numberToString[e]};var nl=function(e,t,n,r,i){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=n,e._y=r,this.properties=e.properties,this.id=i},rl={geometry:{configurable:!0}};rl.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},rl.geometry.set=function(e){this._geometry=e},nl.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(nl.prototype,rl);var il=function(){this.state={},this.stateChanges={},this.deletedStates={}};il.prototype.updateState=function(e,t,n){var r=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][r]=this.stateChanges[e][r]||{},l(this.stateChanges[e][r],n),null===this.deletedStates[e])for(var i in this.deletedStates[e]={},this.state[e])i!==r&&(this.deletedStates[e][i]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][r])for(var o in this.deletedStates[e][r]={},this.state[e][r])n[o]||(this.deletedStates[e][r][o]=null);else for(var a in n)this.deletedStates[e]&&this.deletedStates[e][r]&&null===this.deletedStates[e][r][a]&&delete this.deletedStates[e][r][a]},il.prototype.removeFeatureState=function(e,t,n){if(null!==this.deletedStates[e]){var r=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&void 0!==t)null!==this.deletedStates[e][r]&&(this.deletedStates[e][r]=this.deletedStates[e][r]||{},this.deletedStates[e][r][n]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][r])for(n in this.deletedStates[e][r]={},this.stateChanges[e][r])this.deletedStates[e][r][n]=null;else this.deletedStates[e][r]=null;else this.deletedStates[e]=null}},il.prototype.getState=function(e,t){var n=String(t),r=l({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var i=this.deletedStates[e][t];if(null===i)return{};for(var o in i)delete r[o]}return r},il.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},il.prototype.coalesceChanges=function(e,t){var n={};for(var r in this.stateChanges){this.state[r]=this.state[r]||{};var i={};for(var o in this.stateChanges[r])this.state[r][o]||(this.state[r][o]={}),l(this.state[r][o],this.stateChanges[r][o]),i[o]=this.state[r][o];n[r]=i}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var s={};if(null===this.deletedStates[a])for(var u in this.state[a])s[u]={},this.state[a][u]={};else for(var c in this.deletedStates[a]){if(null===this.deletedStates[a][c])this.state[a][c]={};else for(var p=0,f=Object.keys(this.deletedStates[a][c]);p<f.length;p+=1)delete this.state[a][c][f[p]];s[c]=this.state[a][c]}n[a]=n[a]||{},l(n[a],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(var h in e)e[h].setFeatureState(n,t)};var ol=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Gr(At,16,0),this.grid3D=new Gr(At,16,0),this.featureIndexArray=new go,this.promoteId=t};function al(e,t,n,r,i){return v(e,(function(e,o){var a=t instanceof ki?t.get(o):null;return a&&a.evaluate?a.evaluate(n,r,i):a}))}function sl(e){for(var t=1/0,n=1/0,r=-1/0,i=-1/0,o=0,a=e;o<a.length;o+=1){var s=a[o];t=Math.min(t,s.x),n=Math.min(n,s.y),r=Math.max(r,s.x),i=Math.max(i,s.y)}return{minX:t,minY:n,maxX:r,maxY:i}}function ul(e,t){return t-e}ol.prototype.insert=function(e,t,n,r,i,o){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);for(var s=o?this.grid3D:this.grid,u=0;u<t.length;u++){for(var c=t[u],l=[1/0,1/0,-1/0,-1/0],p=0;p<c.length;p++){var f=c[p];l[0]=Math.min(l[0],f.x),l[1]=Math.min(l[1],f.y),l[2]=Math.max(l[2],f.x),l[3]=Math.max(l[3],f.y)}l[0]<At&&l[1]<At&&l[2]>=0&&l[3]>=0&&s.insert(a,l[0],l[1],l[2],l[3])}},ol.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Ts.VectorTile(new tu(this.rawTileData)).layers,this.sourceLayerCoder=new tl(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ol.prototype.query=function(e,t,n,r){var o=this;this.loadVTLayers();for(var a=e.params||{},s=At/e.tileSize/e.scale,u=gr(a.filter),c=e.queryGeometry,l=e.queryPadding*s,p=sl(c),f=this.grid.query(p.minX-l,p.minY-l,p.maxX+l,p.maxY+l),h=sl(e.cameraQueryGeometry),d=this.grid3D.query(h.minX-l,h.minY-l,h.maxX+l,h.maxY+l,(function(t,n,r,o){return function(e,t,n,r,o){for(var a=0,s=e;a<s.length;a+=1){var u=s[a];if(t<=u.x&&n<=u.y&&r>=u.x&&o>=u.y)return!0}var c=[new i(t,n),new i(t,o),new i(r,o),new i(r,n)];if(e.length>2)for(var l=0,p=c;l<p.length;l+=1)if(sa(e,p[l]))return!0;for(var f=0;f<e.length-1;f++)if(ua(e[f],e[f+1],c))return!0;return!1}(e.cameraQueryGeometry,t-l,n-l,r+l,o+l)})),m=0,g=d;m<g.length;m+=1)f.push(g[m]);f.sort(ul);for(var v,y={},_=function(i){var l=f[i];if(l!==v){v=l;var p=o.featureIndexArray.get(l),h=null;o.loadMatchingFeature(y,p.bucketIndex,p.sourceLayerIndex,p.featureIndex,u,a.layers,a.availableImages,t,n,r,(function(t,n,r){return h||(h=Xo(t)),n.queryIntersectsFeature(c,t,r,h,o.z,e.transform,s,e.pixelPosMatrix)}))}},b=0;b<f.length;b++)_(b);return y},ol.prototype.loadMatchingFeature=function(e,t,n,r,i,o,a,s,u,c,l){var p=this.bucketLayerIDs[t];if(!o||function(e,t){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1}(o,p)){var f=this.sourceLayerCoder.decode(n),h=this.vtLayers[f].feature(r);if(i.filter(new yi(this.tileID.overscaledZ),h))for(var d=this.getId(h,f),m=0;m<p.length;m++){var g=p[m];if(!(o&&o.indexOf(g)<0)){var v=s[g];if(v){var y={};void 0!==d&&c&&(y=c.getState(v.sourceLayer||"_geojsonTileLayer",d));var _=u[g];_.paint=al(_.paint,v.paint,h,y,a),_.layout=al(_.layout,v.layout,h,y,a);var b=!l||l(h,v,y);if(b){var x=new nl(h,this.z,this.x,this.y,d);x.layer=_;var w=e[g];void 0===w&&(w=e[g]=[]),w.push({featureIndex:r,feature:x,intersectionZ:b})}}}}}},ol.prototype.lookupSymbolFeatures=function(e,t,n,r,i,o,a,s){var u={};this.loadVTLayers();for(var c=gr(i),l=0,p=e;l<p.length;l+=1)this.loadMatchingFeature(u,n,r,p[l],c,o,a,s,t);return u},ol.prototype.hasLayer=function(e){for(var t=0,n=this.bucketLayerIDs;t<n.length;t+=1)for(var r=0,i=n[t];r<i.length;r+=1)if(e===i[r])return!0;return!1},ol.prototype.getId=function(e,t){var n=e.id;return this.promoteId&&"boolean"==typeof(n=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(n=Number(n)),n},Xr("FeatureIndex",ol,{omit:["rawTileData","sourceLayerCoder"]});var cl=function(e,t){this.tileID=e,this.uid=f(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};cl.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<z.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},cl.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},cl.prototype.loadVectorData=function(e,t,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var r in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var n={};if(!t)return n;for(var r=function(){var e=o[i],r=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(0!==r.length){e.layers=r,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return r.filter((function(t){return t.id===e}))[0]})));for(var a=0,s=r;a<s.length;a+=1)n[s[a].id]=e}},i=0,o=e;i<o.length;i+=1)r();return n}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[r];if(i instanceof Mc){if(this.hasSymbolBuckets=!0,!n)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var o in this.buckets){var a=this.buckets[o];if(a instanceof Mc&&a.hasRTLText){this.hasRTLText=!0,vi.isLoading()||vi.isLoaded()||"deferred"!==mi()||gi();break}}for(var s in this.queryPadding=0,this.buckets){var u=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(u))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new so},cl.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},cl.prototype.getBucket=function(e){return this.buckets[e.id]},cl.prototype.upload=function(e){for(var t in this.buckets){var n=this.buckets[t];n.uploadPending()&&n.upload(e)}var r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Hc(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Hc(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)},cl.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},cl.prototype.queryRenderedFeatures=function(e,t,n,r,i,o,a,s,u,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:a,queryPadding:this.queryPadding*u},e,t,n):{}},cl.prototype.querySourceFeatures=function(e,t){var n=this.latestFeatureIndex;if(n&&n.rawTileData){var r=n.loadVTLayers(),i=t?t.sourceLayer:"",o=r._geojsonTileLayer||r[i];if(o)for(var a=gr(t&&t.filter),s=this.tileID.canonical,u=s.z,c=s.x,l=s.y,p={z:u,x:c,y:l},f=0;f<o.length;f++){var h=o.feature(f);if(a.filter(new yi(this.tileID.overscaledZ),h)){var d=n.getId(h,i),m=new nl(h,u,c,l,d);m.tile=p,e.push(m)}}}},cl.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},cl.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},cl.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var n=T(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var r=Date.now(),i=!1;if(this.expirationTime>r)i=!1;else if(t)if(this.expirationTime<t)i=!0;else{var o=this.expirationTime-t;o?this.expirationTime=r+Math.max(o,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},cl.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},cl.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var n=this.latestFeatureIndex.loadVTLayers();for(var r in this.buckets)if(t.style.hasLayer(r)){var i=this.buckets[r],o=i.layers[0].sourceLayer||"_geojsonTileLayer",a=n[o],s=e[o];a&&s&&0!==Object.keys(s).length&&(i.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{}),t&&t.style&&(this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(r).queryRadius(i))))}}},cl.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},cl.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z.now()},cl.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},cl.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=z.now()+e},cl.prototype.setDependencies=function(e,t){for(var n={},r=0,i=t;r<i.length;r+=1)n[i[r]]=!0;this.dependencies[e]=n},cl.prototype.hasDependency=function(e,t){for(var n=0,r=e;n<r.length;n+=1){var i=this.dependencies[r[n]];if(i)for(var o=0,a=t;o<a.length;o+=1)if(i[a[o]])return!0}return!1};var ll=self.performance,pl=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},ll.mark(this._marks.start)};pl.prototype.finish=function(){ll.mark(this._marks.end);var e=ll.getEntriesByName(this._marks.measure);return 0===e.length&&(ll.measure(this._marks.measure,this._marks.start,this._marks.end),e=ll.getEntriesByName(this._marks.measure),ll.clearMarks(this._marks.start),ll.clearMarks(this._marks.end),ll.clearMeasures(this._marks.measure)),e},e.Actor=Yc,e.AlphaImage=Sa,e.CanonicalTileID=Kc,e.CollisionBoxArray=so,e.Color=Je,e.DEMData=el,e.DataConstantProperty=Ai,e.DictionaryCoder=tl,e.EXTENT=At,e.ErrorEvent=ke,e.EvaluationParameters=yi,e.Event=Te,e.Evented=Ae,e.FeatureIndex=ol,e.FillBucket=fs,e.FillExtrusionBucket=Is,e.ImageAtlas=Cu,e.ImagePosition=ku,e.LineBucket=Fs,e.LngLat=_t,e.LngLatBounds=yt,e.MercatorCoordinate=kt,e.ONE_EM=Qs,e.OverscaledTileID=Qc,e.Point=i,e.Point$1=i,e.Properties=Oi,e.Protobuf=tu,e.RGBAImage=Ea,e.RequestManager=G,e.RequestPerformance=pl,e.ResourceType=de,e.SegmentVector=yo,e.SourceFeatureState=il,e.StructArrayLayout1ui2=ro,e.StructArrayLayout2i4=Fi,e.StructArrayLayout3ui6=to,e.StructArrayLayout4i8=Bi,e.SymbolBucket=Mc,e.Texture=Hc,e.Tile=cl,e.Transitionable=xi,e.Uniform1f=Po,e.Uniform1i=Mo,e.Uniform2f=Oo,e.Uniform3f=Lo,e.Uniform4f=Ro,e.UniformColor=Do,e.UniformMatrix4f=No,e.UnwrappedTileID=Jc,e.ValidationError=Ie,e.WritingMode=Iu,e.ZoomHistory=ti,e.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},e.addDynamicAttributes=kc,e.asyncAll=function(e,t,n){if(!e.length)return n(null,[]);var r=e.length,i=new Array(e.length),o=null;e.forEach((function(e,a){t(e,(function(e,t){e&&(o=e),i[a]=t,0==--r&&n(o,i)}))}))},e.bezier=a,e.bindAll=m,e.browser=z,e.cacheEntryPossiblyAdded=function(e){++fe>se&&(e.getActor().send("enforceCacheSizeLimit",ae),fe=0)},e.clamp=u,e.clearTileCache=function(e){var t=self.caches.delete(oe);e&&t.catch(e).then((function(){return e()}))},e.clone=function(e){var t=new ma(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=_,e.clone$2=function(e){var t=new ma(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.config=N,e.create=function(){var e=new ma(16);return ma!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=function(){var e=new ma(9);return ma!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},e.create$2=function(){var e=new ma(4);return ma!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},e.createCommonjsModule=t,e.createExpression=rr,e.createLayout=Ni,e.createStyleLayer=function(e){return"custom"===e.type?new Fc(e):new Bc[e.type](e)},e.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},e.deepEqual=function e(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(t).length!==Object.keys(n).length)return!1;for(var i in t)if(!e(t[i],n[i]))return!1;return!0}return t===n},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.ease=s,e.emitValidationErrors=Vr,e.endsWith=g,e.enforceCacheSizeLimit=function(e){ce(),Q&&Q.then((function(t){t.keys().then((function(n){for(var r=0;r<n.length-e;r++)t.delete(n[r])}))}))},e.evaluateSizeForFeature=Wu,e.evaluateSizeForZoom=Yu,e.evaluateVariableOffset=gc,e.evented=di,e.extend=l,e.featureFilter=gr,e.filterObject=y,e.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.getAnchorAlignment=Uu,e.getAnchorJustification=vc,e.getArrayBuffer=be,e.getImage=we,e.getJSON=function(e,t){return _e(l(e,{type:"json"}),t)},e.getRTLTextPluginStatus=mi,e.getReferrer=ye,e.getVideo=function(e,t){var n,r,i=self.document.createElement("video");i.muted=!0,i.onloadstart=function(){t(null,i)};for(var o=0;o<e.length;o++){var a=self.document.createElement("source");n=e[o],r=void 0,(r=self.document.createElement("a")).href=n,(r.protocol!==self.document.location.protocol||r.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),a.src=e[o],i.appendChild(a)}return{cancel:function(){}}},e.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],p=t[9],f=t[10],h=t[11],d=t[12],m=t[13],g=t[14],v=t[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,S=i*c-o*u,E=l*m-p*d,T=l*g-f*d,k=l*v-h*d,A=p*g-f*m,C=p*v-h*m,I=f*v-h*g,M=y*I-_*C+b*A+x*k-w*T+S*E;return M?(e[0]=(s*I-u*C+c*A)*(M=1/M),e[1]=(i*C-r*I-o*A)*M,e[2]=(m*S-g*w+v*x)*M,e[3]=(f*w-p*S-h*x)*M,e[4]=(u*k-a*I-c*T)*M,e[5]=(n*I-i*k+o*T)*M,e[6]=(g*b-d*S-v*_)*M,e[7]=(l*S-f*b+h*_)*M,e[8]=(a*C-s*k+c*E)*M,e[9]=(r*k-n*C-o*E)*M,e[10]=(d*w-m*b+v*y)*M,e[11]=(p*b-l*w-h*y)*M,e[12]=(s*T-a*A-u*E)*M,e[13]=(n*A-r*T+i*E)*M,e[14]=(m*_-d*x-g*y)*M,e[15]=(l*x-p*_+f*y)*M,e):null},e.isChar=ni,e.isMapboxURL=q,e.keysDifference=function(e,t){var n=[];for(var r in e)r in t||n.push(r);return n},e.makeRequest=_e,e.mapObject=v,e.mercatorXfromLng=wt,e.mercatorYfromLat=St,e.mercatorZfromAltitude=Et,e.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],p=t[8],f=t[9],h=t[10],d=t[11],m=t[12],g=t[13],v=t[14],y=t[15],_=n[0],b=n[1],x=n[2],w=n[3];return e[0]=_*r+b*s+x*p+w*m,e[1]=_*i+b*u+x*f+w*g,e[2]=_*o+b*c+x*h+w*v,e[3]=_*a+b*l+x*d+w*y,e[4]=(_=n[4])*r+(b=n[5])*s+(x=n[6])*p+(w=n[7])*m,e[5]=_*i+b*u+x*f+w*g,e[6]=_*o+b*c+x*h+w*v,e[7]=_*a+b*l+x*d+w*y,e[8]=(_=n[8])*r+(b=n[9])*s+(x=n[10])*p+(w=n[11])*m,e[9]=_*i+b*u+x*f+w*g,e[10]=_*o+b*c+x*h+w*v,e[11]=_*a+b*l+x*d+w*y,e[12]=(_=n[12])*r+(b=n[13])*s+(x=n[14])*p+(w=n[15])*m,e[13]=_*i+b*u+x*f+w*g,e[14]=_*o+b*c+x*h+w*v,e[15]=_*a+b*l+x*d+w*y,e},e.mvt=Ts,e.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e},e.number=Kt,e.offscreenCanvasSupported=he,e.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e},e.parseGlyphPBF=function(e){return new tu(e).readFields(bu,[])},e.pbf=tu,e.performSymbolLayout=function(e,t,n,r,o,a,s){e.createArrays(),e.tilePixelRatio=At/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var u=e.layers[0].layout,c=e.layers[0]._unevaluatedLayout._values,l={};if("composite"===e.textSizeData.kind){var p=e.textSizeData,f=p.maxZoom;l.compositeTextSizes=[c["text-size"].possiblyEvaluate(new yi(p.minZoom),s),c["text-size"].possiblyEvaluate(new yi(f),s)]}if("composite"===e.iconSizeData.kind){var h=e.iconSizeData,d=h.maxZoom;l.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new yi(h.minZoom),s),c["icon-size"].possiblyEvaluate(new yi(d),s)]}l.layoutTextSize=c["text-size"].possiblyEvaluate(new yi(e.zoom+1),s),l.layoutIconSize=c["icon-size"].possiblyEvaluate(new yi(e.zoom+1),s),l.textMaxSize=c["text-size"].possiblyEvaluate(new yi(18));for(var m=u.get("text-line-height")*Qs,g="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),v=u.get("text-keep-upright"),y=u.get("text-size"),_=function(){var a=w[b],c=u.get("text-font").evaluate(a,{},s).join(","),p=y.evaluate(a,{},s),f=l.layoutTextSize.evaluate(a,{},s),h=l.layoutIconSize.evaluate(a,{},s),d={horizontal:{},vertical:void 0},_=a.text,S=[0,0];if(_){var E=_.toString(),T=u.get("text-letter-spacing").evaluate(a,{},s)*Qs,k=function(e){for(var t=0,n=e;t<n.length;t+=1)if(r=n[t].charCodeAt(0),ni.Arabic(r)||ni["Arabic Supplement"](r)||ni["Arabic Extended-A"](r)||ni["Arabic Presentation Forms-A"](r)||ni["Arabic Presentation Forms-B"](r))return!1;var r;return!0}(E)?T:0,A=u.get("text-anchor").evaluate(a,{},s),C=u.get("text-variable-anchor");if(!C){var I=u.get("text-radial-offset").evaluate(a,{},s);S=I?gc(A,[I*Qs,mc]):u.get("text-offset").evaluate(a,{},s).map((function(e){return e*Qs}))}var M=g?"center":u.get("text-justify").evaluate(a,{},s),P=u.get("symbol-placement"),O="point"===P?u.get("text-max-width").evaluate(a,{},s)*Qs:0,L=function(){e.allowVerticalPlacement&&ri(E)&&(d.vertical=Lu(_,t,n,o,c,O,m,A,"left",k,S,Iu.vertical,!0,P,f,p))};if(!g&&C){for(var R="auto"===M?C.map((function(e){return vc(e)})):[M],D=!1,z=0;z<R.length;z++){var N=R[z];if(!d.horizontal[N])if(D)d.horizontal[N]=d.horizontal[0];else{var j=Lu(_,t,n,o,c,O,m,"center",N,k,S,Iu.horizontal,!1,P,f,p);j&&(d.horizontal[N]=j,D=1===j.positionedLines.length)}}L()}else{"auto"===M&&(M=vc(A));var F=Lu(_,t,n,o,c,O,m,A,M,k,S,Iu.horizontal,!1,P,f,p);F&&(d.horizontal[M]=F),L(),ri(E)&&g&&v&&(d.vertical=Lu(_,t,n,o,c,O,m,A,M,k,S,Iu.vertical,!1,P,f,p))}}var B=void 0,U=!1;if(a.icon&&a.icon.name){var V=r[a.icon.name];V&&(B=function(e,t,n){var r=Uu(n),i=t[0]-e.displaySize[0]*r.horizontalAlign,o=t[1]-e.displaySize[1]*r.verticalAlign;return{image:e,top:o,bottom:o+e.displaySize[1],left:i,right:i+e.displaySize[0]}}(o[a.icon.name],u.get("icon-offset").evaluate(a,{},s),u.get("icon-anchor").evaluate(a,{},s)),U=V.sdf,void 0===e.sdfIcons?e.sdfIcons=V.sdf:e.sdfIcons!==V.sdf&&x("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(V.pixelRatio!==e.pixelRatio||0!==u.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var G=xc(d.horizontal)||d.vertical;e.iconsInText=!!G&&G.iconsInText,(G||B)&&function(e,t,n,r,o,a,s,u,c,l,p){var f=a.textMaxSize.evaluate(t,{});void 0===f&&(f=s);var h,d=e.layers[0].layout,m=d.get("icon-offset").evaluate(t,{},p),g=xc(n.horizontal),v=s/24,y=e.tilePixelRatio*v,_=e.tilePixelRatio*f/24,b=e.tilePixelRatio*u,w=e.tilePixelRatio*d.get("symbol-spacing"),S=d.get("text-padding")*e.tilePixelRatio,E=d.get("icon-padding")*e.tilePixelRatio,T=d.get("text-max-angle")/180*Math.PI,k="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),A="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),C=d.get("symbol-placement"),I=w/2,M=d.get("icon-text-fit");r&&"none"!==M&&(e.allowVerticalPlacement&&n.vertical&&(h=Gu(r,n.vertical,M,d.get("icon-text-fit-padding"),m,v)),g&&(r=Gu(r,g,M,d.get("icon-text-fit-padding"),m,v)));var P=function(i,s){s.x<0||s.x>=At||s.y<0||s.y>=At||function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g,v,y,_,b,w,S,E){var T,k,A,C,I,M=e.addToLineVertexArray(t,n),P=0,O=0,L=0,R=0,D=-1,z=-1,N={},j=So(""),F=0,B=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(F=(T=s.layout.get("text-offset").evaluate(b,{},E).map((function(e){return e*Qs})))[0],B=T[1]):(F=s.layout.get("text-radial-offset").evaluate(b,{},E)*Qs,B=mc),e.allowVerticalPlacement&&r.vertical){var U=s.layout.get("text-rotate").evaluate(b,{},E)+90;C=new uc(u,n,t,c,l,p,r.vertical,f,h,d,e.overscaling,U),a&&(I=new uc(u,n,t,c,l,p,a,g,v,d,e.overscaling,U))}if(i){var V=s.layout.get("icon-rotate").evaluate(b,{}),G="none"!==s.layout.get("icon-text-fit"),q=rc(i,V,S,G),Z=a?rc(a,V,S,G):void 0;A=new uc(u,n,t,c,l,p,i,g,v,!1,e.overscaling,V),P=4*q.length;var H=e.iconSizeData,W=null;"source"===H.kind?(W=[Zu*s.layout.get("icon-size").evaluate(b,{})])[0]>_c&&x(e.layerIds[0]+': Value for "icon-size" is >= '+yc+'. Reduce your "icon-size".'):"composite"===H.kind&&((W=[Zu*w.compositeIconSizes[0].evaluate(b,{},E),Zu*w.compositeIconSizes[1].evaluate(b,{},E)])[0]>_c||W[1]>_c)&&x(e.layerIds[0]+': Value for "icon-size" is >= '+yc+'. Reduce your "icon-size".'),e.addSymbols(e.icon,q,W,_,y,b,!1,t,M.lineStartIndex,M.lineLength,-1,E),D=e.icon.placedSymbolArray.length-1,Z&&(O=4*Z.length,e.addSymbols(e.icon,Z,W,_,y,b,Iu.vertical,t,M.lineStartIndex,M.lineLength,-1,E),z=e.icon.placedSymbolArray.length-1)}for(var Y in r.horizontal){var X=r.horizontal[Y];if(!k){j=So(X.text);var K=s.layout.get("text-rotate").evaluate(b,{},E);k=new uc(u,n,t,c,l,p,X,f,h,d,e.overscaling,K)}var J=1===X.positionedLines.length;if(L+=bc(e,t,X,o,s,d,b,m,M,r.vertical?Iu.horizontal:Iu.horizontalOnly,J?Object.keys(r.horizontal):[Y],N,D,w,E),J)break}r.vertical&&(R+=bc(e,t,r.vertical,o,s,d,b,m,M,Iu.vertical,["vertical"],N,z,w,E));var Q=k?k.boxStartIndex:e.collisionBoxArray.length,$=k?k.boxEndIndex:e.collisionBoxArray.length,ee=C?C.boxStartIndex:e.collisionBoxArray.length,te=C?C.boxEndIndex:e.collisionBoxArray.length,ne=A?A.boxStartIndex:e.collisionBoxArray.length,re=A?A.boxEndIndex:e.collisionBoxArray.length,ie=I?I.boxStartIndex:e.collisionBoxArray.length,oe=I?I.boxEndIndex:e.collisionBoxArray.length;e.glyphOffsetArray.length>=Mc.MAX_GLYPHS&&x("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,N.right>=0?N.right:-1,N.center>=0?N.center:-1,N.left>=0?N.left:-1,N.vertical||-1,D,z,j,Q,$,ee,te,ne,re,ie,oe,c,L,R,P,O,0,f,F,B)}(e,s,i,n,r,o,h,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,y,S,k,c,b,E,A,m,t,a,l,p)};if("line"===C)for(var O=0,L=function(e,t,n,r,o){for(var a=[],s=0;s<e.length;s++)for(var u=e[s],c=void 0,l=0;l<u.length-1;l++){var p=u[l],f=u[l+1];p.x<0&&f.x<0||(p.x<0?p=new i(0,p.y+(0-p.x)/(f.x-p.x)*(f.y-p.y))._round():f.x<0&&(f=new i(0,p.y+(0-p.x)/(f.x-p.x)*(f.y-p.y))._round()),p.y<0&&f.y<0||(p.y<0?p=new i(p.x+(0-p.y)/(f.y-p.y)*(f.x-p.x),0)._round():f.y<0&&(f=new i(p.x+(0-p.y)/(f.y-p.y)*(f.x-p.x),0)._round()),p.x>=r&&f.x>=r||(p.x>=r?p=new i(r,p.y+(r-p.x)/(f.x-p.x)*(f.y-p.y))._round():f.x>=r&&(f=new i(r,p.y+(r-p.x)/(f.x-p.x)*(f.y-p.y))._round()),p.y>=o&&f.y>=o||(p.y>=o?p=new i(p.x+(o-p.y)/(f.y-p.y)*(f.x-p.x),o)._round():f.y>=o&&(f=new i(p.x+(o-p.y)/(f.y-p.y)*(f.x-p.x),o)._round()),c&&p.equals(c[c.length-1])||a.push(c=[p]),c.push(f)))))}return a}(t.geometry,0,0,At,At);O<L.length;O+=1)for(var R=L[O],D=0,z=tc(R,w,T,n.vertical||g,r,24,_,e.overscaling,At);D<z.length;D+=1){var N=z[D];g&&wc(e,g.text,I,N)||P(R,N)}else if("line-center"===C)for(var j=0,F=t.geometry;j<F.length;j+=1){var B=F[j];if(B.length>1){var U=ec(B,T,n.vertical||g,r,24,_);U&&P(B,U)}}else if("Polygon"===t.type)for(var V=0,G=us(t.geometry,0);V<G.length;V+=1){var q=G[V],Z=pc(q,16);P(q[0],new qu(Z.x,Z.y,0))}else if("LineString"===t.type)for(var H=0,W=t.geometry;H<W.length;H+=1){var Y=W[H];P(Y,new qu(Y[0].x,Y[0].y,0))}else if("Point"===t.type)for(var X=0,K=t.geometry;X<K.length;X+=1)for(var J=0,Q=K[X];J<Q.length;J+=1){var $=Q[J];P([$],new qu($.x,$.y,0))}}(e,a,d,B,r,l,f,h,S,U,s)},b=0,w=e.features;b<w.length;b+=1)_();a&&e.generateCollisionDebugBuffers()},e.perspective=function(e,t,n,r,i){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+r)*(o=1/(r-i)),e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e},e.pick=function(e,t){for(var n={},r=0;r<t.length;r++){var i=t[r];i in e&&(n[i]=e[i])}return n},e.plugin=vi,e.polygonIntersectsPolygon=Qo,e.postMapLoadEvent=ie,e.postTurnstileEvent=ne,e.potpack=Eu,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Xr,e.registerForPluginStateChange=function(e){return e({pluginStatus:li,pluginURL:pi}),di.on("pluginStateChange",e),e},e.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=r*-s+o*u,e[3]=i*-s+a*u,e},e.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],p=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+p*r,e[7]=u*i+f*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=p*i-s*r,e[11]=f*i-u*r,e},e.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],p=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+p*r,e[3]=u*i+f*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=p*i-s*r,e[7]=f*i-u*r,e},e.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$1=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},e.scale$2=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},e.setCacheLimits=function(e,t){ae=e,se=t},e.setRTLTextPlugin=function(e,t,n){if(void 0===n&&(n=!1),"deferred"===li||"loading"===li||"loaded"===li)throw new Error("setRTLTextPlugin cannot be called multiple times.");pi=z.resolveURL(e),li="deferred",ci=t,hi(),n||gi()},e.sphericalToCartesian=function(e){var t=e[0],n=e[1],r=e[2];return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:t*Math.cos(n)*Math.sin(r),y:t*Math.sin(n)*Math.sin(r),z:t*Math.cos(r)}},e.sqrLen=function(e){var t=e[0],n=e[1];return t*t+n*n},e.styleSpec=Ce,e.sub=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},e.symbolSize=Xu,e.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},e.transformMat4=ga,e.translate=function(e,t,n){var r,i,o,a,s,u,c,l,p,f,h,d,m=n[0],g=n[1],v=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],p=t[8],f=t[9],h=t[10],d=t[11],e[0]=r=t[0],e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=p,e[9]=f,e[10]=h,e[11]=d,e[12]=r*m+s*g+p*v+t[12],e[13]=i*m+u*g+f*v+t[13],e[14]=o*m+c*g+h*v+t[14],e[15]=a*m+l*g+d*v+t[15]),e},e.triggerPluginCompletionEvent=fi,e.uniqueId=f,e.validateCustomStyleLayer=function(e){var t=[],n=e.id;return void 0===n&&t.push({message:"layers."+n+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+n+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+n+': property "renderingMode" must be either "2d" or "3d"'}),t},e.validateLight=Fr,e.validateStyle=jr,e.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},e.vectorTile=Ts,e.version="1.9.1",e.warnOnce=x,e.webpSupported=j,e.window=self,e.wrap=c})),r(["./shared"],(function(e){function t(e){var n=typeof e;if("number"===n||"boolean"===n||"string"===n||null==e)return JSON.stringify(e);if(Array.isArray(e)){for(var r="[",i=0,o=e;i<o.length;i+=1)r+=t(o[i])+",";return r+"]"}for(var a=Object.keys(e).sort(),s="{",u=0;u<a.length;u++)s+=JSON.stringify(a[u])+":"+t(e[a[u]])+",";return s+"}"}function n(n){for(var r="",i=0,o=e.refProperties;i<o.length;i+=1)r+="/"+t(n[o[i]]);return r}var r=function(e){this.keyCache={},e&&this.replace(e)};r.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},r.prototype.update=function(t,r){for(var i=this,o=0,a=t;o<a.length;o+=1){var s=a[o];this._layerConfigs[s.id]=s;var u=this._layers[s.id]=e.createStyleLayer(s);u._featureFilter=e.featureFilter(u.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0,l=r;c<l.length;c+=1){var p=l[c];delete this.keyCache[p],delete this._layerConfigs[p],delete this._layers[p]}this.familiesBySource={};for(var f=0,h=function(e,t){for(var r={},i=0;i<e.length;i++){var o=t&&t[e[i].id]||n(e[i]);t&&(t[e[i].id]=o);var a=r[o];a||(a=r[o]=[]),a.push(e[i])}var s=[];for(var u in r)s.push(r[u]);return s}(e.values(this._layerConfigs),this.keyCache);f<h.length;f+=1){var d=h[f].map((function(e){return i._layers[e.id]})),m=d[0];if("none"!==m.visibility){var g=m.source||"",v=this.familiesBySource[g];v||(v=this.familiesBySource[g]={});var y=m.sourceLayer||"_geojsonTileLayer",_=v[y];_||(_=v[y]=[]),_.push(d)}}};var i=function(t){var n={},r=[];for(var i in t){var o=t[i],a=n[i]={};for(var s in o){var u=o[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};r.push(c),a[s]={rect:c,metrics:u.metrics}}}}var l=e.potpack(r),p=new e.AlphaImage({width:l.w||1,height:l.h||1});for(var f in t){var h=t[f];for(var d in h){var m=h[+d];if(m&&0!==m.bitmap.width&&0!==m.bitmap.height){var g=n[f][d].rect;e.AlphaImage.copy(m.bitmap,p,{x:0,y:0},{x:g.x+1,y:g.y+1},m.bitmap)}}}this.image=p,this.positions=n};e.register("GlyphAtlas",i);var o=function(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId};function a(t,n,r){for(var i=new e.EvaluationParameters(n),o=0,a=t;o<a.length;o+=1)a[o].recalculate(i,r)}function s(t,n){var r=e.getArrayBuffer(t.request,(function(t,r,i,o){t?n(t):r&&n(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(r)),rawData:r,cacheControl:i,expires:o})}));return function(){r.cancel(),n()}}o.prototype.parse=function(t,n,r,o,s){var u=this;this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;var c=new e.DictionaryCoder(Object.keys(t.layers).sort()),l=new e.FeatureIndex(this.tileID,this.promoteId);l.bucketLayerIDs=[];var p,f,h,d,m={},g={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:r},v=n.familiesBySource[this.source];for(var y in v){var _=t.layers[y];if(_){1===_.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+y+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var b=c.encode(y),x=[],w=0;w<_.length;w++){var S=_.feature(w),E=l.getId(S,y);x.push({feature:S,id:E,index:w,sourceLayerIndex:b})}for(var T=0,k=v[y];T<k.length;T+=1){var A=k[T],C=A[0];C.minzoom&&this.zoom<Math.floor(C.minzoom)||C.maxzoom&&this.zoom>=C.maxzoom||"none"!==C.visibility&&(a(A,this.zoom,r),(m[C.id]=C.createBucket({index:l.bucketLayerIDs.length,layers:A,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:b,sourceID:this.source})).populate(x,g,this.tileID.canonical),l.bucketLayerIDs.push(A.map((function(e){return e.id}))))}}}var I=e.mapObject(g.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));Object.keys(I).length?o.send("getGlyphs",{uid:this.uid,stacks:I},(function(e,t){p||(p=e,f=t,O.call(u))})):f={};var M=Object.keys(g.iconDependencies);M.length?o.send("getImages",{icons:M,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){p||(p=e,h=t,O.call(u))})):h={};var P=Object.keys(g.patternDependencies);function O(){if(p)return s(p);if(f&&h&&d){var t=new i(f),n=new e.ImageAtlas(h,d);for(var o in m){var u=m[o];u instanceof e.SymbolBucket?(a(u.layers,this.zoom,r),e.performSymbolLayout(u,f,t.positions,h,n.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):u.hasPattern&&(u instanceof e.LineBucket||u instanceof e.FillBucket||u instanceof e.FillExtrusionBucket)&&(a(u.layers,this.zoom,r),u.addFeatures(g,this.tileID.canonical,n.patternPositions))}this.status="done",s(null,{buckets:e.values(m).filter((function(e){return!e.isEmpty()})),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,imageAtlas:n,glyphMap:this.returnDependencies?f:null,iconMap:this.returnDependencies?h:null,glyphPositions:this.returnDependencies?t.positions:null})}}P.length?o.send("getImages",{icons:P,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){p||(p=e,d=t,O.call(u))})):d={},O.call(this)};var u=function(e,t,n,r){this.actor=e,this.layerIndex=t,this.availableImages=n,this.loadVectorData=r||s,this.loading={},this.loaded={}};u.prototype.loadTile=function(t,n){var r=this,i=t.uid;this.loading||(this.loading={});var a=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.RequestPerformance(t.request),s=this.loading[i]=new o(t);s.abort=this.loadVectorData(t,(function(t,o){if(delete r.loading[i],t||!o)return s.status="done",r.loaded[i]=s,n(t);var u=o.rawData,c={};o.expires&&(c.expires=o.expires),o.cacheControl&&(c.cacheControl=o.cacheControl);var l={};if(a){var p=a.finish();p&&(l.resourceTiming=JSON.parse(JSON.stringify(p)))}s.vectorTile=o.vectorTile,s.parse(o.vectorTile,r.layerIndex,r.availableImages,r.actor,(function(t,r){if(t||!r)return n(t);n(null,e.extend({rawTileData:u.slice(0)},r,c,l))})),r.loaded=r.loaded||{},r.loaded[i]=s}))},u.prototype.reloadTile=function(e,t){var n=this,r=this.loaded,i=e.uid,o=this;if(r&&r[i]){var a=r[i];a.showCollisionBoxes=e.showCollisionBoxes;var s=function(e,r){var i=a.reloadCallback;i&&(delete a.reloadCallback,a.parse(a.vectorTile,o.layerIndex,n.availableImages,o.actor,i)),t(e,r)};"parsing"===a.status?a.reloadCallback=s:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}},u.prototype.abortTile=function(e,t){var n=this.loading,r=e.uid;n&&n[r]&&n[r].abort&&(n[r].abort(),delete n[r]),t()},u.prototype.removeTile=function(e,t){var n=this.loaded,r=e.uid;n&&n[r]&&delete n[r],t()};var c=e.window.ImageBitmap,l=function(){this.loaded={}};l.prototype.loadTile=function(t,n){var r=t.uid,i=t.encoding,o=t.rawImageData,a=c&&o instanceof c?this.getImageData(o):o,s=new e.DEMData(r,a,i);this.loaded=this.loaded||{},this.loaded[r]=s,n(null,s)},l.prototype.getImageData=function(t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);var n=this.offscreenCanvasContext.getImageData(-1,-1,t.width+2,t.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:n.width,height:n.height},n.data)},l.prototype.removeTile=function(e){var t=this.loaded,n=e.uid;t&&t[n]&&delete t[n]};var p={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function f(e){var t=0;if(e&&e.length>0){t+=Math.abs(h(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(h(e[n]))}return t}function h(e){var t,n,r,i,o,a,s=0,u=e.length;if(u>2){for(a=0;a<u;a++)a===u-2?(r=u-2,i=u-1,o=0):a===u-1?(r=u-1,i=0,o=1):(r=a,i=a+1,o=a+2),t=e[r],n=e[i],s+=(d(e[o][0])-d(t[0]))*Math.sin(d(n[1]));s=s*p.RADIUS*p.RADIUS/2}return s}function d(e){return e*Math.PI/180}var m={geometry:function e(t){var n,r=0;switch(t.type){case"Polygon":return f(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)r+=f(t.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<t.geometries.length;n++)r+=e(t.geometries[n]);return r}},ring:h};function g(e,t){return function(n){return e(n,t)}}function v(e,t){e[0]=y(e[0],t=!!t);for(var n=1;n<e.length;n++)e[n]=y(e[n],!t);return e}function y(e,t){return function(e){return m.ring(e)>=0}(e)===t?e:e.reverse()}var _=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,b=function(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))};b.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],n=0,r=this._feature.geometry;n<r.length;n+=1){var i=r[n];t.push([new e.Point$1(i[0],i[1])])}return t}for(var o=[],a=0,s=this._feature.geometry;a<s.length;a+=1){for(var u=[],c=0,l=s[a];c<l.length;c+=1){var p=l[c];u.push(new e.Point$1(p[0],p[1]))}o.push(u)}return o},b.prototype.toGeoJSON=function(e,t,n){return _.call(this,e,t,n)};var x=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t};x.prototype.feature=function(e){return new b(this._features[e])};var w=e.vectorTile.VectorTileFeature,S=E;function E(e,t){this.options=t||{},this.features=e,this.length=e.length}function T(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}E.prototype.feature=function(e){return new T(this.features[e],this.options.extent)},T.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var n=0;n<t.length;n++){for(var r=t[n],i=[],o=0;o<r.length;o++)i.push(new e.Point$1(r[o][0],r[o][1]));this.geometry.push(i)}return this.geometry},T.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,n=-1/0,r=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var u=a[s];t=Math.min(t,u.x),n=Math.max(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.y)}return[t,r,n,i]},T.prototype.toGeoJSON=w.prototype.toGeoJSON;var k=C,A=S;function C(t){var n=new e.pbf;return function(e,t){for(var n in e.layers)t.writeMessage(3,I,e.layers[n])}(t,n),n.finish()}function I(e,t){var n;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<e.length;n++)r.feature=e.feature(n),t.writeMessage(2,M,r);var i=r.keys;for(n=0;n<i.length;n++)t.writeStringField(3,i[n]);var o=r.values;for(n=0;n<o.length;n++)t.writeMessage(4,D,o[n])}function M(e,t){var n=e.feature;void 0!==n.id&&t.writeVarintField(1,n.id),t.writeMessage(2,P,e),t.writeVarintField(3,n.type),t.writeMessage(4,R,n)}function P(e,t){var n=e.feature,r=e.keys,i=e.values,o=e.keycache,a=e.valuecache;for(var s in n.properties){var u=o[s];void 0===u&&(r.push(s),o[s]=u=r.length-1),t.writeVarint(u);var c=n.properties[s],l=typeof c;"string"!==l&&"boolean"!==l&&"number"!==l&&(c=JSON.stringify(c));var p=l+":"+c,f=a[p];void 0===f&&(i.push(c),a[p]=f=i.length-1),t.writeVarint(f)}}function O(e,t){return(t<<3)+(7&e)}function L(e){return e<<1^e>>31}function R(e,t){for(var n=e.loadGeometry(),r=e.type,i=0,o=0,a=n.length,s=0;s<a;s++){var u=n[s],c=1;1===r&&(c=u.length),t.writeVarint(O(1,c));for(var l=3===r?u.length-1:u.length,p=0;p<l;p++){1===p&&1!==r&&t.writeVarint(O(2,l-1));var f=u[p].x-i,h=u[p].y-o;t.writeVarint(L(f)),t.writeVarint(L(h)),i+=f,o+=h}3===r&&t.writeVarint(O(7,1))}}function D(e,t){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(7,e):"number"===n&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function z(e,t,n,r){N(e,n,r),N(t,2*n,2*r),N(t,2*n+1,2*r+1)}function N(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function j(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}k.fromVectorTileJs=C,k.fromGeojsonVt=function(e,t){t=t||{};var n={};for(var r in e)n[r]=new S(e[r].features,t),n[r].name=r,n[r].version=t.version,n[r].extent=t.extent;return C({layers:n})},k.GeoJSONWrapper=A;var F=function(e){return e[0]},B=function(e){return e[1]},U=function(e,t,n,r,i){void 0===t&&(t=F),void 0===n&&(n=B),void 0===r&&(r=64),void 0===i&&(i=Float64Array),this.nodeSize=r,this.points=e;for(var o=e.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(e.length),s=this.coords=new i(2*e.length),u=0;u<e.length;u++)a[u]=u,s[2*u]=t(e[u]),s[2*u+1]=n(e[u]);!function e(t,n,r,i,o,a){if(!(o-i<=r)){var s=i+o>>1;!function e(t,n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),p=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);e(t,n,r,Math.max(i,Math.floor(r-u*l/s+p)),Math.min(o,Math.floor(r+(s-u)*l/s+p)),a)}var f=n[2*r+a],h=i,d=o;for(z(t,n,i,r),n[2*o+a]>f&&z(t,n,i,o);h<d;){for(z(t,n,h,d),h++,d--;n[2*h+a]<f;)h++;for(;n[2*d+a]>f;)d--}n[2*i+a]===f?z(t,n,i,d):z(t,n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,n,s,i,o,a%2),e(t,n,r,i,s-1,a+1),e(t,n,r,s+1,o,a+1)}}(a,s,r,0,a.length-1,0)};U.prototype.range=function(e,t,n,r){return function(e,t,n,r,i,o,a){for(var s,u,c=[0,e.length-1,0],l=[];c.length;){var p=c.pop(),f=c.pop(),h=c.pop();if(f-h<=a)for(var d=h;d<=f;d++)u=t[2*d+1],(s=t[2*d])>=n&&s<=i&&u>=r&&u<=o&&l.push(e[d]);else{var m=Math.floor((h+f)/2);u=t[2*m+1],(s=t[2*m])>=n&&s<=i&&u>=r&&u<=o&&l.push(e[m]);var g=(p+1)%2;(0===p?n<=s:r<=u)&&(c.push(h),c.push(m-1),c.push(g)),(0===p?i>=s:o>=u)&&(c.push(m+1),c.push(f),c.push(g))}}return l}(this.ids,this.coords,e,t,n,r,this.nodeSize)},U.prototype.within=function(e,t,n){return function(e,t,n,r,i,o){for(var a=[0,e.length-1,0],s=[],u=i*i;a.length;){var c=a.pop(),l=a.pop(),p=a.pop();if(l-p<=o)for(var f=p;f<=l;f++)j(t[2*f],t[2*f+1],n,r)<=u&&s.push(e[f]);else{var h=Math.floor((p+l)/2),d=t[2*h],m=t[2*h+1];j(d,m,n,r)<=u&&s.push(e[h]);var g=(c+1)%2;(0===c?n-i<=d:r-i<=m)&&(a.push(p),a.push(h-1),a.push(g)),(0===c?n+i>=d:r+i>=m)&&(a.push(h+1),a.push(l),a.push(g))}}return s}(this.ids,this.coords,e,t,n,this.nodeSize)};var V={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},G=function(e){this.options=K(Object.create(V),e),this.trees=new Array(this.options.maxZoom+1)};function q(e,t,n,r,i){return{x:e,y:t,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function Z(e,t){var n=e.geometry.coordinates,r=n[1];return{x:Y(n[0]),y:X(r),zoom:1/0,index:t,parentId:-1}}function H(e){return{type:"Feature",id:e.id,properties:W(e),geometry:{type:"Point",coordinates:[(r=e.x,360*(r-.5)),(t=e.y,n=(180-360*t)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var t,n,r}function W(e){var t=e.numPoints,n=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return K(K({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:n})}function Y(e){return e/360+.5}function X(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function K(e,t){for(var n in t)e[n]=t[n];return e}function J(e){return e.x}function Q(e){return e.y}function $(e,t,n,r,i,o){var a=i-n,s=o-r;if(0!==a||0!==s){var u=((e-n)*a+(t-r)*s)/(a*a+s*s);u>1?(n=i,r=o):u>0&&(n+=a*u,r+=s*u)}return(a=e-n)*a+(s=t-r)*s}function ee(e,t,n,r){var i={id:void 0===e?null:e,type:t,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,n=e.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)te(e,t);else if("Polygon"===n||"MultiLineString"===n)for(var r=0;r<t.length;r++)te(e,t[r]);else if("MultiPolygon"===n)for(r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++)te(e,t[r][i])}(i),i}function te(e,t){for(var n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function ne(e,t,n,r){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=t.id;if(n.promoteId?u=t.properties[n.promoteId]:n.generateId&&(u=r||0),"Point"===o)re(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)re(i[c],s);else if("LineString"===o)ie(i,s,a,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<i.length;c++)ie(i[c],s=[],a,!1),e.push(ee(u,"LineString",s,t.properties));return}oe(i,s,a,!1)}else if("Polygon"===o)oe(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<t.geometry.geometries.length;c++)ne(e,{id:u,geometry:t.geometry.geometries[c],properties:t.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];oe(i[c],l,a,!0),s.push(l)}}e.push(ee(u,o,s,t.properties))}}function re(e,t){t.push(ae(e[0])),t.push(se(e[1])),t.push(0)}function ie(e,t,n,r){for(var i,o,a=0,s=0;s<e.length;s++){var u=ae(e[s][0]),c=se(e[s][1]);t.push(u),t.push(c),t.push(0),s>0&&(a+=r?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=t.length-3;t[2]=1,function e(t,n,r,i){for(var o,a=i,s=r-n>>1,u=r-n,c=t[n],l=t[n+1],p=t[r],f=t[r+1],h=n+3;h<r;h+=3){var d=$(t[h],t[h+1],c,l,p,f);if(d>a)o=h,a=d;else if(d===a){var m=Math.abs(h-s);m<u&&(o=h,u=m)}}a>i&&(o-n>3&&e(t,n,o,i),t[o+2]=a,r-o>3&&e(t,o,r,i))}(t,0,l,n),t[l+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function oe(e,t,n,r){for(var i=0;i<e.length;i++){var o=[];ie(e[i],o,n,r),t.push(o)}}function ae(e){return e/360+.5}function se(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function ue(e,t,n,r,i,o,a,s){if(r/=t,o>=(n/=t)&&a<r)return e;if(a<n||o>=r)return null;for(var u=[],c=0;c<e.length;c++){var l=e[c],p=l.geometry,f=l.type,h=0===i?l.minX:l.minY,d=0===i?l.maxX:l.maxY;if(h>=n&&d<r)u.push(l);else if(!(d<n||h>=r)){var m=[];if("Point"===f||"MultiPoint"===f)ce(p,m,n,r,i);else if("LineString"===f)le(p,m,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===f)fe(p,m,n,r,i,!1);else if("Polygon"===f)fe(p,m,n,r,i,!0);else if("MultiPolygon"===f)for(var g=0;g<p.length;g++){var v=[];fe(p[g],v,n,r,i,!0),v.length&&m.push(v)}if(m.length){if(s.lineMetrics&&"LineString"===f){for(g=0;g<m.length;g++)u.push(ee(l.id,f,m[g],l.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===m.length?(f="LineString",m=m[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===m.length?"Point":"MultiPoint"),u.push(ee(l.id,f,m,l.tags))}}}return u.length?u:null}function ce(e,t,n,r,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];a>=n&&a<=r&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function le(e,t,n,r,i,o,a){for(var s,u,c=pe(e),l=0===i?de:me,p=e.start,f=0;f<e.length-3;f+=3){var h=e[f],d=e[f+1],m=e[f+2],g=e[f+3],v=e[f+4],y=0===i?h:d,_=0===i?g:v,b=!1;a&&(s=Math.sqrt(Math.pow(h-g,2)+Math.pow(d-v,2))),y<n?_>n&&(u=l(c,h,d,g,v,n),a&&(c.start=p+s*u)):y>r?_<r&&(u=l(c,h,d,g,v,r),a&&(c.start=p+s*u)):he(c,h,d,m),_<n&&y>=n&&(u=l(c,h,d,g,v,n),b=!0),_>r&&y<=r&&(u=l(c,h,d,g,v,r),b=!0),!o&&b&&(a&&(c.end=p+s*u),t.push(c),c=pe(e)),a&&(p+=s)}var x=e.length-3;h=e[x],d=e[x+1],m=e[x+2],(y=0===i?h:d)>=n&&y<=r&&he(c,h,d,m),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&he(c,c[0],c[1],c[2]),c.length&&t.push(c)}function pe(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function fe(e,t,n,r,i,o){for(var a=0;a<e.length;a++)le(e[a],t,n,r,i,o,!1)}function he(e,t,n,r){e.push(t),e.push(n),e.push(r)}function de(e,t,n,r,i,o){var a=(o-t)/(r-t);return e.push(o),e.push(n+(i-n)*a),e.push(1),a}function me(e,t,n,r,i,o){var a=(o-n)/(i-n);return e.push(t+(r-t)*a),e.push(o),e.push(1),a}function ge(e,t){for(var n=[],r=0;r<e.length;r++){var i,o=e[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=ve(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(ve(o.geometry[s],t))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(ve(o.geometry[s][c],t));i.push(u)}n.push(ee(o.id,a,i,o.tags))}return n}function ve(e,t){var n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(var r=0;r<e.length;r+=3)n.push(e[r]+t,e[r+1],e[r+2]);return n}function ye(e,t){if(e.transformed)return e;var n,r,i,o=1<<e.z,a=e.x,s=e.y;for(n=0;n<e.features.length;n++){var u=e.features[n],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(r=0;r<c.length;r+=2)u.geometry.push(_e(c[r],c[r+1],t,o,a,s));else for(r=0;r<c.length;r++){var p=[];for(i=0;i<c[r].length;i+=2)p.push(_e(c[r][i],c[r][i+1],t,o,a,s));u.geometry.push(p)}}return e.transformed=!0,e}function _e(e,t,n,r,i,o){return[Math.round(n*(e*r-i)),Math.round(n*(t*r-o))]}function be(e,t,n,r,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,xe(a,e[s],o,i);var u=e[s].minX,c=e[s].minY,l=e[s].maxX,p=e[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),p>a.maxY&&(a.maxY=p)}return a}function xe(e,t,n,r){var i=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)we(a,i,e,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)we(a,i[s],e,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)we(a,c[s],e,n,!0,0===s)}if(a.length){var l=t.tags||null;if("LineString"===o&&r.lineMetrics){for(var p in l={},t.tags)l[p]=t.tags[p];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==t.id&&(f.id=t.id),e.features.push(f)}}function we(e,t,n,r,i,o){var a=r*r;if(r>0&&t.size<(i?a:r))n.numPoints+=t.length/3;else{for(var s=[],u=0;u<t.length;u+=3)(0===r||t[u+2]>a)&&(n.numSimplified++,s.push(t[u]),s.push(t[u+1])),n.numPoints++;i&&function(e,t){for(var n=0,r=0,i=e.length,o=i-2;r<i;o=r,r+=2)n+=(e[r]-e[o])*(e[r+1]+e[o+1]);if(n>0===t)for(r=0,i=e.length;r<i/2;r+=2){var a=e[r],s=e[r+1];e[r]=e[i-2-r],e[r+1]=e[i-1-r],e[i-2-r]=a,e[i-1-r]=s}}(s,o),e.push(s)}}function Se(e,t){var n=(t=this.options=function(e,t){for(var n in t)e[n]=t[n];return e}(Object.create(this.options),t)).debug;if(n&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(e,t){var n=[];if("FeatureCollection"===e.type)for(var r=0;r<e.features.length;r++)ne(n,e.features[r],t,r);else ne(n,"Feature"===e.type?e:{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=function(e,t){var n=t.buffer/t.extent,r=e,i=ue(e,1,-1-n,n,0,-1,2,t),o=ue(e,1,1-n,2+n,0,-1,2,t);return(i||o)&&(r=ue(e,1,-n,1+n,0,-1,2,t)||[],i&&(r=ge(i,1).concat(r)),o&&(r=r.concat(ge(o,-1)))),r}(r,t)).length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ee(e,t,n){return 32*((1<<e)*n+t)+e}function Te(e,t){var n=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return t(null,null);var i=new x(r.features),o=k(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),t(null,{vectorTile:i,rawData:o.buffer})}G.prototype.load=function(e){var t=this.options,n=t.log,r=t.minZoom,i=t.maxZoom,o=t.nodeSize;n&&console.time("total time");var a="prepare "+e.length+" points";n&&console.time(a),this.points=e;for(var s=[],u=0;u<e.length;u++)e[u].geometry&&s.push(Z(e[u],u));this.trees[i+1]=new U(s,J,Q,o,Float32Array),n&&console.timeEnd(a);for(var c=i;c>=r;c--){var l=+Date.now();s=this._cluster(s,c),this.trees[c]=new U(s,J,Q,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",c,s.length,+Date.now()-l)}return n&&console.timeEnd("total time"),this},G.prototype.getClusters=function(e,t){var n=((e[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],t),s=this.getClusters([-180,r,i,o],t);return a.concat(s)}for(var u=this.trees[this._limitZoom(t)],c=[],l=0,p=u.range(Y(n),X(o),Y(i),X(r));l<p.length;l+=1){var f=u.points[p[l]];c.push(f.numPoints?H(f):this.points[f.index])}return c},G.prototype.getChildren=function(e){var t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[t];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],u=0,c=i.within(o.x,o.y,a);u<c.length;u+=1){var l=i.points[c[u]];l.parentId===e&&s.push(l.numPoints?H(l):this.points[l.index])}if(0===s.length)throw new Error(r);return s},G.prototype.getLeaves=function(e,t,n){var r=[];return this._appendLeaves(r,e,t=t||10,n=n||0,0),r},G.prototype.getTile=function(e,t,n){var r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),o=this.options,a=o.radius/o.extent,s=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((t-a)/i,s,(t+1+a)/i,u),r.points,t,n,i,c),0===t&&this._addTileFeatures(r.range(1-a/i,s,1,u),r.points,i,n,i,c),t===i-1&&this._addTileFeatures(r.range(0,s,a/i,u),r.points,-1,n,i,c),c.features.length?c:null},G.prototype.getClusterExpansionZoom=function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t},G.prototype._appendLeaves=function(e,t,n,r,i){for(var o=0,a=this.getChildren(t);o<a.length;o+=1){var s=a[o],u=s.properties;if(u&&u.cluster?i+u.point_count<=r?i+=u.point_count:i=this._appendLeaves(e,u.cluster_id,n,r,i):i<r?i++:e.push(s),e.length===n)break}return i},G.prototype._addTileFeatures=function(e,t,n,r,i,o){for(var a=0,s=e;a<s.length;a+=1){var u=t[s[a]],c=u.numPoints,l={type:1,geometry:[[Math.round(this.options.extent*(u.x*i-n)),Math.round(this.options.extent*(u.y*i-r))]],tags:c?W(u):this.points[u.index].properties},p=void 0;c?p=u.id:this.options.generateId?p=u.index:this.points[u.index].id&&(p=this.points[u.index].id),void 0!==p&&(l.id=p),o.features.push(l)}},G.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(e,this.options.maxZoom+1))},G.prototype._cluster=function(e,t){for(var n=[],r=this.options,i=r.reduce,o=r.radius/(r.extent*Math.pow(2,t)),a=0;a<e.length;a++){var s=e[a];if(!(s.zoom<=t)){s.zoom=t;for(var u=this.trees[t+1],c=u.within(s.x,s.y,o),l=s.numPoints||1,p=s.x*l,f=s.y*l,h=i&&l>1?this._map(s,!0):null,d=(a<<5)+(t+1)+this.points.length,m=0,g=c;m<g.length;m+=1){var v=u.points[g[m]];if(!(v.zoom<=t)){v.zoom=t;var y=v.numPoints||1;p+=v.x*y,f+=v.y*y,l+=y,v.parentId=d,i&&(h||(h=this._map(s,!0)),i(h,this._map(v)))}}1===l?n.push(s):(s.parentId=d,n.push(q(p/l,f/l,d,l,h)))}}return n},G.prototype._getOriginId=function(e){return e-this.points.length>>5},G.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},G.prototype._map=function(e,t){if(e.numPoints)return t?K({},e.properties):e.properties;var n=this.points[e.index].properties,r=this.options.map(n);return t&&r===n?K({},r):r},Se.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Se.prototype.splitTile=function(e,t,n,r,i,o,a){for(var s=[e,t,n,r],u=this.options,c=u.debug;s.length;){r=s.pop(),n=s.pop(),t=s.pop(),e=s.pop();var l=1<<t,p=Ee(t,n,r),f=this.tiles[p];if(!f&&(c>1&&console.time("creation"),f=this.tiles[p]=be(e,t,n,r,u),this.tileCoords.push({z:t,x:n,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,n,r,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var h="z"+t;this.stats[h]=(this.stats[h]||0)+1,this.total++}if(f.source=e,i){if(t===u.maxZoom||t===i)continue;var d=1<<i-t;if(n!==Math.floor(o/d)||r!==Math.floor(a/d))continue}else if(t===u.indexMaxZoom||f.numPoints<=u.indexMaxPoints)continue;if(f.source=null,0!==e.length){c>1&&console.time("clipping");var m,g,v,y,_,b,x=.5*u.buffer/u.extent,w=.5-x,S=.5+x,E=1+x;m=g=v=y=null,_=ue(e,l,n-x,n+S,0,f.minX,f.maxX,u),b=ue(e,l,n+w,n+E,0,f.minX,f.maxX,u),e=null,_&&(m=ue(_,l,r-x,r+S,1,f.minY,f.maxY,u),g=ue(_,l,r+w,r+E,1,f.minY,f.maxY,u),_=null),b&&(v=ue(b,l,r-x,r+S,1,f.minY,f.maxY,u),y=ue(b,l,r+w,r+E,1,f.minY,f.maxY,u),b=null),c>1&&console.timeEnd("clipping"),s.push(m||[],t+1,2*n,2*r),s.push(g||[],t+1,2*n,2*r+1),s.push(v||[],t+1,2*n+1,2*r),s.push(y||[],t+1,2*n+1,2*r+1)}}},Se.prototype.getTile=function(e,t,n){var r=this.options,i=r.extent,o=r.debug;if(e<0||e>24)return null;var a=1<<e,s=Ee(e,t=(t%a+a)%a,n);if(this.tiles[s])return ye(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,n);for(var u,c=e,l=t,p=n;!u&&c>0;)c--,l=Math.floor(l/2),p=Math.floor(p/2),u=this.tiles[Ee(c,l,p)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,p),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,p,e,t,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?ye(this.tiles[s],i):null):null};var ke=function(t){function n(e,n,r,i){t.call(this,e,n,r,Te),i&&(this.loadGeoJSON=i)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.loadData=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=t,this._pendingLoadDataParams=e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},n.prototype._loadData=function(){var t=this;if(this._pendingCallback&&this._pendingLoadDataParams){var n=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var i=!!(r&&r.request&&r.request.collectResourceTiming)&&new e.RequestPerformance(r.request);this.loadGeoJSON(r,(function(o,a){if(o||!a)return n(o);if("object"!=typeof a)return n(new Error("Input data given to '"+r.source+"' is not a valid GeoJSON object."));!function e(t,n){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(g(e,n)),t;case"GeometryCollection":return t.geometries=t.geometries.map(g(e,n)),t;case"Feature":return t.geometry=e(t.geometry,n),t;case"Polygon":case"MultiPolygon":return function(e,t){return"Polygon"===e.type?e.coordinates=v(e.coordinates,t):"MultiPolygon"===e.type&&(e.coordinates=e.coordinates.map(g(v,t))),e}(t,n);default:return t}}(a,!0);try{t._geoJSONIndex=r.cluster?new G(function(t){var n=t.superclusterOptions,r=t.clusterProperties;if(!r||!n)return n;for(var i={},o={},a={accumulated:null,zoom:0},s={properties:null},u=Object.keys(r),c=0,l=u;c<l.length;c+=1){var p=l[c],f=r[p],h=f[0],d=e.createExpression(f[1]),m=e.createExpression("string"==typeof h?[h,["accumulated"],["get",p]]:h);i[p]=d.value,o[p]=m.value}return n.map=function(e){s.properties=e;for(var t={},n=0,r=u;n<r.length;n+=1){var o=r[n];t[o]=i[o].evaluate(a,s)}return t},n.reduce=function(e,t){s.properties=t;for(var n=0,r=u;n<r.length;n+=1){var i=r[n];a.accumulated=e[i],e[i]=o[i].evaluate(a,s)}},n}(r)).load(a.features):function(e,t){return new Se(e,t)}(a,r.geojsonVtOptions)}catch(o){return n(o)}t.loaded={};var s={};if(i){var u=i.finish();u&&(s.resourceTiming={},s.resourceTiming[r.source]=JSON.parse(JSON.stringify(u)))}n(null,s)}))}},n.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},n.prototype.reloadTile=function(e,n){var r=this.loaded;return r&&r[e.uid]?t.prototype.reloadTile.call(this,e,n):this.loadTile(e,n)},n.prototype.loadGeoJSON=function(t,n){if(t.request)e.getJSON(t.request,n);else{if("string"!=typeof t.data)return n(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."));try{return n(null,JSON.parse(t.data))}catch(e){return n(new Error("Input data given to '"+t.source+"' is not a valid GeoJSON object."))}}},n.prototype.removeSource=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()},n.prototype.getClusterExpansionZoom=function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}},n.prototype.getClusterChildren=function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}},n.prototype.getClusterLeaves=function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}},n}(u),Ae=function(t){var n=this;this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:u,geojson:ke},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(n.workerSourceTypes[e])throw new Error('Worker source with name "'+e+'" already registered.');n.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}};return Ae.prototype.setReferrer=function(e,t){this.referrer=t},Ae.prototype.setImages=function(e,t,n){this.availableImages[e]=t,n()},Ae.prototype.setLayers=function(e,t,n){this.getLayerIndex(e).replace(t),n()},Ae.prototype.updateLayers=function(e,t,n){this.getLayerIndex(e).update(t.layers,t.removedIds),n()},Ae.prototype.loadTile=function(e,t,n){this.getWorkerSource(e,t.type,t.source).loadTile(t,n)},Ae.prototype.loadDEMTile=function(e,t,n){this.getDEMWorkerSource(e,t.source).loadTile(t,n)},Ae.prototype.reloadTile=function(e,t,n){this.getWorkerSource(e,t.type,t.source).reloadTile(t,n)},Ae.prototype.abortTile=function(e,t,n){this.getWorkerSource(e,t.type,t.source).abortTile(t,n)},Ae.prototype.removeTile=function(e,t,n){this.getWorkerSource(e,t.type,t.source).removeTile(t,n)},Ae.prototype.removeDEMTile=function(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)},Ae.prototype.removeSource=function(e,t,n){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var r=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==r.removeSource?r.removeSource(t,n):n()}},Ae.prototype.loadWorkerSource=function(e,t,n){try{this.self.importScripts(t.url),n()}catch(e){n(e.toString())}},Ae.prototype.syncRTLPluginState=function(t,n,r){try{e.plugin.setState(n);var i=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=i){this.self.importScripts(i);var o=e.plugin.isParsed();r(o?void 0:new Error("RTL Text Plugin failed to import scripts from "+i),o)}}catch(e){r(e.toString())}},Ae.prototype.getAvailableImages=function(e){var t=this.availableImages[e];return t||(t=[]),t},Ae.prototype.getLayerIndex=function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new r),t},Ae.prototype.getWorkerSource=function(e,t,n){var r=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][n]||(this.workerSources[e][t][n]=new this.workerSourceTypes[t]({send:function(t,n,i){r.actor.send(t,n,i,e)}},this.getLayerIndex(e),this.getAvailableImages(e))),this.workerSources[e][t][n]},Ae.prototype.getDEMWorkerSource=function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new l),this.demWorkerSources[e][t]},Ae.prototype.enforceCacheSizeLimit=function(t,n){e.enforceCacheSizeLimit(n)},"undefined"!=typeof WorkerGlobalScope&&void 0!==e.window&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Ae(e.window)),Ae})),r(["./shared"],(function(e){var t=e.createCommonjsModule((function(e){function t(e){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,n=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(n);try{t=new Worker(r),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(r),e}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&(r=e&&e.failIfMajorPerformanceCaveat,void 0===n[r]&&(n[r]=function(e){var n=document.createElement("canvas"),r=Object.create(t.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=e,n.probablySupportsContext?n.probablySupportsContext("webgl",r)||n.probablySupportsContext("experimental-webgl",r):n.supportsContext?n.supportsContext("webgl",r)||n.supportsContext("experimental-webgl",r):n.getContext("webgl",r)||n.getContext("experimental-webgl",r)}(r)),n[r]));var r}e.exports?e.exports=t:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=t);var n={};t.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),n={create:function(t,n,r){var i=e.window.document.createElement(t);return void 0!==n&&(i.className=n),r&&r.appendChild(i),i},createNS:function(t,n){return e.window.document.createElementNS(t,n)}},r=e.window.document.documentElement.style;function i(e){if(!r)return e[0];for(var t=0;t<e.length;t++)if(e[t]in r)return e[t];return e[0]}var o,a=i(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){r&&a&&(o=r[a],r[a]="none")},n.enableDrag=function(){r&&a&&(r[a]=o)};var s=i(["transform","WebkitTransform"]);n.setTransform=function(e,t){e.style[s]=t};var u=!1;try{var c=Object.defineProperty({},"passive",{get:function(){u=!0}});e.window.addEventListener("test",c,c),e.window.removeEventListener("test",c,c)}catch(e){u=!1}n.addEventListener=function(e,t,n,r){void 0===r&&(r={}),e.addEventListener(t,n,"passive"in r&&u?r:r.capture)},n.removeEventListener=function(e,t,n,r){void 0===r&&(r={}),e.removeEventListener(t,n,"passive"in r&&u?r:r.capture)};var l=function t(n){n.preventDefault(),n.stopPropagation(),e.window.removeEventListener("click",t,!0)};function p(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}n.suppressClick=function(){e.window.addEventListener("click",l,!0),e.window.setTimeout((function(){e.window.removeEventListener("click",l,!0)}),0)},n.mousePos=function(t,n){var r=t.getBoundingClientRect(),i=e.window.TouchEvent&&n instanceof e.window.TouchEvent?n.touches[0]:n;return new e.Point(i.clientX-r.left-t.clientLeft,i.clientY-r.top-t.clientTop)},n.touchPos=function(t,n){for(var r=t.getBoundingClientRect(),i=[],o="touchend"===n.type?n.changedTouches:n.touches,a=0;a<o.length;a++)i.push(new e.Point(o[a].clientX-r.left-t.clientLeft,o[a].clientY-r.top-t.clientTop));return i},n.mouseButton=function(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button},n.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var f=function(t){function n(){t.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.isLoaded=function(){return this.loaded},n.prototype.setLoaded=function(e){if(this.loaded!==e&&(this.loaded=e,e)){for(var t=0,n=this.requestors;t<n.length;t+=1){var r=n[t];this._notify(r.ids,r.callback)}this.requestors=[]}},n.prototype.getImage=function(e){return this.images[e]},n.prototype.addImage=function(e,t){this._validate(e,t)&&(this.images[e]=t)},n.prototype._validate=function(t,n){var r=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchX" value'))),r=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "stretchY" value'))),r=!1),this._validateContent(n.content,n)||(this.fire(new e.ErrorEvent(new Error('Image "'+t+'" has invalid "content" value'))),r=!1),r},n.prototype._validateStretch=function(e,t){if(!e)return!0;for(var n=0,r=0,i=e;r<i.length;r+=1){var o=i[r];if(o[0]<n||o[1]<o[0]||t<o[1])return!1;n=o[1]}return!0},n.prototype._validateContent=function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))},n.prototype.updateImage=function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0},n.prototype.removeImage=function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()},n.prototype.listImages=function(){return Object.keys(this.images)},n.prototype.getImages=function(e,t){var n=!0;if(!this.isLoaded())for(var r=0,i=e;r<i.length;r+=1)this.images[i[r]]||(n=!1);this.isLoaded()||n?this._notify(e,t):this.requestors.push({ids:e,callback:t})},n.prototype._notify=function(t,n){for(var r={},i=0,o=t;i<o.length;i+=1){var a=o[i];this.images[a]||this.fire(new e.Event("styleimagemissing",{id:a}));var s=this.images[a];s?r[a]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'+a+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}n(null,r)},n.prototype.getPixelSize=function(){var e=this.atlasImage;return{width:e.width,height:e.height}},n.prototype.getPattern=function(t){var n=this.patterns[t],r=this.getImage(t);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{var i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},o=new e.ImagePosition(i,r);this.patterns[t]={bin:i,position:o}}return this._updatePatternAtlas(),this.patterns[t].position},n.prototype.bind=function(t){var n=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)},n.prototype._updatePatternAtlas=function(){var t=[];for(var n in this.patterns)t.push(this.patterns[n].bin);var r=e.potpack(t),i=r.w,o=r.h,a=this.atlasImage;for(var s in a.resize({width:i||1,height:o||1}),this.patterns){var u=this.patterns[s].bin,c=u.x+1,l=u.y+1,p=this.images[s].data,f=p.width,h=p.height;e.RGBAImage.copy(p,a,{x:0,y:0},{x:c,y:l},{width:f,height:h}),e.RGBAImage.copy(p,a,{x:0,y:h-1},{x:c,y:l-1},{width:f,height:1}),e.RGBAImage.copy(p,a,{x:0,y:0},{x:c,y:l+h},{width:f,height:1}),e.RGBAImage.copy(p,a,{x:f-1,y:0},{x:c-1,y:l},{width:1,height:h}),e.RGBAImage.copy(p,a,{x:0,y:0},{x:c+f,y:l},{width:1,height:h})}this.dirty=!0},n.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},n.prototype.dispatchRenderCallbacks=function(e){for(var t=0,n=e;t<n.length;t+=1){var r=n[t];if(!this.callbackDispatchedThisFrame[r]){this.callbackDispatchedThisFrame[r]=!0;var i=this.images[r];p(i)&&this.updateImage(r,i)}}},n}(e.Evented),h=g,d=g,m=1e20;function g(e,t,n,r,i,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function v(e,t,n,r,i,o,a){for(var s=0;s<t;s++){for(var u=0;u<n;u++)r[u]=e[u*t+s];for(y(r,i,o,a,n),u=0;u<n;u++)e[u*t+s]=i[u]}for(u=0;u<n;u++){for(s=0;s<t;s++)r[s]=e[u*t+s];for(y(r,i,o,a,t),s=0;s<t;s++)e[u*t+s]=Math.sqrt(i[s])}}function y(e,t,n,r,i){n[0]=0,r[0]=-m,r[1]=+m;for(var o=1,a=0;o<i;o++){for(var s=(e[o]+o*o-(e[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)s=(e[o]+o*o-(e[n[--a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=+m}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;t[o]=(o-n[a])*(o-n[a])+e[n[a]]}}g.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var i=t.data[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?m:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?m:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(v(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),v(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++)n[r]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[r]-this.gridInner[r])/this.radius+this.cutoff))));return n},h.default=d;var _=function(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}};_.prototype.setURL=function(e){this.url=e},_.prototype.getGlyphs=function(t,n){var r=this,i=[];for(var o in t)for(var a=0,s=t[o];a<s.length;a+=1)i.push({stack:o,id:s[a]});e.asyncAll(i,(function(e,t){var n=e.stack,i=e.id,o=r.entries[n];o||(o=r.entries[n]={glyphs:{},requests:{}});var a=o.glyphs[i];if(void 0===a){if(a=r._tinySDF(o,n,i))return o.glyphs[i]=a,void t(null,{stack:n,id:i,glyph:a});var s=Math.floor(i/256);if(256*s>65535)t(new Error("glyphs > 65535 not supported"));else{var u=o.requests[s];u||(u=o.requests[s]=[],_.loadGlyphRange(n,s,r.url,r.requestManager,(function(e,t){if(t)for(var n in t)r._doesCharSupportLocalGlyph(+n)||(o.glyphs[+n]=t[+n]);for(var i=0,a=u;i<a.length;i+=1)(0,a[i])(e,t);delete o.requests[s]}))),u.push((function(e,r){e?t(e):r&&t(null,{stack:n,id:i,glyph:r[i]||null})}))}}else t(null,{stack:n,id:i,glyph:a})}),(function(e,t){if(e)n(e);else if(t){for(var r={},i=0,o=t;i<o.length;i+=1){var a=o[i],s=a.stack,u=a.id,c=a.glyph;(r[s]||(r[s]={}))[u]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}n(null,r)}}))},_.prototype._doesCharSupportLocalGlyph=function(t){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](t)||e.isChar["Hangul Syllables"](t)||e.isChar.Hiragana(t)||e.isChar.Katakana(t))},_.prototype._tinySDF=function(t,n,r){var i=this.localIdeographFontFamily;if(i&&this._doesCharSupportLocalGlyph(r)){var o=t.tinySDF;if(!o){var a="400";/bold/i.test(n)?a="900":/medium/i.test(n)?a="500":/light/i.test(n)&&(a="200"),o=t.tinySDF=new _.TinySDF(24,3,8,.25,i,a)}return{id:r,bitmap:new e.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(t,n,r,i,o){var a=256*n,s=a+255,u=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",t).replace("{range}",a+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(u,(function(t,n){if(t)o(t);else if(n){for(var r={},i=0,a=e.parseGlyphPBF(n);i<a.length;i+=1){var s=a[i];r[s.id]=s}o(null,r)}}))},_.TinySDF=h;var b=function(){this.specification=e.styleSpec.light.position};b.prototype.possiblyEvaluate=function(t,n){return e.sphericalToCartesian(t.expression.evaluate(n))},b.prototype.interpolate=function(t,n,r){return{x:e.number(t.x,n.x,r),y:e.number(t.y,n.y,r),z:e.number(t.z,n.z,r)}};var x=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new b,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),w=function(t){function n(n){t.call(this),this._transitionable=new e.Transitionable(x),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getLight=function(){return this._transitionable.serialize()},n.prototype.setLight=function(t,n){if(void 0===n&&(n={}),!this._validate(e.validateLight,t,n))for(var r in t){var i=t[r];e.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),i):this._transitionable.setValue(r,i)}},n.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},n.prototype.hasTransition=function(){return this._transitioning.hasTransition()},n.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},n.prototype._validate=function(t,n,r){return(!r||!1!==r.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},n}(e.Evented),S=function(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};S.prototype.getDash=function(e,t){var n=e.join(",")+String(t);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(e,t)),this.dashEntry[n]},S.prototype.getDashRanges=function(e,t,n){var r=[],i=e.length%2==1?-e[e.length-1]*n:0,o=e[0]*n,a=!0;r.push({left:i,right:o,isDash:a,zeroLength:0===e[0]});for(var s=e[0],u=1;u<e.length;u++){var c=e[u];r.push({left:i=s*n,right:o=(s+=c)*n,isDash:a=!a,zeroLength:0===c})}return r},S.prototype.addRoundDash=function(e,t,n){for(var r=t/2,i=-n;i<=n;i++)for(var o=this.width*(this.nextRow+n+i),a=0,s=e[a],u=0;u<this.width;u++){u/s.right>1&&(s=e[++a]);var c=Math.abs(u-s.left),l=Math.abs(u-s.right),p=Math.min(c,l),f=void 0,h=i/n*(r+1);if(s.isDash){var d=r-Math.abs(h);f=Math.sqrt(p*p+d*d)}else f=r-Math.sqrt(p*p+h*h);this.data[o+u]=Math.max(0,Math.min(255,f+128))}},S.prototype.addRegularDash=function(e){for(var t=e.length-1;t>=0;--t){var n=e[t],r=e[t+1];n.zeroLength?e.splice(t,1):r&&r.isDash===n.isDash&&(r.left=n.left,e.splice(t,1))}var i=e[0],o=e[e.length-1];i.isDash===o.isDash&&(i.left=o.left-this.width,o.right=i.right+this.width);for(var a=this.width*this.nextRow,s=0,u=e[s],c=0;c<this.width;c++){c/u.right>1&&(u=e[++s]);var l=Math.abs(c-u.left),p=Math.abs(c-u.right),f=Math.min(l,p);this.data[a+c]=Math.max(0,Math.min(255,(u.isDash?f:-f)+128))}},S.prototype.addDash=function(t,n){var r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var o=0,a=0;a<t.length;a++)o+=t[a];if(0!==o){var s=this.width/o,u=this.getDashRanges(t,this.width,s);n?this.addRoundDash(u,s,r):this.addRegularDash(u)}var c={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:o};return this.nextRow+=i,this.dirty=!0,c},S.prototype.bind=function(e){var t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))};var E=function t(n,r){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var i=this.workerPool.acquire(this.id),o=0;o<i.length;o++){var a=new t.Actor(i[o],r,this.id);a.name="Worker "+o,this.actors.push(a)}};function T(t,n,r){var i=function(i,o){if(i)return r(i);if(o){var a=e.pick(e.extend(o,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(a.vectorLayers=o.vector_layers,a.vectorLayerIds=a.vectorLayers.map((function(e){return e.id}))),a.tiles=n.canonicalizeTileset(a,t.url),r(null,a)}};return t.url?e.getJSON(n.transformRequest(n.normalizeSourceURL(t.url),e.ResourceType.Source),i):e.browser.frame((function(){return i(null,t)}))}E.prototype.broadcast=function(t,n,r){e.asyncAll(this.actors,(function(e,r){e.send(t,n,r)}),r=r||function(){})},E.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},E.prototype.remove=function(){this.actors.forEach((function(e){e.remove()})),this.actors=[],this.workerPool.release(this.id)},E.Actor=e.Actor;var k=function(t,n,r){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=r||24};k.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]},k.prototype.contains=function(t){var n=Math.pow(2,t.z),r=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*n),i=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*n),a=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*n);return t.x>=r&&t.x<o&&t.y>=i&&t.y<a};var A=function(t){function n(n,r,i,o){if(t.call(this),this.id=n,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(r,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(o)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=T(this._options,this.map._requestManager,(function(n,r){t._tileJSONRequest=null,t._loaded=!0,n?t.fire(new e.ErrorEvent(n)):r&&(e.extend(t,r),r.bounds&&(t.tileBounds=new k(r.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(r.tiles,t.map._requestManager._customAccessToken),e.postMapLoadEvent(r.tiles,t.map._getMapId(),t.map._requestManager._skuToken,t.map._requestManager._customAccessToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},n.prototype.onAdd=function(e){this.map=e,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return e.extend({},this._options)},n.prototype.loadTile=function(t,n){var r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(r,e.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function o(r,i){return delete t.request,t.aborted?n(null):r&&404!==r.status?n(r):(i&&i.resourceTiming&&(t.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&t.setExpiryData(i),t.loadVectorData(i,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=n:t.request=t.actor.send("reloadTile",i,o.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",i,o.bind(this)))},n.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0)},n.prototype.unloadTile=function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0)},n.prototype.hasTransition=function(){return!1},n}(e.Evented),C=function(t){function n(n,r,i,o){t.call(this),this.id=n,this.dispatcher=i,this.setEventedParent(o),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},r),e.extend(this,e.pick(r,["url","scheme","tileSize"]))}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.load=function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=T(this._options,this.map._requestManager,(function(n,r){t._tileJSONRequest=null,t._loaded=!0,n?t.fire(new e.ErrorEvent(n)):r&&(e.extend(t,r),r.bounds&&(t.tileBounds=new k(r.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(r.tiles),e.postMapLoadEvent(r.tiles,t.map._getMapId(),t.map._requestManager._skuToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.onAdd=function(e){this.map=e,this.load()},n.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},n.prototype.serialize=function(){return e.extend({},this._options)},n.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},n.prototype.loadTile=function(t,n){var r=this,i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(i,e.ResourceType.Tile),(function(i,o){if(delete t.request,t.aborted)t.state="unloaded",n(null);else if(i)t.state="errored",n(i);else if(o){r.map._refreshExpiredTiles&&t.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=r.map.painter.context,s=a.gl;t.texture=r.map.painter.getTileTexture(o.width),t.texture?t.texture.update(o,{useMipmap:!0}):(t.texture=new e.Texture(a,o,s.RGBA,{useMipmap:!0}),t.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),t.state="loaded",e.cacheEntryPossiblyAdded(r.dispatcher),n(null)}}))},n.prototype.abortTile=function(e,t){e.request&&(e.request.cancel(),delete e.request),t()},n.prototype.unloadTile=function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()},n.prototype.hasTransition=function(){return!1},n}(e.Evented),I=function(t){function n(n,r,i,o){t.call(this,n,r,i,o),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},n.prototype.loadTile=function(t,n){var r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function i(e,r){e&&(t.state="errored",n(e)),r&&(t.dem=r,t.needsHillshadePrepare=!0,t.state="loaded",n(null))}t.request=e.getImage(this.map._requestManager.transformRequest(r,e.ResourceType.Tile),function(r,o){if(delete t.request,t.aborted)t.state="unloaded",n(null);else if(r)t.state="errored",n(r);else if(o){this.map._refreshExpiredTiles&&t.setExpiryData(o),delete o.cacheControl,delete o.expires;var a=e.window.ImageBitmap&&o instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?o:e.browser.getImageData(o,1),s={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:a,encoding:this.encoding};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",s,i.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)},n.prototype._getNeighboringTiles=function(t){var n=t.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,o=0===n.x?t.wrap-1:t.wrap,a=(n.x+1+r)%r,s=n.x+1===r?t.wrap+1:t.wrap,u={};return u[new e.OverscaledTileID(t.overscaledZ,o,n.z,i,n.y).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,n.z,a,n.y).key]={backfilled:!1},n.y>0&&(u[new e.OverscaledTileID(t.overscaledZ,o,n.z,i,n.y-1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,n.z,a,n.y-1).key]={backfilled:!1}),n.y+1<r&&(u[new e.OverscaledTileID(t.overscaledZ,o,n.z,i,n.y+1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,n.z,a,n.y+1).key]={backfilled:!1}),u},n.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&e.actor.send("removeDEMTile",{uid:e.uid,source:this.id})},n}(C),M=function(t){function n(n,r,i,o){t.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(o),this._data=r.data,this._options=e.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;var a=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*a,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*a,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(r.clusterRadius||50)*a,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(n){if(n)t.fire(new e.ErrorEvent(n));else{var r={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&t._resourceTiming.length>0&&(r.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new e.Event("data",r))}}))},n.prototype.onAdd=function(e){this.map=e,this.load()},n.prototype.setData=function(t){var n=this;return this._data=t,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(t){if(t)n.fire(new e.ErrorEvent(t));else{var r={dataType:"source",sourceDataType:"content"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(r.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new e.Event("data",r))}})),this},n.prototype.getClusterExpansionZoom=function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this},n.prototype.getClusterChildren=function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this},n.prototype.getClusterLeaves=function(e,t,n,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:n},r),this},n.prototype._updateWorkerData=function(t){var n=this;this._loaded=!1;var r=e.extend({},this.workerOptions),i=this._data;"string"==typeof i?(r.request=this.map._requestManager.transformRequest(e.browser.resolveURL(i),e.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(i),this.actor.send(this.type+".loadData",r,(function(e,i){n._removed||i&&i.abandoned||(n._loaded=!0,i&&i.resourceTiming&&i.resourceTiming[n.id]&&(n._resourceTiming=i.resourceTiming[n.id].slice(0)),n.actor.send(n.type+".coalesce",{source:r.source},null),t(e))}))},n.prototype.loaded=function(){return this._loaded},n.prototype.loadTile=function(t,n){var r=this,i=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(i,{type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(e,o){return delete t.request,t.unloadVectorData(),t.aborted?n(null):e?n(e):(t.loadVectorData(o,r.map.painter,"reloadTile"===i),n(null))}))},n.prototype.abortTile=function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0},n.prototype.unloadTile=function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})},n.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},n.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},n.prototype.hasTransition=function(){return!1},n}(e.Evented),P=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),O=function(t){function n(e,n,r,i){t.call(this),this.id=e,this.dispatcher=r,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=n}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.load=function(t,n){var r=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(i,o){r._loaded=!0,i?r.fire(new e.ErrorEvent(i)):o&&(r.image=o,t&&(r.coordinates=t),n&&n(),r._finishLoading())}))},n.prototype.loaded=function(){return this._loaded},n.prototype.updateImage=function(e){var t=this;return this.image&&e.url?(this.options.url=e.url,this.load(e.coordinates,(function(){t.texture=null})),this):this},n.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},n.prototype.onAdd=function(e){this.map=e,this.load()},n.prototype.setCoordinates=function(t){var n=this;this.coordinates=t;var r=t.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(t){for(var n=1/0,r=1/0,i=-1/0,o=-1/0,a=0,s=t;a<s.length;a+=1){var u=s[a];n=Math.min(n,u.x),r=Math.min(r,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}var c=Math.max(i-n,o-r),l=Math.max(0,Math.floor(-Math.log(c)/Math.LN2)),p=Math.pow(2,l);return new e.CanonicalTileID(l,Math.floor((n+i)/2*p),Math.floor((r+o)/2*p))}(r),this.minzoom=this.maxzoom=this.tileID.z;var i=r.map((function(e){return n.tileID.getTilePoint(e)._round()}));return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},n.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,n=t.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,P.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.loadTile=function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))},n.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return!1},n}(e.Evented),L=function(t){function n(e,n,r,i){t.call(this,e,n,r,i),this.roundZoom=!0,this.type="video",this.options=n}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.load=function(){var t=this;this._loaded=!1;var n=this.options;this.urls=[];for(var r=0,i=n.urls;r<i.length;r+=1)this.urls.push(this.map._requestManager.transformRequest(i[r],e.ResourceType.Source).url);e.getVideo(this.urls,(function(n,r){t._loaded=!0,n?t.fire(new e.ErrorEvent(n)):r&&(t.video=r,t.video.loop=!0,t.video.addEventListener("playing",(function(){t.map.triggerRepaint()})),t.map&&t.video.play(),t._finishLoading())}))},n.prototype.pause=function(){this.video&&this.video.pause()},n.prototype.play=function(){this.video&&this.video.play()},n.prototype.seek=function(t){if(this.video){var n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+n.start(0)+" and "+n.end(0)+"-second mark."))):this.video.currentTime=t}},n.prototype.getVideo=function(){return this.video},n.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},n.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,n=t.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,P.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[r];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this.video&&!this.video.paused},n}(O),R=function(t){function n(n,r,i,o){t.call(this,n,r,i,o),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(e){return!Array.isArray(e)||2!==e.length||e.some((function(e){return"number"!=typeof e}))}))||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+n,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},n.prototype.getCanvas=function(){return this.canvas},n.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},n.prototype.onRemove=function(){this.pause()},n.prototype.prepare=function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var n=this.map.painter.context,r=n.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,P.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(n,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var o=this.tiles[i];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},n.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},n.prototype.hasTransition=function(){return this._playing},n.prototype._hasInvalidDimensions=function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e+=1){var n=t[e];if(isNaN(n)||n<=0)return!0}return!1},n}(O),D={vector:A,raster:C,"raster-dem":I,geojson:M,video:L,image:O,canvas:R},z=function(t,n,r,i){var o=new D[n.type](t,n,r,i);if(o.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+o.id);return e.bindAll(["load","abort","unload","serialize","prepare"],o),o};function N(t,n){var r=e.identity([]);return e.translate(r,r,[1,1,0]),e.scale(r,r,[.5*t.width,.5*t.height,1]),e.multiply(r,r,t.calculatePosMatrix(n.toUnwrapped()))}function j(e,t,n,r,i,o){var a=function(e,t,n){if(e)for(var r=0,i=e;r<i.length;r+=1){var o=t[i[r]];if(o&&o.source===n&&"fill-extrusion"===o.type)return!0}else for(var a in t){var s=t[a];if(s.source===n&&"fill-extrusion"===s.type)return!0}return!1}(i&&i.layers,t,e.id),s=o.maxPitchScaleFactor(),u=e.tilesIn(r,s,a);u.sort(F);for(var c=[],l=0,p=u;l<p.length;l+=1){var f=p[l];c.push({wrappedTileID:f.tileID.wrapped().key,queryResults:f.tile.queryRenderedFeatures(t,n,e._state,f.queryGeometry,f.cameraQueryGeometry,f.scale,i,o,s,N(e.transform,f.tileID))})}var h=function(e){for(var t={},n={},r=0,i=e;r<i.length;r+=1){var o=i[r],a=o.queryResults,s=o.wrappedTileID,u=n[s]=n[s]||{};for(var c in a)for(var l=a[c],p=u[c]=u[c]||{},f=t[c]=t[c]||[],h=0,d=l;h<d.length;h+=1){var m=d[h];p[m.featureIndex]||(p[m.featureIndex]=!0,f.push(m))}}return t}(c);for(var d in h)h[d].forEach((function(t){var n=t.feature,r=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r}));return h}function F(e,t){var n=e.tileID,r=t.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}var B=function(e,t){this.max=e,this.onRemove=t,this.reset()};B.prototype.reset=function(){for(var e in this.data)for(var t=0,n=this.data[e];t<n.length;t+=1){var r=n[t];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},B.prototype.add=function(e,t,n){var r=this,i=e.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var o={value:t,timeout:void 0};if(void 0!==n&&(o.timeout=setTimeout((function(){r.remove(e,o)}),n)),this.data[i].push(o),this.order.push(i),this.order.length>this.max){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},B.prototype.has=function(e){return e.wrapped().key in this.data},B.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},B.prototype._getAndRemoveByKey=function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value},B.prototype.getByKey=function(e){var t=this.data[e];return t?t[0].value:null},B.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},B.prototype.remove=function(e,t){if(!this.has(e))return this;var n=e.wrapped().key,r=void 0===t?0:this.data[n].indexOf(t),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this},B.prototype.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this},B.prototype.filter=function(e){var t=[];for(var n in this.data)for(var r=0,i=this.data[n];r<i.length;r+=1){var o=i[r];e(o.value)||t.push(o)}for(var a=0,s=t;a<s.length;a+=1){var u=s[a];this.remove(u.value.tileID,u)}};var U=function(e,t,n){this.context=e;var r=e.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};U.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},U.prototype.updateData=function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)},U.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var V={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},G=function(e,t,n,r){this.length=t.length,this.attributes=n,this.itemSize=t.bytesPerElement,this.dynamicDraw=r,this.context=e;var i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};G.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},G.prototype.updateData=function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)},G.prototype.enableAttributes=function(e,t){for(var n=0;n<this.attributes.length;n++){var r=t.attributes[this.attributes[n].name];void 0!==r&&e.enableVertexAttribArray(r)}},G.prototype.setVertexAttribPointers=function(e,t,n){for(var r=0;r<this.attributes.length;r++){var i=this.attributes[r],o=t.attributes[i.name];void 0!==o&&e.vertexAttribPointer(o,i.components,e[V[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}},G.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var q=function(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};q.prototype.get=function(){return this.current},q.prototype.set=function(e){},q.prototype.getDefault=function(){return this.default},q.prototype.setDefault=function(){this.set(this.default)};var Z=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getDefault=function(){return e.Color.transparent},n.prototype.set=function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},n}(q),H=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 1},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)},t}(q),W=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)},t}(q),Y=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return[!0,!0,!0,!0]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},t}(q),X=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)},t}(q),K=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 255},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)},t}(q),J=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},t.prototype.set=function(e){var t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)},t}(q),Q=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)},t}(q),$=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}},t}(q),ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return[0,1]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)},t}(q),te=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}},t}(q),ne=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.LESS},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)},t}(q),re=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}},t}(q),ie=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[e.ONE,e.ZERO]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)},t}(q),oe=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getDefault=function(){return e.Color.transparent},n.prototype.set=function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)},n}(q),ae=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.FUNC_ADD},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)},t}(q),se=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}},t}(q),ue=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.BACK},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)},t}(q),ce=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.CCW},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)},t}(q),le=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)},t}(q),pe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return this.gl.TEXTURE0},t.prototype.set=function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)},t}(q),fe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]},t.prototype.set=function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)},t}(q),he=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}},t}(q),de=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},t}(q),me=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}},t}(q),ge=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}},t}(q),ve=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1},t}(q),ye=function(e){function t(t){e.call(this,t),this.vao=t.extVertexArrayObject}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t.prototype.set=function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)},t}(q),_e=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return 4},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}},t}(q),be=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}},t}(q),xe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return!1},t.prototype.set=function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}},t}(q),we=function(e){function t(t,n){e.call(this,t),this.context=t,this.parent=n}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getDefault=function(){return null},t}(q),Se=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.setDirty=function(){this.dirty=!0},t.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}},t}(we),Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}},t}(we),Te=function(e,t,n,r){this.context=e,this.width=t,this.height=n;var i=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new Se(e,i),r&&(this.depthAttachment=new Ee(e,i))};Te.prototype.destroy=function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var n=this.depthAttachment.get();n&&e.deleteRenderbuffer(n)}e.deleteFramebuffer(this.framebuffer)};var ke=function(e,t,n){this.func=e,this.mask=t,this.range=n};ke.ReadOnly=!1,ke.ReadWrite=!0,ke.disabled=new ke(519,ke.ReadOnly,[0,1]);var Ae=function(e,t,n,r,i,o){this.test=e,this.ref=t,this.mask=n,this.fail=r,this.depthFail=i,this.pass=o};Ae.disabled=new Ae({func:519,mask:0},0,0,7680,7680,7680);var Ce=function(e,t,n){this.blendFunction=e,this.blendColor=t,this.mask=n};Ce.Replace=[1,0],Ce.disabled=new Ce(Ce.Replace,e.Color.transparent,[!1,!1,!1,!1]),Ce.unblended=new Ce(Ce.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ce.alphaBlended=new Ce([1,771],e.Color.transparent,[!0,!0,!0,!0]);var Ie=function(e,t,n){this.enable=e,this.mode=t,this.frontFace=n};Ie.disabled=new Ie(!1,1029,2305),Ie.backCCW=new Ie(!0,1029,2305);var Me=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Z(this),this.clearDepth=new H(this),this.clearStencil=new W(this),this.colorMask=new Y(this),this.depthMask=new X(this),this.stencilMask=new K(this),this.stencilFunc=new J(this),this.stencilOp=new Q(this),this.stencilTest=new $(this),this.depthRange=new ee(this),this.depthTest=new te(this),this.depthFunc=new ne(this),this.blend=new re(this),this.blendFunc=new ie(this),this.blendColor=new oe(this),this.blendEquation=new ae(this),this.cullFace=new se(this),this.cullFaceSide=new ue(this),this.frontFace=new ce(this),this.program=new le(this),this.activeTexture=new pe(this),this.viewport=new fe(this),this.bindFramebuffer=new he(this),this.bindRenderbuffer=new de(this),this.bindTexture=new me(this),this.bindVertexBuffer=new ge(this),this.bindElementBuffer=new ve(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ye(this),this.pixelStoreUnpack=new _e(this),this.pixelStoreUnpackPremultiplyAlpha=new be(this),this.pixelStoreUnpackFlipY=new xe(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query")};Me.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Me.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Me.prototype.createIndexBuffer=function(e,t){return new U(this,e,t)},Me.prototype.createVertexBuffer=function(e,t,n){return new G(this,e,t,n)},Me.prototype.createRenderbuffer=function(e,t,n){var r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),i},Me.prototype.createFramebuffer=function(e,t,n){return new Te(this,e,t,n)},Me.prototype.clear=function(e){var t=e.color,n=e.depth,r=this.gl,i=0;t&&(i|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(i|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),r.clear(i)},Me.prototype.setCullFace=function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))},Me.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},Me.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},Me.prototype.setColorMode=function(t){e.deepEqual(t.blendFunction,Ce.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)},Me.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pe=function(t){function n(n,r,i){var o=this;t.call(this),this.id=n,this.dispatcher=i,this.on("data",(function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),this.on("error",(function(){o._sourceErrored=!0})),this._source=z(n,r,i,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},n.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},n.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},n.prototype.getSource=function(){return this._source},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},n.prototype._loadTile=function(e,t){return this._source.loadTile(e,t)},n.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,(function(){}))},n.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,(function(){}))},n.prototype.serialize=function(){return this._source.serialize()},n.prototype.prepare=function(e){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager)}},n.prototype.getIds=function(){return e.values(this._tiles).map((function(e){return e.tileID})).sort(Oe).map((function(e){return e.key}))},n.prototype.getRenderableIds=function(t){var n=this,r=[];for(var i in this._tiles)this._isIdRenderable(i,t)&&r.push(this._tiles[i]);return t?r.sort((function(t,r){var i=t.tileID,o=r.tileID,a=new e.Point(i.canonical.x,i.canonical.y)._rotate(n.transform.angle),s=new e.Point(o.canonical.x,o.canonical.y)._rotate(n.transform.angle);return i.overscaledZ-o.overscaledZ||s.y-a.y||s.x-a.x})).map((function(e){return e.tileID.key})):r.map((function(e){return e.tileID})).sort(Oe).map((function(e){return e.key}))},n.prototype.hasRenderableParent=function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)},n.prototype._isIdRenderable=function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())},n.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")},n.prototype._reloadTile=function(e,t){var n=this._tiles[e];n&&("loading"!==n.state&&(n.state=t),this._loadTile(n,this._tileLoaded.bind(this,n,e,t)))},n.prototype._tileLoaded=function(t,n,r,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire(new e.ErrorEvent(i,{tile:t})):this.update(this.transform));t.timeAdded=e.browser.now(),"expired"===r&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:t,coord:t.tileID}))},n.prototype._backfillDEM=function(e){for(var t=this.getRenderableIds(),n=0;n<t.length;n++){var r=t[n];if(e.neighboringTiles&&e.neighboringTiles[r]){var i=this.getTileByID(r);o(e,i),o(i,e)}}function o(e,t){e.needsHillshadePrepare=!0;var n=t.tileID.canonical.x-e.tileID.canonical.x,r=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,r),e.neighboringTiles&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0)))}},n.prototype.getTile=function(e){return this.getTileByID(e.key)},n.prototype.getTileByID=function(e){return this._tiles[e]},n.prototype._retainLoadedChildren=function(e,t,n,r){for(var i in this._tiles){var o=this._tiles[i];if(!(r[i]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>n)){for(var a=o.tileID;o&&o.tileID.overscaledZ>t+1;){var s=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[s.key])&&o.hasData()&&(a=s)}for(var u=a;u.overscaledZ>t;)if(e[(u=u.scaledTo(u.overscaledZ-1)).key]){r[a.key]=a;break}}}},n.prototype.findLoadedParent=function(e,t){if(e.key in this._loadedParentTiles){var n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(var r=e.overscaledZ-1;r>=t;r--){var i=e.scaledTo(r),o=this._getLoadedTile(i);if(o)return o}},n.prototype._getLoadedTile=function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)},n.prototype.updateCacheSize=function(e){var t=Math.ceil(e.width/this._source.tileSize)+1,n=Math.ceil(e.height/this._source.tileSize)+1,r=Math.floor(t*n*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(i)},n.prototype.handleWrapJump=function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var n={};for(var r in this._tiles){var i=this._tiles[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var a in this._tiles)this._setTileReloadTimer(a,this._tiles[a])}},n.prototype.update=function(t){var r=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)})):(i=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter((function(e){return r._source.hasTile(e)})))):i=[];var o=t.coveringZoomLevel(this._source),a=Math.max(o-n.maxOverzooming,this._source.minzoom),s=Math.max(o+n.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(i,o);if(Le(this._source.type)){for(var c={},l={},p=0,f=Object.keys(u);p<f.length;p+=1){var h=f[p],d=u[h],m=this._tiles[h];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=e.browser.now())){var g=this.findLoadedParent(d,a);g&&(this._addTile(g.tileID),c[g.tileID.key]=g.tileID),l[h]=d}}for(var v in this._retainLoadedChildren(l,o,s,u),c)u[v]||(this._coveredTiles[v]=!0,u[v]=c[v])}for(var y in u)this._tiles[y].clearFadeHold();for(var _=0,b=e.keysDifference(this._tiles,u);_<b.length;_+=1){var x=b[_],w=this._tiles[x];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(x)}this._updateLoadedParentTileCache()}},n.prototype.releaseSymbolFadeTiles=function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)},n.prototype._updateRetainedTiles=function(e,t){for(var r={},i={},o=Math.max(t-n.maxOverzooming,this._source.minzoom),a=Math.max(t+n.maxUnderzooming,this._source.minzoom),s={},u=0,c=e;u<c.length;u+=1){var l=c[u],p=this._addTile(l);r[l.key]=l,p.hasData()||t<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,t,a,r);for(var f=0,h=e;f<h.length;f+=1){var d=h[f],m=this._tiles[d.key];if(!m.hasData()){if(t+1>this._source.maxzoom){var g=d.children(this._source.maxzoom)[0],v=this.getTile(g);if(v&&v.hasData()){r[g.key]=g;continue}}else{var y=d.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}for(var _=m.wasRequested(),b=d.overscaledZ-1;b>=o;--b){var x=d.scaledTo(b);if(i[x.key])break;if(i[x.key]=!0,!(m=this.getTile(x))&&_&&(m=this._addTile(x)),m&&(r[x.key]=x,_=m.wasRequested(),m.hasData()))break}}}return r},n.prototype._updateLoadedParentTileCache=function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],n=void 0,r=this._tiles[e].tileID;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}t.push(r.key);var i=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(i))break;r=i}for(var o=0,a=t;o<a.length;o+=1)this._loadedParentTiles[a[o]]=n}},n.prototype._addTile=function(t){var n=this._tiles[t.key];if(n)return n;(n=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));var r=Boolean(n);return r||(n=new e.Tile(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(n,this._tileLoaded.bind(this,n,t.key,n.state))),n?(n.uses++,this._tiles[t.key]=n,r||this._source.fire(new e.Event("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null},n.prototype._setTileReloadTimer=function(e,t){var n=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout((function(){n._reloadTile(e,"expired"),delete n._timers[e]}),r))},n.prototype._removeTile=function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},n.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},n.prototype.tilesIn=function(t,n,r){var i=this,o=[],a=this.transform;if(!a)return o;for(var s=r?a.getCameraQueryGeometry(t):t,u=t.map((function(e){return a.pointCoordinate(e)})),c=s.map((function(e){return a.pointCoordinate(e)})),l=this.getIds(),p=1/0,f=1/0,h=-1/0,d=-1/0,m=0,g=c;m<g.length;m+=1){var v=g[m];p=Math.min(p,v.x),f=Math.min(f,v.y),h=Math.max(h,v.x),d=Math.max(d,v.y)}for(var y=function(t){var r=i._tiles[l[t]];if(!r.holdingForFade()){var s=r.tileID,m=Math.pow(2,a.zoom-r.tileID.overscaledZ),g=n*r.queryPadding*e.EXTENT/r.tileSize/m,v=[s.getTilePoint(new e.MercatorCoordinate(p,f)),s.getTilePoint(new e.MercatorCoordinate(h,d))];if(v[0].x-g<e.EXTENT&&v[0].y-g<e.EXTENT&&v[1].x+g>=0&&v[1].y+g>=0){var y=u.map((function(e){return s.getTilePoint(e)})),_=c.map((function(e){return s.getTilePoint(e)}));o.push({tile:r,tileID:s,queryGeometry:y,cameraQueryGeometry:_,scale:m})}}},_=0;_<l.length;_++)y(_);return o},n.prototype.getVisibleCoordinates=function(e){for(var t=this,n=this.getRenderableIds(e).map((function(e){return t._tiles[e].tileID})),r=0,i=n;r<i.length;r+=1){var o=i[r];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return n},n.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Le(this._source.type))for(var t in this._tiles){var n=this._tiles[t];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=e.browser.now())return!0}return!1},n.prototype.setFeatureState=function(e,t,n){this._state.updateState(e=e||"_geojsonTileLayer",t,n)},n.prototype.removeFeatureState=function(e,t,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,n)},n.prototype.getFeatureState=function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)},n.prototype.setDependencies=function(e,t,n){var r=this._tiles[e];r&&r.setDependencies(t,n)},n.prototype.reloadTilesForDependencies=function(e,t){for(var n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(n,"reloading");this._cache.filter((function(n){return!n.hasDependency(e,t)}))},n}(e.Evented);function Oe(e,t){var n=Math.abs(2*e.wrap)-+(e.wrap<0),r=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||r-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Le(e){return"raster"===e||"image"===e||"video"===e}function Re(){return new e.window.Worker(gi.workerUrl)}Pe.maxOverzooming=10,Pe.maxUnderzooming=3;var De=function(){this.active={}};De.prototype.acquire=function(e){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new Re);return this.active[e]=!0,this.workers.slice()},De.prototype.release=function(e){delete this.active[e],0===Object.keys(this.active).length&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)};var ze,Ne=Math.floor(e.browser.hardwareConcurrency/2);function je(t,n){var r={};for(var i in t)"ref"!==i&&(r[i]=t[i]);return e.refProperties.forEach((function(e){e in n&&(r[e]=n[e])})),r}function Fe(e){e=e.slice();for(var t=Object.create(null),n=0;n<e.length;n++)t[e[n].id]=e[n];for(var r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=je(e[r],t[e[r].ref]));return e}De.workerCount=Math.max(Math.min(Ne,6),1);var Be={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ue(e,t,n){n.push({command:Be.addSource,args:[e,t[e]]})}function Ve(e,t,n){t.push({command:Be.removeSource,args:[e]}),n[e]=!0}function Ge(e,t,n,r){Ve(e,n,r),Ue(e,t,n)}function qe(t,n,r){var i;for(i in t[r])if(t[r].hasOwnProperty(i)&&"data"!==i&&!e.deepEqual(t[r][i],n[r][i]))return!1;for(i in n[r])if(n[r].hasOwnProperty(i)&&"data"!==i&&!e.deepEqual(t[r][i],n[r][i]))return!1;return!0}function Ze(t,n,r,i,o,a){var s;for(s in n=n||{},t=t||{})t.hasOwnProperty(s)&&(e.deepEqual(t[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}));for(s in n)n.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e.deepEqual(t[s],n[s])||r.push({command:a,args:[i,s,n[s],o]}))}function He(e){return e.id}function We(e,t){return e[t.id]=t,e}var Ye=function(e,t,n){var r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};function Xe(t,n,r,i,o){var a=e.create();return n?(e.scale(a,a,[1/o,1/o,1]),r||e.rotateZ(a,a,i.angle)):e.multiply(a,i.labelPlaneMatrix,t),a}function Ke(t,n,r,i,o){if(n){var a=e.clone(t);return e.scale(a,a,[o,o,1]),r||e.rotateZ(a,a,-i.angle),a}return i.glCoordMatrix}function Je(t,n){var r=[t.x,t.y,0,1];st(r,r,n);var i=r[3];return{point:new e.Point(r[0]/i,r[1]/i),signedDistanceFromCamera:i}}function Qe(e,t){var n=e[0]/e[3],r=e[1]/e[3];return n>=-t[0]&&n<=t[0]&&r>=-t[1]&&r<=t[1]}function $e(t,n,r,i,o,a,s,u){var c=i?t.textSizeData:t.iconSizeData,l=e.evaluateSizeForZoom(c,r.transform.zoom),p=[256/r.width*2+1,256/r.height*2+1],f=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;f.clear();for(var h=t.lineVertexArray,d=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,m=r.transform.width/r.transform.height,g=!1,v=0;v<d.length;v++){var y=d.get(v);if(y.hidden||y.writingMode===e.WritingMode.vertical&&!g)at(y.numGlyphs,f);else{g=!1;var _=[y.anchorX,y.anchorY,0,1];if(e.transformMat4(_,_,n),Qe(_,p)){var b=.5+_[3]/r.transform.cameraToCenterDistance*.5,x=e.evaluateSizeForFeature(c,l,y),w=s?x*b:x/b,S=new e.Point(y.anchorX,y.anchorY),E=Je(S,o).point,T={},k=nt(y,w,!1,u,n,o,a,t.glyphOffsetArray,h,f,E,S,T,m);g=k.useVertical,(k.notEnoughRoom||g||k.needsFlipping&&nt(y,w,!0,u,n,o,a,t.glyphOffsetArray,h,f,E,S,T,m).notEnoughRoom)&&at(y.numGlyphs,f)}else at(y.numGlyphs,f)}}i?t.text.dynamicLayoutVertexBuffer.updateData(f):t.icon.dynamicLayoutVertexBuffer.updateData(f)}function et(e,t,n,r,i,o,a,s,u,c,l,p){var f=s.glyphStartIndex+s.numGlyphs,h=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,m=t.getoffsetX(s.glyphStartIndex),g=t.getoffsetX(f-1),v=it(e*m,n,r,i,o,a,s.segment,h,d,u,c,l,p);if(!v)return null;var y=it(e*g,n,r,i,o,a,s.segment,h,d,u,c,l,p);return y?{first:v,last:y}:null}function tt(t,n,r,i){return t===e.WritingMode.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(t===e.WritingMode.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function nt(t,n,r,i,o,a,s,u,c,l,p,f,h,d){var m,g=n/24,v=t.lineOffsetX*g,y=t.lineOffsetY*g;if(t.numGlyphs>1){var _=t.glyphStartIndex+t.numGlyphs,b=t.lineStartIndex,x=t.lineStartIndex+t.lineLength,w=et(g,u,v,y,r,p,f,t,c,a,h,!1);if(!w)return{notEnoughRoom:!0};var S=Je(w.first.point,s).point,E=Je(w.last.point,s).point;if(i&&!r){var T=tt(t.writingMode,S,E,d);if(T)return T}m=[w.first];for(var k=t.glyphStartIndex+1;k<_-1;k++)m.push(it(g*u.getoffsetX(k),v,y,r,p,f,t.segment,b,x,c,a,h,!1));m.push(w.last)}else{if(i&&!r){var A=Je(f,o).point,C=t.lineStartIndex+t.segment+1,I=new e.Point(c.getx(C),c.gety(C)),M=Je(I,o),P=M.signedDistanceFromCamera>0?M.point:rt(f,I,A,1,o),O=tt(t.writingMode,A,P,d);if(O)return O}var L=it(g*u.getoffsetX(t.glyphStartIndex),v,y,r,p,f,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,c,a,h,!1);if(!L)return{notEnoughRoom:!0};m=[L]}for(var R=0,D=m;R<D.length;R+=1){var z=D[R];e.addDynamicAttributes(l,z.point,z.angle)}return{}}function rt(e,t,n,r,i){var o=Je(e.add(e.sub(t)._unit()),i).point,a=n.sub(o);return n.add(a._mult(r/a.mag()))}function it(t,n,r,i,o,a,s,u,c,l,p,f,h){var d=i?t-n:t+n,m=d>0?1:-1,g=0;i&&(m*=-1,g=Math.PI),m<0&&(g+=Math.PI);for(var v=m>0?u+s:u+s+1,y=v,_=o,b=o,x=0,w=0,S=Math.abs(d);x+w<=S;){if((v+=m)<u||v>=c)return null;if(b=_,void 0===(_=f[v])){var E=new e.Point(l.getx(v),l.gety(v)),T=Je(E,p);if(T.signedDistanceFromCamera>0)_=f[v]=T.point;else{var k=v-m;_=rt(0===x?a:new e.Point(l.getx(k),l.gety(k)),E,b,S-x+1,p)}}x+=w,w=b.dist(_)}var A=(S-x)/w,C=_.sub(b),I=C.mult(A)._add(b);return I._add(C._unit()._perp()._mult(r*m)),{point:I,angle:g+Math.atan2(_.y-b.y,_.x-b.x),tileDistance:h?{prevTileDistance:v-m===y?0:l.gettileUnitDistanceFromAnchor(v-m),lastSegmentViewportDistance:S-x}:null}}Ye.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ye.prototype.insert=function(e,t,n,r,i){this._forEachCell(t,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)},Ye.prototype.insertCircle=function(e,t,n,r){this._forEachCell(t-r,n-r,t+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(r)},Ye.prototype._insertBoxCell=function(e,t,n,r,i,o){this.boxCells[i].push(o)},Ye.prototype._insertCircleCell=function(e,t,n,r,i,o){this.circleCells[i].push(o)},Ye.prototype._query=function(e,t,n,r,i,o){if(n<0||e>this.width||r<0||t>this.height)return!i&&[];var a=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var c=this.circles[3*u],l=this.circles[3*u+1],p=this.circles[3*u+2];a.push({key:this.circleKeys[u],x1:c-p,y1:l-p,x2:c+p,y2:l+p})}return o?a.filter(o):a}return this._forEachCell(e,t,n,r,this._queryCell,a,{hitTest:i,seenUids:{box:{},circle:{}}},o),i?a.length>0:a},Ye.prototype._queryCircle=function(e,t,n,r,i){var o=e-n,a=e+n,s=t-n,u=t+n;if(a<0||o>this.width||u<0||s>this.height)return!r&&[];var c=[];return this._forEachCell(o,s,a,u,this._queryCellCircle,c,{hitTest:r,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}},i),r?c.length>0:c},Ye.prototype.query=function(e,t,n,r,i){return this._query(e,t,n,r,!1,i)},Ye.prototype.hitTest=function(e,t,n,r,i){return this._query(e,t,n,r,!0,i)},Ye.prototype.hitTestCircle=function(e,t,n,r){return this._queryCircle(e,t,n,!0,r)},Ye.prototype._queryCell=function(e,t,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c)for(var l=this.bboxes,p=0,f=c;p<f.length;p+=1){var h=f[p];if(!u.box[h]){u.box[h]=!0;var d=4*h;if(e<=l[d+2]&&t<=l[d+3]&&n>=l[d+0]&&r>=l[d+1]&&(!s||s(this.boxKeys[h]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[h],x1:l[d],y1:l[d+1],x2:l[d+2],y2:l[d+3]})}}}var m=this.circleCells[i];if(null!==m)for(var g=this.circles,v=0,y=m;v<y.length;v+=1){var _=y[v];if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(g[b],g[b+1],g[b+2],e,t,n,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=g[b],w=g[b+1],S=g[b+2];o.push({key:this.circleKeys[_],x1:x-S,y1:w-S,x2:x+S,y2:w+S})}}}},Ye.prototype._queryCellCircle=function(e,t,n,r,i,o,a,s){var u=a.circle,c=a.seenUids,l=this.boxCells[i];if(null!==l)for(var p=this.bboxes,f=0,h=l;f<h.length;f+=1){var d=h[f];if(!c.box[d]){c.box[d]=!0;var m=4*d;if(this._circleAndRectCollide(u.x,u.y,u.radius,p[m+0],p[m+1],p[m+2],p[m+3])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}var g=this.circleCells[i];if(null!==g)for(var v=this.circles,y=0,_=g;y<_.length;y+=1){var b=_[y];if(!c.circle[b]){c.circle[b]=!0;var x=3*b;if(this._circlesCollide(v[x],v[x+1],v[x+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}},Ye.prototype._forEachCell=function(e,t,n,r,i,o,a,s){for(var u=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),l=this._convertToXCellCoord(n),p=this._convertToYCellCoord(r),f=u;f<=l;f++)for(var h=c;h<=p;h++)if(i.call(this,e,t,n,r,this.xCellCount*h+f,o,a,s))return},Ye.prototype._convertToXCellCoord=function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))},Ye.prototype._convertToYCellCoord=function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))},Ye.prototype._circlesCollide=function(e,t,n,r,i,o){var a=r-e,s=i-t,u=n+o;return u*u>a*a+s*s},Ye.prototype._circleAndRectCollide=function(e,t,n,r,i,o,a){var s=(o-r)/2,u=Math.abs(e-(r+s));if(u>s+n)return!1;var c=(a-i)/2,l=Math.abs(t-(i+c));if(l>c+n)return!1;if(u<=s||l<=c)return!0;var p=u-s,f=l-c;return p*p+f*f<=n*n};var ot=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function at(e,t){for(var n=0;n<e;n++){var r=t.length;t.resize(r+4),t.float32.set(ot,3*r)}}function st(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e[3]=n[3]*r+n[7]*i+n[15],e}var ut=function(e,t,n){void 0===t&&(t=new Ye(e.width+200,e.height+200,25)),void 0===n&&(n=new Ye(e.width+200,e.height+200,25)),this.transform=e,this.grid=t,this.ignoredGrid=n,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200};function ct(e,t,n){e[t+4]=n?1:0}function lt(t,n,r){return n*(e.EXTENT/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}ut.prototype.placeCollisionBox=function(e,t,n,r,i){var o=this.projectAndGetPerspectiveRatio(r,e.anchorPointX,e.anchorPointY),a=n*o.perspectiveRatio,s=e.x1*a+o.point.x,u=e.y1*a+o.point.y,c=e.x2*a+o.point.x,l=e.y2*a+o.point.y;return!this.isInsideGrid(s,u,c,l)||!t&&this.grid.hitTest(s,u,c,l,i)?{box:[],offscreen:!1}:{box:[s,u,c,l],offscreen:this.isOffscreen(s,u,c,l)}},ut.prototype.approximateTileDistance=function(e,t,n,r,i){var o=e.lastSegmentViewportDistance*n;return e.prevTileDistance+o+((i?1:r/this.pitchfactor)-1)*o*Math.abs(Math.sin(t))},ut.prototype.placeCollisionCircles=function(t,n,r,i,o,a,s,u,c,l,p,f,h){var d=[],m=this.projectAnchor(c,o.anchorX,o.anchorY),g=u/24,v=o.lineOffsetX*u,y=o.lineOffsetY*u,_=new e.Point(o.anchorX,o.anchorY),b=et(g,s,v,y,!1,Je(_,l).point,_,o,a,l,{},!0),x=!1,w=!1,S=!0,E=m.perspectiveRatio*i,T=1/(i*r),k=0,A=0;b&&(k=this.approximateTileDistance(b.first.tileDistance,b.first.angle,T,m.cameraDistance,f),A=this.approximateTileDistance(b.last.tileDistance,b.last.angle,T,m.cameraDistance,f));for(var C=0;C<t.length;C+=5){var I=t[C],M=t[C+1],P=t[C+2],O=t[C+3];if(!b||O<-k||O>A)ct(t,C,!1);else{var L=this.projectPoint(c,I,M),R=P*E;if(d.length>0){var D=L.x-d[d.length-4],z=L.y-d[d.length-3];if(R*R*2>D*D+z*z&&C+8<t.length){var N=t[C+8];if(N>-k&&N<A){ct(t,C,!1);continue}}}d.push(L.x,L.y,R,C/5),ct(t,C,!0);var j=L.x-R,F=L.y-R,B=L.x+R,U=L.y+R;if(S=S&&this.isOffscreen(j,F,B,U),w=w||this.isInsideGrid(j,F,B,U),!n&&this.grid.hitTestCircle(L.x,L.y,R,h)){if(!p)return{circles:[],offscreen:!1};x=!0}}}return{circles:x||!w?[]:d,offscreen:S}},ut.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],r=1/0,i=1/0,o=-1/0,a=-1/0,s=0,u=t;s<u.length;s+=1){var c=u[s],l=new e.Point(c.x+100,c.y+100);r=Math.min(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y),n.push(l)}for(var p={},f={},h=0,d=this.grid.query(r,i,o,a).concat(this.ignoredGrid.query(r,i,o,a));h<d.length;h+=1){var m=d[h],g=m.key;if(void 0===p[g.bucketInstanceId]&&(p[g.bucketInstanceId]={}),!p[g.bucketInstanceId][g.featureIndex]){var v=[new e.Point(m.x1,m.y1),new e.Point(m.x2,m.y1),new e.Point(m.x2,m.y2),new e.Point(m.x1,m.y2)];e.polygonIntersectsPolygon(n,v)&&(p[g.bucketInstanceId][g.featureIndex]=!0,void 0===f[g.bucketInstanceId]&&(f[g.bucketInstanceId]=[]),f[g.bucketInstanceId].push(g.featureIndex))}}return f},ut.prototype.insertCollisionBox=function(e,t,n,r,i){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:r,collisionGroupID:i},e[0],e[1],e[2],e[3])},ut.prototype.insertCollisionCircles=function(e,t,n,r,i){for(var o=t?this.ignoredGrid:this.grid,a={bucketInstanceId:n,featureIndex:r,collisionGroupID:i},s=0;s<e.length;s+=4)o.insertCircle(a,e[s],e[s+1],e[s+2])},ut.prototype.projectAnchor=function(e,t,n){var r=[t,n,0,1];return st(r,r,e),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/r[3]*.5,cameraDistance:r[3]}},ut.prototype.projectPoint=function(t,n,r){var i=[n,r,0,1];return st(i,i,t),new e.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},ut.prototype.projectAndGetPerspectiveRatio=function(t,n,r){var i=[n,r,0,1];return st(i,i,t),{point:new e.Point((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},ut.prototype.isOffscreen=function(e,t,n,r){return n<100||e>=this.screenRightBoundary||r<100||t>this.screenBottomBoundary},ut.prototype.isInsideGrid=function(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary};var pt=function(e,t,n,r){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):r&&n?1:0,this.placed=n};pt.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var ft=function(e,t,n,r,i){this.text=new pt(e?e.text:null,t,n,i),this.icon=new pt(e?e.icon:null,t,r,i)};ft.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ht=function(e,t,n){this.text=e,this.icon=t,this.skipFade=n},dt=function(e,t,n,r,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i},mt=function(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}};function gt(t,n,r,i,o){var a=e.getAnchorAlignment(t),s=-(a.horizontalAlign-.5)*n,u=-(a.verticalAlign-.5)*r,c=e.evaluateVariableOffset(t,i);return new e.Point(s+c[0]*o,u+c[1]*o)}function vt(t,n,r,i,o,a){var s=t.x1,u=t.x2,c=t.y1,l=t.y2,p=t.anchorPointX,f=t.anchorPointY,h=new e.Point(n,r);return i&&h._rotate(o?a:-a),{x1:s+h.x,y1:c+h.y,x2:u+h.x,y2:l+h.y,anchorPointX:p,anchorPointY:f}}mt.prototype.get=function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]};var yt=function(e,t,n,r){this.transform=e.clone(),this.collisionIndex=new ut(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new mt(n),this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}};function _t(e,t,n,r,i){e.emplaceBack(t?1:0,n?1:0,r||0,i||0),e.emplaceBack(t?1:0,n?1:0,r||0,i||0),e.emplaceBack(t?1:0,n?1:0,r||0,i||0),e.emplaceBack(t?1:0,n?1:0,r||0,i||0)}yt.prototype.getBucketParts=function(t,n,r,i){var o=r.getBucket(n),a=r.latestFeatureIndex;if(o&&a&&n.id===o.layerIds[0]){var s=r.collisionBoxArray,u=o.layers[0].layout,c=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),l=r.tileSize/e.EXTENT,p=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),f=Xe(p,"map"===u.get("text-pitch-alignment"),"map"===u.get("text-rotation-alignment"),this.transform,lt(r,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new dt(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,r.tileID);var h={bucket:o,layout:u,posMatrix:p,textLabelPlaneMatrix:f,scale:c,textPixelRatio:l,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(var d=0,m=o.sortKeyRanges;d<m.length;d+=1){var g=m[d];t.push({sortKey:g.sortKey,symbolInstanceStart:g.symbolInstanceStart,symbolInstanceEnd:g.symbolInstanceEnd,parameters:h})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:h})}},yt.prototype.attemptAnchorPlacement=function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d){var m,g=[p.textOffset0,p.textOffset1],v=gt(e,n,r,g,i),y=this.collisionIndex.placeCollisionBox(vt(t,v.x,v.y,o,a,this.transform.angle),l,s,u,c.predicate);if(!d||0!==this.collisionIndex.placeCollisionBox(vt(d,v.x,v.y,o,a,this.transform.angle),l,s,u,c.predicate).box.length)return y.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(m=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:g,width:n,height:r,anchor:e,textBoxScale:i,prevAnchor:m},this.markUsedJustification(f,e,p,h),f.allowVerticalPlacement&&(this.markUsedOrientation(f,h,p),this.placedOrientations[p.crossTileID]=h),{shift:v,placedGlyphBoxes:y}):void 0},yt.prototype.placeLayerBucketPart=function(t,n,r){var i=this,o=t.parameters,a=o.bucket,s=o.layout,u=o.posMatrix,c=o.textLabelPlaneMatrix,l=o.scale,p=o.textPixelRatio,f=o.holdingForFade,h=o.collisionBoxArray,d=o.partiallyEvaluatedTextSize,m=o.collisionGroup,g=s.get("text-optional"),v=s.get("icon-optional"),y=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),b="map"===s.get("text-rotation-alignment"),x="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),E=y&&(_||!a.hasIconData()||v),T=_&&(y||!a.hasTextData()||g);!a.collisionArrays&&h&&a.deserializeCollisionBoxes(h);var k=function(t,o){if(!n[t.crossTileID])if(f)i.placements[t.crossTileID]=new ht(!1,!1,!1);else{var h,S=!1,k=!1,A=!0,C=null,I={box:null,offscreen:null},M={box:null,offscreen:null},P=null,O=null,L=0,R=0,D=0;o.textFeatureIndex&&(L=o.textFeatureIndex),o.verticalTextFeatureIndex&&(R=o.verticalTextFeatureIndex);var z=o.textBox;if(z){var N=function(n){var r=e.WritingMode.horizontal;if(a.allowVerticalPlacement&&!n&&i.prevPlacement){var o=i.prevPlacement.placedOrientations[t.crossTileID];o&&(i.placedOrientations[t.crossTileID]=o,i.markUsedOrientation(a,r=o,t))}return r},j=function(n,r){if(a.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&o.verticalTextBox)for(var i=0,s=a.writingModes;i<s.length&&(s[i]===e.WritingMode.vertical?(I=r(),M=I):I=n(),!(I&&I.box&&I.box.length));i+=1);else I=n()};if(s.get("text-variable-anchor")){var F=s.get("text-variable-anchor");if(i.prevPlacement&&i.prevPlacement.variableOffsets[t.crossTileID]){var B=i.prevPlacement.variableOffsets[t.crossTileID];F.indexOf(B.anchor)>0&&(F=F.filter((function(e){return e!==B.anchor}))).unshift(B.anchor)}var U=function(e,n,r){for(var o=e.x2-e.x1,s=e.y2-e.y1,c=t.textBoxScale,l=w&&!_?n:null,f={box:[],offscreen:!1},h=y?2*F.length:F.length,d=0;d<h;++d){var g=i.attemptAnchorPlacement(F[d%F.length],e,o,s,c,b,x,p,u,m,d>=F.length,t,a,r,l);if(g&&(f=g.placedGlyphBoxes)&&f.box&&f.box.length){S=!0,C=g.shift;break}}return f};j((function(){return U(z,o.iconBox,e.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&!(I&&I.box&&I.box.length)&&t.numVerticalGlyphVertices>0&&n?U(n,o.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}})),I&&(S=I.box,A=I.offscreen);var V=N(I&&I.box);if(!S&&i.prevPlacement){var G=i.prevPlacement.variableOffsets[t.crossTileID];G&&(i.variableOffsets[t.crossTileID]=G,i.markUsedJustification(a,G.anchor,t,V))}}else{var q=function(e,n){var r=i.collisionIndex.placeCollisionBox(e,y,p,u,m.predicate);return r&&r.box&&r.box.length&&(i.markUsedOrientation(a,n,t),i.placedOrientations[t.crossTileID]=n),r};j((function(){return q(z,e.WritingMode.horizontal)}),(function(){var n=o.verticalTextBox;return a.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&n?q(n,e.WritingMode.vertical):{box:null,offscreen:null}})),N(I&&I.box&&I.box.length)}}S=(h=I)&&h.box&&h.box.length>0,A=h&&h.offscreen;var Z=o.textCircles;if(Z){var H=a.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),W=e.evaluateSizeForFeature(a.textSizeData,d,H);P=i.collisionIndex.placeCollisionCircles(Z,y,l,p,H,a.lineVertexArray,a.glyphOffsetArray,W,u,c,r,x,m.predicate),S=y||P.circles.length>0,A=A&&P.offscreen}if(o.iconFeatureIndex&&(D=o.iconFeatureIndex),o.iconBox){var Y=function(e){var t=w&&C?vt(e,C.x,C.y,b,x,i.transform.angle):e;return i.collisionIndex.placeCollisionBox(t,_,p,u,m.predicate)};k=M&&M.box&&M.box.length&&o.verticalIconBox?(O=Y(o.verticalIconBox)).box.length>0:(O=Y(o.iconBox)).box.length>0,A=A&&O.offscreen}var X=g||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,K=v||0===t.numIconVertices;X||K?K?X||(k=k&&S):S=k&&S:k=S=k&&S,S&&h&&h.box&&i.collisionIndex.insertCollisionBox(h.box,s.get("text-ignore-placement"),a.bucketInstanceId,M&&M.box&&R?R:L,m.ID),k&&O&&i.collisionIndex.insertCollisionBox(O.box,s.get("icon-ignore-placement"),a.bucketInstanceId,D,m.ID),S&&P&&i.collisionIndex.insertCollisionCircles(P.circles,s.get("text-ignore-placement"),a.bucketInstanceId,L,m.ID),i.placements[t.crossTileID]=new ht(S||E,k||T,A||a.justReloaded),n[t.crossTileID]=!0}};if(S)for(var A=a.getSortedSymbolIndexes(this.transform.angle),C=A.length-1;C>=0;--C){var I=A[C];k(a.symbolInstances.get(I),a.collisionArrays[I])}else for(var M=t.symbolInstanceStart;M<t.symbolInstanceEnd;M++)k(a.symbolInstances.get(M),a.collisionArrays[M]);a.justReloaded=!1},yt.prototype.markUsedJustification=function(t,n,r,i){var o;o=i===e.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(n)];for(var a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];a<s.length;a+=1){var u=s[a];u>=0&&(t.text.placedSymbolArray.get(u).crossTileID=o>=0&&u!==o?0:r.crossTileID)}},yt.prototype.markUsedOrientation=function(t,n,r){for(var i=n===e.WritingMode.horizontal||n===e.WritingMode.horizontalOnly?n:0,o=n===e.WritingMode.vertical?n:0,a=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];a<s.length;a+=1)t.text.placedSymbolArray.get(s[a]).placedOrientation=i;r.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=o)},yt.prototype.commit=function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var r=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},o=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(var s in this.placements){var u=this.placements[s],c=i[s];c?(this.opacities[s]=new ft(c,r,u.text,u.icon),n=n||u.text!==c.text.placed||u.icon!==c.icon.placed):(this.opacities[s]=new ft(null,r,u.text,u.icon,u.skipFade),n=n||u.text||u.icon)}for(var l in i){var p=i[l];if(!this.opacities[l]){var f=new ft(p,r,!1,!1);f.isHidden()||(this.opacities[l]=f,n=n||p.text.placed||p.icon.placed)}}for(var h in o)this.variableOffsets[h]||!this.opacities[h]||this.opacities[h].isHidden()||(this.variableOffsets[h]=o[h]);for(var d in a)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=a[d]);n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)},yt.prototype.updateLayerOpacities=function(e,t){for(var n={},r=0,i=t;r<i.length;r+=1){var o=i[r],a=o.getBucket(e);a&&o.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,n,o.collisionBoxArray)}},yt.prototype.updateBucketOpacities=function(t,n,r){var i=this;t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear(),t.hasIconCollisionCircleData()&&t.iconCollisionCircle.collisionVertexArray.clear(),t.hasTextCollisionCircleData()&&t.textCollisionCircle.collisionVertexArray.clear();var o=t.layers[0].layout,a=new ft(null,0,!1,!1,!0),s=o.get("text-allow-overlap"),u=o.get("icon-allow-overlap"),c=o.get("text-variable-anchor"),l="map"===o.get("text-rotation-alignment"),p="map"===o.get("text-pitch-alignment"),f="none"!==o.get("icon-text-fit"),h=new ft(null,0,s&&(u||!t.hasIconData()||o.get("icon-optional")),u&&(s||!t.hasTextData()||o.get("text-optional")),!0);!t.collisionArrays&&r&&(t.hasIconCollisionBoxData()||t.hasIconCollisionCircleData()||t.hasTextCollisionBoxData()||t.hasTextCollisionCircleData())&&t.deserializeCollisionBoxes(r);for(var d=function(e,t,n){for(var r=0;r<t/4;r++)e.opacityVertexArray.emplaceBack(n)},m=function(r){var o=t.symbolInstances.get(r),s=o.numHorizontalGlyphVertices,u=o.numVerticalGlyphVertices,m=o.crossTileID,g=n[m],v=i.opacities[m];g?v=a:v||(i.opacities[m]=v=h),n[m]=!0;var y=o.numIconVertices>0,_=i.placedOrientations[o.crossTileID],b=_===e.WritingMode.vertical,x=_===e.WritingMode.horizontal||_===e.WritingMode.horizontalOnly;if(s>0||u>0){var w=At(v.text);d(t.text,s,b?Ct:w),d(t.text,u,x?Ct:w);var S=v.text.isHidden();[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((function(e){e>=0&&(t.text.placedSymbolArray.get(e).hidden=S||b?1:0)})),o.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).hidden=S||x?1:0);var E=i.variableOffsets[o.crossTileID];E&&i.markUsedJustification(t,E.anchor,o,_);var T=i.placedOrientations[o.crossTileID];T&&(i.markUsedJustification(t,"left",o,T),i.markUsedOrientation(t,T,o))}if(y){var k=At(v.icon),A=!(f&&o.verticalPlacedIconSymbolIndex&&b);o.placedIconSymbolIndex>=0&&(d(t.icon,o.numIconVertices,A?k:Ct),t.icon.placedSymbolArray.get(o.placedIconSymbolIndex).hidden=v.icon.isHidden()),o.verticalPlacedIconSymbolIndex>=0&&(d(t.icon,o.numVerticalIconVertices,A?Ct:k),t.icon.placedSymbolArray.get(o.verticalPlacedIconSymbolIndex).hidden=v.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasIconCollisionCircleData()||t.hasTextCollisionBoxData()||t.hasTextCollisionCircleData()){var C=t.collisionArrays[r];if(C){var I=new e.Point(0,0);if(C.textBox||C.verticalTextBox){var M=!0;if(c){var P=i.variableOffsets[m];P?(I=gt(P.anchor,P.width,P.height,P.textOffset,P.textBoxScale),l&&I._rotate(p?i.transform.angle:-i.transform.angle)):M=!1}C.textBox&&_t(t.textCollisionBox.collisionVertexArray,v.text.placed,!M||b,I.x,I.y),C.verticalTextBox&&_t(t.textCollisionBox.collisionVertexArray,v.text.placed,!M||x,I.x,I.y)}var O=Boolean(!x&&C.verticalIconBox);C.iconBox&&_t(t.iconCollisionBox.collisionVertexArray,v.icon.placed,O,f?I.x:0,f?I.y:0),C.verticalIconBox&&_t(t.iconCollisionBox.collisionVertexArray,v.icon.placed,!O,f?I.x:0,f?I.y:0);var L=C.textCircles;if(L&&t.hasTextCollisionCircleData())for(var R=0;R<L.length;R+=5)_t(t.textCollisionCircle.collisionVertexArray,v.text.placed,g||0===L[R+4])}}},g=0;g<t.symbolInstances.length;g++)m(g);t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.hasIconCollisionCircleData()&&t.iconCollisionCircle.collisionVertexBuffer&&t.iconCollisionCircle.collisionVertexBuffer.updateData(t.iconCollisionCircle.collisionVertexArray),t.hasTextCollisionCircleData()&&t.textCollisionCircle.collisionVertexBuffer&&t.textCollisionCircle.collisionVertexBuffer.updateData(t.textCollisionCircle.collisionVertexArray)},yt.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},yt.prototype.zoomAdjustment=function(e){return Math.max(0,(this.transform.zoom-e)/1.5)},yt.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},yt.prototype.stillRecent=function(e,t){var n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e},yt.prototype.setStale=function(){this.stale=!0};var bt=Math.pow(2,25),xt=Math.pow(2,24),wt=Math.pow(2,17),St=Math.pow(2,16),Et=Math.pow(2,9),Tt=Math.pow(2,8),kt=Math.pow(2,1);function At(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*bt+t*xt+n*wt+t*St+n*Et+t*Tt+n*kt+t}var Ct=0,It=function(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};It.prototype.continuePlacement=function(e,t,n,r,i){for(var o=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(o,r,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((function(e,t){return e.sortKey-t.sortKey})));this._currentPartIndex<o.length;)if(t.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,i())return!0;return!1};var Mt=function(e,t,n,r,i,o,a){this.placement=new yt(e,i,o,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=r,this._done=!1};Mt.prototype.isDone=function(){return this._done},Mt.prototype.continuePlacement=function(t,n,r){for(var i=this,o=e.browser.now(),a=function(){var t=e.browser.now()-o;return!i._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=n[t[this._currentPlacementIndex]],u=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new It(s)),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Mt.prototype.commit=function(e){return this.placement.commit(e),this.placement};var Pt=512/e.EXTENT/2,Ot=function(e,t,n){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var r=0;r<t.length;r++){var i=t.get(r),o=i.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:i.crossTileID,coord:this.getScaledCoordinates(i,e)})}};Ot.prototype.getScaledCoordinates=function(t,n){var r=Pt/Math.pow(2,n.canonical.z-this.tileID.canonical.z);return{x:Math.floor((n.canonical.x*e.EXTENT+t.anchorX)*r),y:Math.floor((n.canonical.y*e.EXTENT+t.anchorY)*r)}},Ot.prototype.findMatches=function(e,t,n){for(var r=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),i=0;i<e.length;i++){var o=e.get(i);if(!o.crossTileID){var a=this.indexedSymbolInstances[o.key];if(a)for(var s=this.getScaledCoordinates(o,t),u=0,c=a;u<c.length;u+=1){var l=c[u];if(Math.abs(l.coord.x-s.x)<=r&&Math.abs(l.coord.y-s.y)<=r&&!n[l.crossTileID]){n[l.crossTileID]=!0,o.crossTileID=l.crossTileID;break}}}}};var Lt=function(){this.maxCrossTileID=0};Lt.prototype.generate=function(){return++this.maxCrossTileID};var Rt=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Rt.prototype.handleWrapJump=function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var n in this.indexes){var r=this.indexes[n],i={};for(var o in r){var a=r[o];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+t),i[a.tileID.key]=a}this.indexes[n]=i}this.lng=e},Rt.prototype.addBucket=function(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var r=0;r<t.symbolInstances.length;r++)t.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var i=this.usedCrossTileIDs[e.overscaledZ];for(var o in this.indexes){var a=this.indexes[o];if(Number(o)>e.overscaledZ)for(var s in a){var u=a[s];u.tileID.isChildOf(e)&&u.findMatches(t.symbolInstances,e,i)}else{var c=a[e.scaledTo(Number(o)).key];c&&c.findMatches(t.symbolInstances,e,i)}}for(var l=0;l<t.symbolInstances.length;l++){var p=t.symbolInstances.get(l);p.crossTileID||(p.crossTileID=n.generate(),i[p.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ot(e,t.symbolInstances,t.bucketInstanceId),!0},Rt.prototype.removeBucketCrossTileIDs=function(e,t){for(var n in t.indexedSymbolInstances)for(var r=0,i=t.indexedSymbolInstances[n];r<i.length;r+=1)delete this.usedCrossTileIDs[e][i[r].crossTileID]},Rt.prototype.removeStaleBuckets=function(e){var t=!1;for(var n in this.indexes){var r=this.indexes[n];for(var i in r)e[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],t=!0)}return t};var Dt=function(){this.layerIndexes={},this.crossTileIDs=new Lt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Dt.prototype.addLayer=function(e,t,n){var r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new Rt);var i=!1,o={};r.handleWrapJump(n);for(var a=0,s=t;a<s.length;a+=1){var u=s[a],c=u.getBucket(e);c&&e.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(u.tileID,c,this.crossTileIDs)&&(i=!0),o[c.bucketInstanceId]=!0)}return r.removeStaleBuckets(o)&&(i=!0),i},Dt.prototype.pruneUnusedLayers=function(e){var t={};for(var n in e.forEach((function(e){t[e]=!0})),this.layerIndexes)t[n]||delete this.layerIndexes[n]};var zt=function(t,n){return e.emitValidationErrors(t,n&&n.filter((function(e){return"source.canvas"!==e.identifier})))},Nt=e.pick(Be,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),jt=e.pick(Be,["setCenter","setZoom","setBearing","setPitch"]),Ft=function(){var t={},n=e.styleSpec.$version;for(var r in e.styleSpec.$root){var i,o=e.styleSpec.$root[r];o.required&&null!=(i="version"===r?n:"array"===o.type?[]:{})&&(t[r]=i)}return t}(),Bt=function(t){function n(r,i){var o=this;void 0===i&&(i={}),t.call(this),this.map=r,this.dispatcher=new E((ze||(ze=new De),ze),this),this.imageManager=new f,this.imageManager.setEventedParent(this),this.glyphManager=new _(r._requestManager,i.localIdeographFontFamily),this.lineAtlas=new S(256,512),this.crossTileSymbolIndex=new Dt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var a=this;this._rtlTextPluginCallback=n.registerForPluginStateChange((function(t){a.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(function(t,n){if(e.triggerPluginCompletionEvent(t),n&&n.every((function(e){return e})))for(var r in a.sourceCaches)a.sourceCaches[r].reload()}))})),this.on("data",(function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=o.sourceCaches[e.sourceId];if(t){var n=t.getSource();if(n&&n.vectorLayerIds)for(var r in o._layers){var i=o._layers[r];i.source===n.id&&o._validateLayer(i)}}}}))}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.loadURL=function(t,n){var r=this;void 0===n&&(n={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken);var o=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(o,(function(t,n){r._request=null,t?r.fire(new e.ErrorEvent(t)):n&&r._load(n,i)}))},n.prototype.loadJSON=function(t,n){var r=this;void 0===n&&(n={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame((function(){r._request=null,r._load(t,!1!==n.validate)}))},n.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Ft,!1)},n.prototype._load=function(t,n){if(!n||!zt(this,e.validateStyle(t))){for(var r in this._loaded=!0,this.stylesheet=t,t.sources)this.addSource(r,t.sources[r],{validate:!1});t.sprite?this._loadSprite(t.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var i=Fe(this.stylesheet.layers);this._order=i.map((function(e){return e.id})),this._layers={},this._serializedLayers={};for(var o=0,a=i;o<a.length;o+=1){var s=a[o];(s=e.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},n.prototype._loadSprite=function(t){var n=this;this._spriteRequest=function(t,n,r){var i,o,a,s=e.browser.devicePixelRatio>1?"@2x":"",u=e.getJSON(n.transformRequest(n.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),(function(e,t){u=null,a||(a=e,i=t,l())})),c=e.getImage(n.transformRequest(n.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),(function(e,t){c=null,a||(a=e,o=t,l())}));function l(){if(a)r(a);else if(i&&o){var t=e.browser.getImageData(o),n={};for(var s in i){var u=i[s],c=u.width,l=u.height,p=u.x,f=u.y,h=u.sdf,d=u.pixelRatio,m=u.stretchX,g=u.stretchY,v=u.content,y=new e.RGBAImage({width:c,height:l});e.RGBAImage.copy(t,y,{x:p,y:f},{x:0,y:0},{width:c,height:l}),n[s]={data:y,pixelRatio:d,sdf:h,stretchX:m,stretchY:g,content:v}}r(null,n)}}return{cancel:function(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,(function(t,r){if(n._spriteRequest=null,t)n.fire(new e.ErrorEvent(t));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n._availableImages=n.imageManager.listImages(),n.dispatcher.broadcast("setImages",n._availableImages),n.fire(new e.Event("data",{dataType:"style"}))}))},n.prototype._validateLayer=function(t){var n=this.sourceCaches[t.source];if(n){var r=t.sourceLayer;if(r){var i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+i.id+'" as specified by style layer "'+t.id+'"')))}}},n.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},n.prototype._serializeLayers=function(e){for(var t=[],n=0,r=e;n<r.length;n+=1){var i=this._layers[r[n]];"custom"!==i.type&&t.push(i.serialize())}return t},n.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},n.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},n.prototype.update=function(t){if(this._loaded){var n=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var o in(r.length||i.length)&&this._updateWorkerLayers(r,i),this._updatedSources){var a=this._updatedSources[o];"reload"===a?this._reloadSource(o):"clear"===a&&this._clearSource(o)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}for(var u in this.sourceCaches)this.sourceCaches[u].used=!1;for(var c=0,l=this._order;c<l.length;c+=1){var p=this._layers[l[c]];p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}this.light.recalculate(t),this.z=t.zoom,n&&this.fire(new e.Event("data",{dataType:"style"}))}},n.prototype._updateTilesForChangedImages=function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}},n.prototype._updateWorkerLayers=function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})},n.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},n.prototype.setState=function(t){var n=this;if(this._checkLoaded(),zt(this,e.validateStyle(t)))return!1;(t=e.clone$1(t)).layers=Fe(t.layers);var r=function(t,n){if(!t)return[{command:Be.setStyle,args:[n]}];var r=[];try{if(!e.deepEqual(t.version,n.version))return[{command:Be.setStyle,args:[n]}];e.deepEqual(t.center,n.center)||r.push({command:Be.setCenter,args:[n.center]}),e.deepEqual(t.zoom,n.zoom)||r.push({command:Be.setZoom,args:[n.zoom]}),e.deepEqual(t.bearing,n.bearing)||r.push({command:Be.setBearing,args:[n.bearing]}),e.deepEqual(t.pitch,n.pitch)||r.push({command:Be.setPitch,args:[n.pitch]}),e.deepEqual(t.sprite,n.sprite)||r.push({command:Be.setSprite,args:[n.sprite]}),e.deepEqual(t.glyphs,n.glyphs)||r.push({command:Be.setGlyphs,args:[n.glyphs]}),e.deepEqual(t.transition,n.transition)||r.push({command:Be.setTransition,args:[n.transition]}),e.deepEqual(t.light,n.light)||r.push({command:Be.setLight,args:[n.light]});var i={},o=[];!function(t,n,r,i){var o;for(o in n=n||{},t=t||{})t.hasOwnProperty(o)&&(n.hasOwnProperty(o)||Ve(o,r,i));for(o in n)n.hasOwnProperty(o)&&(t.hasOwnProperty(o)?e.deepEqual(t[o],n[o])||("geojson"===t[o].type&&"geojson"===n[o].type&&qe(t,n,o)?r.push({command:Be.setGeoJSONSourceData,args:[o,n[o].data]}):Ge(o,n,r,i)):Ue(o,n,r))}(t.sources,n.sources,o,i);var a=[];t.layers&&t.layers.forEach((function(e){i[e.source]?r.push({command:Be.removeLayer,args:[e.id]}):a.push(e)})),r=r.concat(o),function(t,n,r){n=n||[];var i,o,a,s,u,c,l,p=(t=t||[]).map(He),f=n.map(He),h=t.reduce(We,{}),d=n.reduce(We,{}),m=p.slice(),g=Object.create(null);for(i=0,o=0;i<p.length;i++)d.hasOwnProperty(a=p[i])?o++:(r.push({command:Be.removeLayer,args:[a]}),m.splice(m.indexOf(a,o),1));for(i=0,o=0;i<f.length;i++)m[m.length-1-i]!==(a=f[f.length-1-i])&&(h.hasOwnProperty(a)?(r.push({command:Be.removeLayer,args:[a]}),m.splice(m.lastIndexOf(a,m.length-o),1)):o++,r.push({command:Be.addLayer,args:[d[a],c=m[m.length-i]]}),m.splice(m.length-i,0,a),g[a]=!0);for(i=0;i<f.length;i++)if(s=h[a=f[i]],u=d[a],!g[a]&&!e.deepEqual(s,u))if(e.deepEqual(s.source,u.source)&&e.deepEqual(s["source-layer"],u["source-layer"])&&e.deepEqual(s.type,u.type)){for(l in Ze(s.layout,u.layout,r,a,null,Be.setLayoutProperty),Ze(s.paint,u.paint,r,a,null,Be.setPaintProperty),e.deepEqual(s.filter,u.filter)||r.push({command:Be.setFilter,args:[a,u.filter]}),e.deepEqual(s.minzoom,u.minzoom)&&e.deepEqual(s.maxzoom,u.maxzoom)||r.push({command:Be.setLayerZoomRange,args:[a,u.minzoom,u.maxzoom]}),s)s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Ze(s[l],u[l],r,a,l.slice(6),Be.setPaintProperty):e.deepEqual(s[l],u[l])||r.push({command:Be.setLayerProperty,args:[a,l,u[l]]}));for(l in u)u.hasOwnProperty(l)&&!s.hasOwnProperty(l)&&"layout"!==l&&"paint"!==l&&"filter"!==l&&"metadata"!==l&&"minzoom"!==l&&"maxzoom"!==l&&(0===l.indexOf("paint.")?Ze(s[l],u[l],r,a,l.slice(6),Be.setPaintProperty):e.deepEqual(s[l],u[l])||r.push({command:Be.setLayerProperty,args:[a,l,u[l]]}))}else r.push({command:Be.removeLayer,args:[a]}),c=m[m.lastIndexOf(a)+1],r.push({command:Be.addLayer,args:[u,c]})}(a,n.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:Be.setStyle,args:[n]}]}return r}(this.serialize(),t).filter((function(e){return!(e.command in jt)}));if(0===r.length)return!1;var i=r.filter((function(e){return!(e.command in Nt)}));if(i.length>0)throw new Error("Unimplemented: "+i.map((function(e){return e.command})).join(", ")+".");return r.forEach((function(e){"setTransition"!==e.command&&n[e.command].apply(n,e.args)})),this.stylesheet=t,!0},n.prototype.addImage=function(t,n){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,n),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},n.prototype.updateImage=function(e,t){this.imageManager.updateImage(e,t)},n.prototype.getImage=function(e){return this.imageManager.getImage(e)},n.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},n.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},n.prototype.addSource=function(t,n,r){var i=this;if(void 0===r&&(r={}),this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!n.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(n).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(e.validateStyle.source,"sources."+t,n,null,r))){this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);var o=this.sourceCaches[t]=new Pe(t,n,this.dispatcher);o.style=this,o.setEventedParent(this,(function(){return{isSourceLoaded:i.loaded(),source:o.serialize(),sourceId:t}})),o.onAdd(this.map),this._changed=!0}},n.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+n+'" is using it.')));var r=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],r.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},n.prototype.setGeoJSONSourceData=function(e,t){this._checkLoaded(),this.sourceCaches[e].getSource().setData(t),this._changed=!0},n.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},n.prototype.addLayer=function(t,n,r){void 0===r&&(r={}),this._checkLoaded();var i=t.id;if(this.getLayer(i))this.fire(new e.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else{var o;if("custom"===t.type){if(zt(this,e.validateCustomStyleLayer(t)))return;o=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(i,t.source),t=e.clone$1(t),t=e.extend(t,{source:i})),this._validate(e.validateStyle.layer,"layers."+i,t,{arrayIndex:-1},r))return;o=e.createStyleLayer(t),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[o.id]=o.serialize()}var a=n?this._order.indexOf(n):this._order.length;if(n&&-1===a)this.fire(new e.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.')));else{if(this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o,this._removedLayers[i]&&o.source&&"custom"!==o.type){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map)}}},n.prototype.moveLayer=function(t,n){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==n){var r=this._order.indexOf(t);this._order.splice(r,1);var i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new e.ErrorEvent(new Error('Layer with id "'+n+'" does not exist on this map.'))):(this._order.splice(i,0,t),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},n.prototype.removeLayer=function(t){this._checkLoaded();var n=this._layers[t];if(n){n.setEventedParent(null);var r=this._order.indexOf(t);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},n.prototype.getLayer=function(e){return this._layers[e]},n.prototype.hasLayer=function(e){return e in this._layers},n.prototype.setLayerZoomRange=function(t,n,r){this._checkLoaded();var i=this.getLayer(t);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},n.prototype.setFilter=function(t,n,r){void 0===r&&(r={}),this._checkLoaded();var i=this.getLayer(t);if(i){if(!e.deepEqual(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(e.validateStyle.filter,"layers."+i.id+".filter",n,null,r)||(i.filter=e.clone$1(n),this._updateLayer(i)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},n.prototype.getFilter=function(t){return e.clone$1(this.getLayer(t).filter)},n.prototype.setLayoutProperty=function(t,n,r,i){void 0===i&&(i={}),this._checkLoaded();var o=this.getLayer(t);o?e.deepEqual(o.getLayoutProperty(n),r)||(o.setLayoutProperty(n,r,i),this._updateLayer(o)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getLayoutProperty=function(t,n){var r=this.getLayer(t);if(r)return r.getLayoutProperty(n);this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style.")))},n.prototype.setPaintProperty=function(t,n,r,i){void 0===i&&(i={}),this._checkLoaded();var o=this.getLayer(t);o?e.deepEqual(o.getPaintProperty(n),r)||(o.setPaintProperty(n,r,i)&&this._updateLayer(o),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},n.prototype.getPaintProperty=function(e,t){return this.getLayer(e).getPaintProperty(t)},n.prototype.setFeatureState=function(t,n){this._checkLoaded();var r=t.source,i=t.sourceLayer,o=this.sourceCaches[r];if(void 0!==o){var a=o.getSource().type;"geojson"===a&&i?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==a||i?(void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),o.setFeatureState(i,t.id,n)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.removeFeatureState=function(t,n){this._checkLoaded();var r=t.source,i=this.sourceCaches[r];if(void 0!==i){var o=i.getSource().type,a="vector"===o?t.sourceLayer:void 0;"vector"!==o||a?n&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):i.removeFeatureState(a,t.id,n):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},n.prototype.getFeatureState=function(t){this._checkLoaded();var n=t.source,r=t.sourceLayer,i=this.sourceCaches[n];if(void 0!==i){if("vector"!==i.getSource().type||r)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),i.getFeatureState(r,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")))},n.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},n.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,(function(e){return e.serialize()})),layers:this._serializeLayers(this._order)},(function(e){return void 0!==e}))},n.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},n.prototype._flattenAndSortRenderedFeatures=function(e){for(var t=this,n=function(e){return"fill-extrusion"===t._layers[e].type},r={},i=[],o=this._order.length-1;o>=0;o--){var a=this._order[o];if(n(a)){r[a]=o;for(var s=0,u=e;s<u.length;s+=1){var c=u[s][a];if(c)for(var l=0,p=c;l<p.length;l+=1)i.push(p[l])}}}i.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));for(var f=[],h=this._order.length-1;h>=0;h--){var d=this._order[h];if(n(d))for(var m=i.length-1;m>=0;m--){var g=i[m].feature;if(r[g.layer.id]<h)break;f.push(g),i.pop()}else for(var v=0,y=e;v<y.length;v+=1){var _=y[v][d];if(_)for(var b=0,x=_;b<x.length;b+=1)f.push(x[b].feature)}}return f},n.prototype.queryRenderedFeatures=function(t,n,r){n&&n.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",n.filter,null,n);var i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var o=0,a=n.layers;o<a.length;o+=1){var s=a[o],u=this._layers[s];if(!u)return this.fire(new e.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[u.source]=!0}}var c=[];for(var l in n.availableImages=this._availableImages,this.sourceCaches)n.layers&&!i[l]||c.push(j(this.sourceCaches[l],this._layers,this._serializedLayers,t,n,r));return this.placement&&c.push(function(e,t,n,r,i,o,a){for(var s={},u=o.queryRenderedSymbols(r),c=[],l=0,p=Object.keys(u).map(Number);l<p.length;l+=1)c.push(a[p[l]]);c.sort(F);for(var f=function(){var n=d[h],r=n.featureIndex.lookupSymbolFeatures(u[n.bucketInstanceId],t,n.bucketIndex,n.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(var o in r){var a=s[o]=s[o]||[],c=r[o];c.sort((function(e,t){var r=n.featureSortOrder;if(r){var i=r.indexOf(e.featureIndex);return r.indexOf(t.featureIndex)-i}return t.featureIndex-e.featureIndex}));for(var l=0,p=c;l<p.length;l+=1)a.push(p[l])}},h=0,d=c;h<d.length;h+=1)f();var m=function(t){s[t].forEach((function(r){var i=r.feature,o=n[e[t].source].getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o}))};for(var g in s)m(g);return s}(this._layers,this._serializedLayers,this.sourceCaches,t,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},n.prototype.querySourceFeatures=function(t,n){n&&n.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",n.filter,null,n);var r=this.sourceCaches[t];return r?function(e,t){for(var n=e.getRenderableIds().map((function(t){return e.getTileByID(t)})),r=[],i={},o=0;o<n.length;o++){var a=n[o],s=a.tileID.canonical.key;i[s]||(i[s]=!0,a.querySourceFeatures(r,t))}return r}(r,n):[]},n.prototype.addSourceType=function(e,t,r){return n.getSourceType(e)?r(new Error('A source type called "'+e+'" already exists.')):(n.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},r):r(null,null))},n.prototype.getLight=function(){return this.light.getLight()},n.prototype.setLight=function(t,n){void 0===n&&(n={}),this._checkLoaded();var r=this.light.getLight(),i=!1;for(var o in t)if(!e.deepEqual(t[o],r[o])){i=!0;break}if(i){var a={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,n),this.light.updateTransitions(a)}},n.prototype._validate=function(t,n,r,i,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&zt(this,t.call(e.validateStyle,e.extend({key:n,style:this.serialize(),value:r,styleSpec:e.styleSpec},i)))},n.prototype._remove=function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var n in this.sourceCaches)this.sourceCaches[n].clearTiles(),this.sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},n.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},n.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},n.prototype._updateSources=function(e){for(var t in this.sourceCaches)this.sourceCaches[t].update(e)},n.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},n.prototype._updatePlacement=function(t,n,r,i,o){void 0===o&&(o=!1);for(var a=!1,s=!1,u={},c=0,l=this._order;c<l.length;c+=1){var p=this._layers[l[c]];if("symbol"===p.type){if(!u[p.source]){var f=this.sourceCaches[p.source];u[p.source]=f.getRenderableIds(!0).map((function(e){return f.getTileByID(e)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}var h=this.crossTileSymbolIndex.addLayer(p,u[p.source],t.center.lng);a=a||h}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((o=o||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),t.zoom))&&(this.pauseablePlacement=new Mt(t,this._order,o,n,r,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(var d=0,m=this._order;d<m.length;d+=1){var g=this._layers[m[d]];"symbol"===g.type&&this.placement.updateLayerOpacities(g,u[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},n.prototype._releaseSymbolFadeTiles=function(){for(var e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()},n.prototype.getImages=function(e,t,n){this.imageManager.getImages(t.icons,n),this._updateTilesForChangedImages();var r=this.sourceCaches[t.source];r&&r.setDependencies(t.tileID.key,t.type,t.icons)},n.prototype.getGlyphs=function(e,t,n){this.glyphManager.getGlyphs(t.stacks,n)},n.prototype.getResource=function(t,n,r){return e.makeRequest(n,r)},n}(e.Evented);Bt.getSourceType=function(e){return D[e]},Bt.setSourceType=function(e,t){D[e]=t},Bt.registerForPluginStateChange=e.registerForPluginStateChange;var Ut=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Vt=mn("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Gt=mn("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),qt=mn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Zt=mn("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Ht=mn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Wt=mn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Yt=mn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Xt=mn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Kt=mn("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),Jt=mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Qt=mn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),$t=mn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),en=mn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),tn=mn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),nn=mn("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),rn=mn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),on=mn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),an=mn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),sn=mn("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),un=mn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),cn=mn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),ln=mn("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pn=mn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),fn=mn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),hn=mn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),dn=mn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function mn(e,t){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r={};return{fragmentSource:e=e.replace(n,(function(e,t,n,i,o){return r[o]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"})),vertexSource:t=t.replace(n,(function(e,t,n,i,o){var a="float"===i?"vec2":"vec4",s=o.match(/color/)?"color":a;return r[o]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\nvarying "+n+" "+i+" "+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+s+"(a_"+o+", u_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+n+" "+a+" a_"+o+";\n#else\nuniform "+n+" "+i+" u_"+o+";\n#endif\n":"vec4"===s?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = a_"+o+";\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+n+" "+i+" "+o+" = unpack_mix_"+s+"(a_"+o+", u_"+o+"_t);\n#else\n    "+n+" "+i+" "+o+" = u_"+o+";\n#endif\n"}))}}var gn=Object.freeze({__proto__:null,prelude:Vt,background:Gt,backgroundPattern:qt,circle:Zt,clippingMask:Ht,heatmap:Wt,heatmapTexture:Yt,collisionBox:Xt,collisionCircle:Kt,debug:Jt,fill:Qt,fillOutline:$t,fillOutlinePattern:en,fillPattern:tn,fillExtrusion:nn,fillExtrusionPattern:rn,hillshadePrepare:on,hillshade:an,line:sn,lineGradient:un,linePattern:cn,lineSDF:ln,raster:pn,symbolIcon:fn,symbolSDF:hn,symbolTextAndIcon:dn}),vn=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};vn.prototype.bind=function(e,t,n,r,i,o,a,s){this.context=e;for(var u=this.boundPaintVertexBuffers.length!==r.length,c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===n&&!u&&this.boundIndexBuffer===i&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(e.bindVertexArrayOES.set(this.vao),a&&a.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind()):this.freshBind(t,n,r,i,o,a,s)},vn.prototype.freshBind=function(e,t,n,r,i,o,a){var s,u=e.numAttributes,c=this.context,l=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=c.currentNumAttributes||0;for(var p=u;p<s;p++)l.disableVertexAttribArray(p)}t.enableAttributes(l,e);for(var f=0,h=n;f<h.length;f+=1)h[f].enableAttributes(l,e);o&&o.enableAttributes(l,e),a&&a.enableAttributes(l,e),t.bind(),t.setVertexAttribPointers(l,e,i);for(var d=0,m=n;d<m.length;d+=1){var g=m[d];g.bind(),g.setVertexAttribPointers(l,e,i)}o&&(o.bind(),o.setVertexAttribPointers(l,e,i)),r&&r.bind(),a&&(a.bind(),a.setVertexAttribPointers(l,e,i)),c.currentNumAttributes=u},vn.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var yn=function(e,t,n,r,i){var o=e.gl;this.program=o.createProgram();var a=n?n.defines():[];i&&a.push("#define OVERDRAW_INSPECTOR;");var s=a.concat(Vt.fragmentSource,t.fragmentSource).join("\n"),u=a.concat(Vt.vertexSource,t.vertexSource).join("\n"),c=o.createShader(o.FRAGMENT_SHADER);if(o.isContextLost())this.failedToCreate=!0;else{o.shaderSource(c,s),o.compileShader(c),o.attachShader(this.program,c);var l=o.createShader(o.VERTEX_SHADER);if(o.isContextLost())this.failedToCreate=!0;else{o.shaderSource(l,u),o.compileShader(l),o.attachShader(this.program,l);for(var p=n?n.layoutAttributes:[],f=0;f<p.length;f++)o.bindAttribLocation(this.program,f,p[f].name);o.linkProgram(this.program),this.numAttributes=o.getProgramParameter(this.program,o.ACTIVE_ATTRIBUTES),this.attributes={};for(var h={},d=0;d<this.numAttributes;d++){var m=o.getActiveAttrib(this.program,d);m&&(this.attributes[m.name]=o.getAttribLocation(this.program,m.name))}for(var g=o.getProgramParameter(this.program,o.ACTIVE_UNIFORMS),v=0;v<g;v++){var y=o.getActiveUniform(this.program,v);y&&(h[y.name]=o.getUniformLocation(this.program,y.name))}this.fixedUniforms=r(e,h),this.binderUniforms=n?n.getUniforms(e,h):[]}}};function _n(e,t,n){var r=1/lt(n,1,t.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),o=n.tileSize*Math.pow(2,t.transform.tileZoom)/i,a=o*(n.tileID.canonical.x+n.tileID.wrap*i),s=o*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}yn.prototype.draw=function(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m){var g,v=e.gl;if(!this.failedToCreate){for(var y in e.program.set(this.program),e.setDepthMode(n),e.setStencilMode(r),e.setColorMode(i),e.setCullFace(o),this.fixedUniforms)this.fixedUniforms[y].set(a[y]);h&&h.setUniforms(e,this.binderUniforms,p,{zoom:f});for(var _=(g={},g[v.LINES]=2,g[v.TRIANGLES]=3,g[v.LINE_STRIP]=1,g)[t],b=0,x=l.get();b<x.length;b+=1){var w=x[b],S=w.vaos||(w.vaos={});(S[s]||(S[s]=new vn)).bind(e,this,u,h?h.getPaintVertexBuffers():[],c,w.vertexOffset,d,m),v.drawElements(t,w.primitiveLength*_,v.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var bn=function(t,n,r,i){var o=n.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],u=e.create$1();"viewport"===o.properties.get("anchor")&&e.fromRotation(u,-n.transform.angle),e.transformMat3(s,s,u);var c=o.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:i}},xn=function(t,n,r,i,o,a,s){return e.extend(bn(t,n,r,i),_n(a,n,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8})},wn=function(e){return{u_matrix:e}},Sn=function(t,n,r,i){return e.extend(wn(t),_n(r,n,i))},En=function(e,t){return{u_matrix:e,u_world:t}},Tn=function(t,n,r,i,o){return e.extend(Sn(t,n,r,i),{u_world:o})},kn=function(t,n,r,i){var o,a,s=t.transform;if("map"===i.paint.get("circle-pitch-alignment")){var u=lt(r,1,s.zoom);o=!0,a=[u,u]}else o=!1,a=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(n.posMatrix,r,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:a}},An=function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,n.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(t,n.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(t,n.u_extrude_scale),u_overscale_factor:new e.Uniform1f(t,n.u_overscale_factor)}},Cn=function(e,t,n){var r=lt(n,1,t.zoom),i=Math.pow(2,t.zoom-n.tileID.overscaledZ),o=n.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[t.pixelsToGLUnits[0]/(r*i),t.pixelsToGLUnits[1]/(r*i)],u_overscale_factor:o}},In=function(e,t,n){return void 0===n&&(n=1),{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:n}},Mn=function(e){return{u_matrix:e}},Pn=function(e,t,n,r){return{u_matrix:e,u_extrude_scale:lt(t,1,n),u_intensity:r}},On=function(t,n,r){var i=r.paint.get("hillshade-shadow-color"),o=r.paint.get("hillshade-highlight-color"),a=r.paint.get("hillshade-accent-color"),s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);var u,c,l,p=!t.options.moving;return{u_matrix:t.transform.calculatePosMatrix(n.tileID.toUnwrapped(),p),u_image:0,u_latrange:(u=n.tileID,c=Math.pow(2,u.canonical.z),l=u.canonical.y,[new e.MercatorCoordinate(0,l/c).toLngLat().lat,new e.MercatorCoordinate(0,(l+1)/c).toLngLat().lat]),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}},Ln=function(t,n,r){var i=n.stride,o=e.create();return e.ortho(o,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(o,o,[0,-e.EXTENT,0]),{u_matrix:o,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_maxzoom:r,u_unpack:n.getUnpackVector()}},Rn=function(t,n,r){var i=t.transform;return{u_matrix:Fn(t,n,r),u_ratio:1/lt(n,1,i.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Dn=function(t,n,r){return e.extend(Rn(t,n,r),{u_image:0})},zn=function(t,n,r,i){var o=t.transform,a=jn(n,o);return{u_matrix:Fn(t,n,r),u_texsize:n.imageAtlasTexture.size,u_ratio:1/lt(n,1,o.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[a,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Nn=function(t,n,r,i,o){var a=t.lineAtlas,s=jn(n,t.transform),u="round"===r.layout.get("line-cap"),c=a.getDash(i.from,u),l=a.getDash(i.to,u),p=c.width*o.fromScale,f=l.width*o.toScale;return e.extend(Rn(t,n,r),{u_patternscale_a:[s/p,-c.height/2],u_patternscale_b:[s/f,-l.height/2],u_sdfgamma:a.width/(256*Math.min(p,f)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:l.y,u_mix:o.t})};function jn(e,t){return 1/lt(e,1,t.tileZoom)}function Fn(e,t,n){return e.translatePosMatrix(t.tileID.posMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var Bn=function(e,t,n,r,i){return{u_matrix:e,u_tl_parent:t,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(a=i.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=i.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Un(i.paint.get("raster-hue-rotate"))};var o,a};function Un(e){e*=Math.PI/180;var t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}var Vn=function(e,t,n,r,i,o,a,s,u,c){var l=i.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:l.cameraToCenterDistance,u_pitch:l.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:l.width/l.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},Gn=function(t,n,r,i,o,a,s,u,c,l,p){var f=o.transform;return e.extend(Vn(t,n,r,i,o,a,s,u,c,l),{u_gamma_scale:i?Math.cos(f._pitch)*f.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+p})},qn=function(t,n,r,i,o,a,s,u,c,l){return e.extend(Gn(t,n,r,i,o,a,s,u,!0,c,!0),{u_texsize_icon:l,u_texture_icon:1})},Zn=function(e,t,n){return{u_matrix:e,u_opacity:t,u_color:n}},Hn=function(t,n,r,i,o,a){return e.extend(function(e,t,n,r){var i=n.imageManager.getPattern(e.from.toString()),o=n.imageManager.getPattern(e.to.toString()),a=n.imageManager.getPixelSize(),s=a.width,u=a.height,c=Math.pow(2,r.tileID.overscaledZ),l=r.tileSize*Math.pow(2,n.transform.tileZoom)/c,p=l*(r.tileID.canonical.x+r.tileID.wrap*c),f=l*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[s,u],u_mix:t.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/lt(r,1,n.transform.tileZoom),u_pixel_coord_upper:[p>>16,f>>16],u_pixel_coord_lower:[65535&p,65535&f]}}(i,a,r,o),{u_matrix:t,u_opacity:n})},Wn={fillExtrusion:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_lightpos:new e.Uniform3f(t,n.u_lightpos),u_lightintensity:new e.Uniform1f(t,n.u_lightintensity),u_lightcolor:new e.Uniform3f(t,n.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,n.u_vertical_gradient),u_opacity:new e.Uniform1f(t,n.u_opacity)}},fillExtrusionPattern:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_lightpos:new e.Uniform3f(t,n.u_lightpos),u_lightintensity:new e.Uniform1f(t,n.u_lightintensity),u_lightcolor:new e.Uniform3f(t,n.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,n.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,n.u_height_factor),u_image:new e.Uniform1i(t,n.u_image),u_texsize:new e.Uniform2f(t,n.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,n.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,n.u_scale),u_fade:new e.Uniform1f(t,n.u_fade),u_opacity:new e.Uniform1f(t,n.u_opacity)}},fill:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix)}},fillPattern:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_image:new e.Uniform1i(t,n.u_image),u_texsize:new e.Uniform2f(t,n.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,n.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,n.u_scale),u_fade:new e.Uniform1f(t,n.u_fade)}},fillOutline:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_world:new e.Uniform2f(t,n.u_world)}},fillOutlinePattern:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_world:new e.Uniform2f(t,n.u_world),u_image:new e.Uniform1i(t,n.u_image),u_texsize:new e.Uniform2f(t,n.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,n.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,n.u_scale),u_fade:new e.Uniform1f(t,n.u_fade)}},circle:function(t,n){return{u_camera_to_center_distance:new e.Uniform1f(t,n.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(t,n.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(t,n.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(t,n.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,n.u_matrix)}},collisionBox:An,collisionCircle:An,debug:function(t,n){return{u_color:new e.UniformColor(t,n.u_color),u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_overlay:new e.Uniform1i(t,n.u_overlay),u_overlay_scale:new e.Uniform1f(t,n.u_overlay_scale)}},clippingMask:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix)}},heatmap:function(t,n){return{u_extrude_scale:new e.Uniform1f(t,n.u_extrude_scale),u_intensity:new e.Uniform1f(t,n.u_intensity),u_matrix:new e.UniformMatrix4f(t,n.u_matrix)}},heatmapTexture:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_world:new e.Uniform2f(t,n.u_world),u_image:new e.Uniform1i(t,n.u_image),u_color_ramp:new e.Uniform1i(t,n.u_color_ramp),u_opacity:new e.Uniform1f(t,n.u_opacity)}},hillshade:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_image:new e.Uniform1i(t,n.u_image),u_latrange:new e.Uniform2f(t,n.u_latrange),u_light:new e.Uniform2f(t,n.u_light),u_shadow:new e.UniformColor(t,n.u_shadow),u_highlight:new e.UniformColor(t,n.u_highlight),u_accent:new e.UniformColor(t,n.u_accent)}},hillshadePrepare:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_image:new e.Uniform1i(t,n.u_image),u_dimension:new e.Uniform2f(t,n.u_dimension),u_zoom:new e.Uniform1f(t,n.u_zoom),u_maxzoom:new e.Uniform1f(t,n.u_maxzoom),u_unpack:new e.Uniform4f(t,n.u_unpack)}},line:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_ratio:new e.Uniform1f(t,n.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,n.u_units_to_pixels)}},lineGradient:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_ratio:new e.Uniform1f(t,n.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,n.u_units_to_pixels),u_image:new e.Uniform1i(t,n.u_image)}},linePattern:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_texsize:new e.Uniform2f(t,n.u_texsize),u_ratio:new e.Uniform1f(t,n.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_image:new e.Uniform1i(t,n.u_image),u_units_to_pixels:new e.Uniform2f(t,n.u_units_to_pixels),u_scale:new e.Uniform3f(t,n.u_scale),u_fade:new e.Uniform1f(t,n.u_fade)}},lineSDF:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_ratio:new e.Uniform1f(t,n.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,n.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(t,n.u_patternscale_a),u_patternscale_b:new e.Uniform2f(t,n.u_patternscale_b),u_sdfgamma:new e.Uniform1f(t,n.u_sdfgamma),u_image:new e.Uniform1i(t,n.u_image),u_tex_y_a:new e.Uniform1f(t,n.u_tex_y_a),u_tex_y_b:new e.Uniform1f(t,n.u_tex_y_b),u_mix:new e.Uniform1f(t,n.u_mix)}},raster:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_tl_parent:new e.Uniform2f(t,n.u_tl_parent),u_scale_parent:new e.Uniform1f(t,n.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,n.u_buffer_scale),u_fade_t:new e.Uniform1f(t,n.u_fade_t),u_opacity:new e.Uniform1f(t,n.u_opacity),u_image0:new e.Uniform1i(t,n.u_image0),u_image1:new e.Uniform1i(t,n.u_image1),u_brightness_low:new e.Uniform1f(t,n.u_brightness_low),u_brightness_high:new e.Uniform1f(t,n.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,n.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,n.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,n.u_spin_weights)}},symbolIcon:function(t,n){return{u_is_size_zoom_constant:new e.Uniform1i(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,n.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,n.u_size_t),u_size:new e.Uniform1f(t,n.u_size),u_camera_to_center_distance:new e.Uniform1f(t,n.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,n.u_pitch),u_rotate_symbol:new e.Uniform1i(t,n.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,n.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,n.u_fade_change),u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,n.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,n.u_coord_matrix),u_is_text:new e.Uniform1i(t,n.u_is_text),u_pitch_with_map:new e.Uniform1i(t,n.u_pitch_with_map),u_texsize:new e.Uniform2f(t,n.u_texsize),u_texture:new e.Uniform1i(t,n.u_texture)}},symbolSDF:function(t,n){return{u_is_size_zoom_constant:new e.Uniform1i(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,n.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,n.u_size_t),u_size:new e.Uniform1f(t,n.u_size),u_camera_to_center_distance:new e.Uniform1f(t,n.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,n.u_pitch),u_rotate_symbol:new e.Uniform1i(t,n.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,n.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,n.u_fade_change),u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,n.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,n.u_coord_matrix),u_is_text:new e.Uniform1i(t,n.u_is_text),u_pitch_with_map:new e.Uniform1i(t,n.u_pitch_with_map),u_texsize:new e.Uniform2f(t,n.u_texsize),u_texture:new e.Uniform1i(t,n.u_texture),u_gamma_scale:new e.Uniform1f(t,n.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,n.u_is_halo)}},symbolTextAndIcon:function(t,n){return{u_is_size_zoom_constant:new e.Uniform1i(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,n.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,n.u_size_t),u_size:new e.Uniform1f(t,n.u_size),u_camera_to_center_distance:new e.Uniform1f(t,n.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,n.u_pitch),u_rotate_symbol:new e.Uniform1i(t,n.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,n.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,n.u_fade_change),u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,n.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,n.u_coord_matrix),u_is_text:new e.Uniform1i(t,n.u_is_text),u_pitch_with_map:new e.Uniform1i(t,n.u_pitch_with_map),u_texsize:new e.Uniform2f(t,n.u_texsize),u_texsize_icon:new e.Uniform2f(t,n.u_texsize_icon),u_texture:new e.Uniform1i(t,n.u_texture),u_texture_icon:new e.Uniform1i(t,n.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,n.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,n.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,n.u_is_halo)}},background:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_opacity:new e.Uniform1f(t,n.u_opacity),u_color:new e.UniformColor(t,n.u_color)}},backgroundPattern:function(t,n){return{u_matrix:new e.UniformMatrix4f(t,n.u_matrix),u_opacity:new e.Uniform1f(t,n.u_opacity),u_image:new e.Uniform1i(t,n.u_image),u_pattern_tl_a:new e.Uniform2f(t,n.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,n.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,n.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,n.u_pattern_br_b),u_texsize:new e.Uniform2f(t,n.u_texsize),u_mix:new e.Uniform1f(t,n.u_mix),u_pattern_size_a:new e.Uniform2f(t,n.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,n.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,n.u_scale_a),u_scale_b:new e.Uniform1f(t,n.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,n.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,n.u_tile_units_to_pixels)}}};function Yn(e,t,n,r,i,o,a,s){for(var u=e.context,c=u.gl,l=e.useProgram(i?"collisionCircle":"collisionBox"),p=0;p<r.length;p++){var f=r[p],h=t.getTile(f),d=h.getBucket(n);if(d){var m=i?s?d.textCollisionCircle:d.iconCollisionCircle:s?d.textCollisionBox:d.iconCollisionBox;if(m){var g=f.posMatrix;0===o[0]&&0===o[1]||(g=e.translatePosMatrix(f.posMatrix,h,o,a)),l.draw(u,i?c.TRIANGLES:c.LINES,ke.disabled,Ae.disabled,e.colorModeForRenderPass(),Ie.disabled,Cn(g,e.transform,h),n.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,e.transform.zoom,null,null,m.collisionVertexBuffer)}}}}function Xn(e,t,n,r,i,o,a){Yn(e,t,n,r,!1,i,o,a),Yn(e,t,n,r,!0,i,o,a)}var Kn=e.identity(new Float32Array(16));function Jn(t,n,r,i,o,a){var s=e.getAnchorAlignment(t),u=-(s.horizontalAlign-.5)*n,c=-(s.verticalAlign-.5)*r,l=e.evaluateVariableOffset(t,i);return new e.Point((u/o+l[0])*a,(c/o+l[1])*a)}function Qn(t,n,r,i,o,a,s,u,c,l,p){var f=t.text.placedSymbolArray,h=t.text.dynamicLayoutVertexArray,d=t.icon.dynamicLayoutVertexArray,m={};h.clear();for(var g=0;g<f.length;g++){var v=f.get(g),y=v.hidden||!v.crossTileID||t.allowVerticalPlacement&&!v.placedOrientation?null:i[v.crossTileID];if(y){var _=new e.Point(v.anchorX,v.anchorY),b=Je(_,r?u:s),x=.5+a.cameraToCenterDistance/b.signedDistanceFromCamera*.5,w=o.evaluateSizeForFeature(t.textSizeData,l,v)*x/e.ONE_EM;r&&(w*=t.tilePixelRatio/c);for(var S=Jn(y.anchor,y.width,y.height,y.textOffset,y.textBoxScale,w),E=r?Je(_.add(S),s).point:b.point.add(n?S.rotate(-a.angle):S),T=t.allowVerticalPlacement&&v.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,k=0;k<v.numGlyphs;k++)e.addDynamicAttributes(h,E,T);p&&v.associatedIconIndex>=0&&(m[v.associatedIconIndex]={shiftedAnchor:E,angle:T})}else at(v.numGlyphs,h)}if(p){d.clear();for(var A=t.icon.placedSymbolArray,C=0;C<A.length;C++){var I=A.get(C);if(I.hidden)at(I.numGlyphs,d);else{var M=m[C];if(M)for(var P=0;P<I.numGlyphs;P++)e.addDynamicAttributes(d,M.shiftedAnchor,M.angle);else at(I.numGlyphs,d)}}t.icon.dynamicLayoutVertexBuffer.updateData(d)}t.text.dynamicLayoutVertexBuffer.updateData(h)}function $n(e,t,n){return n.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function er(t,n,r,i,o,a,s,u,c,l,p,f){for(var h=t.context,d=h.gl,m=t.transform,g="map"===u,v="map"===c,y=g&&"point"!==r.layout.get("symbol-placement"),_=g&&!v&&!y,b=void 0!==r.layout.get("symbol-sort-key").constantOr(1),x=t.depthModeForSublayer(0,ke.ReadOnly),w=r.layout.get("text-variable-anchor"),S=[],E=0,T=i;E<T.length;E+=1){var k=T[E],A=n.getTile(k),C=A.getBucket(r);if(C){var I=o?C.text:C.icon;if(I&&I.segments.get().length){var M=I.programConfigurations.get(r.id),P=o||C.sdfIcons,O=o?C.textSizeData:C.iconSizeData,L=v||0!==m.pitch,R=t.useProgram($n(P,o,C),M),D=e.evaluateSizeForZoom(O,m.zoom),z=void 0,N=[0,0],j=void 0,F=void 0,B=null,U=void 0;if(o)j=A.glyphAtlasTexture,F=d.LINEAR,z=A.glyphAtlasTexture.size,C.iconsInText&&(N=A.imageAtlasTexture.size,B=A.imageAtlasTexture,U=L||t.options.rotating||t.options.zooming||"composite"===O.kind||"camera"===O.kind?d.LINEAR:d.NEAREST);else{var V=1!==r.layout.get("icon-size").constantOr(0)||C.iconsNeedLinear;j=A.imageAtlasTexture,F=P||t.options.rotating||t.options.zooming||V||L?d.LINEAR:d.NEAREST,z=A.imageAtlasTexture.size}var G=lt(A,1,t.transform.zoom),q=Xe(k.posMatrix,v,g,t.transform,G),Z=Ke(k.posMatrix,v,g,t.transform,G),H=w&&C.hasTextData(),W="none"!==r.layout.get("icon-text-fit")&&H&&C.hasIconData();y&&$e(C,k.posMatrix,t,o,q,Z,v,l);var Y=t.translatePosMatrix(k.posMatrix,A,a,s),X=y||o&&w||W?Kn:q,K=t.translatePosMatrix(Z,A,a,s,!0),J=P&&0!==r.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),Q={program:R,buffers:I,uniformValues:P?C.iconsInText?qn(O.kind,D,_,v,t,Y,X,K,z,N):Gn(O.kind,D,_,v,t,Y,X,K,o,z,!0):Vn(O.kind,D,_,v,t,Y,X,K,o,z),atlasTexture:j,atlasTextureIcon:B,atlasInterpolation:F,atlasInterpolationIcon:U,isSDF:P,hasHalo:J};if(b)for(var $=0,ee=I.segments.get();$<ee.length;$+=1){var te=ee[$];S.push({segments:new e.SegmentVector([te]),sortKey:te.sortKey,state:Q})}else S.push({segments:I.segments,sortKey:0,state:Q})}}}b&&S.sort((function(e,t){return e.sortKey-t.sortKey}));for(var ne=0,re=S;ne<re.length;ne+=1){var ie=re[ne],oe=ie.state;if(h.activeTexture.set(d.TEXTURE0),oe.atlasTexture.bind(oe.atlasInterpolation,d.CLAMP_TO_EDGE),oe.atlasTextureIcon&&(h.activeTexture.set(d.TEXTURE1),oe.atlasTextureIcon&&oe.atlasTextureIcon.bind(oe.atlasInterpolationIcon,d.CLAMP_TO_EDGE)),oe.isSDF){var ae=oe.uniformValues;oe.hasHalo&&(ae.u_is_halo=1,tr(oe.buffers,ie.segments,r,t,oe.program,x,p,f,ae)),ae.u_is_halo=0}tr(oe.buffers,ie.segments,r,t,oe.program,x,p,f,oe.uniformValues)}}function tr(e,t,n,r,i,o,a,s,u){var c=r.context;i.draw(c,c.gl.TRIANGLES,o,a,s,Ie.disabled,u,n.id,e.layoutVertexBuffer,e.indexBuffer,t,n.paint,r.transform.zoom,e.programConfigurations.get(n.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function nr(e,t,n,r,i,o,a){var s,u,c,l,p,f=e.context.gl,h=n.paint.get("fill-pattern"),d=h&&h.constantOr(1),m=n.getCrossfadeParameters();a?(u=d&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=f.LINES):(u=d?"fillPattern":"fill",s=f.TRIANGLES);for(var g=0,v=r;g<v.length;g+=1){var y=v[g],_=t.getTile(y);if(!d||_.patternsLoaded()){var b=_.getBucket(n);if(b){var x=b.programConfigurations.get(n.id),w=e.useProgram(u,x);d&&(e.context.activeTexture.set(f.TEXTURE0),_.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),x.updatePaintBuffers(m));var S=h.constantOr(null);if(S&&_.imageAtlas){var E=_.imageAtlas,T=E.patternPositions[S.to.toString()],k=E.patternPositions[S.from.toString()];T&&k&&x.setConstantPatternPositions(T,k)}var A=e.translatePosMatrix(y.posMatrix,_,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(a){l=b.indexBuffer2,p=b.segments2;var C=[f.drawingBufferWidth,f.drawingBufferHeight];c="fillOutlinePattern"===u&&d?Tn(A,e,m,_,C):En(A,C)}else l=b.indexBuffer,p=b.segments,c=d?Sn(A,e,m,_):wn(A);w.draw(e.context,s,i,e.stencilModeForClipping(y),o,Ie.disabled,c,n.id,b.layoutVertexBuffer,l,p,n.paint,e.transform.zoom,x)}}}}function rr(e,t,n,r,i,o,a){for(var s=e.context,u=s.gl,c=n.paint.get("fill-extrusion-pattern"),l=c.constantOr(1),p=n.getCrossfadeParameters(),f=n.paint.get("fill-extrusion-opacity"),h=0,d=r;h<d.length;h+=1){var m=d[h],g=t.getTile(m),v=g.getBucket(n);if(v){var y=v.programConfigurations.get(n.id),_=e.useProgram(l?"fillExtrusionPattern":"fillExtrusion",y);l&&(e.context.activeTexture.set(u.TEXTURE0),g.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),y.updatePaintBuffers(p));var b=c.constantOr(null);if(b&&g.imageAtlas){var x=g.imageAtlas,w=x.patternPositions[b.to.toString()],S=x.patternPositions[b.from.toString()];w&&S&&y.setConstantPatternPositions(w,S)}var E=e.translatePosMatrix(m.posMatrix,g,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),T=n.paint.get("fill-extrusion-vertical-gradient"),k=l?xn(E,e,T,f,m,p,g):bn(E,e,T,f);_.draw(s,s.gl.TRIANGLES,i,o,a,Ie.backCCW,k,n.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,n.paint,e.transform.zoom,y)}}}function ir(e,t,n,r,i,o){var a=e.context,s=a.gl,u=t.fbo;if(u){var c=e.useProgram("hillshade");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u.colorAttachment.get());var l=On(e,t,n);c.draw(a,s.TRIANGLES,r,i,o,Ie.disabled,l,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function or(t,n,r,i,o,a,s){var u=t.context,c=u.gl,l=n.dem;if(l&&l.data){var p=l.dim,f=l.stride,h=l.getPixels();if(u.activeTexture.set(c.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||t.getTileTexture(f),n.demTexture){var d=n.demTexture;d.update(h,{premultiply:!1}),d.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else n.demTexture=new e.Texture(u,h,c.RGBA,{premultiply:!1}),n.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);u.activeTexture.set(c.TEXTURE0);var m=n.fbo;if(!m){var g=new e.Texture(u,{width:p,height:p,data:null},c.RGBA);g.bind(c.LINEAR,c.CLAMP_TO_EDGE),(m=n.fbo=u.createFramebuffer(p,p,!0)).colorAttachment.set(g.texture)}u.bindFramebuffer.set(m.framebuffer),u.viewport.set([0,0,p,p]),t.useProgram("hillshadePrepare").draw(u,c.TRIANGLES,o,a,s,Ie.disabled,Ln(n.tileID,l,i),r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function ar(t,n,r,i,o){var a=i.paint.get("raster-fade-duration");if(a>0){var s=e.browser.now(),u=(s-t.timeAdded)/a,c=n?(s-n.timeAdded)/a:-1,l=r.getSource(),p=o.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),f=!n||Math.abs(n.tileID.overscaledZ-p)>Math.abs(t.tileID.overscaledZ-p),h=f&&t.refreshedUponExpiration?1:e.clamp(f?u:1-c,0,1);return t.refreshedUponExpiration&&u>=1&&(t.refreshedUponExpiration=!1),n?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}var sr=new e.Color(1,0,0,1),ur=new e.Color(0,1,0,1),cr=new e.Color(0,0,1,1),lr=new e.Color(1,0,1,1),pr=new e.Color(0,1,1,1);function fr(e,t,n,r){dr(e,0,t+n/2,e.transform.width,n,r)}function hr(e,t,n,r){dr(e,t-n/2,0,n,e.transform.height,r)}function dr(t,n,r,i,o,a){var s=t.context,u=s.gl;u.enable(u.SCISSOR_TEST),u.scissor(n*e.browser.devicePixelRatio,r*e.browser.devicePixelRatio,i*e.browser.devicePixelRatio,o*e.browser.devicePixelRatio),s.clear({color:a}),u.disable(u.SCISSOR_TEST)}function mr(t,n,r){var i=t.context,o=i.gl,a=r.posMatrix,s=t.useProgram("debug"),u=ke.disabled,c=Ae.disabled,l=t.colorModeForRenderPass();i.activeTexture.set(o.TEXTURE0),t.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.draw(i,o.LINE_STRIP,u,c,l,Ie.disabled,In(a,e.Color.red),"$debug",t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var p=n.getTileByID(r.key).latestRawTileData,f=Math.floor((p&&p.byteLength||0)/1024),h=n.getTile(r).tileSize,d=512/Math.min(h,512)*(r.overscaledZ/t.transform.zoom)*.5,m=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(m+=" => "+r.overscaledZ),function(e,t){e.initDebugOverlayCanvas();var n=e.debugOverlayCanvas,r=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(n),e.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(t,m+" "+f+"kb"),s.draw(i,o.TRIANGLES,u,c,Ce.alphaBlended,Ie.disabled,In(a,e.Color.transparent,d),"$debug",t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}var gr={symbol:function(t,n,r,i,o){if("translucent"===t.renderPass){var a=Ae.disabled,s=t.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(t,n,r,i,o,a,s){for(var u=n.transform,c="map"===o,l="map"===a,p=0,f=t;p<f.length;p+=1){var h=f[p],d=i.getTile(h),m=d.getBucket(r);if(m&&m.text&&m.text.segments.get().length){var g=e.evaluateSizeForZoom(m.textSizeData,u.zoom),v=lt(d,1,n.transform.zoom),y=Xe(h.posMatrix,l,c,n.transform,v),_="none"!==r.layout.get("icon-text-fit")&&m.hasIconData();if(g){var b=Math.pow(2,u.zoom-d.tileID.overscaledZ);Qn(m,c,l,s,e.symbolSize,u,y,h.posMatrix,b,g,_)}}}}(i,t,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),o),0!==r.paint.get("icon-opacity").constantOr(1)&&er(t,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),a,s),0!==r.paint.get("text-opacity").constantOr(1)&&er(t,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),a,s),n.map.showCollisionBoxes&&(Xn(t,n,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Xn(t,n,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(t,n,r,i){if("translucent"===t.renderPass){var o=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),u=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0!==o.constantOr(1)||0!==a.constantOr(1)&&0!==s.constantOr(1)){for(var c=t.context,l=c.gl,p=t.depthModeForSublayer(0,ke.ReadOnly),f=Ae.disabled,h=t.colorModeForRenderPass(),d=[],m=0;m<i.length;m++){var g=i[m],v=n.getTile(g),y=v.getBucket(r);if(y){var _=y.programConfigurations.get(r.id),b={programConfiguration:_,program:t.useProgram("circle",_),layoutVertexBuffer:y.layoutVertexBuffer,indexBuffer:y.indexBuffer,uniformValues:kn(t,g,v,r)};if(u)for(var x=0,w=y.segments.get();x<w.length;x+=1){var S=w[x];d.push({segments:new e.SegmentVector([S]),sortKey:S.sortKey,state:b})}else d.push({segments:y.segments,sortKey:0,state:b})}}u&&d.sort((function(e,t){return e.sortKey-t.sortKey}));for(var E=0,T=d;E<T.length;E+=1){var k=T[E],A=k.state;A.program.draw(c,l.TRIANGLES,p,f,h,Ie.disabled,A.uniformValues,r.id,A.layoutVertexBuffer,A.indexBuffer,k.segments,r.paint,t.transform.zoom,A.programConfiguration)}}}},heatmap:function(t,n,r,i){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var o=t.context,a=o.gl,s=Ae.disabled,u=new Ce([a.ONE,a.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,n){var r=e.gl;e.activeTexture.set(r.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var i=n.heatmapFbo;if(i)r.bindTexture(r.TEXTURE_2D,i.colorAttachment.get()),e.bindFramebuffer.set(i.framebuffer);else{var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),i=n.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1),function e(t,n,r,i){var o=t.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,n.width/4,n.height/4,0,o.RGBA,t.extTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),i.colorAttachment.set(r),t.extTextureHalfFloat&&o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE&&(t.extTextureHalfFloat=null,i.colorAttachment.setDirty(),e(t,n,r,i))}(e,t,o,i)}}(o,t,r),o.clear({color:e.Color.transparent});for(var c=0;c<i.length;c++){var l=i[c];if(!n.hasRenderableParent(l)){var p=n.getTile(l),f=p.getBucket(r);if(f){var h=f.programConfigurations.get(r.id);t.useProgram("heatmap",h).draw(o,a.TRIANGLES,ke.disabled,s,u,Ie.disabled,Pn(l.posMatrix,p,t.transform.zoom,r.paint.get("heatmap-intensity")),r.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,r.paint,t.transform.zoom,h)}}}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,n){var r=t.context,i=r.gl,o=n.heatmapFbo;if(o){r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1);var a=n.colorRampTexture;a||(a=n.colorRampTexture=new e.Texture(r,n.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(r,i.TRIANGLES,ke.disabled,Ae.disabled,t.colorModeForRenderPass(),Ie.disabled,function(t,n,r,i){var o=e.create();e.ortho(o,0,t.width,t.height,0,0,1);var a=t.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}}(t,n),n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,n.paint,t.transform.zoom)}}(t,r))},line:function(t,n,r,i){if("translucent"===t.renderPass){var o=r.paint.get("line-opacity"),a=r.paint.get("line-width");if(0!==o.constantOr(1)&&0!==a.constantOr(1)){var s=t.depthModeForSublayer(0,ke.ReadOnly),u=t.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),l=r.paint.get("line-pattern"),p=l.constantOr(1),f=r.paint.get("line-gradient"),h=r.getCrossfadeParameters(),d=p?"linePattern":c?"lineSDF":f?"lineGradient":"line",m=t.context,g=m.gl,v=!0;if(f){m.activeTexture.set(g.TEXTURE0);var y=r.gradientTexture;if(!r.gradient)return;y||(y=r.gradientTexture=new e.Texture(m,r.gradient,g.RGBA)),y.bind(g.LINEAR,g.CLAMP_TO_EDGE)}for(var _=0,b=i;_<b.length;_+=1){var x=b[_],w=n.getTile(x);if(!p||w.patternsLoaded()){var S=w.getBucket(r);if(S){var E=S.programConfigurations.get(r.id),T=t.context.program.get(),k=t.useProgram(d,E),A=v||k.program!==T,C=l.constantOr(null);if(C&&w.imageAtlas){var I=w.imageAtlas,M=I.patternPositions[C.to.toString()],P=I.patternPositions[C.from.toString()];M&&P&&E.setConstantPatternPositions(M,P)}var O=p?zn(t,w,r,h):c?Nn(t,w,r,c,h):f?Dn(t,w,r):Rn(t,w,r);p?(m.activeTexture.set(g.TEXTURE0),w.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),E.updatePaintBuffers(h)):c&&(A||t.lineAtlas.dirty)&&(m.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(m)),k.draw(m,g.TRIANGLES,s,t.stencilModeForClipping(x),u,Ie.disabled,O,r.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,r.paint,t.transform.zoom,E),v=!1}}}}}},fill:function(t,n,r,i){var o=r.paint.get("fill-color"),a=r.paint.get("fill-opacity");if(0!==a.constantOr(1)){var s=t.colorModeForRenderPass(),u=r.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===o.constantOr(e.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){var l=t.depthModeForSublayer(1,"opaque"===t.renderPass?ke.ReadWrite:ke.ReadOnly);nr(t,n,r,i,l,s,!1)}if("translucent"===t.renderPass&&r.paint.get("fill-antialias")){var p=t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,ke.ReadOnly);nr(t,n,r,i,p,s,!0)}}},"fill-extrusion":function(e,t,n,r){var i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===e.renderPass){var o=new ke(e.context.gl.LEQUAL,ke.ReadWrite,e.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))rr(e,t,n,r,o,Ae.disabled,Ce.disabled),rr(e,t,n,r,o,e.stencilModeFor3D(),e.colorModeForRenderPass());else{var a=e.colorModeForRenderPass();rr(e,t,n,r,o,Ae.disabled,a)}}},hillshade:function(e,t,n,r){if("offscreen"===e.renderPass||"translucent"===e.renderPass){for(var i=e.context,o=t.getSource().maxzoom,a=e.depthModeForSublayer(0,ke.ReadOnly),s=e.colorModeForRenderPass(),u="translucent"===e.renderPass?e.stencilConfigForOverlap(r):[{},r],c=u[0],l=0,p=u[1];l<p.length;l+=1){var f=p[l],h=t.getTile(f);h.needsHillshadePrepare&&"offscreen"===e.renderPass?or(e,h,n,o,a,Ae.disabled,s):"translucent"===e.renderPass&&ir(e,h,n,a,c[f.overscaledZ],s)}i.viewport.set([0,0,e.width,e.height])}},raster:function(e,t,n,r){if("translucent"===e.renderPass&&0!==n.paint.get("raster-opacity")&&r.length)for(var i=e.context,o=i.gl,a=t.getSource(),s=e.useProgram("raster"),u=e.colorModeForRenderPass(),c=a instanceof O?[{},r]:e.stencilConfigForOverlap(r),l=c[0],p=c[1],f=p[p.length-1].overscaledZ,h=!e.options.moving,d=0,m=p;d<m.length;d+=1){var g=m[d],v=e.depthModeForSublayer(g.overscaledZ-f,1===n.paint.get("raster-opacity")?ke.ReadWrite:ke.ReadOnly,o.LESS),y=t.getTile(g),_=e.transform.calculatePosMatrix(g.toUnwrapped(),h);y.registerFadeDuration(n.paint.get("raster-fade-duration"));var b=t.findLoadedParent(g,0),x=ar(y,b,t,n,e.transform),w=void 0,S=void 0,E="nearest"===n.paint.get("raster-resampling")?o.NEAREST:o.LINEAR;i.activeTexture.set(o.TEXTURE0),y.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(o.TEXTURE1),b?(b.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,b.tileID.overscaledZ-y.tileID.overscaledZ),S=[y.tileID.canonical.x*w%1,y.tileID.canonical.y*w%1]):y.texture.bind(E,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST);var T=Bn(_,S||[0,0],w||1,x,n);a instanceof O?s.draw(i,o.TRIANGLES,v,Ae.disabled,u,Ie.disabled,T,n.id,a.boundsBuffer,e.quadTriangleIndexBuffer,a.boundsSegments):s.draw(i,o.TRIANGLES,v,l[g.overscaledZ],u,Ie.disabled,T,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,t,n){var r=n.paint.get("background-color"),i=n.paint.get("background-opacity");if(0!==i){var o=e.context,a=o.gl,s=e.transform,u=s.tileSize,c=n.paint.get("background-pattern");if(!e.isPatternMissing(c)){var l=!c&&1===r.a&&1===i&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass===l){var p=Ae.disabled,f=e.depthModeForSublayer(0,"opaque"===l?ke.ReadWrite:ke.ReadOnly),h=e.colorModeForRenderPass(),d=e.useProgram(c?"backgroundPattern":"background"),m=s.coveringTiles({tileSize:u});c&&(o.activeTexture.set(a.TEXTURE0),e.imageManager.bind(e.context));for(var g=n.getCrossfadeParameters(),v=0,y=m;v<y.length;v+=1){var _=y[v],b=e.transform.calculatePosMatrix(_.toUnwrapped()),x=c?Hn(b,i,e,c,{tileID:_,tileSize:u},g):Zn(b,i,r);d.draw(o,a.TRIANGLES,f,p,h,Ie.disabled,x,n.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}}}},debug:function(e,t,n){for(var r=0;r<n.length;r++)mr(e,t,n[r])},custom:function(e,t,n){var r=e.context,i=n.implementation;if("offscreen"===e.renderPass){var o=i.prerender;o&&(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),o.call(i,r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(Ae.disabled);var a="3d"===i.renderingMode?new ke(e.context.gl.LEQUAL,ke.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,ke.ReadOnly);r.setDepthMode(a),i.render(r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null)}}},vr=function(e,t){this.context=new Me(e),this.transform=t,this._tileTextures={},this.setup(),this.numSublayers=Pe.maxUnderzooming+Pe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Dt,this.gpuTimers={}};vr.prototype.resize=function(t,n){if(this.width=t*e.browser.devicePixelRatio,this.height=n*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var r=0,i=this.style._order;r<i.length;r+=1)this.style._layers[i[r]].resize()},vr.prototype.setup=function(){var t=this.context,n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(n,Ut.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var r=new e.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(r,Ut.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var i=new e.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(e.EXTENT,0,e.EXTENT,0),i.emplaceBack(0,e.EXTENT,0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(i,P.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(o,Ut.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var a=new e.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(a);var s=new e.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA);var u=this.context.gl;this.stencilClearMode=new Ae({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)},vr.prototype.clearStencil=function(){var t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=e.create();e.ortho(r,0,this.width,this.height,0,0,1),e.scale(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,n.TRIANGLES,ke.disabled,this.stencilClearMode,Ce.disabled,Ie.disabled,Mn(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},vr.prototype._renderTileClippingMasks=function(e,t){if(this.currentStencilSource!==e.source&&e.isTileClipped()&&t&&t.length){this.currentStencilSource=e.source;var n=this.context,r=n.gl;this.nextStencilID+t.length>256&&this.clearStencil(),n.setColorMode(Ce.disabled),n.setDepthMode(ke.disabled);var i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var o=0,a=t;o<a.length;o+=1){var s=a[o],u=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;i.draw(n,r.TRIANGLES,ke.disabled,new Ae({func:r.ALWAYS,mask:0},u,255,r.KEEP,r.KEEP,r.REPLACE),Ce.disabled,Ie.disabled,Mn(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},vr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var e=this.nextStencilID++,t=this.context.gl;return new Ae({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)},vr.prototype.stencilModeForClipping=function(e){var t=this.context.gl;return new Ae({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)},vr.prototype.stencilConfigForOverlap=function(e){var t,n=this.context.gl,r=e.sort((function(e,t){return t.overscaledZ-e.overscaledZ})),i=r[r.length-1].overscaledZ,o=r[0].overscaledZ-i+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var a={},s=0;s<o;s++)a[s+i]=new Ae({func:n.GEQUAL,mask:255},s+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[a,r]}return[(t={},t[i]=Ae.disabled,t),r]},vr.prototype.colorModeForRenderPass=function(){var t=this.context.gl;return this._showOverdrawInspector?new Ce([t.CONSTANT_COLOR,t.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ce.unblended:Ce.alphaBlended},vr.prototype.depthModeForSublayer=function(e,t,n){if(!this.opaquePassEnabledForLayer())return ke.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ke(n||this.context.gl.LEQUAL,t,[r,r])},vr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},vr.prototype.render=function(t,n){var r=this;this.style=t,this.options=n,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var i=this.style._order,o=this.style.sourceCaches;for(var a in o){var s=o[a];s.used&&s.prepare(this.context)}var u,c,l={},p={},f={};for(var h in o){var d=o[h];l[h]=d.getVisibleCoordinates(),p[h]=l[h].slice().reverse(),f[h]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<i.length;m++)if(this.style._layers[i[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var g=0,v=i;g<v.length;g+=1){var y=this.style._layers[v[g]];if(y.hasOffscreenPass()&&!y.isHidden(this.transform.zoom)){var _=p[y.source];("custom"===y.type||_.length)&&this.renderLayer(this,o[y.source],y,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var b=this.style._layers[i[this.currentLayer]],x=o[b.source],w=l[b.source];this._renderTileClippingMasks(b,w),this.renderLayer(this,x,b,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var S=this.style._layers[i[this.currentLayer]],E=o[S.source],T=("symbol"===S.type?f:p)[S.source];this._renderTileClippingMasks(S,l[S.source]),this.renderLayer(this,E,S,T)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach((function(e){e.source&&!e.isHidden(r.transform.zoom)&&(e.source!==(c&&c.id)&&(c=r.style.sourceCaches[e.source]),(!u||u.getSource().maxzoom<c.getSource().maxzoom)&&(u=c))})),u&&gr.debug(this,u,u.getVisibleCoordinates())),this.options.showPadding&&function(e){var t=e.transform.padding;fr(e,e.transform.height-(t.top||0),3,sr),fr(e,t.bottom||0,3,ur),hr(e,t.left||0,3,cr),hr(e,e.transform.width-(t.right||0),3,lr);var n=e.transform.centerPoint;!function(e,t,n,r){dr(e,t-1,n-10,2,20,r),dr(e,t-10,n-1,20,2,r)}(e,n.x,e.transform.height-n.y,pr)}(this),this.context.setDefault()},vr.prototype.renderLayer=function(e,t,n,r){n.isHidden(this.transform.zoom)||("background"===n.type||"custom"===n.type||r.length)&&(this.id=n.id,this.gpuTimingStart(n),gr[n.type](e,t,n,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},vr.prototype.gpuTimingStart=function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,n=this.gpuTimers[e.id];n||(n=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),n.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,n.query)}},vr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}},vr.prototype.collectGpuTimers=function(){var e=this.gpuTimers;return this.gpuTimers={},e},vr.prototype.queryGpuTimers=function(e){var t={};for(var n in e){var r=e[n],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(r.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r.query),t[n]=o}return t},vr.prototype.translatePosMatrix=function(t,n,r,i,o){if(!r[0]&&!r[1])return t;var a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){var s=Math.sin(a),u=Math.cos(a);r=[r[0]*u-r[1]*s,r[0]*s+r[1]*u]}var c=[o?r[0]:lt(n,r[0],this.transform.zoom),o?r[1]:lt(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return e.translate(l,t,c),l},vr.prototype.saveTileTexture=function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]},vr.prototype.getTileTexture=function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null},vr.prototype.isPatternMissing=function(e){if(!e)return!1;var t=this.imageManager.getPattern(e.from.toString()),n=this.imageManager.getPattern(e.to.toString());return!t||!n},vr.prototype.useProgram=function(e,t){this.cache=this.cache||{};var n=""+e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new yn(this.context,gn[e],t,Wn[e],this._showOverdrawInspector)),this.cache[n]},vr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},vr.prototype.setBaseState=function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)},vr.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},vr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var yr=function(e,t){this.points=e,this.planes=t};yr.fromInvProjectionMatrix=function(t,n,r){var i=Math.pow(2,r),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(n){return e.transformMat4([],n,t)})).map((function(t){return e.scale$1([],t,1/t[3]/n*i)})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(t){var n=e.sub([],o[t[0]],o[t[1]]),r=e.sub([],o[t[2]],o[t[1]]),i=e.normalize([],e.cross([],n,r)),a=-e.dot(i,o[t[1]]);return i.concat(a)}));return new yr(o,a)};var _r=function(t,n){this.min=t,this.max=n,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};_r.prototype.quadrant=function(t){for(var n=[t%2==0,t<2],r=e.clone$2(this.min),i=e.clone$2(this.max),o=0;o<n.length;o++)r[o]=n[o]?this.min[o]:this.center[o],i[o]=n[o]?this.center[o]:this.max[o];return i[2]=this.max[2],new _r(r,i)},_r.prototype.distanceX=function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]},_r.prototype.distanceY=function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]},_r.prototype.intersects=function(t){for(var n=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],r=!0,i=0;i<t.planes.length;i++){for(var o=t.planes[i],a=0,s=0;s<n.length;s++)a+=e.dot$1(o,n[s])>=0;if(0===a)return 0;a!==n.length&&(r=!1)}if(r)return 2;for(var u=0;u<3;u++){for(var c=Number.MAX_VALUE,l=-Number.MAX_VALUE,p=0;p<t.points.length;p++){var f=t.points[p][u]-this.min[u];c=Math.min(c,f),l=Math.max(l,f)}if(l<0||c>this.max[u]-this.min[u])return 0}return 1};var br=function(e,t,n,r){if(void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=r};br.prototype.interpolate=function(t,n,r){return null!=n.top&&null!=t.top&&(this.top=e.number(t.top,n.top,r)),null!=n.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,n.bottom,r)),null!=n.left&&null!=t.left&&(this.left=e.number(t.left,n.left,r)),null!=n.right&&null!=t.right&&(this.right=e.number(t.right,n.right,r)),this},br.prototype.getCenter=function(t,n){var r=e.clamp((this.left+t-this.right)/2,0,t),i=e.clamp((this.top+n-this.bottom)/2,0,n);return new e.Point(r,i)},br.prototype.equals=function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right},br.prototype.clone=function(){return new br(this.top,this.bottom,this.left,this.right)},br.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var xr=function(t,n,r,i,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new br,this._posMatrixCache={},this._alignedPosMatrixCache={}},wr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};xr.prototype.clone=function(){var e=new xr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._calcMatrices(),e},wr.minZoom.get=function(){return this._minZoom},wr.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))},wr.maxZoom.get=function(){return this._maxZoom},wr.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))},wr.minPitch.get=function(){return this._minPitch},wr.minPitch.set=function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))},wr.maxPitch.get=function(){return this._maxPitch},wr.maxPitch.set=function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))},wr.renderWorldCopies.get=function(){return this._renderWorldCopies},wr.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},wr.worldSize.get=function(){return this.tileSize*this.scale},wr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},wr.size.get=function(){return new e.Point(this.width,this.height)},wr.bearing.get=function(){return-this.angle/Math.PI*180},wr.bearing.set=function(t){var n=-e.wrap(t,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},wr.pitch.get=function(){return this._pitch/Math.PI*180},wr.pitch.set=function(t){var n=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())},wr.fov.get=function(){return this._fov/Math.PI*180},wr.fov.set=function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())},wr.zoom.get=function(){return this._zoom},wr.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},wr.center.get=function(){return this._center},wr.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},wr.padding.get=function(){return this._edgeInsets.toJSON()},wr.padding.set=function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())},wr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},xr.prototype.isPaddingEqual=function(e){return this._edgeInsets.equals(e)},xr.prototype.interpolatePadding=function(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()},xr.prototype.coveringZoomLevel=function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)},xr.prototype.getVisibleUnwrappedCoordinates=function(t){var n=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new e.Point(0,0)),i=this.pointCoordinate(new e.Point(this.width,0)),o=this.pointCoordinate(new e.Point(this.width,this.height)),a=this.pointCoordinate(new e.Point(0,this.height)),s=Math.floor(Math.min(r.x,i.x,o.x,a.x)),u=Math.floor(Math.max(r.x,i.x,o.x,a.x)),c=s-1;c<=u+1;c++)0!==c&&n.push(new e.UnwrappedTileID(c,t));return n},xr.prototype.coveringTiles=function(t){var n=this.coveringZoomLevel(t),r=n;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);var i=e.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,n),a=[o*i.x,o*i.y,0],s=yr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),u=t.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(u=n);var c=function(e){return{aabb:new _r([e*o,0,0],[(e+1)*o,o,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}},l=[],p=[],f=n,h=t.reparseOverscaled?r:n;if(this._renderWorldCopies)for(var d=1;d<=3;d++)l.push(c(-d)),l.push(c(d));for(l.push(c(0));l.length>0;){var m=l.pop(),g=m.x,v=m.y,y=m.fullyVisible;if(!y){var _=m.aabb.intersects(s);if(0===_)continue;y=2===_}var b=m.aabb.distanceX(a),x=m.aabb.distanceY(a),w=Math.max(Math.abs(b),Math.abs(x));if(m.zoom===f||w>3+(1<<f-m.zoom)-2&&m.zoom>=u)p.push({tileID:new e.OverscaledTileID(m.zoom===f?h:m.zoom,m.wrap,m.zoom,g,v),distanceSq:e.sqrLen([a[0]-.5-g,a[1]-.5-v])});else for(var S=0;S<4;S++){var E=(g<<1)+S%2,T=(v<<1)+(S>>1);l.push({aabb:m.aabb.quadrant(S),zoom:m.zoom+1,x:E,y:T,wrap:m.wrap,fullyVisible:y})}}return p.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))},xr.prototype.resize=function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()},wr.unmodified.get=function(){return this._unmodified},xr.prototype.zoomScale=function(e){return Math.pow(2,e)},xr.prototype.scaleZoom=function(e){return Math.log(e)/Math.LN2},xr.prototype.project=function(t){var n=e.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(t.lng)*this.worldSize,e.mercatorYfromLat(n)*this.worldSize)},xr.prototype.unproject=function(t){return new e.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()},wr.point.get=function(){return this.project(this.center)},xr.prototype.setLocationAtPoint=function(t,n){var r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(t),a=new e.MercatorCoordinate(o.x-(r.x-i.x),o.y-(r.y-i.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())},xr.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},xr.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},xr.prototype.locationCoordinate=function(t){return e.MercatorCoordinate.fromLngLat(t)},xr.prototype.coordinateLocation=function(e){return e.toLngLat()},xr.prototype.pointCoordinate=function(t){var n=[t.x,t.y,0,1],r=[t.x,t.y,1,1];e.transformMat4(n,n,this.pixelMatrixInverse),e.transformMat4(r,r,this.pixelMatrixInverse);var i=n[3],o=r[3],a=n[1]/i,s=r[1]/o,u=n[2]/i,c=r[2]/o,l=u===c?0:(0-u)/(c-u);return new e.MercatorCoordinate(e.number(n[0]/i,r[0]/o,l)/this.worldSize,e.number(a,s,l)/this.worldSize)},xr.prototype.coordinatePoint=function(t){var n=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(n,n,this.pixelMatrix),new e.Point(n[0]/n[3],n[1]/n[3])},xr.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},xr.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},xr.prototype.setMaxBounds=function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},xr.prototype.calculatePosMatrix=function(t,n){void 0===n&&(n=!1);var r=t.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];var o=t.canonical,a=this.worldSize/this.zoomScale(o.z),s=o.x+Math.pow(2,o.z)*t.wrap,u=e.identity(new Float64Array(16));return e.translate(u,u,[s*a,o.y*a,0]),e.scale(u,u,[a/e.EXTENT,a/e.EXTENT,1]),e.multiply(u,n?this.alignedProjMatrix:this.projMatrix,u),i[r]=new Float32Array(u),i[r]},xr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},xr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,n,r,i,o=-90,a=90,s=-180,u=180,c=this.size,l=this._unmodified;if(this.latRange){var p=this.latRange;o=e.mercatorYfromLat(p[1])*this.worldSize,t=(a=e.mercatorYfromLat(p[0])*this.worldSize)-o<c.y?c.y/(a-o):0}if(this.lngRange){var f=this.lngRange;s=e.mercatorXfromLng(f[0])*this.worldSize,n=(u=e.mercatorXfromLng(f[1])*this.worldSize)-s<c.x?c.x/(u-s):0}var h=this.point,d=Math.max(n||0,t||0);if(d)return this.center=this.unproject(new e.Point(n?(u+s)/2:h.x,t?(a+o)/2:h.y)),this.zoom+=this.scaleZoom(d),this._unmodified=l,void(this._constraining=!1);if(this.latRange){var m=h.y,g=c.y/2;m-g<o&&(i=o+g),m+g>a&&(i=a-g)}if(this.lngRange){var v=h.x,y=c.x/2;v-y<s&&(r=s+y),v+y>u&&(r=u-y)}void 0===r&&void 0===i||(this.center=this.unproject(new e.Point(void 0!==r?r:h.x,void 0!==i?i:h.y))),this._unmodified=l,this._constraining=!1}},xr.prototype._calcMatrices=function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var n=Math.PI/2+this._pitch,r=this._fov*(.5+t.y/this.height),i=Math.sin(r)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-n-r,.01,Math.PI-.01)),o=this.point,a=o.x,s=o.y,u=1.01*(Math.cos(Math.PI/2-this._pitch)*i+this.cameraToCenterDistance),c=this.height/50,l=new Float64Array(16);e.perspective(l,this._fov,this.width/this.height,c,u),l[8]=2*-t.x/this.width,l[9]=2*t.y/this.height,e.scale(l,l,[1,-1,1]),e.translate(l,l,[0,0,-this.cameraToCenterDistance]),e.rotateX(l,l,this._pitch),e.rotateZ(l,l,this.angle),e.translate(l,l,[-a,-s,0]),this.mercatorMatrix=e.scale([],l,[this.worldSize,this.worldSize,this.worldSize]),e.scale(l,l,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=l,this.invProjMatrix=e.invert([],this.projMatrix);var p=this.width%2/2,f=this.height%2/2,h=Math.cos(this.angle),d=Math.sin(this.angle),m=a-Math.round(a)+h*p+d*f,g=s-Math.round(s)+h*f+d*p,v=new Float64Array(l);if(e.translate(v,v,[m>.5?m-1:m,g>.5?g-1:g,0]),this.alignedProjMatrix=v,l=e.create(),e.scale(l,l,[this.width/2,-this.height/2,1]),e.translate(l,l,[1,-1,0]),this.labelPlaneMatrix=l,l=e.create(),e.scale(l,l,[1,-1,1]),e.translate(l,l,[-1,-1,0]),e.scale(l,l,[2/this.width,2/this.height,1]),this.glCoordMatrix=l,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(l=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=l,this._posMatrixCache={},this._alignedPosMatrixCache={}}},xr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new e.Point(0,0)),n=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.transformMat4(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance},xr.prototype.getCameraPoint=function(){var t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))},xr.prototype.getCameraQueryGeometry=function(t){var n=this.getCameraPoint();if(1===t.length)return[t[0],n];for(var r=n.x,i=n.y,o=n.x,a=n.y,s=0,u=t;s<u.length;s+=1){var c=u[s];r=Math.min(r,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}return[new e.Point(r,i),new e.Point(o,i),new e.Point(o,a),new e.Point(r,a),new e.Point(r,i)]},Object.defineProperties(xr.prototype,wr);var Sr=function(t){var n,r,i,o;this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),r=!1,i=null,o=function(){i=null,r&&(n(),i=setTimeout(o,300),r=!1)},function(){return r=!0,i||o(),i})};Sr.prototype.addTo=function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Sr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Sr.prototype.getHashString=function(t){var n=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,i=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),a=Math.round(n.lng*o)/o,s=Math.round(n.lat*o)/o,u=this._map.getBearing(),c=this._map.getPitch(),l="";if(l+=t?"/"+a+"/"+s+"/"+r:r+"/"+s+"/"+a,(u||c)&&(l+="/"+Math.round(10*u)/10),c&&(l+="/"+Math.round(c)),this._hashName){var p=this._hashName,f=!1,h=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];return t===p?(f=!0,t+"="+l):e})).filter((function(e){return e}));return f||h.push(p+"="+l),"#"+h.join("&")}return"#"+l},Sr.prototype._getCurrentHash=function(){var t,n=this,r=e.window.location.hash.replace("#","");return this._hashName?(r.split("&").map((function(e){return e.split("=")})).forEach((function(e){e[0]===n._hashName&&(t=e)})),(t&&t[1]||"").split("/")):r.split("/")},Sr.prototype._onHashChange=function(){var e=this._getCurrentHash();if(e.length>=3&&!e.some((function(e){return isNaN(e)}))){var t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},Sr.prototype._updateHashUnthrottled=function(){var t=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",t)}catch(e){}};var Er=function(t){function r(r,i,o,a){void 0===a&&(a={});var s=n.mousePos(i.getCanvasContainer(),o),u=i.unproject(s);t.call(this,r,e.extend({point:s,lngLat:u,originalEvent:o},a)),this._defaultPrevented=!1,this.target=i}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(e.Event),Tr=function(t){function r(r,i,o){var a=n.touchPos(i.getCanvasContainer(),o),s=a.map((function(e){return i.unproject(e)})),u=a.reduce((function(e,t,n,r){return e.add(t.div(r.length))}),new e.Point(0,0)),c=i.unproject(u);t.call(this,r,{points:a,point:u,lngLats:s,lngLat:c,originalEvent:o}),this._defaultPrevented=!1}t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r;var i={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,i),r}(e.Event),kr=function(e){function t(t,n,r){e.call(this,t,{originalEvent:r}),this._defaultPrevented=!1}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,n),t}(e.Event),Ar=function(t){this._map=t,this._el=t.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ar.prototype.setZoomRate=function(e){this._defaultZoomRate=e},Ar.prototype.setWheelZoomRate=function(e){this._wheelZoomRate=e},Ar.prototype.isEnabled=function(){return!!this._enabled},Ar.prototype.isActive=function(){return!!this._active},Ar.prototype.isZooming=function(){return!!this._zooming},Ar.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},Ar.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ar.prototype.onWheel=function(t){if(this.isEnabled()){var n=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,r=e.browser.now(),i=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==n&&n%4.000244140625==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this.isActive()||this._start(t)),t.preventDefault()}},Ar.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(e)},Ar.prototype._start=function(t){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new e.Event("movestart",{originalEvent:t})),this._map.fire(new e.Event("zoomstart",{originalEvent:t}))),this._finishTimeout&&clearTimeout(this._finishTimeout);var r=n.mousePos(this._el,t);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Ar.prototype._onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){var n=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,i=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var a="number"==typeof this._targetZoom?this._targetZoom:n.zoom,s=this._startZoom,u=this._easing,c=!1;if("wheel"===this._type&&s&&u){var l=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),p=u(l);n.zoom=e.number(s,a,p),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):c=!0}else n.zoom=a,c=!0;n.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new e.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new e.Event("zoom",{originalEvent:this._lastWheelEvent})),c&&(this._active=!1,this._finishTimeout=setTimeout((function(){t._zooming=!1,t._map.fire(new e.Event("zoomend",{originalEvent:t._lastWheelEvent})),t._map.fire(new e.Event("moveend",{originalEvent:t._lastWheelEvent})),delete t._targetZoom}),200))}},Ar.prototype._smoothOutEasing=function(t){var n=e.ease;if(this._prevEase){var r=this._prevEase,i=(e.browser.now()-r.start)/r.duration,o=r.easing(i+.01)-r.easing(i),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);n=e.bezier(a,s,.25,1)}return this._prevEase={start:e.browser.now(),duration:t,easing:n},n};var Cr=function(t,n){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=n.clickTolerance||1,e.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Cr.prototype.isEnabled=function(){return!!this._enabled},Cr.prototype.isActive=function(){return!!this._active},Cr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Cr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Cr.prototype.onMouseDown=function(t){this.isEnabled()&&t.shiftKey&&0===t.button&&(e.window.document.addEventListener("mousemove",this._onMouseMove,!1),e.window.document.addEventListener("keydown",this._onKeyDown,!1),e.window.document.addEventListener("mouseup",this._onMouseUp,!1),n.disableDrag(),this._startPos=this._lastPos=n.mousePos(this._el,t),this._active=!0)},Cr.prototype._onMouseMove=function(e){var t=n.mousePos(this._el,e);if(!(this._lastPos.equals(t)||!this._box&&t.dist(this._startPos)<this._clickTolerance)){var r=this._startPos;this._lastPos=t,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var i=Math.min(r.x,t.x),o=Math.max(r.x,t.x),a=Math.min(r.y,t.y),s=Math.max(r.y,t.y);n.setTransform(this._box,"translate("+i+"px,"+a+"px)"),this._box.style.width=o-i+"px",this._box.style.height=s-a+"px"}},Cr.prototype._onMouseUp=function(t){if(0===t.button){var r=this._startPos,i=n.mousePos(this._el,t);this._finish(),n.suppressClick(),r.x===i.x&&r.y===i.y?this._fireEvent("boxzoomcancel",t):this._map.fitScreenCoordinates(r,i,this._map.getBearing(),{linear:!0}).fire(new e.Event("boxzoomend",{originalEvent:t}))}},Cr.prototype._onKeyDown=function(e){27===e.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",e))},Cr.prototype._finish=function(){this._active=!1,e.window.document.removeEventListener("mousemove",this._onMouseMove,!1),e.window.document.removeEventListener("keydown",this._onKeyDown,!1),e.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},Cr.prototype._fireEvent=function(t,n){return this._map.fire(new e.Event(t,{originalEvent:n}))};var Ir=e.bezier(0,0,.25,1),Mr=function(t,n){this._map=t,this._el=n.element||t.getCanvasContainer(),this._state="disabled",this._button=n.button||"right",this._bearingSnap=n.bearingSnap||0,this._pitchWithRotate=!1!==n.pitchWithRotate,this._clickTolerance=n.clickTolerance||1,e.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};Mr.prototype.isEnabled=function(){return"disabled"!==this._state},Mr.prototype.isActive=function(){return"active"===this._state},Mr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},Mr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Mr.prototype.onMouseDown=function(t){if("enabled"===this._state){var r="touchstart"===t.type;if(r)this._startTime=Date.now();else if("right"===this._button){if(this._eventButton=n.mouseButton(t),t.altKey||t.metaKey)return;if(this._eventButton!==(t.ctrlKey?0:2))return}else{if(t.ctrlKey||0!==n.mouseButton(t))return;this._eventButton=0}n.disableDrag(),r?(e.window.document.addEventListener("touchmove",this._onMouseMove,{capture:!0}),e.window.document.addEventListener("touchend",this._onMouseUp)):(e.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),e.window.document.addEventListener("mouseup",this._onMouseUp)),e.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[e.browser.now(),this._map.getBearing()]],this._startPos=this._prevPos=this._lastPos=n.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},Mr.prototype._onMouseMove=function(e){var t=n.mousePos(this._el,e);this._lastPos.equals(t)||"pending"===this._state&&t.dist(this._startPos)<this._clickTolerance||(this._lastMoveEvent=e,this._lastPos=t,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",e),this._fireEvent("movestart",e),this._pitchWithRotate&&this._fireEvent("pitchstart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Mr.prototype._onDragFrame=function(){this._frameId=null;var t=this._lastMoveEvent;if(t){var n=this._map.transform,r=this._prevPos,i=this._lastPos,o=n.bearing-.8*(r.x-i.x),a=n.pitch- -.5*(r.y-i.y),s=this._inertia,u=s[s.length-1];this._drainInertiaBuffer(),s.push([e.browser.now(),this._map._normalizeBearing(o,u[1])]);var c=n.bearing;if(n.bearing=o,this._pitchWithRotate){var l=n.pitch;n.pitch=a,n.pitch!==l&&this._fireEvent("pitch",t)}n.bearing!==c&&this._fireEvent("rotate",t),this._fireEvent("move",t),delete this._lastMoveEvent,this._prevPos=this._lastPos}},Mr.prototype._onMouseUp=function(e){var t="touchend"===e.type;if(t&&this._startPos===this._lastPos&&Date.now()-this._startTime<300&&this._el.click(),t||n.mouseButton(e)===this._eventButton)switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(e);break;case"pending":this._state="enabled",this._unbind()}},Mr.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",e),this._pitchWithRotate&&this._fireEvent("pitchend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind()}},Mr.prototype._unbind=function(){e.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),e.window.document.removeEventListener("mouseup",this._onMouseUp),e.window.document.removeEventListener("touchmove",this._onMouseMove,{capture:!0}),e.window.document.removeEventListener("touchend",this._onMouseUp),e.window.removeEventListener("blur",this._onBlur),n.enableDrag()},Mr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._lastPos},Mr.prototype._inertialRotate=function(e){var t=this;this._fireEvent("rotateend",e),this._drainInertiaBuffer();var n=this._map,r=n.getBearing(),i=this._inertia,o=function(){Math.abs(r)<t._bearingSnap?n.resetNorth({noMoveStart:!0},{originalEvent:e}):t._fireEvent("moveend",e),t._pitchWithRotate&&t._fireEvent("pitchend",e)};if(i.length<2)o();else{var a=i[0],s=i[i.length-1],u=n._normalizeBearing(r,i[i.length-2][1]),c=s[1]-a[1],l=c<0?-1:1,p=(s[0]-a[0])/1e3;if(0!==c&&0!==p){var f=Math.abs(c*(.25/p));f>180&&(f=180);var h=f/180;u+=l*f*(h/2),Math.abs(n._normalizeBearing(u,0))<this._bearingSnap&&(u=n._normalizeBearing(0,u)),n.rotateTo(u,{duration:1e3*h,easing:Ir,noMoveStart:!0},{originalEvent:e})}else o()}},Mr.prototype._fireEvent=function(t,n){return this._map.fire(new e.Event(t,n?{originalEvent:n}:{}))},Mr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,n=e.browser.now();t.length>0&&n-t[0][0]>160;)t.shift()};var Pr={linearity:.3,easing:e.bezier(0,0,.3,1),maxSpeed:1400,deceleration:2500},Or=function(t,n){this._map=t,this._el=t.getCanvasContainer(),this._state="disabled",this._clickTolerance=n.clickTolerance||1,this._inertiaOptions=Pr,e.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Or.prototype.isEnabled=function(){return"disabled"!==this._state},Or.prototype.isActive=function(){return"active"===this._state},Or.prototype.enable=function(t){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled",this._inertiaOptions=e.extend(Pr,t))},Or.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Or.prototype.onMouseDown=function(t){"enabled"===this._state&&(t.ctrlKey||0!==n.mouseButton(t)||(n.addEventListener(e.window.document,"mousemove",this._onMove,{capture:!0}),n.addEventListener(e.window.document,"mouseup",this._onMouseUp),this._start(t)))},Or.prototype.onTouchStart=function(t){this.isEnabled()&&(t.touches&&t.touches.length>1&&("pending"===this._state||"active"===this._state)||(n.addEventListener(e.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.addEventListener(e.window.document,"touchend",this._onTouchEnd),this._start(t)))},Or.prototype._start=function(t){e.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._prevPos=this._lastPos=n.mousePos(this._el,t),this._startTouch=this._lastTouch=e.window.TouchEvent&&t instanceof e.window.TouchEvent?n.touchPos(this._el,t):null,this._inertia=[[e.browser.now(),this._startPos]]},Or.prototype._touchesMatch=function(e,t){return!(!e||!t||e.length!==t.length)&&e.every((function(e,n){return t[n]===e}))},Or.prototype._onMove=function(t){t.preventDefault();var r=e.window.TouchEvent&&t instanceof e.window.TouchEvent?n.touchPos(this._el,t):null,i=n.mousePos(this._el,t);(r?this._touchesMatch(this._lastTouch,r):this._lastPos.equals(i))||"pending"===this._state&&i.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=t,this._lastPos=i,this._lastTouch=r,this._drainInertiaBuffer(),this._inertia.push([e.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._shouldStart=!0),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},Or.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e)if(this._map.touchZoomRotate.isActive())this._abort(e);else if(this._shouldStart&&(this._fireEvent("dragstart",e),this._fireEvent("movestart",e),this._shouldStart=!1),this.isActive()){var t=this._map.transform;t.setLocationAtPoint(t.pointLocation(this._prevPos),this._lastPos),this._fireEvent("drag",e),this._fireEvent("move",e),this._prevPos=this._lastPos,delete this._lastMoveEvent}},Or.prototype._onMouseUp=function(e){if(0===n.mouseButton(e))switch(this._state){case"active":this._state="enabled",n.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind()}},Or.prototype._onTouchEnd=function(e){if(e.touches&&0!==e.touches.length)switch(this._state){case"pending":case"active":break;case"enabled":this.onTouchStart(e)}else switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},Or.prototype._abort=function(t){switch(this._state){case"active":this._state="enabled",this._shouldStart||(this._fireEvent("dragend",t),this._fireEvent("moveend",t)),this._unbind(),this._deactivate(),e.window.TouchEvent&&t instanceof e.window.TouchEvent&&t.touches.length>1&&n.addEventListener(e.window.document,"touchend",this._onTouchEnd);break;case"pending":this._state="enabled",this._unbind();break;case"enabled":this._unbind()}},Or.prototype._onBlur=function(e){this._abort(e)},Or.prototype._unbind=function(){n.removeEventListener(e.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),n.removeEventListener(e.window.document,"touchend",this._onTouchEnd),n.removeEventListener(e.window.document,"mousemove",this._onMove,{capture:!0}),n.removeEventListener(e.window.document,"mouseup",this._onMouseUp),n.removeEventListener(e.window,"blur",this._onBlur)},Or.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._prevPos,delete this._mouseDownPos,delete this._lastPos,delete this._startTouch,delete this._lastTouch,delete this._shouldStart},Or.prototype._inertialPan=function(e){this._fireEvent("dragend",e),this._drainInertiaBuffer();var t=this._inertia;if(t.length<2)this._fireEvent("moveend",e);else{var n=t[t.length-1],r=t[0],i=n[1].sub(r[1]),o=(n[0]-r[0])/1e3;if(0===o||n[1].equals(r[1]))this._fireEvent("moveend",e);else{var a=this._inertiaOptions,s=a.linearity,u=a.easing,c=a.maxSpeed,l=a.deceleration,p=i.mult(s/o),f=p.mag();f>c&&(f=c,p._unit()._mult(f));var h=f/(l*s),d=p.mult(-h/2);this._map.panBy(d,{duration:1e3*h,easing:u,noMoveStart:!0},{originalEvent:e})}}},Or.prototype._fireEvent=function(t,n){return this._map.fire(new e.Event(t,n?{originalEvent:n}:{}))},Or.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,n=e.browser.now();t.length>0&&n-t[0][0]>160;)t.shift()};var Lr=function(t){this._map=t,this._el=t.getCanvasContainer(),e.bindAll(["_onKeyDown"],this)};function Rr(e){return e*(2-e)}Lr.prototype.isEnabled=function(){return!!this._enabled},Lr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Lr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Lr.prototype._onKeyDown=function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t=0,n=0,r=0,i=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?r=-1:(o=1,e.preventDefault());break;default:return}var a=this._map,s=a.getZoom(),u={duration:300,delayEndEvents:500,easing:Rr,zoom:t?Math.round(s)+t*(e.shiftKey?2:1):s,bearing:a.getBearing()+15*n,pitch:a.getPitch()+10*r,offset:[100*-i,100*-o],center:a.getCenter()};a.easeTo(u,{originalEvent:e})}};var Dr=function(t){this._map=t,e.bindAll(["_onDblClick","_onZoomEnd"],this)};Dr.prototype.isEnabled=function(){return!!this._enabled},Dr.prototype.isActive=function(){return!!this._active},Dr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Dr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Dr.prototype.onTouchStart=function(e){var t=this;if(this.isEnabled()&&!(e.points.length>1))if(this._tapped){var n=this._tappedPoint;if(n&&n.dist(e.points[0])<=30){e.originalEvent.preventDefault();var r=function(){t._tapped&&t._zoom(e),t._map.off("touchcancel",i),t._resetTapped()},i=function(){t._map.off("touchend",r),t._resetTapped()};this._map.once("touchend",r),this._map.once("touchcancel",i)}else this._resetTapped()}else this._tappedPoint=e.points[0],this._tapped=setTimeout((function(){t._tapped=null,t._tappedPoint=null}),300)},Dr.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},Dr.prototype.onDblClick=function(e){this.isEnabled()&&(e.originalEvent.preventDefault(),this._zoom(e))},Dr.prototype._zoom=function(e){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(e.originalEvent.shiftKey?-1:1),{around:e.lngLat},e)},Dr.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var zr=e.bezier(0,0,.15,1),Nr=function(t){this._map=t,this._el=t.getCanvasContainer(),e.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Nr.prototype.isEnabled=function(){return!!this._enabled},Nr.prototype.enable=function(e){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)},Nr.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Nr.prototype.disableRotation=function(){this._rotationDisabled=!0},Nr.prototype.enableRotation=function(){this._rotationDisabled=!1},Nr.prototype.isActive=function(){return this.isEnabled()&&!!this._gestureIntent},Nr.prototype.onStart=function(t){if(this.isEnabled()&&2===t.touches.length){var r=n.mousePos(this._el,t.touches[0]),i=n.mousePos(this._el,t.touches[1]),o=r.add(i).div(2);this._startVec=r.sub(i),this._startAround=this._map.transform.pointLocation(o),this._gestureIntent=void 0,this._inertia=[],n.addEventListener(e.window.document,"touchmove",this._onMove,{passive:!1}),n.addEventListener(e.window.document,"touchend",this._onEnd)}},Nr.prototype._getTouchEventData=function(e){var t=n.mousePos(this._el,e.touches[0]),r=n.mousePos(this._el,e.touches[1]),i=t.sub(r);return{vec:i,center:t.add(r).div(2),scale:i.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*i.angleWith(this._startVec)/Math.PI}},Nr.prototype._onMove=function(t){if(2===t.touches.length){var n=this._getTouchEventData(t),r=n.vec,i=n.scale,o=n.bearing;if(!this._gestureIntent){var a=this._rotationDisabled&&1!==i||Math.abs(1-i)>.15;Math.abs(o)>10?this._gestureIntent="rotate":a&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new e.Event(this._gestureIntent+"start",{originalEvent:t})),this._map.fire(new e.Event("movestart",{originalEvent:t})),this._startVec=r)}this._lastTouchEvent=t,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),t.preventDefault()}},Nr.prototype._onTouchFrame=function(){this._frameId=null;var t=this._gestureIntent;if(t){var n=this._map.transform;this._startScale||(this._startScale=n.scale,this._startBearing=n.bearing);var r=this._getTouchEventData(this._lastTouchEvent),i=r.center,o=r.bearing,a=r.scale,s=n.pointLocation(i),u=n.locationPoint(s);"rotate"===t&&(n.bearing=this._startBearing+o),n.zoom=n.scaleZoom(this._startScale*a),n.setLocationAtPoint(this._startAround,u),this._map.fire(new e.Event(t,{originalEvent:this._lastTouchEvent})),this._map.fire(new e.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([e.browser.now(),a,i])}},Nr.prototype._onEnd=function(t){n.removeEventListener(e.window.document,"touchmove",this._onMove,{passive:!1}),n.removeEventListener(e.window.document,"touchend",this._onEnd);var r=this._gestureIntent,i=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,r){this._map.fire(new e.Event(r+"end",{originalEvent:t})),this._drainInertiaBuffer();var o=this._inertia,a=this._map;if(o.length<2)a.snapToNorth({},{originalEvent:t});else{var s=o[o.length-1],u=o[0],c=a.transform.scaleZoom(i*s[1]),l=a.transform.scaleZoom(i*u[1]),p=(s[0]-u[0])/1e3,f=s[2];if(0!==p&&c!==l){var h=.15*(c-l)/p;Math.abs(h)>2.5&&(h=h>0?2.5:-2.5);var d=1e3*Math.abs(h/(12*.15));a.easeTo({zoom:c+h*d/2e3,duration:d,easing:zr,around:this._aroundCenter?a.getCenter():a.unproject(f),noMoveStart:!0},{originalEvent:t})}else a.snapToNorth({},{originalEvent:t})}}},Nr.prototype._drainInertiaBuffer=function(){for(var t=this._inertia,n=e.browser.now();t.length>2&&n-t[0][0]>160;)t.shift()};var jr={scrollZoom:Ar,boxZoom:Cr,dragRotate:Mr,dragPan:Or,keyboard:Lr,doubleClickZoom:Dr,touchZoomRotate:Nr},Fr=function(t){function n(n,r){t.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=r.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n,n.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},n.prototype.setCenter=function(e,t){return this.jumpTo({center:e},t)},n.prototype.panBy=function(t,n,r){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},n),r)},n.prototype.panTo=function(t,n,r){return this.easeTo(e.extend({center:t},n),r)},n.prototype.getZoom=function(){return this.transform.zoom},n.prototype.setZoom=function(e,t){return this.jumpTo({zoom:e},t),this},n.prototype.zoomTo=function(t,n,r){return this.easeTo(e.extend({zoom:t},n),r)},n.prototype.zoomIn=function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this},n.prototype.zoomOut=function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this},n.prototype.getBearing=function(){return this.transform.bearing},n.prototype.setBearing=function(e,t){return this.jumpTo({bearing:e},t),this},n.prototype.getPadding=function(){return this.transform.padding},n.prototype.setPadding=function(e,t){return this.jumpTo({padding:e},t),this},n.prototype.rotateTo=function(t,n,r){return this.easeTo(e.extend({bearing:t},n),r)},n.prototype.resetNorth=function(t,n){return this.rotateTo(0,e.extend({duration:1e3},t),n),this},n.prototype.resetNorthPitch=function(t,n){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),n),this},n.prototype.snapToNorth=function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this},n.prototype.getPitch=function(){return this.transform.pitch},n.prototype.setPitch=function(e,t){return this.jumpTo({pitch:e},t),this},n.prototype.cameraForBounds=function(t,n){return t=e.LngLatBounds.convert(t),this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),0,n)},n.prototype._cameraForBoxAndBearing=function(t,n,r,i){var o={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=e.extend({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){var a=i.padding;i.padding={top:a,bottom:a,right:a,left:a}}i.padding=e.extend(o,i.padding);var s=this.transform,u=s.padding,c=s.project(e.LngLat.convert(t)),l=s.project(e.LngLat.convert(n)),p=c.rotate(-r*Math.PI/180),f=l.rotate(-r*Math.PI/180),h=new e.Point(Math.max(p.x,f.x),Math.max(p.y,f.y)),d=new e.Point(Math.min(p.x,f.x),Math.min(p.y,f.y)),m=h.sub(d),g=(s.width-(u.left+u.right+i.padding.left+i.padding.right))/m.x,v=(s.height-(u.top+u.bottom+i.padding.top+i.padding.bottom))/m.y;if(!(v<0||g<0)){var y=Math.min(s.scaleZoom(s.scale*Math.min(g,v)),i.maxZoom),_=e.Point.convert(i.offset),b=new e.Point(_.x+(i.padding.left-i.padding.right)/2,_.y+(i.padding.top-i.padding.bottom)/2).mult(s.scale/s.zoomScale(y));return{center:s.unproject(c.add(l).div(2).sub(b)),zoom:y,bearing:r}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},n.prototype.fitBounds=function(e,t,n){return this._fitInternal(this.cameraForBounds(e,t),t,n)},n.prototype.fitScreenCoordinates=function(t,n,r,i,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(t)),this.transform.pointLocation(e.Point.convert(n)),r,i),i,o)},n.prototype._fitInternal=function(t,n,r){return t?(delete(n=e.extend(t,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this},n.prototype.jumpTo=function(t,n){this.stop();var r=this.transform,i=!1,o=!1,a=!1;return"zoom"in t&&r.zoom!==+t.zoom&&(i=!0,r.zoom=+t.zoom),void 0!==t.center&&(r.center=e.LngLat.convert(t.center)),"bearing"in t&&r.bearing!==+t.bearing&&(o=!0,r.bearing=+t.bearing),"pitch"in t&&r.pitch!==+t.pitch&&(a=!0,r.pitch=+t.pitch),null==t.padding||r.isPaddingEqual(t.padding)||(r.padding=t.padding),this.fire(new e.Event("movestart",n)).fire(new e.Event("move",n)),i&&this.fire(new e.Event("zoomstart",n)).fire(new e.Event("zoom",n)).fire(new e.Event("zoomend",n)),o&&this.fire(new e.Event("rotatestart",n)).fire(new e.Event("rotate",n)).fire(new e.Event("rotateend",n)),a&&this.fire(new e.Event("pitchstart",n)).fire(new e.Event("pitch",n)).fire(new e.Event("pitchend",n)),this.fire(new e.Event("moveend",n))},n.prototype.easeTo=function(t,n){var r=this;this.stop(),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.browser.prefersReducedMotion)&&(t.duration=0);var i=this.transform,o=this.getZoom(),a=this.getBearing(),s=this.getPitch(),u=this.getPadding(),c="zoom"in t?+t.zoom:o,l="bearing"in t?this._normalizeBearing(t.bearing,a):a,p="pitch"in t?+t.pitch:s,f="padding"in t?t.padding:i.padding,h=e.Point.convert(t.offset),d=i.centerPoint.add(h),m=i.pointLocation(d),g=e.LngLat.convert(t.center||m);this._normalizeCenter(g);var v,y,_=i.project(m),b=i.project(g).sub(_),x=i.zoomScale(c-o);return t.around&&(v=e.LngLat.convert(t.around),y=i.locationPoint(v)),this._zooming=c!==o,this._rotating=a!==l,this._pitching=p!==s,this._padding=!i.isPaddingEqual(f),this._prepareEase(n,t.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease((function(t){if(r._zooming&&(i.zoom=e.number(o,c,t)),r._rotating&&(i.bearing=e.number(a,l,t)),r._pitching&&(i.pitch=e.number(s,p,t)),r._padding&&(i.interpolatePadding(u,f,t),d=i.centerPoint.add(h)),v)i.setLocationAtPoint(v,y);else{var m=i.zoomScale(i.zoom-o),g=c>o?Math.min(2,x):Math.max(.5,x),w=Math.pow(g,1-t),S=i.unproject(_.add(b.mult(t*w)).mult(m));i.setLocationAtPoint(i.renderWorldCopies?S.wrap():S,d)}r._fireMoveEvents(n)}),(function(){t.delayEndEvents?r._easeEndTimeoutID=setTimeout((function(){return r._afterEase(n)}),t.delayEndEvents):r._afterEase(n)}),t),this},n.prototype._prepareEase=function(t,n){this._moving=!0,n||this.fire(new e.Event("movestart",t)),this._zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&this.fire(new e.Event("pitchstart",t))},n.prototype._fireMoveEvents=function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))},n.prototype._afterEase=function(t){var n=this._zooming,r=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),r&&this.fire(new e.Event("rotateend",t)),i&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))},n.prototype.flyTo=function(t,n){var r=this;if(!t.essential&&e.browser.prefersReducedMotion){var i=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var o=this.transform,a=this.getZoom(),s=this.getBearing(),u=this.getPitch(),c=this.getPadding(),l="zoom"in t?e.clamp(+t.zoom,o.minZoom,o.maxZoom):a,p="bearing"in t?this._normalizeBearing(t.bearing,s):s,f="pitch"in t?+t.pitch:u,h="padding"in t?t.padding:o.padding,d=o.zoomScale(l-a),m=e.Point.convert(t.offset),g=o.centerPoint.add(m),v=o.pointLocation(g),y=e.LngLat.convert(t.center||v);this._normalizeCenter(y);var _=o.project(v),b=o.project(y).sub(_),x=t.curve,w=Math.max(o.width,o.height),S=w/d,E=b.mag();if("minZoom"in t){var T=e.clamp(Math.min(t.minZoom,a,l),o.minZoom,o.maxZoom),k=w/o.zoomScale(T-a);x=Math.sqrt(k/E*2)}var A=x*x;function C(e){var t=(S*S-w*w+(e?-1:1)*A*A*E*E)/(2*(e?S:w)*A*E);return Math.log(Math.sqrt(t*t+1)-t)}function I(e){return(Math.exp(e)-Math.exp(-e))/2}function M(e){return(Math.exp(e)+Math.exp(-e))/2}var P=C(0),O=function(e){return M(P)/M(P+x*e)},L=function(e){return w*((M(P)*(I(t=P+x*e)/M(t))-I(P))/A)/E;var t},R=(C(1)-P)/x;if(Math.abs(E)<1e-6||!isFinite(R)){if(Math.abs(w-S)<1e-6)return this.easeTo(t,n);var D=S<w?-1:1;R=Math.abs(Math.log(S/w))/x,L=function(){return 0},O=function(e){return Math.exp(D*x*e)}}return t.duration="duration"in t?+t.duration:1e3*R/("screenSpeed"in t?+t.screenSpeed/x:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=s!==p,this._pitching=f!==u,this._padding=!o.isPaddingEqual(h),this._prepareEase(n,!1),this._ease((function(t){var i=t*R,d=1/O(i);o.zoom=1===t?l:a+o.scaleZoom(d),r._rotating&&(o.bearing=e.number(s,p,t)),r._pitching&&(o.pitch=e.number(u,f,t)),r._padding&&(o.interpolatePadding(c,h,t),g=o.centerPoint.add(m));var v=1===t?y:o.unproject(_.add(b.mult(L(i))).mult(d));o.setLocationAtPoint(o.renderWorldCopies?v.wrap():v,g),r._fireMoveEvents(n)}),(function(){return r._afterEase(n)}),t),this},n.prototype.isEasing=function(){return!!this._easeFrameId},n.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var e=this._onEaseEnd;delete this._onEaseEnd,e.call(this)}return this},n.prototype._ease=function(t,n,r){!1===r.animate||0===r.duration?(t(1),n()):(this._easeStart=e.browser.now(),this._easeOptions=r,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},n.prototype._renderFrameCallback=function(){var t=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},n.prototype._normalizeBearing=function(t,n){t=e.wrap(t,-180,180);var r=Math.abs(t-n);return Math.abs(t-360-n)<r&&(t-=360),Math.abs(t+360-n)<r&&(t+=360),t},n.prototype._normalizeCenter=function(e){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}},n}(e.Evented),Br=function(t){void 0===t&&(t={}),this.options=t,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Br.prototype.getDefaultPosition=function(){return"bottom-right"},Br.prototype.onAdd=function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Br.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Br.prototype._updateEditLink=function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var r=n.reduce((function(e,t,r){return t.value&&(e+=t.key+"="+t.value+(r<n.length-1?"&":"")),e}),"?");t.href=e.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow"}},Br.prototype._updateData=function(e){!e||"metadata"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())},Br.prototype._updateAttributions=function(){if(this._map.style){var e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((function(e){return"string"!=typeof e?"":e}))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var n=this._map.style.sourceCaches;for(var r in n){var i=n[r];if(i.used){var o=i.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e.sort((function(e,t){return e.length-t.length}));var a=(e=e.filter((function(t,n){for(var r=n+1;r<e.length;r++)if(e[r].indexOf(t)>=0)return!1;return!0}))).join(" | ");a!==this._attribHTML&&(this._attribHTML=a,e.length?(this._innerContainer.innerHTML=a,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Br.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Ur=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Ur.prototype.onAdd=function(e){this._map=e,this._container=n.create("div","mapboxgl-ctrl");var t=n.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ur.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ur.prototype.getDefaultPosition=function(){return"bottom-left"},Ur.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Ur.prototype._logoRequired=function(){if(this._map.style){var e=this._map.style.sourceCaches;for(var t in e)if(e[t].getSource().mapbox_logo)return!0;return!1}},Ur.prototype._updateCompact=function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}};var Vr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Vr.prototype.add=function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t},Vr.prototype.remove=function(e){for(var t=this._currentlyRunning,n=0,r=t?this._queue.concat(t):this._queue;n<r.length;n+=1){var i=r[n];if(i.id===e)return void(i.cancelled=!0)}},Vr.prototype.run=function(){var e=this._currentlyRunning=this._queue;this._queue=[];for(var t=0,n=e;t<n.length;t+=1){var r=n[t];if(!r.cancelled&&(r.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Vr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Gr={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},qr=e.window.HTMLImageElement,Zr=e.window.HTMLElement,Hr=e.window.ImageBitmap,Wr=0,Yr=60,Xr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:Wr,maxPitch:Yr,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Kr=function(r){function i(t){var i=this;if(null!=(t=e.extend({},Xr,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<Wr)throw new Error("minPitch must be greater than or equal to "+Wr);if(null!=t.maxPitch&&t.maxPitch>Yr)throw new Error("maxPitch must be less than or equal to "+Yr);var o=new xr(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies);if(r.call(this,o,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new Vr,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Gr,t.locale),this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken),"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error("Container '"+t.container+"' not found.")}else{if(!(t.container instanceof Zr))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return i._update(!1)})),this.on("moveend",(function(){return i._update(!1)})),this.on("zoom",(function(){return i._update(!0)})),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),function(e,t){var r=e.getCanvasContainer(),i=null,o=!1,a=null;for(var s in jr)e[s]=new jr[s](e,t),t.interactive&&t[s]&&e[s].enable(t[s]);n.addEventListener(r,"mouseout",(function(t){e.fire(new Er("mouseout",e,t))})),n.addEventListener(r,"mousedown",(function(i){o=!0,a=n.mousePos(r,i);var s=new Er("mousedown",e,i);e.fire(s),s.defaultPrevented||(t.interactive&&!e.doubleClickZoom.isActive()&&e.stop(),e.boxZoom.onMouseDown(i),e.boxZoom.isActive()||e.dragPan.isActive()||e.dragRotate.onMouseDown(i),e.boxZoom.isActive()||e.dragRotate.isActive()||e.dragPan.onMouseDown(i))})),n.addEventListener(r,"mouseup",(function(t){var n=e.dragRotate.isActive();i&&!n&&e.fire(new Er("contextmenu",e,i)),i=null,o=!1,e.fire(new Er("mouseup",e,t))})),n.addEventListener(r,"mousemove",(function(t){if(!e.dragPan.isActive()&&!e.dragRotate.isActive()){for(var n=t.target;n&&n!==r;)n=n.parentNode;n===r&&e.fire(new Er("mousemove",e,t))}})),n.addEventListener(r,"mouseover",(function(t){for(var n=t.target;n&&n!==r;)n=n.parentNode;n===r&&e.fire(new Er("mouseover",e,t))})),n.addEventListener(r,"touchstart",(function(n){var r=new Tr("touchstart",e,n);e.fire(r),r.defaultPrevented||(t.interactive&&e.stop(),e.boxZoom.isActive()||e.dragRotate.isActive()||e.dragPan.onTouchStart(n),e.touchZoomRotate.onStart(n),e.doubleClickZoom.onTouchStart(r))}),{passive:!1}),n.addEventListener(r,"touchmove",(function(t){e.fire(new Tr("touchmove",e,t))}),{passive:!1}),n.addEventListener(r,"touchend",(function(t){e.fire(new Tr("touchend",e,t))})),n.addEventListener(r,"touchcancel",(function(t){e.fire(new Tr("touchcancel",e,t))})),n.addEventListener(r,"click",(function(i){var o=n.mousePos(r,i);(!a||o.equals(a)||o.dist(a)<t.clickTolerance)&&e.fire(new Er("click",e,i))})),n.addEventListener(r,"dblclick",(function(t){var n=new Er("dblclick",e,t);e.fire(n),n.defaultPrevented||e.doubleClickZoom.onDblClick(n)})),n.addEventListener(r,"contextmenu",(function(t){var n=e.dragRotate.isActive();o||n?o&&(i=t):e.fire(new Er("contextmenu",e,t)),(e.dragRotate.isEnabled()||e.listens("contextmenu"))&&t.preventDefault()})),n.addEventListener(r,"wheel",(function(n){t.interactive&&e.stop();var r=new kr("wheel",e,n);e.fire(r),r.defaultPrevented||e.scrollZoom.onWheel(n)}),{passive:!1})}(this,t),this._hash=t.hash&&new Sr("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new Br({customAttribution:t.customAttribution})),this.addControl(new Ur,t.logoPosition),this.on("style.load",(function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)})),this.on("data",(function(t){i._update("style"===t.dataType),i.fire(new e.Event(t.dataType+"data",t))})),this.on("dataloading",(function(t){i.fire(new e.Event(t.dataType+"dataloading",t))}))}r&&(i.__proto__=r),(i.prototype=Object.create(r&&r.prototype)).constructor=i;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return i.prototype._getMapId=function(){return this._mapId},i.prototype.addControl=function(t,n){if(void 0===n&&t.getDefaultPosition&&(n=t.getDefaultPosition()),void 0===n&&(n="top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=t.onAdd(this);this._controls.push(t);var i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this},i.prototype.removeControl=function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var n=this._controls.indexOf(t);return n>-1&&this._controls.splice(n,1),t.onRemove(this),this},i.prototype.resize=function(t){var n=this._containerDimensions(),r=n[0],i=n[1];return this._resizeCanvas(r,i),this.transform.resize(r,i),this.painter.resize(r,i),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)).fire(new e.Event("resize",t)).fire(new e.Event("moveend",t)),this},i.prototype.getBounds=function(){return this.transform.getBounds()},i.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},i.prototype.setMaxBounds=function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()},i.prototype.setMinZoom=function(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},i.prototype.getMinZoom=function(){return this.transform.minZoom},i.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},i.prototype.getMaxZoom=function(){return this.transform.maxZoom},i.prototype.setMinPitch=function(e){if((e=null==e?Wr:e)<Wr)throw new Error("minPitch must be greater than or equal to "+Wr);if(e>=Wr&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between "+Wr+" and the current maxPitch, inclusive")},i.prototype.getMinPitch=function(){return this.transform.minPitch},i.prototype.setMaxPitch=function(e){if((e=null==e?Yr:e)>Yr)throw new Error("maxPitch must be less than or equal to "+Yr);if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")},i.prototype.getMaxPitch=function(){return this.transform.maxPitch},i.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},i.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update()},i.prototype.project=function(t){return this.transform.locationPoint(e.LngLat.convert(t))},i.prototype.unproject=function(t){return this.transform.pointLocation(e.Point.convert(t))},i.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},i.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},i.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},i.prototype._createDelegatedListener=function(e,t,n){var r,i=this;if("mouseenter"===e||"mouseover"===e){var o=!1;return{layer:t,listener:n,delegates:{mousemove:function(r){var a=i.getLayer(t)?i.queryRenderedFeatures(r.point,{layers:[t]}):[];a.length?o||(o=!0,n.call(i,new Er(e,i,r.originalEvent,{features:a}))):o=!1},mouseout:function(){o=!1}}}}if("mouseleave"===e||"mouseout"===e){var a=!1;return{layer:t,listener:n,delegates:{mousemove:function(r){(i.getLayer(t)?i.queryRenderedFeatures(r.point,{layers:[t]}):[]).length?a=!0:a&&(a=!1,n.call(i,new Er(e,i,r.originalEvent)))},mouseout:function(t){a&&(a=!1,n.call(i,new Er(e,i,t.originalEvent)))}}}}return{layer:t,listener:n,delegates:(r={},r[e]=function(e){var r=i.getLayer(t)?i.queryRenderedFeatures(e.point,{layers:[t]}):[];r.length&&(e.features=r,n.call(i,e),delete e.features)},r)}},i.prototype.on=function(e,t,n){if(void 0===n)return r.prototype.on.call(this,e,t);var i=this._createDelegatedListener(e,t,n);for(var o in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(i),i.delegates)this.on(o,i.delegates[o]);return this},i.prototype.once=function(e,t,n){if(void 0===n)return r.prototype.once.call(this,e,t);var i=this._createDelegatedListener(e,t,n);for(var o in i.delegates)this.once(o,i.delegates[o]);return this},i.prototype.off=function(e,t,n){var i=this;return void 0===n?r.prototype.off.call(this,e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&function(r){for(var o=r[e],a=0;a<o.length;a++){var s=o[a];if(s.layer===t&&s.listener===n){for(var u in s.delegates)i.off(u,s.delegates[u]);return o.splice(a,1),i}}}(this._delegatedListeners),this)},i.prototype.queryRenderedFeatures=function(t,n){if(!this.style)return[];var r;if(void 0!==n||void 0===t||t instanceof e.Point||Array.isArray(t)||(n=t,t=void 0),n=n||{},(t=t||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof t[0])r=[e.Point.convert(t)];else{var i=e.Point.convert(t[0]),o=e.Point.convert(t[1]);r=[i,new e.Point(o.x,i.y),o,new e.Point(i.x,o.y),i]}return this.style.queryRenderedFeatures(r,n,this.transform)},i.prototype.querySourceFeatures=function(e,t){return this.style.querySourceFeatures(e,t)},i.prototype.setStyle=function(t,n){return!1!==(n=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(t,n))},i.prototype._getUIString=function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '"+e+"'");return t},i.prototype._updateStyle=function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove()),e?(this.style=new Bt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e),this):(delete this.style,this)},i.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Bt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},i.prototype._diffStyle=function(t,n){var r=this;if("string"==typeof t){var i=this._requestManager.normalizeStyleURL(t),o=this._requestManager.transformRequest(i,e.ResourceType.Style);e.getJSON(o,(function(t,i){t?r.fire(new e.ErrorEvent(t)):i&&r._updateDiff(i,n)}))}else"object"==typeof t&&this._updateDiff(t,n)},i.prototype._updateDiff=function(t,n){try{this.style.setState(t)&&this._update(!0)}catch(r){e.warnOnce("Unable to perform style diff: "+(r.message||r.error||r)+".  Rebuilding the style from scratch."),this._updateStyle(t,n)}},i.prototype.getStyle=function(){if(this.style)return this.style.serialize()},i.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},i.prototype.addSource=function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)},i.prototype.isSourceLoaded=function(t){var n=this.style&&this.style.sourceCaches[t];if(void 0!==n)return n.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},i.prototype.areTilesLoaded=function(){var e=this.style&&this.style.sourceCaches;for(var t in e){var n=e[t]._tiles;for(var r in n){var i=n[r];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},i.prototype.addSourceType=function(e,t,n){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,n)},i.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0)},i.prototype.getSource=function(e){return this.style.getSource(e)},i.prototype.addImage=function(t,n,r){void 0===r&&(r={});var i=r.pixelRatio;void 0===i&&(i=1);var o=r.sdf;void 0===o&&(o=!1);var a=r.stretchX,s=r.stretchY,u=r.content;if(this._lazyInitEmptyStyle(),n instanceof qr||Hr&&n instanceof Hr){var c=e.browser.getImageData(n);this.style.addImage(t,{data:new e.RGBAImage({width:c.width,height:c.height},c.data),pixelRatio:i,stretchX:a,stretchY:s,content:u,sdf:o,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var l=n;this.style.addImage(t,{data:new e.RGBAImage({width:n.width,height:n.height},new Uint8Array(n.data)),pixelRatio:i,stretchX:a,stretchY:s,content:u,sdf:o,version:0,userImage:l}),l.onAdd&&l.onAdd(this,t)}},i.prototype.updateImage=function(t,n){var r=this.style.getImage(t);if(!r)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=n instanceof qr||Hr&&n instanceof Hr?e.browser.getImageData(n):n,o=i.width,a=i.height,s=i.data;return void 0===o||void 0===a?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==r.data.width||a!==r.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(r.data.replace(s,!(n instanceof qr||Hr&&n instanceof Hr)),void this.style.updateImage(t,r))},i.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},i.prototype.removeImage=function(e){this.style.removeImage(e)},i.prototype.loadImage=function(t,n){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),n)},i.prototype.listImages=function(){return this.style.listImages()},i.prototype.addLayer=function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)},i.prototype.moveLayer=function(e,t){return this.style.moveLayer(e,t),this._update(!0)},i.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0)},i.prototype.getLayer=function(e){return this.style.getLayer(e)},i.prototype.setLayerZoomRange=function(e,t,n){return this.style.setLayerZoomRange(e,t,n),this._update(!0)},i.prototype.setFilter=function(e,t,n){return void 0===n&&(n={}),this.style.setFilter(e,t,n),this._update(!0)},i.prototype.getFilter=function(e){return this.style.getFilter(e)},i.prototype.setPaintProperty=function(e,t,n,r){return void 0===r&&(r={}),this.style.setPaintProperty(e,t,n,r),this._update(!0)},i.prototype.getPaintProperty=function(e,t){return this.style.getPaintProperty(e,t)},i.prototype.setLayoutProperty=function(e,t,n,r){return void 0===r&&(r={}),this.style.setLayoutProperty(e,t,n,r),this._update(!0)},i.prototype.getLayoutProperty=function(e,t){return this.style.getLayoutProperty(e,t)},i.prototype.setLight=function(e,t){return void 0===t&&(t={}),this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)},i.prototype.getLight=function(){return this.style.getLight()},i.prototype.setFeatureState=function(e,t){return this.style.setFeatureState(e,t),this._update()},i.prototype.removeFeatureState=function(e,t){return this.style.removeFeatureState(e,t),this._update()},i.prototype.getFeatureState=function(e){return this.style.getFeatureState(e)},i.prototype.getContainer=function(){return this._container},i.prototype.getCanvasContainer=function(){return this._canvasContainer},i.prototype.getCanvas=function(){return this._canvas},i.prototype._containerDimensions=function(){var e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]},i.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},i.prototype._setupContainer=function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=n.create("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var i=this._controlContainer=n.create("div","mapboxgl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){o[e]=n.create("div","mapboxgl-ctrl-"+e,i)}))},i.prototype._resizeCanvas=function(t,n){var r=e.browser.devicePixelRatio||1;this._canvas.width=r*t,this._canvas.height=r*n,this._canvas.style.width=t+"px",this._canvas.style.height=n+"px"},i.prototype._setupPainter=function(){var n=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);r?(this.painter=new vr(r,this.transform),e.webpSupported.testSupport(r)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},i.prototype._contextLost=function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))},i.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))},i.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},i.prototype._update=function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this},i.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},i.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},i.prototype._render=function(){var t,n=this,r=0,i=this.painter.context.extTimerQuery;this.listens("gpu-timing-frame")&&(t=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,t),r=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var a=this.transform.zoom,s=e.browser.now();this.style.zoomHistory.update(a,s);var u=new e.EvaluationParameters(a,{now:s,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();1===c&&c===this._crossFadingFactor||(o=!0,this._crossFadingFactor=c),this.style.update(u)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var l=e.browser.now()-r;i.endQueryEXT(i.TIME_ELAPSED_EXT,t),setTimeout((function(){var r=i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(t),n.fire(new e.Event("gpu-timing-frame",{cpuTime:l,gpuTime:r}))}),50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout((function(){var t=n.painter.queryGpuTimers(p);n.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this},i.prototype.remove=function(){this._hash&&this._hash.remove();for(var t=0,n=this._controls;t<n.length;t+=1)n[t].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),Jr(this._canvasContainer),Jr(this._controlContainer),Jr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new e.Event("remove"))},i.prototype.triggerRepaint=function(){var t=this;this.style&&!this._frame&&(this._frame=e.browser.frame((function(e){t._frame=null,t._render()})))},i.prototype._onWindowOnline=function(){this._update()},i.prototype._onWindowResize=function(e){this._trackResize&&this.resize({originalEvent:e})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(e){this._showPadding!==e&&(this._showPadding=e,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(e){this._vertices=e,this._update()},i.prototype._setCacheLimits=function(t,n){e.setCacheLimits(t,n)},o.version.get=function(){return e.version},Object.defineProperties(i.prototype,o),i}(Fr);function Jr(e){e.parentNode&&e.parentNode.removeChild(e)}var Qr={showCompass:!0,showZoom:!0,visualizePitch:!1},$r=function(t){var r=this;this.options=e.extend({},Qr,t),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){return r._map.zoomIn({},{originalEvent:e})})),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){return r._map.zoomOut({},{originalEvent:e})})),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){r.options.visualizePitch?r._map.resetNorthPitch({},{originalEvent:e}):r._map.resetNorth({},{originalEvent:e})})),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};function ei(t,n,r){if(t=new e.LngLat(t.lng,t.lat),n){var i=new e.LngLat(t.lng-360,t.lat),o=new e.LngLat(t.lng+360,t.lat),a=r.locationPoint(t).distSqr(n);r.locationPoint(i).distSqr(n)<a?t=i:r.locationPoint(o).distSqr(n)<a&&(t=o)}for(;Math.abs(t.lng-r.center.lng)>180;){var s=r.locationPoint(t);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}$r.prototype._updateZoomButtons=function(){var e=this._map.getZoom();this._zoomInButton.disabled=e===this._map.getMaxZoom(),this._zoomOutButton.disabled=e===this._map.getMinZoom()},$r.prototype._rotateCompassArrow=function(){var e=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=e},$r.prototype.onAdd=function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mr(e,{button:"left",element:this._compass,clickTolerance:e.dragRotate._clickTolerance}),n.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),n.addEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.enable()),this._container},$r.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),n.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),n.removeEventListener(this._compass,"touchstart",this._handler.onMouseDown,{passive:!1}),this._handler.disable(),delete this._handler),delete this._map},$r.prototype._createButton=function(e,t){var r=n.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r},$r.prototype._setButtonTitle=function(e,t){var n=this._map._getUIString("NavigationControl."+t);e.title=n,e.setAttribute("aria-label",n)};var ti={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ni(e,t,n){var r=e.classList;for(var i in ti)r.remove("mapboxgl-"+n+"-anchor-"+i);r.add("mapboxgl-"+n+"-anchor-"+t)}var ri,ii=function(t){function r(r,i){var o=this;if(t.call(this),(r instanceof e.window.HTMLElement||i)&&(r=e.extend({element:r},i)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._draggable=r&&r.draggable||!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&"auto"!==r.pitchAlignment?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=e.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var a=n.createNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height","41px"),a.setAttributeNS(null,"width","27px"),a.setAttributeNS(null,"viewBox","0 0 27 41");var s=n.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");var u=n.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill-rule","nonzero");var c=n.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"transform","translate(3.0, 29.0)"),c.setAttributeNS(null,"fill","#000000");for(var l=0,p=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<p.length;l+=1){var f=p[l],h=n.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04"),h.setAttributeNS(null,"cx","10.5"),h.setAttributeNS(null,"cy","5.80029008"),h.setAttributeNS(null,"rx",f.rx),h.setAttributeNS(null,"ry",f.ry),c.appendChild(h)}var d=n.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill",this._color);var m=n.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),d.appendChild(m);var g=n.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"fill","#000000");var v=n.createNS("http://www.w3.org/2000/svg","path");v.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),g.appendChild(v);var y=n.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),y.setAttributeNS(null,"fill","#FFFFFF");var _=n.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(8.0, 8.0)");var b=n.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#000000"),b.setAttributeNS(null,"opacity","0.25"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962");var x=n.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962"),_.appendChild(b),_.appendChild(x),u.appendChild(c),u.appendChild(d),u.appendChild(g),u.appendChild(y),u.appendChild(_),a.appendChild(u),this._element.appendChild(a),this._offset=e.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(e){e.preventDefault()})),this._element.addEventListener("mousedown",(function(e){e.preventDefault()})),this._element.addEventListener("focus",(function(){var e=o._map.getContainer();e.scrollTop=0,e.scrollLeft=0})),ni(this._element,this._anchor,"marker"),this._popup=null}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},r.prototype._onKeyPress=function(e){var t=e.code,n=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==n&&13!==n||this.togglePopup()},r.prototype._onMapClick=function(e){var t=e.originalEvent.target,n=this._element;this._popup&&(t===n||n.contains(t))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},r.prototype._update=function(e){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ei(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var t="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?t="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(t="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX("+this._map.getPitch()+"deg)"),e&&"moveend"!==e.type||(this._pos=this._pos.round()),n.setTransform(this._element,ti[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+r+" "+t)}},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(t){return this._offset=e.Point.convert(t),this._update(),this},r.prototype._onMove=function(t){this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r.prototype.setRotation=function(e){return this._rotation=e||0,this._update(),this},r.prototype.getRotation=function(){return this._rotation},r.prototype.setRotationAlignment=function(e){return this._rotationAlignment=e||"auto",this._update(),this},r.prototype.getRotationAlignment=function(){return this._rotationAlignment},r.prototype.setPitchAlignment=function(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this},r.prototype.getPitchAlignment=function(){return this._pitchAlignment},r}(e.Evented),oi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ai=0,si=!1,ui=function(t){function r(n){t.call(this),this.options=e.extend({},oi,n),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.onAdd=function(t){var r;return this._map=t,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==ri?r(ri):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){r(ri="denied"!==e.state)})):r(ri=!!e.window.navigator.geolocation),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ai=0,si=!1},r.prototype._isOutOfMapMaxBounds=function(e){var t=this._map.getMaxBounds(),n=e.coords;return t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())},r.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},r.prototype._onSuccess=function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}},r.prototype._updateCamera=function(t){var n=new e.LngLat(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,i=this._map.getBearing(),o=e.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(r),o,{geolocateSource:!0})},r.prototype._updateMarker=function(t){if(t){var n=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},r.prototype._updateCircleRadius=function(){var e=this._map._container.clientHeight/2,t=this._map.unproject([0,e]),n=this._map.unproject([1,e]),r=t.distanceTo(n),i=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=i+"px",this._circleElement.style.height=i+"px"},r.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},r.prototype._onError=function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&si)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(t){var r=this;if(this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{var o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ii(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ii({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(t){t.geolocateSource||"ACTIVE_LOCK"!==r._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new e.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ai--,si=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ai>1?(t={maximumAge:6e5,timeout:0},si=!0):(t=this.options.positionOptions,si=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(e.Evented),ci={maxWidth:100,unit:"metric"},li=function(t){this.options=e.extend({},ci,t),e.bindAll(["_onMove","setUnit"],this)};function pi(e,t,n){var r=n&&n.maxWidth||100,i=e._container.clientHeight/2,o=e.unproject([0,i]),a=e.unproject([r,i]),s=o.distanceTo(a);if(n&&"imperial"===n.unit){var u=3.2808*s;u>5280?fi(t,r,u/5280,e._getUIString("ScaleControl.Miles")):fi(t,r,u,e._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?fi(t,r,s/1852,e._getUIString("ScaleControl.NauticalMiles")):s>=1e3?fi(t,r,s/1e3,e._getUIString("ScaleControl.Kilometers")):fi(t,r,s,e._getUIString("ScaleControl.Meters"))}function fi(e,t,n,r){var i,o,a,s=(i=n,(o=Math.pow(10,(""+Math.floor(i)).length-1))*(a=(a=i/o)>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(a)));e.style.width=t*(s/n)+"px",e.innerHTML=s+"&nbsp;"+r}li.prototype.getDefaultPosition=function(){return"bottom-left"},li.prototype._onMove=function(){pi(this._map,this._container,this.options)},li.prototype.onAdd=function(e){return this._map=e,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},li.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},li.prototype.setUnit=function(e){this.options.unit=e,pi(this._map,this._container,this.options)};var hi=function(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};hi.prototype.onAdd=function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},hi.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},hi.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},hi.prototype._setupUI=function(){var t=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},hi.prototype._updateTitle=function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e},hi.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},hi.prototype._isFullscreen=function(){return this._fullscreen},hi.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},hi.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var di={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},mi=function(t){function r(n){t.call(this),this.options=e.extend(Object.create(di),n),e.bindAll(["_update","_onClose","remove"],this)}return t&&(r.__proto__=t),(r.prototype=Object.create(t&&t.prototype)).constructor=r,r.prototype.addTo=function(t){var n=this;return this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",(function(e){n._update(e.point)})),this._map.on("mouseup",(function(e){n._update(e.point)})),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new e.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},r.prototype.trackPointer=function(){var e=this;return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",(function(t){e._update(t.point)})),this._map.on("drag",(function(t){e._update(t.point)})),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},r.prototype.getElement=function(){return this._container},r.prototype.setText=function(t){return this.setDOMContent(e.window.document.createTextNode(t))},r.prototype.setHTML=function(t){var n,r=e.window.document.createDocumentFragment(),i=e.window.document.createElement("body");for(i.innerHTML=t;n=i.firstChild;)r.appendChild(n);return this.setDOMContent(r)},r.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},r.prototype.setMaxWidth=function(e){return this.options.maxWidth=e,this._update(),this},r.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},r.prototype.addClassName=function(e){this._container&&this._container.classList.add(e)},r.prototype.removeClassName=function(e){this._container&&this._container.classList.remove(e)},r.prototype.toggleClassName=function(e){if(this._container)return this._container.classList.toggle(e)},r.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},r.prototype._update=function(t){var r=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(e){return r._container.classList.add(e)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ei(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||t)){var i=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat),o=this.options.anchor,a=function t(n){if(n){if("number"==typeof n){var r=Math.round(Math.sqrt(.5*Math.pow(n,2)));return{center:new e.Point(0,0),top:new e.Point(0,n),"top-left":new e.Point(r,r),"top-right":new e.Point(-r,r),bottom:new e.Point(0,-n),"bottom-left":new e.Point(r,-r),"bottom-right":new e.Point(-r,-r),left:new e.Point(n,0),right:new e.Point(-n,0)}}if(n instanceof e.Point||Array.isArray(n)){var i=e.Point.convert(n);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:e.Point.convert(n.center||[0,0]),top:e.Point.convert(n.top||[0,0]),"top-left":e.Point.convert(n["top-left"]||[0,0]),"top-right":e.Point.convert(n["top-right"]||[0,0]),bottom:e.Point.convert(n.bottom||[0,0]),"bottom-left":e.Point.convert(n["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(n["bottom-right"]||[0,0]),left:e.Point.convert(n.left||[0,0]),right:e.Point.convert(n.right||[0,0])}}return t(new e.Point(0,0))}(this.options.offset);if(!o){var s,u=this._container.offsetWidth,c=this._container.offsetHeight;s=i.y+a.bottom.y<c?["top"]:i.y>this._map.transform.height-c?["bottom"]:[],i.x<u/2?s.push("left"):i.x>this._map.transform.width-u/2&&s.push("right"),o=0===s.length?"bottom":s.join("-")}var l=i.add(a[o]).round();n.setTransform(this._container,ti[o]+" translate("+l.x+"px,"+l.y+"px)"),ni(this._container,o,"popup")}},r.prototype._onClose=function(){this.remove()},r}(e.Evented),gi={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Kr,NavigationControl:$r,GeolocateControl:ui,AttributionControl:Br,ScaleControl:li,FullscreenControl:hi,Popup:mi,Marker:ii,Style:Bt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return De.workerCount},set workerCount(e){De.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:""};return gi})),n}))},"4cb6":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm");t.METADATA_KEY=r;var i=n("9Fde");t.Container=i.Container;var o=n("FV85");t.BindingScopeEnum=o.BindingScopeEnum,t.BindingTypeEnum=o.BindingTypeEnum,t.TargetTypeEnum=o.TargetTypeEnum;var a=n("dxzI");t.AsyncContainerModule=a.AsyncContainerModule,t.ContainerModule=a.ContainerModule;var s=n("cZ5Q");t.injectable=s.injectable;var u=n("0gSV");t.tagged=u.tagged;var c=n("ZzCi");t.named=c.named;var l=n("Yk9n");t.inject=l.inject,t.LazyServiceIdentifer=l.LazyServiceIdentifer;var p=n("jYx5");t.optional=p.optional;var f=n("n2J3");t.unmanaged=f.unmanaged;var h=n("jIg/");t.multiInject=h.multiInject;var d=n("oaX6");t.targetName=d.targetName;var m=n("Sk89");t.postConstruct=m.postConstruct;var g=n("wnjb");t.MetadataReader=g.MetadataReader;var v=n("d9O0");t.id=v.id;var y=n("Ztfv");t.decorate=y.decorate;var _=n("RR/i");t.traverseAncerstors=_.traverseAncerstors,t.taggedConstraint=_.taggedConstraint,t.namedConstraint=_.namedConstraint,t.typeConstraint=_.typeConstraint;var b=n("ujMp");t.getServiceIdentifierAsString=b.getServiceIdentifierAsString;var x=n("78VC");t.multiBindToService=x.multiBindToService},"4qC0":function(e,t,n){var r=n("NykK"),i=n("Z0cm"),o=n("ExA7"),a="[object String]";function s(e){return"string"==typeof e||!i(e)&&o(e)&&r(e)==a}e.exports=s},"5gLl":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("lSNA"),i=n.n(r),o=n("Aib3"),a=n.n(o),s=n("AKIq"),u=n("cWyK");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){a()(e,!0);var n=[],r={};if(e.features=e.features.filter((function(e){var t=e.geometry;return null!=e&&t&&t.type&&t.coordinates&&t.coordinates.length>0})),0===e.features.length)return{dataArray:[],featureKeys:r};return u["flattenEach"](e,(function(e,t){var r=Object(s["getCoords"])(e),i=t;if("Polygon"===e.geometry.type)r.forEach((function(t){var r=l({},e.properties,{coordinates:[t],_id:i});n.push(r)}));else{var o=l({},e.properties,{coordinates:r,_id:i});n.push(o)}})),{dataArray:n,featureKeys:r}}},"5ku3":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n("U8pU"),i=n("I0ug");function o(){var t="object"===("undefined"===typeof e?"undefined":Object(r["a"])(e))&&"[object process]"===String(e)&&!e.browser;return!t||Object(i["a"])()}}).call(this,n("Q2Ig"))},"5zYK":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("lSNA"),i=n.n(r),o=n("RIqP"),a=n.n(o),s=n("Aib3"),u=n.n(s);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){var n=t.x,r=t.y,i=t.x1,o=t.y1,s=t.coordinates,c=[];return e.forEach((function(e,t){var p=[];if(n&&r&&(p=[parseFloat(e[n]),parseFloat(e[r])]),n&&r&&i&&o){var f=[parseFloat(e[n]),parseFloat(e[r])],h=[parseFloat(e[i]),parseFloat(e[o])];p=[f,h]}if(s){var d="Polygon";Array.isArray(s[0])||(d="Point"),Array.isArray(s[0])&&!Array.isArray(s[0][0])&&(d="LineString");var m={type:d,coordinates:a()(e[s])};u()(m,!0),p=m.coordinates}var g=l({},e,{_id:t,coordinates:p});c.push(g)})),{dataArray:c}}},"6AGu":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("FV85"),i=n("LKzl"),o=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=o},"6D9b":function(e,t,n){e.exports={"ant-statistic":"ant-statistic","ant-statistic-title":"ant-statistic-title","ant-statistic-content":"ant-statistic-content","ant-statistic-content-value":"ant-statistic-content-value","ant-statistic-content-value-decimal":"ant-statistic-content-value-decimal","ant-statistic-content-prefix":"ant-statistic-content-prefix","ant-statistic-content-suffix":"ant-statistic-content-suffix","ant-statistic-rtl":"ant-statistic-rtl"}},"6NqC":function(e,t){},"6acW":function(e,t,n){var r=n("dt0z"),i=n("gQMU");function o(e){return i(r(e).toLowerCase())}e.exports=o},"6nK8":function(e,t,n){var r=n("dVn5"),i=n("fo6e"),o=n("dt0z"),a=n("9NmV");function s(e,t,n){return e=o(e),t=n?void 0:t,void 0===t?i(e)?a(e):r(e):e.match(t)||[]}e.exports=s},"711d":function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},"78VC":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return e.bind(n).toService(t)}))}}}},"7tbW":function(e,t,n){var r=n("LGYb");function i(e){return e&&e.length?r(e):[]}e.exports=i},"8/Fi":function(e,t,n){"use strict";n("J4zp"),n("9nhX")},"8ml+":function(e,t,n){"use strict";var r=n("h1nZ");n.o(r,"LineLayer")&&n.d(t,"LineLayer",(function(){return r["LineLayer"]})),n.o(r,"PointLayer")&&n.d(t,"PointLayer",(function(){return r["PointLayer"]})),n.o(r,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return r["PolygonLayer"]})),n.o(r,"Popup")&&n.d(t,"Popup",(function(){return r["Popup"]})),n.o(r,"Scene")&&n.d(t,"Scene",(function(){return r["Scene"]}));var i=n("kQ+U");n.d(t,"Scene",(function(){return i["a"]}));var o=n("sxDa");n.d(t,"LineLayer",(function(){return o["a"]})),n.d(t,"PointLayer",(function(){return o["b"]})),n.d(t,"PolygonLayer",(function(){return o["c"]}));var a=n("k5/I");n.d(t,"Popup",(function(){return a["b"]}));n("Hel2"),n("RL2/")},"8uyu":function(e,t){},"9Fde":function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r["throw"](e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return u([e,t])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n("LgvC"),a=n("MON2"),s=n("FV85"),u=n("xfSm"),c=n("wnjb"),l=n("h7MG"),p=n("aPG5"),f=n("gzZq"),h=n("d9O0"),d=n("ujMp"),m=n("HpQ9"),g=n("AwBQ"),v=function(){function e(e){var t=e||{};if("object"!==typeof t)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=s.BindingScopeEnum.Transient;else if(t.defaultScope!==s.BindingScopeEnum.Singleton&&t.defaultScope!==s.BindingScopeEnum.Transient&&t.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!==typeof t.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!==typeof t.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=h.id(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new c.MetadataReader}return e.merge=function(t,n){var r=new e,i=l.getBindingDictionary(r),o=l.getBindingDictionary(t),a=l.getBindingDictionary(n);function s(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s(o,i),s(a,i),r},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(this,void 0,void 0,(function(){var t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,i.label=1;case 1:return n<r.length?(o=r[n],a=t(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new o.Binding(e,t);return this._bindingDictionary.add(e,n),new f.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(a.CANNOT_UNBIND+" "+d.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new g.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,u.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),o=l.createMockRequest(this,e,t,n);r=i.some((function(e){return e.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(m.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,s.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,u.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,s.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,u.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.bind.bind(e),o=i(r);return t(o,n),o}},r=function(t){return function(t){var n=e.unbind.bind(e);n(t)}},i=function(t){return function(t){var n=e.isBound.bind(e);return n(t)}},o=function(n){return function(r){var i=e.rebind.bind(e),o=i(r);return t(o,n),o}};return function(e){return{bindFunction:n(e),isboundFunction:i(e),rebindFunction:o(e),unbindFunction:r(e)}}},e.prototype._get=function(e,t,n,r,i,o){var s=null,u={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(s=this._middleware(u),void 0===s||null===s)throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(u);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=l.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var r=p.resolve(n);return r}},e}();t.Container=v},"9NmV":function(e,t){var n="\\ud800-\\udfff",r="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",a=r+i+o,s="\\u2700-\\u27bf",u="a-z\\xdf-\\xf6\\xf8-\\xff",c="\\xac\\xb1\\xd7\\xf7",l="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",p="\\u2000-\\u206f",f=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",h="A-Z\\xc0-\\xd6\\xd8-\\xde",d="\\ufe0e\\ufe0f",m=c+l+p+f,g="['\u2019]",v="["+m+"]",y="["+a+"]",_="\\d+",b="["+s+"]",x="["+u+"]",w="[^"+n+m+_+s+u+h+"]",S="\\ud83c[\\udffb-\\udfff]",E="(?:"+y+"|"+S+")",T="[^"+n+"]",k="(?:\\ud83c[\\udde6-\\uddff]){2}",A="[\\ud800-\\udbff][\\udc00-\\udfff]",C="["+h+"]",I="\\u200d",M="(?:"+x+"|"+w+")",P="(?:"+C+"|"+w+")",O="(?:"+g+"(?:d|ll|m|re|s|t|ve))?",L="(?:"+g+"(?:D|LL|M|RE|S|T|VE))?",R=E+"?",D="["+d+"]?",z="(?:"+I+"(?:"+[T,k,A].join("|")+")"+D+R+")*",N="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",j="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",F=D+R+z,B="(?:"+[b,k,A].join("|")+")"+F,U=RegExp([C+"?"+x+"+"+O+"(?="+[v,C,"$"].join("|")+")",P+"+"+L+"(?="+[v,C+M,"$"].join("|")+")",C+"?"+M+"+"+O,C+"+"+L,j,N,_,B].join("|"),"g");function V(e){return e.match(U)||[]}e.exports=V},"9lTW":function(e,t,n){"use strict";(function(t){var r=n("MgzW");function i(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function o(e){return t.Buffer&&"function"===typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var a=n("MCLT"),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c=function(){return"foo"===function(){}.name}();function l(e){return Object.prototype.toString.call(e)}function p(e){return!o(e)&&("function"===typeof t.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var f=e.exports=_,h=/\s*function\s+([^\(\s]*)\s*/;function d(e){if(a.isFunction(e)){if(c)return e.name;var t=e.toString(),n=t.match(h);return n&&n[1]}}function m(e,t){return"string"===typeof e?e.length<t?e:e.slice(0,t):e}function g(e){if(c||!a.isFunction(e))return a.inspect(e);var t=d(e),n=t?": "+t:"";return"[Function"+n+"]"}function v(e){return m(g(e.actual),128)+" "+e.operator+" "+m(g(e.expected),128)}function y(e,t,n,r,i){throw new f.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function _(e,t){e||y(e,!0,t,"==",f.ok)}function b(e,t,n,r){if(e===t)return!0;if(o(e)&&o(t))return 0===i(e,t);if(a.isDate(e)&&a.isDate(t))return e.getTime()===t.getTime();if(a.isRegExp(e)&&a.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===typeof e||null!==t&&"object"===typeof t){if(p(e)&&p(t)&&l(e)===l(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===i(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(o(e)!==o(t))return!1;r=r||{actual:[],expected:[]};var s=r.actual.indexOf(e);return-1!==s&&s===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),w(e,t,n,r))}return n?e===t:e==t}function x(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function w(e,t,n,r){if(null===e||void 0===e||null===t||void 0===t)return!1;if(a.isPrimitive(e)||a.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=x(e),o=x(t);if(i&&!o||!i&&o)return!1;if(i)return e=u.call(e),t=u.call(t),b(e,t,n);var s,c,l=C(e),p=C(t);if(l.length!==p.length)return!1;for(l.sort(),p.sort(),c=l.length-1;c>=0;c--)if(l[c]!==p[c])return!1;for(c=l.length-1;c>=0;c--)if(s=l[c],!b(e[s],t[s],n,r))return!1;return!0}function S(e,t,n){b(e,t,!0)&&y(e,t,n,"notDeepStrictEqual",S)}function E(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(n){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function T(e){var t;try{e()}catch(n){t=n}return t}function k(e,t,n,r){var i;if("function"!==typeof t)throw new TypeError('"block" argument must be a function');"string"===typeof n&&(r=n,n=null),i=T(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&y(i,n,"Missing expected exception"+r);var o="string"===typeof r,s=!e&&a.isError(i),u=!e&&i&&!n;if((s&&o&&E(i,n)||u)&&y(i,n,"Got unwanted exception"+r),e&&i&&n&&!E(i,n)||!e&&i)throw i}function A(e,t){e||y(e,!0,t,"==",A)}f.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=v(this),this.generatedMessage=!0);var t=e.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,i=d(t),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(f.AssertionError,Error),f.fail=y,f.ok=_,f.equal=function(e,t,n){e!=t&&y(e,t,n,"==",f.equal)},f.notEqual=function(e,t,n){e==t&&y(e,t,n,"!=",f.notEqual)},f.deepEqual=function(e,t,n){b(e,t,!1)||y(e,t,n,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(e,t,n){b(e,t,!0)||y(e,t,n,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(e,t,n){b(e,t,!1)&&y(e,t,n,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=S,f.strictEqual=function(e,t,n){e!==t&&y(e,t,n,"===",f.strictEqual)},f.notStrictEqual=function(e,t,n){e===t&&y(e,t,n,"!==",f.notStrictEqual)},f.throws=function(e,t,n){k(!0,e,t,n)},f.doesNotThrow=function(e,t,n){k(!1,e,t,n)},f.ifError=function(e){if(e)throw e},f.strict=r(A,f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var C=Object.keys||function(e){var t=[];for(var n in e)s.call(e,n)&&t.push(n);return t}}).call(this,n("yLpj"))},"9nhX":function(e,t,n){var r=n("g4R6"),i=n("tLB3");function o(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=i(n),n=n===n?n:0),void 0!==t&&(t=i(t),t=t===t?t:0),r(i(e),t,n)}e.exports=o},AFH1:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e["TOPRIGHT"]="topright",e["TOPLEFT"]="topleft",e["BOTTOMRIGHT"]="bottomright",e["BOTTOMLEFT"]="bottomleft"}(r||(r={}))},AKIq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/rf6");function i(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function o(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function a(e){if(e.length>1&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return a(e[0]);throw new Error("coordinates must only contain numbers")}function s(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)}function u(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)}function c(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=e.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+o.geometry.type)}}function l(e){return"Feature"===e.type?e.geometry:e}function p(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}t.getCoord=i,t.getCoords=o,t.containsNumber=a,t.geojsonType=s,t.featureOf=u,t.collectionOf=c,t.getGeom=l,t.getType=p},APxj:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Ucsi");function i(e,t){void 0===t&&(t=!0);var n=r.makePropertyInjectDecorator(e,t),i=r.makePropertyInjectNamedDecorator(e,t),o=r.makePropertyInjectTaggedDecorator(e,t),a=r.makePropertyMultiInjectDecorator(e,t);return{lazyInject:n,lazyInjectNamed:i,lazyInjectTagged:o,lazyMultiInject:a}}t.default=i},Aib3:function(e,t,n){var r=n("mhV4");function i(e,t){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.map(o(i,t)),e;case"GeometryCollection":return e.geometries=e.geometries.map(o(i,t)),e;case"Feature":return e.geometry=i(e.geometry,t),e;case"Polygon":case"MultiPolygon":return a(e,t);default:return e}}function o(e,t){return function(n){return e(n,t)}}function a(e,t){return"Polygon"===e.type?e.coordinates=s(e.coordinates,t):"MultiPolygon"===e.type&&(e.coordinates=e.coordinates.map(o(s,t))),e}function s(e,t){t=!!t,e[0]=u(e[0],t);for(var n=1;n<e.length;n++)e[n]=u(e[n],!t);return e}function u(e,t){return c(e)===t?e:e.reverse()}function c(e){return r.ring(e)>=0}e.exports=i},AwBQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(r.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(r.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,r){var i=n.filter((function(t){return!e(t)}));i.length>0?t._map.set(r,i):t._map.delete(r)}))},e.prototype.hasKey=function(e){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();t.Lookup=i},"B6l+":function(e,t,n){var r=n("Sq3C"),i=n("Z1HP"),o=n("Sxd8"),a=n("dt0z");function s(e,t,n){e=a(e),t=o(t);var s=t?i(e):0;return t&&s<t?e+r(t-s,n):e}e.exports=s},BGjm:function(e,t){function n(e,t){t||(t=document);var n=t.head||t.getElementsByTagName("head")[0];if(!n){n=t.createElement("head");var r=t.body||t.getElementsByTagName("body")[0];r?r.parentNode.insertBefore(n,r):t.documentElement.appendChild(n)}var i=t.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(t.createTextNode(e)),n.appendChild(i),i}e.exports=n},BkRI:function(e,t,n){var r=n("OBhP"),i=1,o=4;function a(e){return r(e,i|o)}e.exports=a},BpBL:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("Hel2");function i(e,t){var n=t.extent,r=new Promise((function(t){o(e,(function(e){t(e)}))})),i={images:r,_id:1,dataArray:[{_id:0,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return i}function o(e,t){var n=e,o=[];if("string"===typeof n)Object(r["m"])({url:n},(function(e,n){o.push(n),t(o)}));else{var a=n.length,s=0;n.forEach((function(e){Object(r["m"])({url:e},(function(e,n){s++,o.push(n),s===a&&t(o)}))}))}return i}},CZoQ:function(e,t){function n(e,t,n){var r=n-1,i=e.length;while(++r<i)if(e[r]===t)return r;return-1}e.exports=n},"D+ow":function(e,t){},D9lx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("6AGu"),i=n("406g"),o=n("z4Hk"),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=a},"Dw+G":function(e,t,n){var r=n("juv8"),i=n("mTTR");function o(e,t){return e&&r(t,i(t),e)}e.exports=o},EEGq:function(e,t,n){var r=n("juv8"),i=n("oCl/");function o(e,t){return r(e,i(e),t)}e.exports=o},EfZ0:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},FI6e:function(e,t){},FV85:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingScopeEnum=r;var i={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.BindingTypeEnum=i;var o={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};t.TargetTypeEnum=o},FmoU:function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return k}));var r=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function i(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function o(){}var a=.7,s=1/a,u="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",p=/^#([0-9a-f]{3,8})$/,f=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),h=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),d=new RegExp("^rgba\\("+[u,u,u,c]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,c]+"\\)$"),g=new RegExp("^hsl\\("+[c,l,l]+"\\)$"),v=new RegExp("^hsla\\("+[c,l,l,c]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _(){return this.rgb().formatHex()}function b(){return O(this).formatHsl()}function x(){return this.rgb().formatRgb()}function w(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=p.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?S(t):3===n?new A(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?E(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?E(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=f.exec(e))?new A(t[1],t[2],t[3],1):(t=h.exec(e))?new A(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=d.exec(e))?E(t[1],t[2],t[3],t[4]):(t=m.exec(e))?E(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=g.exec(e))?P(t[1],t[2]/100,t[3]/100,1):(t=v.exec(e))?P(t[1],t[2]/100,t[3]/100,t[4]):y.hasOwnProperty(e)?S(y[e]):"transparent"===e?new A(NaN,NaN,NaN,0):null}function S(e){return new A(e>>16&255,e>>8&255,255&e,1)}function E(e,t,n,r){return r<=0&&(e=t=n=NaN),new A(e,t,n,r)}function T(e){return e instanceof o||(e=w(e)),e?(e=e.rgb(),new A(e.r,e.g,e.b,e.opacity)):new A}function k(e,t,n,r){return 1===arguments.length?T(e):new A(e,t,n,null==r?1:r)}function A(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function C(){return"#"+M(this.r)+M(this.g)+M(this.b)}function I(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(1===e?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function M(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function P(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new R(e,t,n,r)}function O(e){if(e instanceof R)return new R(e.h,e.s,e.l,e.opacity);if(e instanceof o||(e=w(e)),!e)return new R;if(e instanceof R)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),s=NaN,u=a-i,c=(a+i)/2;return u?(s=t===a?(n-r)/u+6*(n<r):n===a?(r-t)/u+2:(t-n)/u+4,u/=c<.5?a+i:2-a-i,s*=60):u=c>0&&c<1?0:s,new R(s,u,c,e.opacity)}function L(e,t,n,r){return 1===arguments.length?O(e):new R(e,t,n,null==r?1:r)}function R(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function D(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}r(o,w,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:_,formatHex:_,formatHsl:b,formatRgb:x,toString:x}),r(A,k,i(o,{brighter:function(e){return e=null==e?s:Math.pow(s,e),new A(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?a:Math.pow(a,e),new A(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:I,toString:I})),r(R,L,i(o,{brighter:function(e){return e=null==e?s:Math.pow(s,e),new R(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?a:Math.pow(a,e),new R(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new A(D(e>=240?e-240:e+120,i,r),D(e,i,r),D(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(1===e?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}))},G6z8:function(e,t,n){var r=n("fR/l"),i=n("oCl/"),o=n("mTTR");function a(e){return r(e,o,i)}e.exports=a},GXnB:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=i},Gi0A:function(e,t,n){var r=n("QqLw"),i=n("ExA7"),o="[object Map]";function a(e){return i(e)&&r(e)==o}e.exports=a},Hel2:function(e,t,n){"use strict";n.d(t,"m",(function(){return B})),n.d(t,"l",(function(){return Z})),n.d(t,"n",(function(){return W})),n.d(t,"d",(function(){return J})),n.d(t,"o",(function(){return Q})),n.d(t,"p",(function(){return $})),n.d(t,"i",(function(){return ee})),n.d(t,"b",(function(){return te})),n.d(t,"h",(function(){return ne})),n.d(t,"q",(function(){return oe})),n.d(t,"j",(function(){return ae})),n.d(t,"k",(function(){return se})),n.d(t,"f",(function(){return re})),n.d(t,"e",(function(){return ue})),n.d(t,"g",(function(){return ce})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i}));var r={};n.r(r),n.d(r,"getContainer",(function(){return a})),n.d(r,"trim",(function(){return s})),n.d(r,"splitWords",(function(){return u})),n.d(r,"create",(function(){return l})),n.d(r,"remove",(function(){return p})),n.d(r,"addClass",(function(){return f})),n.d(r,"removeClass",(function(){return h})),n.d(r,"hasClass",(function(){return d})),n.d(r,"setClass",(function(){return m})),n.d(r,"getClass",(function(){return g})),n.d(r,"empty",(function(){return v})),n.d(r,"setTransform",(function(){return _})),n.d(r,"triggerResize",(function(){return b})),n.d(r,"printCanvas",(function(){return x}));var i={};n.r(i),n.d(i,"sum",(function(){return fe})),n.d(i,"max",(function(){return le})),n.d(i,"min",(function(){return pe})),n.d(i,"mean",(function(){return he})),n.d(i,"mode",(function(){return de})),n.d(i,"statMap",(function(){return me})),n.d(i,"getColumn",(function(){return ge})),n.d(i,"getSatByColumn",(function(){return ve}));var o=window.document.documentElement.style;function a(e){var t=e;return"string"===typeof e&&(t=document.getElementById(e)),t}function s(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function u(e){return s(e).split(/\s+/)}function c(e){if(!o)return e[0];for(var t in e)if(e[t]&&e[t]in o)return e[t];return e[0]}function l(e,t,n){var r=document.createElement(e);return r.className=t||"",n&&n.appendChild(r),r}function p(e){var t=e.parentNode;t&&t.removeChild(e)}function f(e,t){if(void 0!==e.classList)for(var n=u(t),r=0,i=n.length;r<i;r++)e.classList.add(n[r]);else if(!d(e,t)){var o=g(e);m(e,(o?o+" ":"")+t)}}function h(e,t){void 0!==e.classList?e.classList.remove(t):m(e,s((" "+g(e)+" ").replace(" "+t+" "," ")))}function d(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=g(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function m(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function g(e){return e instanceof SVGElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function v(e){while(e&&e.firstChild)e.removeChild(e.firstChild)}var y=c(["transform","WebkitTransform"]);function _(e,t){e.style[y]=t}function b(){if("function"===typeof Event)window.dispatchEvent(new Event("resize"));else{var e=window.document.createEvent("UIEvents");e.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(e)}}function x(e){var t=["padding: "+(e.height/2-8)+"px "+e.width/2+"px;","line-height: "+e.height+"px;","background-image: url("+e.toDataURL()+");"];console.log("%c\n",t.join(""))}var w=n("lwsE"),S=n.n(w),E=n("W8MJ"),T=n.n(E),k=n("7W2i"),A=n.n(k),C=n("a1gu"),I=n.n(C),M=n("Nsbk"),P=n.n(M),O=n("oShl"),L=n.n(O);function R(e){return function(){var t,n=P()(e);if(D()){var r=P()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return I()(this,t)}}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var z=function(e){A()(n,e);var t=R(n);function n(e,r,i){var o;return S()(this,n),o=t.call(this,e),o.status=void 0,o.url=void 0,o.status=r,o.url=i,o.name=o.constructor.name,o.message=e,o}return T()(n,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),n}(L()(Error));function N(e){var t=new XMLHttpRequest;for(var n in t.open("GET",e.url,!0),e.headers)e.headers.hasOwnProperty(n)&&t.setRequestHeader(n,e.headers[n]);return t.withCredentials="include"===e.credentials,t}var j=function(e,t){var n=N(e);return n.responseType="arraybuffer",n.onerror=function(){t(new Error(n.statusText))},n.onload=function(){var r=n.response;if(0===r.byteLength&&200===n.status)return t(new Error("http status 200 returned without content."));n.status>=200&&n.status<300&&n.response?t(null,{data:r,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")}):t(new z(n.statusText,n.status,e.url))},n.send(),n};var F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",B=function(e,t){return j(e,(function(e,n){if(e)t(e);else if(n){var r=new window.Image;r.crossOrigin="anonymous";var i=window.URL||window.webkitURL;r.onload=function(){t(null,r),i.revokeObjectURL(r.src)};var o=new window.Blob([new Uint8Array(n.data)],{type:"image/png"});r.src=n.data.byteLength?i.createObjectURL(o):F}}))},U=n("J4zp"),V=n.n(U),G=n("/rf6"),q=2*Math.PI*6378137/2;function Z(e){var t=[1/0,1/0,-1/0,-1/0];return e.forEach((function(e){var n=e.coordinates;H(t,n)})),t}function H(e,t){return Array.isArray(t[0])?t.forEach((function(t){H(e,t)})):(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])),e}function W(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1};e=K(e,t);var r=e[0],i=e[1],o=r*q/180,a=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return a=a*q/180,n.enable&&(o=Number(o.toFixed(n.decimal)),a=Number(a.toFixed(n.decimal))),3===e.length?[o,a,e[2]]:[o,a]}function Y(e){if(void 0===e||null===e)throw new Error("lng is required");return(e>180||e<-180)&&(e%=360,e>180&&(e=-360+e),e<-180&&(e=360+e),0===e&&(e=0)),e}function X(e){if(void 0===e||null===e)throw new Error("lat is required");return(e>90||e<-90)&&(e%=180,e>90&&(e=-180+e),e<-90&&(e=180+e),0===e&&(e=0)),e}function K(e,t){if(!1===t)return e;var n=Y(e[0]),r=X(e[1]);return r>85&&(r=85),r<-85&&(r=-85),3===e.length?[n,r,e[2]]:[n,r]}function J(e){var t=85.0511287798,n=Math.max(Math.min(t,e[1]),-t),r=256<<20,i=Math.PI/180,o=e[0]*i,a=n*i;a=Math.log(Math.tan(Math.PI/4+a/2));var s=.5/Math.PI,u=.5,c=-.5/Math.PI;return i=.5,o=r*(s*o+u),a=r*(c*a+i),[parseInt(o.toString(),10),parseInt(a.toString(),10)]}function Q(e,t,n){var r=Object(G["degreesToRadians"])(t[1]-e[1]),i=Object(G["degreesToRadians"])(t[0]-e[0]),o=Object(G["degreesToRadians"])(e[1]),a=Object(G["degreesToRadians"])(t[1]),s=Math.pow(Math.sin(r/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(o)*Math.cos(a);return Object(G["radiansToLength"])(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),"meters")}function $(e,t){var n=Math.abs(e[1][1]-e[0][1])*t,r=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-r,e[0][1]-n],[e[1][0]+r,e[1][1]+n]]}function ee(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}var te=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=arguments.length>1?arguments[1]:void 0;S()(this,e),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=t,this.destroy=n||this.defaultDestroy,this.order=[],this.clear()}return T()(e,[{key:"clear",value:function(){var e=this;this.order.forEach((function(t){e.delete(t)})),this.cache={},this.order=[]}},{key:"get",value:function(e){var t=this.cache[e];return t&&(this.deleteOrder(e),this.appendOrder(e)),t}},{key:"set",value:function(e,t){this.cache[e]?(this.delete(e),this.cache[e]=t,this.appendOrder(e)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[e]=t,this.appendOrder(e))}},{key:"delete",value:function(e){var t=this.cache[e];t&&(this.deleteCache(e),this.deleteOrder(e),this.destroy(t,e))}},{key:"deleteCache",value:function(e){delete this.cache[e]}},{key:"deleteOrder",value:function(e){var t=this.order.findIndex((function(t){return t===e}));t>=0&&this.order.splice(t,1)}},{key:"appendOrder",value:function(e){this.order.push(e)}},{key:"defaultDestroy",value:function(e,t){return null}}]),e}();function ne(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}var re,ie=n("FmoU");function oe(e){var t=ie["a"](e),n=[0,0,0,0];return null!=t&&(n[0]=t.r/255,n[1]=t.g/255,n[2]=t.b/255,n[3]=t.opacity),n}function ae(e){var t=V()(e,3),n=t[0],r=t[1],i=t[2],o=n+256*r+65536*i-1;return o}function se(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}(function(e){e["CENTER"]="center",e["TOP"]="top",e["TOP-LEFT"]="top-left",e["TOP-RIGHT"]="top-right",e["BOTTOM"]="bottom",e["BOTTOM-LEFT"]="bottom-left",e["LEFT"]="left",e["RIGHT"]="right"})(re||(re={}));var ue={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ce(e,t,n){var r=e.classList;for(var i in ue)ue.hasOwnProperty(i)&&r.remove("l7-".concat(n,"-anchor-").concat(i));r.add("l7-".concat(n,"-anchor-").concat(t))}function le(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t}function pe(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t}function fe(e){if(0===e.length)return 0;for(var t,n=1*e[0],r=0,i=1;i<e.length;i++)t=n+1*e[i],Math.abs(n)>=Math.abs(e[i])?r+=n-t+e[i]:r+=e[i]-t+n,n=t;return n+1*r}function he(e){if(0===e.length)throw new Error("mean requires at least one data point");return fe(e)/e.length}function de(e){if(0===e.length)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();for(var t=e[0],n=NaN,r=0,i=1,o=1;o<e.length+1;o++)e[o]!==t?(i>r&&(r=i,n=t),i=1,t=e[o]):i++;return n}var me={min:pe,max:le,mean:he,sum:fe,mode:de};function ge(e,t){return e.map((function(e){return e[t]}))}function ve(e,t){return me[e](t)}},HpQ9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}();t.ContainerSnapshot=r},HthE:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e[e["LNGLAT"]=1]="LNGLAT",e[e["LNGLAT_OFFSET"]=2]="LNGLAT_OFFSET",e[e["VECTOR_TILE"]=3]="VECTOR_TILE",e[e["IDENTITY"]=4]="IDENTITY",e[e["P20"]=5]="P20",e[e["P20_OFFSET"]=6]="P20_OFFSET",e[e["METER_OFFSET"]=7]="METER_OFFSET"}(r||(r={}));var i={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var r=n("U8pU");function i(t){if("undefined"!==typeof window&&"object"===Object(r["a"])(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof e&&"object"===Object(r["a"])(e.versions)&&Boolean(e.versions.electron))return!0;var n="object"===("undefined"===typeof navigator?"undefined":Object(r["a"])(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,i=t||n;return!!(i&&i.indexOf("Electron")>=0)}}).call(this,n("Q2Ig"))},IOcx:function(e,t,n){"use strict";var r=n("ZaHm");n.d(t,"a",(function(){return r}));var i=n("ZxFD");n.d(t,"b",(function(){return i}));var o=n("n+fv");n.d(t,"c",(function(){return o}));var a=n("bl9R");n.d(t,"d",(function(){return a}))},ISu3:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u}));var r={},i={},o=function(e){return i[e]},a=function(e,t){i[e]=t},s=function(e){return r[e]},u=function(e,t){r[e]=t}},J2iB:function(e,t){function n(e){return null==e}e.exports=n},J7lC:function(e,t){},K9nA:function(e,t,n){"use strict";(function(e,r){n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var i=n("U8pU"),o={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof e&&e,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":Object(i["a"])(r))&&r},a=(o.self||o.window||o.global,o.window||o.self||o.global),s=(o.global||o.self||o.window,o.document,o.process||{});console}).call(this,n("yLpj"),n("Q2Ig"))},KKCa:function(e,t){"function"===typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},KwMD:function(e,t){function n(e,t,n,r){var i=e.length,o=n+(r?1:-1);while(r?o--:++o<i)if(t(e[o],o,e))return o;return-1}e.exports=n},L56e:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["mapload"]},LGYb:function(e,t,n){var r=n("1hJj"),i=n("jbM+"),o=n("Xt/L"),a=n("xYSL"),s=n("dQpi"),u=n("rEGp"),c=200;function l(e,t,n){var l=-1,p=i,f=e.length,h=!0,d=[],m=d;if(n)h=!1,p=o;else if(f>=c){var g=t?null:s(e);if(g)return u(g);h=!1,p=a,m=new r}else m=t?[]:d;e:while(++l<f){var v=e[l],y=t?t(v):v;if(v=n||0!==v?v:0,h&&y===y){var _=m.length;while(_--)if(m[_]===y)continue e;t&&m.push(y),d.push(v)}else p(m,y,n)||(m!==d&&m.push(y),d.push(v))}return d}e.exports=l},LKzl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("406g"),i=n("z4Hk"),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=o},LgvC:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("FV85"),i=n("d9O0"),o=function(){function e(e,t){this.id=i.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=o},MCLT:function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}})),u=r[n];n<o;u=r[++n])_(u)||!k(u)?a+=" "+u:a+=" "+s(u);return a},t.deprecate=function(n,r){if("undefined"!==typeof e&&!0===e.noDeprecation)return n;if("undefined"===typeof e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;function o(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}return o};var o,a={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&t._extend(r,n),E(r.showHidden)&&(r.showHidden=!1),E(r.depth)&&(r.depth=2),E(r.colors)&&(r.colors=!1),E(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),p(r,e,r.depth)}function u(e,t){var n=s.styles[t];return n?"\x1b["+s.colors[n][0]+"m"+e+"\x1b["+s.colors[n][1]+"m":e}function c(e,t){return e}function l(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}function p(e,n,r){if(e.customInspect&&n&&I(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return w(i)||(i=p(e,i,r)),i}var o=f(e,n);if(o)return o;var a=Object.keys(n),s=l(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),C(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(I(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(T(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(A(n))return e.stylize(Date.prototype.toString.call(n),"date");if(C(n))return h(n)}var c,y="",_=!1,b=["{","}"];if(v(n)&&(_=!0,b=["[","]"]),I(n)){var x=n.name?": "+n.name:"";y=" [Function"+x+"]"}return T(n)&&(y=" "+RegExp.prototype.toString.call(n)),A(n)&&(y=" "+Date.prototype.toUTCString.call(n)),C(n)&&(y=" "+h(n)),0!==a.length||_&&0!=n.length?r<0?T(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=_?d(e,n,r,s,a):a.map((function(t){return m(e,n,r,s,t,_)})),e.seen.pop(),g(c,y,b)):b[0]+y+b[1]}function f(e,t){if(E(t))return e.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return x(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):_(t)?e.stylize("null","null"):void 0}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)D(t,String(a))?o.push(m(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(m(e,t,n,r,i,!0))})),o}function m(e,t,n,r,i,o){var a,s,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),D(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=_(n)?p(e,u.value,null):p(e,u.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n"))):s=e.stylize("[Circular]","special")),E(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function g(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);return r>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function v(e){return Array.isArray(e)}function y(e){return"boolean"===typeof e}function _(e){return null===e}function b(e){return null==e}function x(e){return"number"===typeof e}function w(e){return"string"===typeof e}function S(e){return"symbol"===typeof e}function E(e){return void 0===e}function T(e){return k(e)&&"[object RegExp]"===P(e)}function k(e){return"object"===typeof e&&null!==e}function A(e){return k(e)&&"[object Date]"===P(e)}function C(e){return k(e)&&("[object Error]"===P(e)||e instanceof Error)}function I(e){return"function"===typeof e}function M(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e}function P(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(E(o)&&(o=Object({GITHUB_TOKEN:"942bb2823b531cc69cf2ac0aa73ae1332844fa5f",npm_package_scripts_docker_prod_build:"docker-compose -f ./docker/docker-compose.yml build",npm_package_scripts_docker_dev:"docker-compose -f ./docker/docker-compose.dev.yml up",npm_package_dependencies__types_lodash_debounce:"^4.0.6",npm_package_devDependencies_cross_port_killer:"^1.1.1",npm_config_cache_lock_stale:"60000",npm_config_ham_it_up:"",GA_KEY:"UA-72788897-6",ACTIONS_RUNTIME_TOKEN:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaOHdqOHQzYy1xWVhxU0wtQk55Z1pTWWNhRSJ9.eyJuYW1laWQiOiIyMWUyYjU5ZC0zZmNkLTQ1NDAtYWE0ZS03YWNjNWU1OWFjZTMiLCJzY3AiOiJBY3Rpb25zLlVwbG9hZEFydGlmYWN0czowMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAvMTpCdWlsZC9CdWlsZC8zNzc0IExvY2F0aW9uU2VydmljZS5Db25uZWN0IFByb2plY3QuR2VuZXJpY1JlYWQ6MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIFJlYWRBbmRVcGRhdGVCdWlsZEJ5VXJpOjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMC8xOkJ1aWxkL0J1aWxkLzM3NzQiLCJJZGVudGl0eVR5cGVDbGFpbSI6Ik1pY3Jvc29mdC5UZWFtRm91bmRhdGlvbi5TZXJ2aWNlSWRlbnRpdHkiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9zaWQiOiIzZjExZDZkMy1jYjJjLTQyZDgtYjM4MS0yZjU5NmI1NjRhYzU6QWN0aW9uczplZGZjZmFhOS1lZDQ1LTQ1ZWQtYmY2My0wZjQyZjgyOGMxNGMiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3ByaW1hcnlzaWQiOiIyMWUyYjU5ZC0zZmNkLTQ1NDAtYWE0ZS03YWNjNWU1OWFjZTMiLCJhdWkiOiJlOGYyNGMwNi02YTM0LTQzZTktODBlZC0yZWE3ODcxZDA4MzkiLCJzaWQiOiI1OTUyMTMxOC02NTYxLTQwYmUtYjI4My00NzMzNGFmMmU4MzAiLCJhYyI6Ilt7XCJTY29wZVwiOlwicmVmcy9oZWFkcy9tYXN0ZXJcIixcIlBlcm1pc3Npb25cIjozfV0iLCJvcmNoaWQiOiJhMDIwZGJmZC05YjU1LTQ4YTctODM5ZS0zYWYyMzJhNjk5YWYuYnVpbGQtYW5kLWRlcGxveS5fX2RlZmF1bHQiLCJpc3MiOiJ2c3Rva2VuLmFjdGlvbnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwiYXVkIjoidnN0b2tlbi5hY3Rpb25zLmdpdGh1YnVzZXJjb250ZW50LmNvbXx2c286ZWRmY2ZhYTktZWQ0NS00NWVkLWJmNjMtMGY0MmY4MjhjMTRjIiwibmJmIjoxNTg3OTU0NzY0LCJleHAiOjE1ODc5Nzc1NjR9.MbQQqrPmCUZ5lpyUWZW368UtG8cmFUHhI5hqTsh2Uf_WDxrT_hSzOlhQTPwMpxx1aDn5jSHxrdlGcSBEYYIASn9gLVVzSTaiHfnXsKGRBl0VDdoMTxFUcCbJoKAUSHHb813a6D4QV2PUQBj25sMrSUauju0hPgtXg2B7vhOKfyR3Y4hzCQk-u85ItVg08IgGmoTnl7Ay4ydKen3jaW4oizocdErOSDzlhD3Ss6J2mzWKpH_8M70w0jCMyRbFEOk1Hp-xP_Zf0q4zOcOIzGuCJAUbLWtu6I-dWqMfSnGmi1APqQQk8Z4aRdTigGP3jSgx6ovICTSmUp_pItbXABWlRw",npm_package_devDependencies__types_qs:"^6.5.3",npm_package_devDependencies_chalk:"^4.0.0",npm_config_legacy_bundling:"",npm_config_sign_git_tag:"",ACTIONS_CACHE_URL:"https://artifactcache.actions.githubusercontent.com/6ox3nltdSCqlq9JnytEd3HXU2vAMTbWRdkFGiQZ4Z57LU2Z2qP/",npm_package_scripts_pretest:"node ./tests/beforeTest",npm_package_dependencies_mockjs:"^1.0.1-beta3",npm_config_user_agent:"npm/6.13.4 node/v10.19.0 linux x64 ci/github-actions",npm_config_always_auth:"",CI:"true",NODE_VERSION:"10.19.0",npm_package_scripts_lint_staged:"lint-staged",npm_package_dependencies_nzh:"^1.0.3",npm_config_bin_links:"true",npm_config_key:"",HOSTNAME:"727e1f058d15",FOLDER:"dist/",BRANCH:"gh-pages",YARN_VERSION:"1.21.1",npm_package_scripts_start_dev:"cross-env REACT_APP_ENV=dev MOCK=none umi dev",npm_package_dependencies__antv_data_set:"^0.11.0",npm_package_devDependencies_gh_pages:"^2.0.1",npm_config_description:"true",npm_config_fetch_retries:"2",npm_config_heading:"npm",npm_config_init_version:"1.0.0",npm_config_allow_same_version:"",npm_config_if_present:"",npm_config_user:"",npm_node_execpath:"/usr/local/bin/node",npm_package_scripts_test_all:"node ./tests/run-tests.js",npm_package_dependencies_react_helmet_async:"^1.0.4",npm_package_devDependencies__types_express:"^4.17.0",npm_config_prefer_online:"",npm_config_noproxy:"",HOME:"/github/home",OLDPWD:"/github/workspace",npm_package_dependencies__ant_design_icons:"^4.0.0",npm_package_devDependencies_jsdom_global:"^3.0.2",npm_config_force:"",RUNNER_TEMP:"/home/runner/work/_temp",GITHUB_EVENT_PATH:"/github/workflow/event.json",npm_package_scripts_lint_staged_js:"eslint --ext .js,.jsx,.ts,.tsx ",npm_config_only:"",npm_config_read_only:"",GITHUB_REPOSITORY_OWNER:"ant-design",npm_package_scripts_test_component:"umi test ./src/components",npm_package_engines_node:">=10.0.0",npm_config_cache_min:"10",npm_config_init_license:"ISC",NODE_OPTIONS:"--max_old_space_size=4096",npm_package_devDependencies__umijs_preset_ant_design_pro:"^1.2.0",npm_config_editor:"vi",npm_config_rollback:"true",npm_config_tag_version_prefix:"v",GITHUB_HEAD_REF:"",npm_package_scripts_lint_fix:"eslint --fix --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src && npm run lint:style",npm_package_scripts_lint_style:'stylelint --fix "src/**/*.less" --syntax less',npm_package_dependencies_umi_plugin_pro:"^2.0.1",npm_config_cache_max:"Infinity",npm_config_userconfig:"/github/home/.npmrc",npm_config_timing:"",npm_package_scripts_postinstall:"umi g tmp",npm_package_dependencies_moment:"^2.24.0",npm_package_dependencies_use_merge_value:"^1.0.1",npm_config_tmp:"/tmp",npm_config_engine_strict:"",npm_config_init_author_name:"",npm_config_init_author_url:"",npm_config_preid:"",GIT_CONFIG_EMAIL:"qixian.cs@outlook.com",npm_package_description:"An out-of-box UI solution for enterprise applications",npm_package_scripts_docker_push:"npm run docker-hub:build && npm run docker:tag && docker push antdesign/ant-design-pro",npm_package_scripts_start_pre:"cross-env REACT_APP_ENV=pre umi dev",npm_package_dependencies_antd:"^4.0.0",npm_package_dependencies_qs:"^6.9.0",npm_package_dependencies_react_fittext:"^1.0.0",npm_package_dependencies_umi_request:"^1.0.8",npm_config_depth:"Infinity",npm_config_package_lock_only:"",npm_config_save_dev:"",npm_config_usage:"",npm_package_dependencies_bizcharts:"^3.5.3-beta.0",npm_package_devDependencies__types_history:"^4.7.2",npm_package_devDependencies__types_react_dom:"^16.8.4",npm_package_readmeFilename:"README.fr-FR.md",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_package_lock:"true",npm_config_cafile:"",npm_config_otp:"",npm_config_progress:"",npm_config_https_proxy:"",npm_config_save_prod:"",npm_package_scripts_dev:"npm run start:dev",npm_package_scripts_docker_build:"docker-compose -f ./docker/docker-compose.dev.yml build",npm_package_scripts_fetch_blocks:"pro fetch-blocks --branch=umi@3 && npm run prettier",npm_package_dependencies__antv_l7_maps:"^2.0.0",npm_package_devDependencies_prettier:"^2.0.1",npm_config_audit:"true",npm_config_sso_type:"oauth",npm_config_cidr:"",npm_config_onload_script:"",ACTIONS_RUNTIME_URL:"https://pipelines.actions.githubusercontent.com/6ox3nltdSCqlq9JnytEd3HXU2vAMTbWRdkFGiQZ4Z57LU2Z2qP/",RUNNER_OS:"Linux",npm_package_scripts_site:"npm run fetch:blocks && npm run build",npm_package_devDependencies_carlo:"^0.9.46",npm_package_checkFiles_0:"src/**/*.js*",npm_config_rebuild_bundle:"true",npm_config_shell:"bash",npm_config_save_bundle:"",GITHUB_WORKFLOW:"Deploy CI",npm_package_private:"true",npm_package_scripts_lint_prettier:'prettier --check "**/*" --end-of-line auto',npm_package_scripts_start_test:"cross-env REACT_APP_ENV=test MOCK=none umi dev",npm_package_devDependencies__types_jest:"^25.1.0",npm_package_devDependencies_mockjs:"^1.0.1-beta3",npm_package_checkFiles_1:"src/**/*.ts*",npm_config_format_package_lock:"true",npm_config_prefix:"/usr/local",npm_config_dry_run:"",npm_package_scripts_lint:"umi g tmp && npm run lint:js && npm run lint:style && npm run lint:prettier",npm_package_devDependencies__umijs_plugin_blocks:"^2.0.5",npm_package_devDependencies_puppeteer_core:"^3.0.0",npm_package_checkFiles_2:"src/**/*.less",npm_config_scope:"",npm_config_cache_lock_wait:"10000",npm_config_registry:"https://registry.npmjs.org/",npm_config_browser:"",npm_config_ignore_prepublish:"",npm_config_save_optional:"",npm_config_searchopts:"",npm_config_versions:"",GITHUB_RUN_ID:"88676759",npm_package_scripts_gh_pages:"cp CNAME ./dist/ && gh-pages -d dist",npm_package_devDependencies__types_lodash:"^4.14.144",npm_package_devDependencies_detect_installer:"^1.0.1",npm_package_devDependencies_stylelint:"^13.0.0",npm_package_checkFiles_3:"config/**/*.js*",npm_config_cache:"/github/home/.npm",npm_config_proxy:"",npm_config_send_metrics:"",GIT_CONFIG_NAME:"qixian.cs",GITHUB_BASE_REF:"",npm_package_scripts_start:"umi dev",npm_package_dependencies_bizcharts_plugin_slider:"^2.1.1-beta.1",npm_package_checkFiles_4:"scripts/**/*.js",npm_package_create_umi_ignore_0:".dockerignore",npm_config_global_style:"",npm_config_ignore_scripts:"",npm_config_version:"",npm_package_dependencies_umi_plugin_antd_theme:"^2.1.2",npm_package_devDependencies__types_classnames:"^2.2.7",npm_package_devDependencies__types_react_helmet:"^5.0.13",npm_package_create_umi_ignore_1:".git",npm_config_viewer:"man",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_config_local_address:"",PATH:"/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/github/workspace/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/github/workspace/node_modules/.bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",RUNNER_TOOL_CACHE:"/opt/hostedtoolcache",ANT_DESIGN_PRO_ONLY_DO_NOT_USE_IN_YOUR_PRODUCTION:"site",NODE:"/usr/local/bin/node",npm_package_name:"ant-design-pro",npm_package_scripts_lint_js:"eslint --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src",npm_package_dependencies_dva:"^2.4.0",npm_package_create_umi_ignore_2:".github",npm_config_audit_level:"low",npm_config_prefer_offline:"",GITHUB_ACTION:"JamesIvesgithub-pages-deploy-action",GITHUB_RUN_NUMBER:"184",npm_package_scripts_analyze:"cross-env ANALYZE=1 umi build",npm_package_dependencies__ant_design_pro_layout:"^5.0.8",npm_package_dependencies_lodash_isequal:"^4.5.0",npm_package_create_umi_ignore_3:".gitpod.yml",npm_config_color:"true",npm_config_sign_git_commit:"",npm_package_scripts_i18n_remove:"pro i18n-remove --locale=zh-CN --write",npm_package_create_umi_ignore_4:"CODE_OF_CONDUCT.md",npm_config_fetch_retry_mintimeout:"10000",npm_config_maxsockets:"50",npm_config_sso_poll_frequency:"500",npm_config_offline:"",npm_package_lint_staged______less:"stylelint --syntax less",npm_package_dependencies_react_dom:"^16.8.6",npm_package_devDependencies__umijs_fabric:"^2.0.5",npm_package_devDependencies_eslint:"^6.8.0",npm_package_create_umi_ignoreScript_0:"docker*",npm_package_create_umi_ignore_5:"Dockerfile",npm_config_umask:"0022",GITHUB_REPOSITORY:"ant-design/ant-design-pro",npm_package_scripts_docker_prod_dev:"docker-compose -f ./docker/docker-compose.yml up",npm_package_scripts_tsc:"tsc",npm_package_browserslist_0:"> 1%",npm_package_dependencies_lodash_debounce:"^4.0.8",npm_package_create_umi_ignoreScript_1:"functions*",npm_package_create_umi_ignore_6:"Dockerfile.*",npm_package_gitHead:"d4c972a0e771c76edf687073edb8b555d6b9ba93",npm_config_fund:"true",npm_config_fetch_retry_maxtimeout:"60000",npm_config_loglevel:"notice",npm_config_logs_max:"10",npm_config_message:"%s",npm_lifecycle_script:"umi build",npm_package_scripts_test:"umi test",npm_package_browserslist_1:"last 2 versions",npm_package_dependencies_react_router:"^4.3.1",npm_package_create_umi_ignoreScript_2:"site",npm_package_create_umi_ignore_7:"lambda",npm_config_ca:"",npm_config_cert:"",npm_config_global:"",npm_config_link:"",GITHUB_ACTIONS:"true",npm_package_version:"4.0.0",npm_package_husky_hooks_pre_commit:"npm run lint-staged",npm_package_browserslist_2:"not ie <= 10",npm_package_devDependencies__types_react:"^16.9.17",npm_package_devDependencies__umijs_preset_react:"^1.4.8",npm_package_create_umi_ignoreScript_3:"generateMock",npm_package_create_umi_ignore_8:"LICENSE",npm_config_save:"true",npm_config_access:"",npm_config_also:"",npm_config_unicode:"",npm_lifecycle_event:"build",npm_package_scripts_build:"umi build",npm_package_scripts_prettier:'prettier -c --write "**/*"',npm_package_scripts_start_no_ui:"cross-env UMI_UI=none umi dev",npm_package_dependencies__ant_design_pro_table:"2.2.1",npm_package_devDependencies_lint_staged:"^10.0.0",npm_package_create_umi_ignore_9:"netlify.toml",npm_config_argv:'{"remain":[],"cooked":["run","build"],"original":["run","build"]}',npm_config_searchlimit:"20",npm_config_update_notifier:"true",npm_config_before:"",npm_config_long:"",npm_config_production:"",npm_config_unsafe_perm:"",GITHUB_WORKSPACE:"/github/workspace",GITHUB_JOB:"build-and-deploy",npm_package_dependencies_lodash:"^4.17.11",npm_package_devDependencies__ant_design_pro_cli:"^1.0.18",npm_package_create_umi_ignore_10:"README.*.md",npm_config_auth_type:"legacy",npm_config_node_version:"10.19.0",npm_config_tag:"latest",GITHUB_SHA:"d4c972a0e771c76edf687073edb8b555d6b9ba93",npm_package_dependencies_gg_editor:"^2.0.2",npm_package_devDependencies_express:"^4.17.1",npm_package_create_umi_ignore_11:"azure-pipelines.yml",npm_config_git_tag_version:"true",npm_config_commit_hooks:"true",npm_config_shrinkwrap:"true",npm_config_script_shell:"",GITHUB_ACTOR:"chenshuai2144",GITHUB_REF:"refs/heads/master",npm_package_lint_staged_______js_jsx_tsx_ts_less_md_json__0:"prettier --write",npm_package_dependencies_classnames:"^2.2.6",npm_package_create_umi_ignore_12:"docker",npm_config_fetch_retry_factor:"10",npm_config_strict_ssl:"true",npm_config_save_exact:"",npm_package_dependencies__antv_l7:"^2.0.0",npm_package_dependencies_lodash_decorators:"^6.0.0",npm_package_create_umi_ignore_13:"CNAME",npm_config_globalconfig:"/usr/local/etc/npmrc",npm_config_init_module:"/github/home/.npm-init.js",npm_config_dev:"",npm_config_parseable:"",RUNNER_WORKSPACE:"/home/runner/work/ant-design-pro",PWD:"/github/workspace",npm_package_dependencies_numeral:"^2.0.6",npm_package_dependencies_path_to_regexp:"2.4.0",npm_package_devDependencies_enzyme:"^3.11.0",npm_package_devDependencies_pro_download:"1.0.1",npm_package_create_umi_ignoreDependencies_0:"netlify*",npm_package_create_umi_ignore_14:"create-umi",npm_config_globalignorefile:"/usr/local/etc/npmignore",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",GITHUB_EVENT_NAME:"push",npm_package_lint_staged_______js_jsx_ts_tsx_:"npm run lint-staged:js",npm_package_dependencies_omit_js:"^1.0.2",npm_package_devDependencies__umijs_preset_ui:"^2.0.9",npm_package_create_umi_ignoreDependencies_1:"serverless",npm_config_cache_lock_retries:"10",npm_config_searchstaleness:"900",npm_package_dependencies_prop_types:"^15.5.10",npm_package_devDependencies_cross_env:"^7.0.0",npm_config_save_prefix:"^",npm_config_scripts_prepend_node_path:"warn-only",npm_config_node_options:"",npm_package_scripts_deploy:"npm run site && npm run gh-pages",npm_package_scripts_docker_tag:"docker tag ant-design-pro antdesign/ant-design-pro",npm_package_dependencies__types_lodash_isequal:"^4.5.5",npm_config_group:"",npm_config_init_author_email:"",npm_config_searchexclude:"",PROGRESS:"none",npm_package_scripts_start_no_mock:"cross-env MOCK=none umi dev",npm_package_dependencies_umi:"3.1.1",npm_config_git:"git",npm_config_optional:"true",BUILD_SCRIPT:"yarn && npm uninstall husky && yarn add umi-plugin-antd-theme umi-plugin-pro  && npm run site && git checkout . && git clean -df",INIT_CWD:"/github/workspace",npm_package_scripts_docker_hub_build:"docker build  -f Dockerfile.hub -t  ant-design-pro ./",npm_package_dependencies_react:"^16.8.6",npm_config_json:"",NODE_ENV:"production",UMI_VERSION:"3.1.1",UMI_DIR:"/github/workspace/node_modules/umi"}).NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;a[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else a[n]=function(){};return a[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=v,t.isBoolean=y,t.isNull=_,t.isNullOrUndefined=b,t.isNumber=x,t.isString=w,t.isSymbol=S,t.isUndefined=E,t.isRegExp=T,t.isObject=k,t.isDate=A,t.isError=C,t.isFunction=I,t.isPrimitive=M,t.isBuffer=n("1gqn");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",R(),t.format.apply(t,arguments))},t.inherits=n("KKCa"),t._extend=function(e,t){if(!t||!k(t))return e;var n=Object.keys(t),r=n.length;while(r--)e[n[r]]=t[n[r]];return e};var z="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function N(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}function j(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!==typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(N,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}t.promisify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');if(z&&e[z]){var t=e[z];if("function"!==typeof t)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,z,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(a){n(a)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),z&&Object.defineProperty(t,z,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=z,t.callbackify=j}).call(this,n("Q2Ig"))},MON2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},O1je:function(e,t){},OBhP:function(e,t,n){var r=n("fmRc"),i=n("gFfm"),o=n("MrPd"),a=n("WwFo"),s=n("Dw+G"),u=n("5Tg0"),c=n("Q1l4"),l=n("VOtZ"),p=n("EEGq"),f=n("qZTm"),h=n("G6z8"),d=n("QqLw"),m=n("yHx3"),g=n("wrZu"),v=n("+iFO"),y=n("Z0cm"),_=n("DSRE"),b=n("zEVN"),x=n("GoyQ"),w=n("1+5i"),S=n("7GkX"),E=1,T=2,k=4,A="[object Arguments]",C="[object Array]",I="[object Boolean]",M="[object Date]",P="[object Error]",O="[object Function]",L="[object GeneratorFunction]",R="[object Map]",D="[object Number]",z="[object Object]",N="[object RegExp]",j="[object Set]",F="[object String]",B="[object Symbol]",U="[object WeakMap]",V="[object ArrayBuffer]",G="[object DataView]",q="[object Float32Array]",Z="[object Float64Array]",H="[object Int8Array]",W="[object Int16Array]",Y="[object Int32Array]",X="[object Uint8Array]",K="[object Uint8ClampedArray]",J="[object Uint16Array]",Q="[object Uint32Array]",$={};function ee(e,t,n,C,I,M){var P,R=t&E,D=t&T,N=t&k;if(n&&(P=I?n(e,C,I,M):n(e)),void 0!==P)return P;if(!x(e))return e;var j=y(e);if(j){if(P=m(e),!R)return c(e,P)}else{var F=d(e),B=F==O||F==L;if(_(e))return u(e,R);if(F==z||F==A||B&&!I){if(P=D||B?{}:v(e),!R)return D?p(e,s(P,e)):l(e,a(P,e))}else{if(!$[F])return I?e:{};P=g(e,F,R)}}M||(M=new r);var U=M.get(e);if(U)return U;M.set(e,P),w(e)?e.forEach((function(r){P.add(ee(r,t,n,r,e,M))})):b(e)&&e.forEach((function(r,i){P.set(i,ee(r,t,n,i,e,M))}));var V=N?D?h:f:D?keysIn:S,G=j?void 0:V(e);return i(G||e,(function(r,i){G&&(i=r,r=e[i]),o(P,i,ee(r,t,n,i,e,M))})),P}$[A]=$[C]=$[V]=$[G]=$[I]=$[M]=$[q]=$[Z]=$[H]=$[W]=$[Y]=$[R]=$[D]=$[z]=$[N]=$[j]=$[F]=$[B]=$[X]=$[K]=$[J]=$[Q]=!0,$[P]=$[O]=$[U]=!1,e.exports=ee},PSsN:function(e,t){},PUg6:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e["normal"]="normal",e["additive"]="additive",e["subtractive"]="subtractive",e["min"]="min",e["max"]="max"}(r||(r={}))},QGbF:function(e,t){},"QQZ/":function(e,t,n){var r=n("Sq3C"),i=n("Z1HP"),o=n("Sxd8"),a=n("dt0z");function s(e,t,n){e=a(e),t=o(t);var s=t?i(e):0;return t&&s<t?r(t-s,n)+e:e}e.exports=s},"R/W3":function(e,t,n){var r=n("KwMD"),i=n("2ajD"),o=n("CZoQ");function a(e,t,n){return t===t?o(e,t,n):r(e,i,n)}e.exports=a},"RL2/":function(e,t,n){"use strict"},RMtq:function(e,t){},"RR/i":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=function e(t,n){var r=t.parentRequest;return null!==r&&(!!n(r)||e(r,n))};t.traverseAncerstors=o;var a=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new i.Metadata(e,t),n}};t.taggedConstraint=a;var s=a(r.NAMED_TAG);t.namedConstraint=s;var u=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"===typeof e){var r=n.serviceIdentifier;return r===e}var i=t.bindings[0].implementationType;return e===i}return!1}};t.typeConstraint=u},Sk89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm"),o=n("GXnB");function a(){return function(e,t,n){var a=new o.Metadata(i.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,e.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,e.constructor)}}t.postConstruct=a},SpH2:function(e,t,n){(function(t,n){e.exports=n()})(0,(function(){"use strict";function e(n,r,i,o,a,s){if(!(a-o<=i)){var u=o+a>>1;t(n,r,u,o,a,s%2),e(n,r,i,o,u-1,s+1),e(n,r,i,u+1,a,s+1)}}function t(e,r,i,o,a,s){while(a>o){if(a-o>600){var u=a-o+1,c=i-o+1,l=Math.log(u),p=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*p*(u-p)/u)*(c-u/2<0?-1:1),h=Math.max(o,Math.floor(i-c*p/u+f)),d=Math.min(a,Math.floor(i+(u-c)*p/u+f));t(e,r,i,h,d,s)}var m=r[2*i+s],g=o,v=a;n(e,r,o,i),r[2*a+s]>m&&n(e,r,o,a);while(g<v){n(e,r,g,v),g++,v--;while(r[2*g+s]<m)g++;while(r[2*v+s]>m)v--}r[2*o+s]===m?n(e,r,o,v):(v++,n(e,r,v,a)),v<=i&&(o=v+1),i<=v&&(a=v-1)}}function n(e,t,n,i){r(e,n,i),r(t,2*n,2*i),r(t,2*n+1,2*i+1)}function r(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function i(e,t,n,r,i,o,a){var s,u,c=[0,e.length-1,0],l=[];while(c.length){var p=c.pop(),f=c.pop(),h=c.pop();if(f-h<=a)for(var d=h;d<=f;d++)s=t[2*d],u=t[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(e[d]);else{var m=Math.floor((h+f)/2);s=t[2*m],u=t[2*m+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(e[m]);var g=(p+1)%2;(0===p?n<=s:r<=u)&&(c.push(h),c.push(m-1),c.push(g)),(0===p?i>=s:o>=u)&&(c.push(m+1),c.push(f),c.push(g))}}return l}function o(e,t,n,r,i,o){var s=[0,e.length-1,0],u=[],c=i*i;while(s.length){var l=s.pop(),p=s.pop(),f=s.pop();if(p-f<=o)for(var h=f;h<=p;h++)a(t[2*h],t[2*h+1],n,r)<=c&&u.push(e[h]);else{var d=Math.floor((f+p)/2),m=t[2*d],g=t[2*d+1];a(m,g,n,r)<=c&&u.push(e[d]);var v=(l+1)%2;(0===l?n-i<=m:r-i<=g)&&(s.push(f),s.push(d-1),s.push(v)),(0===l?n+i>=m:r+i>=g)&&(s.push(d+1),s.push(p),s.push(v))}}return u}function a(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}var s=function(e){return e[0]},u=function(e){return e[1]},c=function(t,n,r,i,o){void 0===n&&(n=s),void 0===r&&(r=u),void 0===i&&(i=64),void 0===o&&(o=Float64Array),this.nodeSize=i,this.points=t;for(var a=t.length<65536?Uint16Array:Uint32Array,c=this.ids=new a(t.length),l=this.coords=new o(2*t.length),p=0;p<t.length;p++)c[p]=p,l[2*p]=n(t[p]),l[2*p+1]=r(t[p]);e(c,l,i,0,c.length-1,0)};c.prototype.range=function(e,t,n,r){return i(this.ids,this.coords,e,t,n,r,this.nodeSize)},c.prototype.within=function(e,t,n){return o(this.ids,this.coords,e,t,n,this.nodeSize)};var l={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:function(e){return e}},p=function(e){this.options=b(Object.create(l),e),this.trees=new Array(this.options.maxZoom+1)};function f(e,t,n,r,i){return{x:e,y:t,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function h(e,t){var n=e.geometry.coordinates,r=n[0],i=n[1];return{x:g(r),y:v(i),zoom:1/0,index:t,parentId:-1}}function d(e){return{type:"Feature",id:e.id,properties:m(e),geometry:{type:"Point",coordinates:[y(e.x),_(e.y)]}}}function m(e){var t=e.numPoints,n=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return b(b({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:n})}function g(e){return e/360+.5}function v(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function y(e){return 360*(e-.5)}function _(e){var t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function b(e,t){for(var n in t)e[n]=t[n];return e}function x(e){return e.x}function w(e){return e.y}return p.prototype.load=function(e){var t=this.options,n=t.log,r=t.minZoom,i=t.maxZoom,o=t.nodeSize;n&&console.time("total time");var a="prepare "+e.length+" points";n&&console.time(a),this.points=e;for(var s=[],u=0;u<e.length;u++)e[u].geometry&&s.push(h(e[u],u));this.trees[i+1]=new c(s,x,w,o,Float32Array),n&&console.timeEnd(a);for(var l=i;l>=r;l--){var p=+Date.now();s=this._cluster(s,l),this.trees[l]=new c(s,x,w,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",l,s.length,+Date.now()-p)}return n&&console.timeEnd("total time"),this},p.prototype.getClusters=function(e,t){var n=((e[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],t),s=this.getClusters([-180,r,i,o],t);return a.concat(s)}for(var u=this.trees[this._limitZoom(t)],c=u.range(g(n),v(o),g(i),v(r)),l=[],p=0,f=c;p<f.length;p+=1){var h=f[p],m=u.points[h];l.push(m.numPoints?d(m):this.points[m.index])}return l},p.prototype.getChildren=function(e){var t=e>>5,n=e%32,r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[t];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),u=[],c=0,l=s;c<l.length;c+=1){var p=l[c],f=i.points[p];f.parentId===e&&u.push(f.numPoints?d(f):this.points[f.index])}if(0===u.length)throw new Error(r);return u},p.prototype.getLeaves=function(e,t,n){t=t||10,n=n||0;var r=[];return this._appendLeaves(r,e,t,n,0),r},p.prototype.getTile=function(e,t,n){var r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),o=this.options,a=o.extent,s=o.radius,u=s/a,c=(n-u)/i,l=(n+1+u)/i,p={features:[]};return this._addTileFeatures(r.range((t-u)/i,c,(t+1+u)/i,l),r.points,t,n,i,p),0===t&&this._addTileFeatures(r.range(1-u/i,c,1,l),r.points,i,n,i,p),t===i-1&&this._addTileFeatures(r.range(0,c,u/i,l),r.points,-1,n,i,p),p.features.length?p:null},p.prototype.getClusterExpansionZoom=function(e){var t=e%32-1;while(t<=this.options.maxZoom){var n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t},p.prototype._appendLeaves=function(e,t,n,r,i){for(var o=this.getChildren(t),a=0,s=o;a<s.length;a+=1){var u=s[a],c=u.properties;if(c&&c.cluster?i+c.point_count<=r?i+=c.point_count:i=this._appendLeaves(e,c.cluster_id,n,r,i):i<r?i++:e.push(u),e.length===n)break}return i},p.prototype._addTileFeatures=function(e,t,n,r,i,o){for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=t[u],l={type:1,geometry:[[Math.round(this.options.extent*(c.x*i-n)),Math.round(this.options.extent*(c.y*i-r))]],tags:c.numPoints?m(c):this.points[c.index].properties},p=c.numPoints?c.id:this.points[c.index].id;void 0!==p&&(l.id=p),o.features.push(l)}},p.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(e,this.options.maxZoom+1))},p.prototype._cluster=function(e,t){for(var n=[],r=this.options,i=r.radius,o=r.extent,a=r.reduce,s=i/(o*Math.pow(2,t)),u=0;u<e.length;u++){var c=e[u];if(!(c.zoom<=t)){c.zoom=t;for(var l=this.trees[t+1],p=l.within(c.x,c.y,s),h=c.numPoints||1,d=c.x*h,m=c.y*h,g=a&&h>1?this._map(c,!0):null,v=(u<<5)+(t+1),y=0,_=p;y<_.length;y+=1){var b=_[y],x=l.points[b];if(!(x.zoom<=t)){x.zoom=t;var w=x.numPoints||1;d+=x.x*w,m+=x.y*w,h+=w,x.parentId=v,a&&(g||(g=this._map(c,!0)),a(g,this._map(x)))}}1===h?n.push(c):(c.parentId=v,n.push(f(d/h,m/h,v,h,g)))}}return n},p.prototype._map=function(e,t){if(e.numPoints)return t?b({},e.properties):e.properties;var n=this.points[e.index].properties,r=this.options.map(n);return t&&r===n?b({},r):r},p}))},Sq3C:function(e,t,n){var r=n("sKgW"),i=n("zoYe"),o=n("wy8a"),a=n("quyA"),s=n("Z1HP"),u=n("Em2t"),c=Math.ceil;function l(e,t){t=void 0===t?" ":i(t);var n=t.length;if(n<2)return n?r(t,e):t;var l=r(t,c(e/s(t)));return a(t)?o(u(l),0,e).join(""):l.slice(0,e)}e.exports=l},Sxd8:function(e,t,n){var r=n("ZCgT");function i(e){var t=r(e),n=t%1;return t===t?n?t-n:t:0}e.exports=i},TKrE:function(e,t,n){var r=n("qRkn"),i=n("dt0z"),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,a="\\u0300-\\u036f",s="\\ufe20-\\ufe2f",u="\\u20d0-\\u20ff",c=a+s+u,l="["+c+"]",p=RegExp(l,"g");function f(e){return e=i(e),e&&e.replace(o,r).replace(p,"")}e.exports=f},"U+yc":function(e,t){function n(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}e.exports=n},U1ZX:function(e,t){},UB5X:function(e,t,n){var r=n("NykK"),i=n("ExA7"),o="[object Number]";function a(e){return"number"==typeof e||i(e)&&r(e)==o}e.exports=a},Ucsi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Symbol.for("INJECTION");function i(e,t,n,i){function o(){return i&&!Reflect.hasMetadata(r,this,t)&&Reflect.defineMetadata(r,n(),this,t),Reflect.hasMetadata(r,this,t)?Reflect.getMetadata(r,this,t):n()}function a(e){Reflect.defineMetadata(r,e,this,t)}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:o,set:a})}function o(e,t){return function(n){return function(r,o){var a=function(){return e.get(n)};i(r,o,a,t)}}}function a(e,t){return function(n,r){return function(o,a){var s=function(){return e.getNamed(n,r)};i(o,a,s,t)}}}function s(e,t){return function(n,r,o){return function(a,s){var u=function(){return e.getTagged(n,r,o)};i(a,s,u,t)}}}function u(e,t){return function(n){return function(r,o){var a=function(){return e.getAll(n)};i(r,o,a,t)}}}t.makePropertyInjectDecorator=o,t.makePropertyInjectNamedDecorator=a,t.makePropertyInjectTaggedDecorator=s,t.makePropertyMultiInjectDecorator=u},V1cb:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e["Hover"]="hover",e["Click"]="click",e["Select"]="select",e["Active"]="active",e["Drag"]="drag"}(r||(r={}))},VIsB:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("Hel2");function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=o(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function o(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=6378e3;function u(e,t){var n=e.dataArray,r=t.size,i=void 0===r?10:r,o=c(n,i),a=o.gridHash,s=o.gridOffset,u=h(a,s,t);return{yOffset:s.yOffset/2,xOffset:s.xOffset/2,radius:s.xOffset,type:"grid",dataArray:u}}function c(e,t){var n,r,o=1/0,a=-1/0,s=i(e);try{for(s.s();!(r=s.n()).done;){var u=r.value;n=u.coordinates[1],Number.isFinite(n)&&(o=n<o?n:o,a=n>a?n:a)}}catch(x){s.e(x)}finally{s.f()}var c=(o+a)/2,p=l(t,c);if(p.xOffset<=0||p.yOffset<=0)return{gridHash:{},gridOffset:p};var f,h={},d=i(e);try{for(d.s();!(f=d.n()).done;){var m=f.value,g=m.coordinates[1],v=m.coordinates[0];if(Number.isFinite(g)&&Number.isFinite(v)){var y=Math.floor((g+90)/p.yOffset),_=Math.floor((v+180)/p.xOffset),b="".concat(y,"-").concat(_);h[b]=h[b]||{count:0,points:[]},h[b].count+=1,h[b].points.push(m)}}}catch(x){d.e(x)}finally{d.f()}return{gridHash:h,gridOffset:p}}function l(e,t){var n=p(e),r=f(t,e);return{yOffset:n,xOffset:r}}function p(e){return e/s*(180/Math.PI)}function f(e,t){return t/s*(180/Math.PI)/Math.cos(e*Math.PI/180)}function h(e,t,n){return Object.keys(e).reduce((function(i,o,a){var s=o.split("-"),u=parseInt(s[0],10),c=parseInt(s[1],10),l={};if(n.field&&n.method){var p=r["c"].getColumn(e[o].points,n.field);l[n.method]=r["c"].statMap[n.method](p)}return Object.assign(l,{_id:a,coordinates:[t.xOffset*(c+.5)-180,t.yOffset*(u+.5)-90],rawData:e[o].points,count:e[o].count}),i.push(l),i}),[])}},VOtZ:function(e,t,n){var r=n("juv8"),i=n("MvSz");function o(e,t){return r(e,i(e),t)}e.exports=o},VmRL:function(e,t,n){"use strict";function r(e,t,n){n=n||2;var r,o,s,u,c,l,f,h=t&&t.length,d=h?t[0]*n:e.length,m=i(e,0,d,n,!0),g=[];if(!m||m.next===m.prev)return g;if(h&&(m=p(e,t,m,n)),e.length>80*n){r=s=e[0],o=u=e[1];for(var v=n;v<d;v+=n)c=e[v],l=e[v+1],c<r&&(r=c),l<o&&(o=l),c>s&&(s=c),l>u&&(u=l);f=Math.max(s-r,u-o),f=0!==f?1/f:0}return a(m,g,n,r,o,f),g}function i(e,t,n,r,i){var o,a;if(i===R(e,t,n,r)>0)for(o=t;o<n;o+=r)a=P(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=P(o,e[o],e[o+1],a);return a&&S(a,a.next)&&(O(a),a=a.next),a}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!S(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(O(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function a(e,t,n,r,i,p,f){if(e){!f&&p&&g(e,r,i,p);var h,d,m=e;while(e.prev!==e.next)if(h=e.prev,d=e.next,p?u(e,r,i,p):s(e))t.push(h.i/n),t.push(e.i/n),t.push(d.i/n),O(e),e=d.next,m=d.next;else if(e=d,e===m){f?1===f?(e=c(o(e),t,n),a(e,t,n,r,i,p,2)):2===f&&l(e,t,n,r,i,p):a(o(e),t,n,r,i,p,1);break}}}function s(e){var t=e.prev,n=e,r=e.next;if(w(t,n,r)>=0)return!1;var i=e.next.next;while(i!==e.prev){if(b(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&w(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(e,t,n,r){var i=e.prev,o=e,a=e.next;if(w(i,o,a)>=0)return!1;var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,p=y(s,u,t,n,r),f=y(c,l,t,n,r),h=e.prevZ,d=e.nextZ;while(h&&h.z>=p&&d&&d.z<=f){if(h!==e.prev&&h!==e.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==e.prev&&d!==e.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}while(h&&h.z>=p){if(h!==e.prev&&h!==e.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;h=h.prevZ}while(d&&d.z<=f){if(d!==e.prev&&d!==e.next&&b(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function c(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!S(i,a)&&E(i,r,r.next,a)&&C(i,a)&&C(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),O(r),O(r.next),r=e=a),r=r.next}while(r!==e);return o(r)}function l(e,t,n,r,i,s){var u=e;do{var c=u.next.next;while(c!==u.prev){if(u.i!==c.i&&x(u,c)){var l=M(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,t,n,r,i,s),void a(l,t,n,r,i,s)}c=c.next}u=u.next}while(u!==e)}function p(e,t,n,r){var a,s,u,c,l,p=[];for(a=0,s=t.length;a<s;a++)u=t[a]*r,c=a<s-1?t[a+1]*r:e.length,l=i(e,u,c,r,!1),l===l.next&&(l.steiner=!0),p.push(_(l));for(p.sort(f),a=0;a<p.length;a++)h(p[a],n),n=o(n,n.next);return n}function f(e,t){return e.x-t.x}function h(e,t){if(t=d(e,t),t){var n=M(t,e);o(t,t.next),o(n,n.next)}}function d(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,p=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&b(o<p?i:a,o,l,p,o<p?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),C(r,e)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&m(n,r)))&&(n=r,f=u)),r=r.next}while(r!==c);return n}function m(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function g(e,t,n,r){var i=e;do{null===i.z&&(i.z=y(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,v(i)}function v(e){var t,n,r,i,o,a,s,u,c=1;do{n=e,e=null,o=null,a=0;while(n){for(a++,r=n,s=0,t=0;t<c;t++)if(s++,r=r.nextZ,!r)break;u=c;while(s>0||u>0&&r)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1);return e}function y(e,t,n,r,i){return e=32767*(e-n)*i,t=32767*(t-r)*i,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function _(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function b(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!A(e,t)&&(C(e,t)&&C(t,e)&&I(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||S(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function S(e,t){return e.x===t.x&&e.y===t.y}function E(e,t,n,r){var i=k(w(e,t,n)),o=k(w(e,t,r)),a=k(w(n,r,e)),s=k(w(n,r,t));return i!==o&&a!==s||(!(0!==i||!T(e,n,t))||(!(0!==o||!T(e,r,t))||(!(0!==a||!T(n,e,r))||!(0!==s||!T(n,t,r)))))}function T(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function k(e){return e>0?1:e<0?-1:0}function A(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&E(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function C(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function I(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}function M(e,t){var n=new L(e.i,e.x,e.y),r=new L(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function P(e,t,n,r){var i=new L(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function O(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function L(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}e.exports=r,e.exports.default=r,r.deviation=function(e,t,n,r){var i=t&&t.length,o=i?t[0]*n:e.length,a=Math.abs(R(e,0,o,n));if(i)for(var s=0,u=t.length;s<u;s++){var c=t[s]*n,l=s<u-1?t[s+1]*n:e.length;a-=Math.abs(R(e,c,l,n))}var p=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,h=r[s+1]*n,d=r[s+2]*n;p+=Math.abs((e[f]-e[d])*(e[h+1]-e[f+1])-(e[f]-e[h])*(e[d+1]-e[f+1]))}return 0===a&&0===p?0:Math.abs((p-a)/a)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},WFAs:function(e,t){var n=Array.isArray;e.exports=n},WwFo:function(e,t,n){var r=n("juv8"),i=n("7GkX");function o(e,t){return e&&r(t,i(t),e)}e.exports=o},XYm9:function(e,t,n){var r=n("+K+b");function i(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}e.exports=i},"Xt/L":function(e,t){function n(e,t,n){var r=-1,i=null==e?0:e.length;while(++r<i)if(n(t,e[r]))return!0;return!1}e.exports=n},Y8BV:function(e,t,n){"use strict";function r(e,t){var n=t.callback;return n&&(e.dataArray=e.dataArray.filter(n)),e}n.d(t,"a",(function(){return r}))},Yk9n:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm"),o=n("GXnB"),a=n("Ztfv"),s=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();function u(e){return function(t,n,s){if(void 0===e)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(t.name));var u=new o.Metadata(i.INJECT_TAG,e);"number"===typeof s?a.tagParameter(t,n,s,u):a.tagProperty(t,n,u)}}t.LazyServiceIdentifer=s,t.inject=u},Z1HP:function(e,t,n){var r=n("ycre"),i=n("quyA"),o=n("q4HE");function a(e){return i(e)?o(e):r(e)}e.exports=a},ZCgT:function(e,t,n){var r=n("tLB3"),i=1/0,o=17976931348623157e292;function a(e){if(!e)return 0===e?e:0;if(e=r(e),e===i||e===-i){var t=e<0?-1:1;return t*o}return e===e?e:0}e.exports=a},ZK94:function(e,t){e.exports.RADIUS=6378137,e.exports.FLATTENING=1/298.257223563,e.exports.POLAR_RADIUS=6356752.3142},ZaHm:function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return i})),n.d(t,"clone",(function(){return o})),n.d(t,"copy",(function(){return a})),n.d(t,"fromValues",(function(){return s})),n.d(t,"set",(function(){return u})),n.d(t,"identity",(function(){return c})),n.d(t,"transpose",(function(){return l})),n.d(t,"invert",(function(){return p})),n.d(t,"adjoint",(function(){return f})),n.d(t,"determinant",(function(){return h})),n.d(t,"multiply",(function(){return d})),n.d(t,"translate",(function(){return m})),n.d(t,"scale",(function(){return g})),n.d(t,"rotate",(function(){return v})),n.d(t,"rotateX",(function(){return y})),n.d(t,"rotateY",(function(){return _})),n.d(t,"rotateZ",(function(){return b})),n.d(t,"fromTranslation",(function(){return x})),n.d(t,"fromScaling",(function(){return w})),n.d(t,"fromRotation",(function(){return S})),n.d(t,"fromXRotation",(function(){return E})),n.d(t,"fromYRotation",(function(){return T})),n.d(t,"fromZRotation",(function(){return k})),n.d(t,"fromRotationTranslation",(function(){return A})),n.d(t,"fromQuat2",(function(){return C})),n.d(t,"getTranslation",(function(){return I})),n.d(t,"getScaling",(function(){return M})),n.d(t,"getRotation",(function(){return P})),n.d(t,"fromRotationTranslationScale",(function(){return O})),n.d(t,"fromRotationTranslationScaleOrigin",(function(){return L})),n.d(t,"fromQuat",(function(){return R})),n.d(t,"frustum",(function(){return D})),n.d(t,"perspective",(function(){return z})),n.d(t,"perspectiveFromFieldOfView",(function(){return N})),n.d(t,"ortho",(function(){return j})),n.d(t,"lookAt",(function(){return F})),n.d(t,"targetTo",(function(){return B})),n.d(t,"str",(function(){return U})),n.d(t,"frob",(function(){return V})),n.d(t,"add",(function(){return G})),n.d(t,"subtract",(function(){return q})),n.d(t,"multiplyScalar",(function(){return Z})),n.d(t,"multiplyScalarAndAdd",(function(){return H})),n.d(t,"exactEquals",(function(){return W})),n.d(t,"equals",(function(){return Y})),n.d(t,"mul",(function(){return X})),n.d(t,"sub",(function(){return K}));var r=n("yU0y");function i(){var e=new r["a"](16);return r["a"]!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function o(e){var t=new r["a"](16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function s(e,t,n,i,o,a,s,u,c,l,p,f,h,d,m,g){var v=new r["a"](16);return v[0]=e,v[1]=t,v[2]=n,v[3]=i,v[4]=o,v[5]=a,v[6]=s,v[7]=u,v[8]=c,v[9]=l,v[10]=p,v[11]=f,v[12]=h,v[13]=d,v[14]=m,v[15]=g,v}function u(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d,m,g){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=p,e[11]=f,e[12]=h,e[13]=d,e[14]=m,e[15]=g,e}function c(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function l(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function p(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],p=t[9],f=t[10],h=t[11],d=t[12],m=t[13],g=t[14],v=t[15],y=n*s-r*a,_=n*u-i*a,b=n*c-o*a,x=r*u-i*s,w=r*c-o*s,S=i*c-o*u,E=l*m-p*d,T=l*g-f*d,k=l*v-h*d,A=p*g-f*m,C=p*v-h*m,I=f*v-h*g,M=y*I-_*C+b*A+x*k-w*T+S*E;return M?(M=1/M,e[0]=(s*I-u*C+c*A)*M,e[1]=(i*C-r*I-o*A)*M,e[2]=(m*S-g*w+v*x)*M,e[3]=(f*w-p*S-h*x)*M,e[4]=(u*k-a*I-c*T)*M,e[5]=(n*I-i*k+o*T)*M,e[6]=(g*b-d*S-v*_)*M,e[7]=(l*S-f*b+h*_)*M,e[8]=(a*C-s*k+c*E)*M,e[9]=(r*k-n*C-o*E)*M,e[10]=(d*w-m*b+v*y)*M,e[11]=(p*b-l*w-h*y)*M,e[12]=(s*T-a*A-u*E)*M,e[13]=(n*A-r*T+i*E)*M,e[14]=(m*_-d*x-g*y)*M,e[15]=(l*x-p*_+f*y)*M,e):null}function f(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],p=t[9],f=t[10],h=t[11],d=t[12],m=t[13],g=t[14],v=t[15];return e[0]=s*(f*v-h*g)-p*(u*v-c*g)+m*(u*h-c*f),e[1]=-(r*(f*v-h*g)-p*(i*v-o*g)+m*(i*h-o*f)),e[2]=r*(u*v-c*g)-s*(i*v-o*g)+m*(i*c-o*u),e[3]=-(r*(u*h-c*f)-s*(i*h-o*f)+p*(i*c-o*u)),e[4]=-(a*(f*v-h*g)-l*(u*v-c*g)+d*(u*h-c*f)),e[5]=n*(f*v-h*g)-l*(i*v-o*g)+d*(i*h-o*f),e[6]=-(n*(u*v-c*g)-a*(i*v-o*g)+d*(i*c-o*u)),e[7]=n*(u*h-c*f)-a*(i*h-o*f)+l*(i*c-o*u),e[8]=a*(p*v-h*m)-l*(s*v-c*m)+d*(s*h-c*p),e[9]=-(n*(p*v-h*m)-l*(r*v-o*m)+d*(r*h-o*p)),e[10]=n*(s*v-c*m)-a*(r*v-o*m)+d*(r*c-o*s),e[11]=-(n*(s*h-c*p)-a*(r*h-o*p)+l*(r*c-o*s)),e[12]=-(a*(p*g-f*m)-l*(s*g-u*m)+d*(s*f-u*p)),e[13]=n*(p*g-f*m)-l*(r*g-i*m)+d*(r*f-i*p),e[14]=-(n*(s*g-u*m)-a*(r*g-i*m)+d*(r*u-i*s)),e[15]=n*(s*f-u*p)-a*(r*f-i*p)+l*(r*u-i*s),e}function h(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],p=e[10],f=e[11],h=e[12],d=e[13],m=e[14],g=e[15],v=t*a-n*o,y=t*s-r*o,_=t*u-i*o,b=n*s-r*a,x=n*u-i*a,w=r*u-i*s,S=c*d-l*h,E=c*m-p*h,T=c*g-f*h,k=l*m-p*d,A=l*g-f*d,C=p*g-f*m;return v*C-y*A+_*k+b*T-x*E+w*S}function d(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],p=t[8],f=t[9],h=t[10],d=t[11],m=t[12],g=t[13],v=t[14],y=t[15],_=n[0],b=n[1],x=n[2],w=n[3];return e[0]=_*r+b*s+x*p+w*m,e[1]=_*i+b*u+x*f+w*g,e[2]=_*o+b*c+x*h+w*v,e[3]=_*a+b*l+x*d+w*y,_=n[4],b=n[5],x=n[6],w=n[7],e[4]=_*r+b*s+x*p+w*m,e[5]=_*i+b*u+x*f+w*g,e[6]=_*o+b*c+x*h+w*v,e[7]=_*a+b*l+x*d+w*y,_=n[8],b=n[9],x=n[10],w=n[11],e[8]=_*r+b*s+x*p+w*m,e[9]=_*i+b*u+x*f+w*g,e[10]=_*o+b*c+x*h+w*v,e[11]=_*a+b*l+x*d+w*y,_=n[12],b=n[13],x=n[14],w=n[15],e[12]=_*r+b*s+x*p+w*m,e[13]=_*i+b*u+x*f+w*g,e[14]=_*o+b*c+x*h+w*v,e[15]=_*a+b*l+x*d+w*y,e}function m(e,t,n){var r,i,o,a,s,u,c,l,p,f,h,d,m=n[0],g=n[1],v=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],p=t[8],f=t[9],h=t[10],d=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=p,e[9]=f,e[10]=h,e[11]=d,e[12]=r*m+s*g+p*v+t[12],e[13]=i*m+u*g+f*v+t[13],e[14]=o*m+c*g+h*v+t[14],e[15]=a*m+l*g+d*v+t[15]),e}function g(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function v(e,t,n,i){var o,a,s,u,c,l,p,f,h,d,m,g,v,y,_,b,x,w,S,E,T,k,A,C,I=i[0],M=i[1],P=i[2],O=Math.hypot(I,M,P);return O<r["b"]?null:(O=1/O,I*=O,M*=O,P*=O,o=Math.sin(n),a=Math.cos(n),s=1-a,u=t[0],c=t[1],l=t[2],p=t[3],f=t[4],h=t[5],d=t[6],m=t[7],g=t[8],v=t[9],y=t[10],_=t[11],b=I*I*s+a,x=M*I*s+P*o,w=P*I*s-M*o,S=I*M*s-P*o,E=M*M*s+a,T=P*M*s+I*o,k=I*P*s+M*o,A=M*P*s-I*o,C=P*P*s+a,e[0]=u*b+f*x+g*w,e[1]=c*b+h*x+v*w,e[2]=l*b+d*x+y*w,e[3]=p*b+m*x+_*w,e[4]=u*S+f*E+g*T,e[5]=c*S+h*E+v*T,e[6]=l*S+d*E+y*T,e[7]=p*S+m*E+_*T,e[8]=u*k+f*A+g*C,e[9]=c*k+h*A+v*C,e[10]=l*k+d*A+y*C,e[11]=p*k+m*A+_*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function y(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],p=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*r,e[5]=a*i+l*r,e[6]=s*i+p*r,e[7]=u*i+f*r,e[8]=c*i-o*r,e[9]=l*i-a*r,e[10]=p*i-s*r,e[11]=f*i-u*r,e}function _(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],p=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*r,e[1]=a*i-l*r,e[2]=s*i-p*r,e[3]=u*i-f*r,e[8]=o*r+c*i,e[9]=a*r+l*i,e[10]=s*r+p*i,e[11]=u*r+f*i,e}function b(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],p=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*r,e[1]=a*i+l*r,e[2]=s*i+p*r,e[3]=u*i+f*r,e[4]=c*i-o*r,e[5]=l*i-a*r,e[6]=p*i-s*r,e[7]=f*i-u*r,e}function x(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function w(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function S(e,t,n){var i,o,a,s=n[0],u=n[1],c=n[2],l=Math.hypot(s,u,c);return l<r["b"]?null:(l=1/l,s*=l,u*=l,c*=l,i=Math.sin(t),o=Math.cos(t),a=1-o,e[0]=s*s*a+o,e[1]=u*s*a+c*i,e[2]=c*s*a-u*i,e[3]=0,e[4]=s*u*a-c*i,e[5]=u*u*a+o,e[6]=c*u*a+s*i,e[7]=0,e[8]=s*c*a+u*i,e[9]=u*c*a-s*i,e[10]=c*c*a+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function E(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function T(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function k(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function A(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,c=o+o,l=r*s,p=r*u,f=r*c,h=i*u,d=i*c,m=o*c,g=a*s,v=a*u,y=a*c;return e[0]=1-(h+m),e[1]=p+y,e[2]=f-v,e[3]=0,e[4]=p-y,e[5]=1-(l+m),e[6]=d+g,e[7]=0,e[8]=f+v,e[9]=d-g,e[10]=1-(l+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function C(e,t){var n=new r["a"](3),i=-t[0],o=-t[1],a=-t[2],s=t[3],u=t[4],c=t[5],l=t[6],p=t[7],f=i*i+o*o+a*a+s*s;return f>0?(n[0]=2*(u*s+p*i+c*a-l*o)/f,n[1]=2*(c*s+p*o+l*i-u*a)/f,n[2]=2*(l*s+p*a+u*o-c*i)/f):(n[0]=2*(u*s+p*i+c*a-l*o),n[1]=2*(c*s+p*o+l*i-u*a),n[2]=2*(l*s+p*a+u*o-c*i)),A(e,t,n),e}function I(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function M(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(u,c,l),e}function P(e,t){var n=new r["a"](3);M(n,t);var i=1/n[0],o=1/n[1],a=1/n[2],s=t[0]*i,u=t[1]*o,c=t[2]*a,l=t[4]*i,p=t[5]*o,f=t[6]*a,h=t[8]*i,d=t[9]*o,m=t[10]*a,g=s+p+m,v=0;return g>0?(v=2*Math.sqrt(g+1),e[3]=.25*v,e[0]=(f-d)/v,e[1]=(h-c)/v,e[2]=(u-l)/v):s>p&&s>m?(v=2*Math.sqrt(1+s-p-m),e[3]=(f-d)/v,e[0]=.25*v,e[1]=(u+l)/v,e[2]=(h+c)/v):p>m?(v=2*Math.sqrt(1+p-s-m),e[3]=(h-c)/v,e[0]=(u+l)/v,e[1]=.25*v,e[2]=(f+d)/v):(v=2*Math.sqrt(1+m-s-p),e[3]=(u-l)/v,e[0]=(h+c)/v,e[1]=(f+d)/v,e[2]=.25*v),e}function O(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,c=o+o,l=a+a,p=i*u,f=i*c,h=i*l,d=o*c,m=o*l,g=a*l,v=s*u,y=s*c,_=s*l,b=r[0],x=r[1],w=r[2];return e[0]=(1-(d+g))*b,e[1]=(f+_)*b,e[2]=(h-y)*b,e[3]=0,e[4]=(f-_)*x,e[5]=(1-(p+g))*x,e[6]=(m+v)*x,e[7]=0,e[8]=(h+y)*w,e[9]=(m-v)*w,e[10]=(1-(p+d))*w,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function L(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],u=t[3],c=o+o,l=a+a,p=s+s,f=o*c,h=o*l,d=o*p,m=a*l,g=a*p,v=s*p,y=u*c,_=u*l,b=u*p,x=r[0],w=r[1],S=r[2],E=i[0],T=i[1],k=i[2],A=(1-(m+v))*x,C=(h+b)*x,I=(d-_)*x,M=(h-b)*w,P=(1-(f+v))*w,O=(g+y)*w,L=(d+_)*S,R=(g-y)*S,D=(1-(f+m))*S;return e[0]=A,e[1]=C,e[2]=I,e[3]=0,e[4]=M,e[5]=P,e[6]=O,e[7]=0,e[8]=L,e[9]=R,e[10]=D,e[11]=0,e[12]=n[0]+E-(A*E+M*T+L*k),e[13]=n[1]+T-(C*E+P*T+R*k),e[14]=n[2]+k-(I*E+O*T+D*k),e[15]=1,e}function R(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,p=r*s,f=i*a,h=i*s,d=i*u,m=o*a,g=o*s,v=o*u;return e[0]=1-p-d,e[1]=l+v,e[2]=f-g,e[3]=0,e[4]=l-v,e[5]=1-c-d,e[6]=h+m,e[7]=0,e[8]=f+g,e[9]=h-m,e[10]=1-c-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function D(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}function z(e,t,n,r,i){var o,a=1/Math.tan(t/2);return e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e}function N(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function j(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*c,e[15]=1,e}function F(e,t,n,i){var o,a,s,u,l,p,f,h,d,m,g=t[0],v=t[1],y=t[2],_=i[0],b=i[1],x=i[2],w=n[0],S=n[1],E=n[2];return Math.abs(g-w)<r["b"]&&Math.abs(v-S)<r["b"]&&Math.abs(y-E)<r["b"]?c(e):(f=g-w,h=v-S,d=y-E,m=1/Math.hypot(f,h,d),f*=m,h*=m,d*=m,o=b*d-x*h,a=x*f-_*d,s=_*h-b*f,m=Math.hypot(o,a,s),m?(m=1/m,o*=m,a*=m,s*=m):(o=0,a=0,s=0),u=h*s-d*a,l=d*o-f*s,p=f*a-h*o,m=Math.hypot(u,l,p),m?(m=1/m,u*=m,l*=m,p*=m):(u=0,l=0,p=0),e[0]=o,e[1]=u,e[2]=f,e[3]=0,e[4]=a,e[5]=l,e[6]=h,e[7]=0,e[8]=s,e[9]=p,e[10]=d,e[11]=0,e[12]=-(o*g+a*v+s*y),e[13]=-(u*g+l*v+p*y),e[14]=-(f*g+h*v+d*y),e[15]=1,e)}function B(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=r[0],u=r[1],c=r[2],l=i-n[0],p=o-n[1],f=a-n[2],h=l*l+p*p+f*f;h>0&&(h=1/Math.sqrt(h),l*=h,p*=h,f*=h);var d=u*f-c*p,m=c*l-s*f,g=s*p-u*l;return h=d*d+m*m+g*g,h>0&&(h=1/Math.sqrt(h),d*=h,m*=h,g*=h),e[0]=d,e[1]=m,e[2]=g,e[3]=0,e[4]=p*g-f*m,e[5]=f*d-l*g,e[6]=l*m-p*d,e[7]=0,e[8]=l,e[9]=p,e[10]=f,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function U(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function V(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function G(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function q(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Z(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function H(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function W(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Y(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],p=e[8],f=e[9],h=e[10],d=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=t[0],b=t[1],x=t[2],w=t[3],S=t[4],E=t[5],T=t[6],k=t[7],A=t[8],C=t[9],I=t[10],M=t[11],P=t[12],O=t[13],L=t[14],R=t[15];return Math.abs(n-_)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-b)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-x)<=r["b"]*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-w)<=r["b"]*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-S)<=r["b"]*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-E)<=r["b"]*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-T)<=r["b"]*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(l-k)<=r["b"]*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(p-A)<=r["b"]*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(f-C)<=r["b"]*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(h-I)<=r["b"]*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(d-M)<=r["b"]*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(m-P)<=r["b"]*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(g-O)<=r["b"]*Math.max(1,Math.abs(g),Math.abs(O))&&Math.abs(v-L)<=r["b"]*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(y-R)<=r["b"]*Math.max(1,Math.abs(y),Math.abs(R))}var X=d,K=q},Ztfv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm");function o(e,t,n,r){var o=i.TAGGED;s(o,e,t,r,n)}function a(e,t,n){var r=i.TAGGED_PROP;s(r,e.constructor,t,n)}function s(e,t,n,i,o){var a={},s="number"===typeof o,u=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var c=a[u];if(Array.isArray(c))for(var l=0,p=c;l<p.length;l++){var f=p[l];if(f.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+f.key.toString())}else c=[];c.push(i),a[u]=c,Reflect.defineMetadata(e,a,t)}function u(e,t){Reflect.decorate(e,t)}function c(e,t){return function(n,r){t(n,r,e)}}function l(e,t,n){"number"===typeof n?u([c(n,e)],t):"string"===typeof n?Reflect.decorate([e],t,n):u([e],t)}t.tagParameter=o,t.tagProperty=a,t.decorate=l},ZxFD:function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return i})),n.d(t,"clone",(function(){return o})),n.d(t,"fromValues",(function(){return a})),n.d(t,"copy",(function(){return s})),n.d(t,"set",(function(){return u})),n.d(t,"add",(function(){return c})),n.d(t,"subtract",(function(){return l})),n.d(t,"multiply",(function(){return p})),n.d(t,"divide",(function(){return f})),n.d(t,"ceil",(function(){return h})),n.d(t,"floor",(function(){return d})),n.d(t,"min",(function(){return m})),n.d(t,"max",(function(){return g})),n.d(t,"round",(function(){return v})),n.d(t,"scale",(function(){return y})),n.d(t,"scaleAndAdd",(function(){return _})),n.d(t,"distance",(function(){return b})),n.d(t,"squaredDistance",(function(){return x})),n.d(t,"length",(function(){return w})),n.d(t,"squaredLength",(function(){return S})),n.d(t,"negate",(function(){return E})),n.d(t,"inverse",(function(){return T})),n.d(t,"normalize",(function(){return k})),n.d(t,"dot",(function(){return A})),n.d(t,"cross",(function(){return C})),n.d(t,"lerp",(function(){return I})),n.d(t,"random",(function(){return M})),n.d(t,"transformMat2",(function(){return P})),n.d(t,"transformMat2d",(function(){return O})),n.d(t,"transformMat3",(function(){return L})),n.d(t,"transformMat4",(function(){return R})),n.d(t,"rotate",(function(){return D})),n.d(t,"angle",(function(){return z})),n.d(t,"zero",(function(){return N})),n.d(t,"str",(function(){return j})),n.d(t,"exactEquals",(function(){return F})),n.d(t,"equals",(function(){return B})),n.d(t,"len",(function(){return U})),n.d(t,"sub",(function(){return V})),n.d(t,"mul",(function(){return G})),n.d(t,"div",(function(){return q})),n.d(t,"dist",(function(){return Z})),n.d(t,"sqrDist",(function(){return H})),n.d(t,"sqrLen",(function(){return W})),n.d(t,"forEach",(function(){return Y}));var r=n("yU0y");function i(){var e=new r["a"](2);return r["a"]!=Float32Array&&(e[0]=0,e[1]=0),e}function o(e){var t=new r["a"](2);return t[0]=e[0],t[1]=e[1],t}function a(e,t){var n=new r["a"](2);return n[0]=e,n[1]=t,n}function s(e,t){return e[0]=t[0],e[1]=t[1],e}function u(e,t,n){return e[0]=t,e[1]=n,e}function c(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function l(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function p(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function f(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function h(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function d(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function m(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}function g(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}function v(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function y(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function _(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e}function b(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.hypot(n,r)}function x(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function w(e){var t=e[0],n=e[1];return Math.hypot(t,n)}function S(e){var t=e[0],n=e[1];return t*t+n*n}function E(e,t){return e[0]=-t[0],e[1]=-t[1],e}function T(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function k(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function A(e,t){return e[0]*t[0]+e[1]*t[1]}function C(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e}function I(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e}function M(e,t){t=t||1;var n=2*r["c"]()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}function P(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e}function O(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e}function L(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e}function R(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}function D(e,t,n,r){var i=t[0]-n[0],o=t[1]-n[1],a=Math.sin(r),s=Math.cos(r);return e[0]=i*s-o*a+n[0],e[1]=i*a+o*s+n[1],e}function z(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),s=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function N(e){return e[0]=0,e[1]=0,e}function j(e){return"vec2("+e[0]+", "+e[1]+")"}function F(e,t){return e[0]===t[0]&&e[1]===t[1]}function B(e,t){var n=e[0],i=e[1],o=t[0],a=t[1];return Math.abs(n-o)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(a))}var U=w,V=l,G=p,q=f,Z=b,H=x,W=S,Y=function(){var e=i();return function(t,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}()},ZzCi:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(e){return function(t,n,a){var s=new i.Metadata(r.NAMED_TAG,e);"number"===typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}t.named=a},aF1E:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("lSNA"),i=n.n(r);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){var n=t.sourceField,r=t.targetField,i=t.data,o={};return i.forEach((function(e){o[e[n]]=e})),e.dataArray=e.dataArray.map((function(e){var t=e[r];return a({},o[t],{},e)})),e}},aHsQ:function(e,t,n){"use strict";n("cIOH"),n("6D9b")},aPG5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("FV85"),o=n("qK8v"),a=n("ujMp"),s=n("cSJO"),u=function(e,t,n){try{return n()}catch(i){throw o.isStackOverflowExeption(i)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):i}},c=function e(t){return function(n){n.parentContext.setCurrentRequest(n);var o=n.bindings,c=n.childRequests,l=n.target&&n.target.isArray(),p=!n.parentRequest||!n.parentRequest.target||!n.target||!n.parentRequest.target.matchesArray(n.target.serviceIdentifier);if(l&&p)return c.map((function(n){var r=e(t);return r(n)}));var f=null;if(!n.target.isOptional()||0!==o.length){var h=o[0],d=h.scope===i.BindingScopeEnum.Singleton,m=h.scope===i.BindingScopeEnum.Request;if(d&&h.activated)return h.cache;if(m&&null!==t&&t.has(h.id))return t.get(h.id);if(h.type===i.BindingTypeEnum.ConstantValue)f=h.cache;else if(h.type===i.BindingTypeEnum.Function)f=h.cache;else if(h.type===i.BindingTypeEnum.Constructor)f=h.implementationType;else if(h.type===i.BindingTypeEnum.DynamicValue&&null!==h.dynamicValue)f=u("toDynamicValue",h.serviceIdentifier,(function(){return h.dynamicValue(n.parentContext)}));else if(h.type===i.BindingTypeEnum.Factory&&null!==h.factory)f=u("toFactory",h.serviceIdentifier,(function(){return h.factory(n.parentContext)}));else if(h.type===i.BindingTypeEnum.Provider&&null!==h.provider)f=u("toProvider",h.serviceIdentifier,(function(){return h.provider(n.parentContext)}));else{if(h.type!==i.BindingTypeEnum.Instance||null===h.implementationType){var g=a.getServiceIdentifierAsString(n.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+g)}f=s.resolveInstance(h.implementationType,c,e(t))}return"function"===typeof h.onActivation&&(f=h.onActivation(n.parentContext,f)),d&&(h.cache=f,h.activated=!0),m&&null!==t&&!t.has(h.id)&&t.set(h.id,f),f}}};function l(e){var t=c(e.plan.rootRequest.requestScope);return t(e.plan.rootRequest)}t.resolve=l},asDA:function(e,t){function n(e,t,n,r){var i=-1,o=null==e?0:e.length;r&&o&&(n=e[++i]);while(++i<o)n=t(n,e[i],i,e);return n}e.exports=n},b2z7:function(e,t){var n=/\w*$/;function r(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}e.exports=r},b48C:function(e,t){function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}e.exports=n},bB6j:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e["Normal"]="normal",e["PostProcessing"]="post-processing"}(r||(r={}))},bTtR:function(e,t){},bYl4:function(e,t){},bl9R:function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return i})),n.d(t,"clone",(function(){return o})),n.d(t,"fromValues",(function(){return a})),n.d(t,"copy",(function(){return s})),n.d(t,"set",(function(){return u})),n.d(t,"add",(function(){return c})),n.d(t,"subtract",(function(){return l})),n.d(t,"multiply",(function(){return p})),n.d(t,"divide",(function(){return f})),n.d(t,"ceil",(function(){return h})),n.d(t,"floor",(function(){return d})),n.d(t,"min",(function(){return m})),n.d(t,"max",(function(){return g})),n.d(t,"round",(function(){return v})),n.d(t,"scale",(function(){return y})),n.d(t,"scaleAndAdd",(function(){return _})),n.d(t,"distance",(function(){return b})),n.d(t,"squaredDistance",(function(){return x})),n.d(t,"length",(function(){return w})),n.d(t,"squaredLength",(function(){return S})),n.d(t,"negate",(function(){return E})),n.d(t,"inverse",(function(){return T})),n.d(t,"normalize",(function(){return k})),n.d(t,"dot",(function(){return A})),n.d(t,"cross",(function(){return C})),n.d(t,"lerp",(function(){return I})),n.d(t,"random",(function(){return M})),n.d(t,"transformMat4",(function(){return P})),n.d(t,"transformQuat",(function(){return O})),n.d(t,"zero",(function(){return L})),n.d(t,"str",(function(){return R})),n.d(t,"exactEquals",(function(){return D})),n.d(t,"equals",(function(){return z})),n.d(t,"sub",(function(){return N})),n.d(t,"mul",(function(){return j})),n.d(t,"div",(function(){return F})),n.d(t,"dist",(function(){return B})),n.d(t,"sqrDist",(function(){return U})),n.d(t,"len",(function(){return V})),n.d(t,"sqrLen",(function(){return G})),n.d(t,"forEach",(function(){return q}));var r=n("yU0y");function i(){var e=new r["a"](4);return r["a"]!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function o(e){var t=new r["a"](4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,n,i){var o=new r["a"](4);return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function u(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function c(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}function l(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function p(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function f(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function h(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function d(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function m(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}function g(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}function v(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function y(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function _(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e}function b(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.hypot(n,r,i,o)}function x(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function w(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.hypot(t,n,r,i)}function S(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}function E(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function T(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function k(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a,e}function A(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function C(e,t,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],s=n[1]*r[2]-n[2]*r[1],u=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],l=t[0],p=t[1],f=t[2],h=t[3];return e[0]=p*c-f*u+h*s,e[1]=-l*c+f*a-h*o,e[2]=l*u-p*a+h*i,e[3]=-l*s+p*o-f*i,e}function I(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e}function M(e,t){var n,i,o,a,s,u;t=t||1;do{n=2*r["c"]()-1,i=2*r["c"]()-1,s=n*n+i*i}while(s>=1);do{o=2*r["c"]()-1,a=2*r["c"]()-1,u=o*o+a*a}while(u>=1);var c=Math.sqrt((1-s)/u);return e[0]=t*n,e[1]=t*i,e[2]=t*o*c,e[3]=t*a*c,e}function P(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e}function O(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,p=c*i+u*r-a*o,f=c*o+a*i-s*r,h=-a*r-s*i-u*o;return e[0]=l*c+h*-a+p*-u-f*-s,e[1]=p*c+h*-s+f*-a-l*-u,e[2]=f*c+h*-u+l*-s-p*-a,e[3]=t[3],e}function L(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function R(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function D(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function z(e,t){var n=e[0],i=e[1],o=e[2],a=e[3],s=t[0],u=t[1],c=t[2],l=t[3];return Math.abs(n-s)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r["b"]*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=r["b"]*Math.max(1,Math.abs(a),Math.abs(l))}var N=l,j=p,F=f,B=b,U=x,V=w,G=S,q=function(){var e=i();return function(t,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}()},bzyH:function(e,t){},cSJO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("FV85"),o=n("xfSm");function a(e,t,n){var r=t.filter((function(e){return null!==e.target&&e.target.type===i.TargetTypeEnum.ClassProperty})),o=r.map(n);return r.forEach((function(t,n){var r="";r=t.target.name.value();var i=o[n];e[r]=i})),e}function s(e,t){return new(e.bind.apply(e,[void 0].concat(t)))}function u(e,t){if(Reflect.hasMetadata(o.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,e);try{t[n.value]()}catch(i){throw new Error(r.POST_CONSTRUCT_ERROR(e.name,i.message))}}}function c(e,t,n){var r=null;if(t.length>0){var o=t.filter((function(e){return null!==e.target&&e.target.type===i.TargetTypeEnum.ConstructorArgument})),c=o.map(n);r=s(e,c),r=a(r,t,n)}else r=new e;return u(e,r),r}t.resolveInstance=c},cWyK:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("/rf6");function i(e,t,n){if(null!==e)for(var r,o,a,s,u,c,l,p,f=0,h=0,d=e.type,m="FeatureCollection"===d,g="Feature"===d,v=m?e.features.length:1,y=0;y<v;y++){l=m?e.features[y].geometry:g?e.geometry:e,p=!!l&&"GeometryCollection"===l.type,u=p?l.geometries.length:1;for(var _=0;_<u;_++){var b=0,x=0;if(s=p?l.geometries[_]:l,null!==s){c=s.coordinates;var w=s.type;switch(f=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===t(c,h,y,b,x))return!1;h++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(!1===t(c[r],h,y,b,x))return!1;h++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(o=0;o<c[r].length-f;o++){if(!1===t(c[r][o],h,y,b,x))return!1;h++}"MultiLineString"===w&&b++,"Polygon"===w&&x++}"Polygon"===w&&b++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(x=0,o=0;o<c[r].length;o++){for(a=0;a<c[r][o].length-f;a++){if(!1===t(c[r][o][a],h,y,b,x))return!1;h++}x++}b++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===i(s.geometries[r],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(e,t,n,r){var o=n;return i(e,(function(e,r,i,a,s){o=0===r&&void 0===n?e:t(o,e,r,i,a,s)}),r),o}function a(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length;n++)if(!1===t(e.features[n].properties,n))break;break;case"Feature":t(e.properties,0);break}}function s(e,t,n){var r=n;return a(e,(function(e,i){r=0===i&&void 0===n?e:t(r,e,i)})),r}function u(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)if(!1===t(e.features[n],n))break}function c(e,t,n){var r=n;return u(e,(function(e,i){r=0===i&&void 0===n?e:t(r,e,i)})),r}function l(e){var t=[];return i(e,(function(e){t.push(e)})),t}function p(e,t){var n,r,i,o,a,s,u,c,l,p,f=0,h="FeatureCollection"===e.type,d="Feature"===e.type,m=h?e.features.length:1;for(n=0;n<m;n++){for(s=h?e.features[n].geometry:d?e.geometry:e,c=h?e.features[n].properties:d?e.properties:{},l=h?e.features[n].bbox:d?e.bbox:void 0,p=h?e.features[n].id:d?e.id:void 0,u=!!s&&"GeometryCollection"===s.type,a=u?s.geometries.length:1,i=0;i<a;i++)if(o=u?s.geometries[i]:s,null!==o)switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,f,c,l,p))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===t(o.geometries[r],f,c,l,p))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,f,c,l,p))return!1;f++}}function f(e,t,n){var r=n;return p(e,(function(e,i,o,a,s){r=0===i&&void 0===n?e:t(r,e,i,o,a,s)})),r}function h(e,t){p(e,(function(e,n,i,o,a){var s,u=null===e?null:e.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==t(r.feature(e,i,{bbox:o,id:a}),n,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon";break}for(var c=0;c<e.coordinates.length;c++){var l=e.coordinates[c],p={type:s,coordinates:l};if(!1===t(r.feature(p,i),n,c))return!1}}))}function d(e,t,n){var r=n;return h(e,(function(e,i,o){r=0===i&&0===o&&void 0===n?e:t(r,e,i,o)})),r}function m(e,t){h(e,(function(e,n,o){var a=0;if(e.geometry){var s=e.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var u,c=0,l=0,p=0;return!1!==i(e,(function(i,s,f,h,d){if(void 0===u||n>c||h>l||d>p)return u=i,c=n,l=h,p=d,void(a=0);var m=r.lineString([u,i],e.properties);if(!1===t(m,n,o,d,a))return!1;a++,u=i}))&&void 0}}}))}function g(e,t,n){var r=n,i=!1;return m(e,(function(e,o,a,s,u){r=!1===i&&void 0===n?e:t(r,e,o,a,s,u),i=!0})),r}function v(e,t){if(!e)throw new Error("geojson is required");h(e,(function(e,n,i){if(null!==e.geometry){var o=e.geometry.type,a=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,n,i,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===t(r.lineString(a[s],e.properties),n,i,s))return!1;break}}}))}function y(e,t,n){var r=n;return v(e,(function(e,i,o,a){r=0===i&&void 0===n?e:t(r,e,i,o,a)})),r}function _(e,t){if(t=t||{},!r.isObject(t))throw new Error("options is invalid");var n,i=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.segmentIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":i<0&&(i=e.features.length+i),u=u||e.features[i].properties,n=e.features[i].geometry;break;case"Feature":u=u||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=c.length+s-1),r.lineString([c[s],c[s+1]],u,t);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s-1),r.lineString([c[a][s],c[a][s+1]],u,t);case"MultiLineString":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s-1),r.lineString([c[o][s],c[o][s+1]],u,t);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),s<0&&(s=c[o][a].length-s-1),r.lineString([c[o][a][s],c[o][a][s+1]],u,t)}throw new Error("geojson is invalid")}function b(e,t){if(t=t||{},!r.isObject(t))throw new Error("options is invalid");var n,i=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.coordIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":i<0&&(i=e.features.length+i),u=u||e.features[i].properties,n=e.features[i].geometry;break;case"Feature":u=u||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return r.point(c,u,t);case"MultiPoint":return o<0&&(o=c.length+o),r.point(c[o],u,t);case"LineString":return s<0&&(s=c.length+s),r.point(c[s],u,t);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s),r.point(c[a][s],u,t);case"MultiLineString":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),r.point(c[o][s],u,t);case"MultiPolygon":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),s<0&&(s=c[o][a].length-s),r.point(c[o][a][s],u,t)}throw new Error("geojson is invalid")}t.coordEach=i,t.coordReduce=o,t.propEach=a,t.propReduce=s,t.featureEach=u,t.featureReduce=c,t.coordAll=l,t.geomEach=p,t.geomReduce=f,t.flattenEach=h,t.flattenReduce=d,t.segmentEach=m,t.segmentReduce=g,t.lineEach=v,t.lineReduce=y,t.findSegment=_,t.findPoint=b},cZ5Q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("xfSm");function o(){return function(e){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,e))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(i.PARAM_TYPES,t,e),e}}t.injectable=o},cZlC:function(e,t,n){"use strict";var r,i,o;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e["LINEAR"]="linear",e["POWER"]="power",e["LOG"]="log",e["IDENTITY"]="identity",e["TIME"]="time",e["QUANTILE"]="quantile",e["QUANTIZE"]="quantize",e["THRESHOLD"]="threshold",e["CAT"]="cat"}(r||(r={})),function(e){e["CONSTANT"]="constant",e["VARIABLE"]="variable"}(i||(i={})),function(e){e[e["Attribute"]=0]="Attribute",e[e["InstancedAttribute"]=1]="InstancedAttribute",e[e["Uniform"]=2]="Uniform"}(o||(o={}))},d9O0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=0;function i(){return r++}t.id=i},dQpi:function(e,t,n){var r=n("yGk4"),i=n("vN+2"),o=n("rEGp"),a=1/0,s=r&&1/o(new r([,-0]))[1]==a?function(e){return new r(e)}:i;e.exports=s},dVn5:function(e,t){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function r(e){return e.match(n)||[]}e.exports=r},dX1H:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("d9O0"),o=n("GXnB"),a=n("zxMA"),s=function(){function e(e,t,n,s){this.id=i.id(),this.type=e,this.serviceIdentifier=n,this.name=new a.QueryableString(t||""),this.metadata=new Array;var u=null;"string"===typeof s?u=new o.Metadata(r.NAMED_TAG,s):s instanceof o.Metadata&&(u=s),null!==u&&this.metadata.push(u)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var r=n[t];if(r.key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(r.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG}))},e.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===r.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(r.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var o=i[r];if(o.key===e&&o.value===n)return!0}return!1}},e}();t.Target=s},doU7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};t.BindingCount=r},dxzI:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("d9O0"),i=function(){function e(e){this.id=r.id(),this.registry=e}return e}();t.ContainerModule=i;var o=function(){function e(e){this.id=r.id(),this.registry=e}return e}();t.AsyncContainerModule=o},"eg+a":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(e,t,n){"use strict";n.d(t,"d",(function(){return Za})),n.d(t,"b",(function(){return Wa})),n.d(t,"a",(function(){return Ya}));n("mNvP");var r=n("uhBA"),i=n.n(r),o=n("4cb6"),a=n("APxj"),s=n.n(a),u=n("bB6j"),c=n("lSNA"),l=n.n(c),p=n("lwsE"),f=n.n(p),h=n("W8MJ"),d=n.n(h),m=n("Hel2"),g=n("rxlC"),v=n.n(g);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=x(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function x(e,t){if(e){if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S,E,T,k=30;function A(e){var t=e.characterSet,n=e.getFontWidth,r=e.fontHeight,i=e.buffer,o=e.maxCanvasWidth,a=e.mapping,s=void 0===a?{}:a,u=e.xOffset,c=void 0===u?0:u,l=e.yOffset,p=void 0===l?0:l,f=0,h=c;Array.from(t).forEach((function(e,t){if(!s[e]){var r=n(e,t);h+k>o&&(h=0,f++),s[e]={x:h,y:p+f*k,width:k,height:k,advance:r},h+=k}}));var d=r+2*i;return{mapping:s,xOffset:h,yOffset:p+f*d,canvasHeight:M(p+(f+1)*d)}}function C(e,t,n){var r,i=0,o=0,a=0,s=[],u={},c=b(e);try{for(c.s();!(r=c.n()).done;){var l=r.value;if(!u[l.id]){var p=l.height,f=l.width;i+f+t>n&&(I(u,s,o),i=0,o=a+o+t,a=0,s=[]),s.push({icon:l,xOffset:i}),i=i+f+t,a=Math.max(a,p)}}}catch(d){c.e(d)}finally{c.f()}s.length>0&&I(u,s,o);var h=M(a+o+t);return{mapping:u,canvasHeight:h}}function I(e,t,n){var r,i=b(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.icon,s=o.xOffset;e[a.id]=_({},a,{x:s,y:n,image:a.image})}}catch(u){i.e(u)}finally{i.f()}}function M(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function P(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=O(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function O(e,t){if(e){if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=W(),N="sans-serif",j="normal",F=24,B=3,U=.25,V=8,G=1024,q=1,Z=1,H=3;function W(){for(var e=[],t=32;t<128;t++)e.push(String.fromCharCode(t));return e}function Y(e,t,n,r){e.font="".concat(r," ").concat(n,"px ").concat(t),e.fillStyle="black",e.textBaseline="middle"}function X(e,t){for(var n=0;n<e.length;n++)t.data[4*n+3]=e[n]}var K,J,Q,$=(S=Object(o["injectable"])(),S((T=function(){function e(){f()(this,e),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new m["b"](H)}return d()(e,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:N,fontWeight:j,characterSet:z,fontSize:F,buffer:B,sdf:!0,cutoff:U,radius:V},this.key=""}},{key:"addIconGlyphs",value:function(e){var t=this;e.forEach((function(e){t.iconFontGlyphs[e.name]=e.unicode}))}},{key:"getGlyph",value:function(e){return this.iconFontGlyphs[e]?String.fromCharCode(parseInt(this.iconFontGlyphs[e],16)):""}},{key:"setFontOptions",value:function(e){this.fontOptions=D({},this.fontOptions,{},e),this.key=this.getKey();var t=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(!n||0!==t.length){var r=this.generateFontAtlas(this.key,t,n);this.fontAtlas=r,this.cache.set(this.key,r)}}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(e,t,n){var r=this.fontOptions,i=r.fontFamily,o=r.fontWeight,a=r.fontSize,s=r.buffer,u=r.sdf,c=r.radius,l=r.cutoff,p=n&&n.data;p||(p=document.createElement("canvas"),p.width=G);var f=p.getContext("2d");Y(f,i,a,o);var h=A(D({getFontWidth:function(e){return f.measureText(e).width},fontHeight:a*Z,buffer:s,characterSet:t,maxCanvasWidth:G},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),d=h.mapping,m=h.canvasHeight,g=h.xOffset,y=h.yOffset;if(p.height!==m){var _=f.getImageData(0,0,p.width,p.height);p.height=m,f.putImageData(_,0,0)}if(Y(f,i,a,o),u){var b,x=new v.a(a,s,c,l,i,o),w=f.getImageData(0,0,x.size,x.size),S=P(t);try{for(S.s();!(b=S.n()).done;){var E=b.value;X(x.draw(E),w),f.putImageData(w,d[E].x,d[E].y)}}catch(I){S.e(I)}finally{S.f()}}else{var T,k=P(t);try{for(k.s();!(T=k.n()).done;){var C=T.value;f.fillText(C,d[C].x,d[C].y+a*q)}}catch(I){k.e(I)}finally{k.f()}}return{xOffset:g,yOffset:y,mapping:d,data:p,width:p.width,height:p.height}}},{key:"getKey",value:function(){var e=this.fontOptions,t=e.fontFamily,n=e.fontWeight,r=e.fontSize,i=e.buffer,o=e.sdf,a=e.radius,s=e.cutoff;return o?"".concat(t," ").concat(n," ").concat(r," ").concat(i," ").concat(a," ").concat(s):"".concat(t," ").concat(n," ").concat(r," ").concat(i)}},{key:"getNewChars",value:function(e,t){var n=this.cache.get(e);if(!n)return t;var r=[],i=n.mapping,o=new Set(Object.keys(i)),a=new Set(t);return a.forEach((function(e){o.has(e)||r.push(e)})),r}},{key:"scale",get:function(){return Z}},{key:"canvas",get:function(){var e=this.cache.get(this.key);return e&&e.data}},{key:"mapping",get:function(){var e=this.cache.get(this.key);return e&&e.mapping}}]),e}(),E=T))||E),ee=n("7W2i"),te=n.n(ee),ne=n("a1gu"),re=n.n(ne),ie=n("Nsbk"),oe=n.n(ie);function ae(e){return function(){var t,n=oe()(e);if(se()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function se(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ue,ce,le,pe,fe,he,de=3,me=1024,ge=64,ve=(K=Object(o["injectable"])(),K((Q=function(e){te()(n,e);var t=ae(n);function n(){var e;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.canvasHeight=void 0,e.texture=void 0,e.canvas=void 0,e.iconData=void 0,e.iconMap=void 0,e.ctx=void 0,e}return d()(n,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(e,t){var n=this,r=new Image;if(this.hasImage(e))throw new Error("Image Id already exists");this.iconData.push({id:e,width:ge,height:ge}),this.updateIconMap(),this.loadImage(t).then((function(t){r=t;var i=n.iconData.find((function(t){return t.id===e}));i&&(i.image=r),n.update()}))}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(e){return this.iconMap.hasOwnProperty(e)}},{key:"removeImage",value:function(e){this.hasImage(e)&&(this.iconData=this.iconData.filter((function(t){return t.id!==e})),delete this.iconMap[e],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var e=this;this.canvas.width=me,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach((function(t){var n=e.iconMap[t],r=n.x,i=n.y,o=n.image;o&&e.ctx.drawImage(o,r,i,ge,ge)}))}},{key:"updateIconMap",value:function(){var e=C(this.iconData,de,me),t=e.mapping,n=e.canvasHeight;this.iconMap=t,this.canvasHeight=n}},{key:"loadImage",value:function(e){return new Promise((function(t,n){if(e instanceof HTMLImageElement)t(e);else{var r=new Image;r.crossOrigin="anonymous",r.onload=function(){t(r)},r.onerror=function(){n(new Error("Could not load image at "+e))},r.src=e instanceof File?URL.createObjectURL(e):e}}))}}]),n}(r["EventEmitter"]),J=Q))||J),ye=n("J4zp"),_e=n.n(ye),be=n("IOcx"),xe=(ue=Object(o["injectable"])(),ue((le=function(){function e(){f()(this,e),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return d()(e,[{key:"init",value:function(){}},{key:"update",value:function(e){this.viewport=e,this.viewMatrixInverse=be["a"].invert(be["a"].create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var e=this.viewport.getCenter(),t=_e()(e,2),n=t[0],r=t[1];return[n,r]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(e,t){return this.viewport.projectFlat(e,t)}},{key:"setViewProjectionMatrix",value:function(e){this.overridedViewProjectionMatrix=e}},{key:"jitterProjectionMatrix",value:function(e,t){var n=be["a"].fromTranslation(be["a"].create(),[e,t,0]);this.jitteredProjectionMatrix=be["a"].multiply(be["a"].create(),n,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=be["a"].multiply(be["a"].create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),e}(),ce=le))||ce);function we(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Se(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Se(e,t){if(e){if("string"===typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(e,t):void 0}}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te,ke,Ae,Ce,Ie,Me,Pe,Oe,Le,Re=(pe=Object(o["injectable"])(),pe((he=function(){function e(){f()(this,e),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return d()(e,[{key:"init",value:function(e,t){this.container=e.container,this.scene=t,this.mapsService=t.get(u["a"].IMapService),this.initControlPos()}},{key:"addControl",value:function(e,t){var n=t.get(u["a"].IMapService);n.map?(e.addTo(this.scene),this.controls.push(e)):this.unAddControls.push(e)}},{key:"getControlByName",value:function(e){return this.controls.find((function(t){return t.controlOption.name===e}))}},{key:"removeControl",value:function(e){var t=this.controls.indexOf(e);return t>-1&&this.controls.splice(t,1),e.remove(),this}},{key:"addControls",value:function(){var e=this;this.unAddControls.forEach((function(t){t.addTo(e.scene),e.controls.push(t)})),this.unAddControls=[]}},{key:"destroy",value:function(){var e,t=we(this.controls);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.remove()}}catch(r){t.e(r)}finally{t.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var e=this.controlCorners={},t="l7-",n=this.controlContainer=m["a"].create("div",t+"control-container",this.container);function r(r,i){var o=t+r+" "+t+i;e[r+i]=m["a"].create("div",o,n)}r("top","left"),r("top","right"),r("bottom","left"),r("bottom","right")}},{key:"clearControlPos",value:function(){for(var e in this.controlCorners)this.controlCorners[e]&&m["a"].remove(this.controlCorners[e]);this.controlContainer&&m["a"].remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),e}(),fe=he))||fe),De=(Te=Object(o["injectable"])(),Te((Ae=function(){function e(){f()(this,e),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return d()(e,[{key:"addMarkerLayer",value:function(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(e),e.addTo(this.scene)):this.unAddMarkerLayers.push(e)}},{key:"removeMarkerLayer",value:function(e){e.destroy(),this.markerLayers.indexOf(e);var t=this.markerLayers.indexOf(e);t>-1&&this.markerLayers.splice(t,1)}},{key:"addMarker",value:function(e){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(e),e.addTo(this.scene)):this.unAddMarkers.push(e)}},{key:"addMarkers",value:function(){var e=this;this.unAddMarkers.forEach((function(t){t.addTo(e.scene),e.markers.push(t)})),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var e=this;this.unAddMarkerLayers.forEach((function(t){e.markerLayers.push(t),t.addTo(e.scene)})),this.unAddMarkers=[]}},{key:"removeMarker",value:function(e){e.remove(),this.markers.indexOf(e);var t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(e){this.scene=e,this.mapsService=e.get(u["a"].IMapService)}},{key:"destroy",value:function(){this.markers.forEach((function(e){e.remove()})),this.markers=[],this.markerLayers.forEach((function(e){e.destroy()})),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(e){e.destroy()}}]),e}(),ke=Ae))||ke),ze=(Ce=Object(o["injectable"])(),Ce((Me=function(){function e(){f()(this,e),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return d()(e,[{key:"removePopup",value:function(e){e.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(e){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(e.addTo(this.scene),this.popup=e):this.unAddPopup=e}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(e){this.scene=e,this.mapsService=e.get(u["a"].IMapService)}}]),e}(),Ie=Me))||Ie),Ne=n("QkVN"),je=n.n(Ne),Fe={MapToken:"\u60a8\u6b63\u5728\u4f7f\u7528 Demo\u6d4b\u8bd5\u5730\u56fetoken\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u53bb\u5bf9\u5e94\u5730\u56fe\u8bf7\u6ce8\u518cToken",SDK:"\u8bf7\u786e\u8ba4\u5f15\u5165\u4e86mapbox-gl api\u4e14\u5728L7\u4e4b\u524d\u5f15\u5165"},Be=Fe;function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ge={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},qe={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},Ze=(Pe=Object(o["injectable"])(),Pe((Le=function(){function e(){f()(this,e),this.sceneConfigCache={},this.layerConfigCache={}}return d()(e,[{key:"getSceneConfig",value:function(e){return this.sceneConfigCache[e]}},{key:"getSceneWarninfo",value:function(e){return Be[e]}},{key:"setSceneConfig",value:function(e,t){this.sceneConfigCache[e]=Ve({},Ge,{},t)}},{key:"getLayerConfig",value:function(e){return this.layerConfigCache[e]}},{key:"setLayerConfig",value:function(e,t,n){this.layerConfigCache[t]=Ve({},je()({},this.sceneConfigCache[e],qe,n))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),e}(),Oe=Le))||Oe),He=n("yG8O"),We=n.n(He),Ye=n("U+yc"),Xe=n.n(Ye),Ke=(n("1ABj"),Math.PI/180),Je=512,Qe=4003e4;function $e(e){var t=e.latitude,n=void 0===t?0:t,r=e.zoom,i=void 0===r?0:r,o=e.scale,a=e.highPrecision,s=void 0!==a&&a,u=e.flipY,c=void 0!==u&&u;o=void 0!==o?o:Math.pow(2,i);var l={},p=Je*o,f=Math.cos(n*Ke),h=p/360,d=h/f,m=p/Qe/f;if(l.pixelsPerMeter=[m,-m,m],l.metersPerPixel=[1/m,-1/m,1/m],l.pixelsPerDegree=[h,-d,m],l.degreesPerPixel=[1/h,-1/d,1/m],s){var g=Ke*Math.tan(n*Ke)/f,v=h*g/2,y=p/Qe*g,_=y/d*m;l.pixelsPerDegree2=[0,-v,y],l.pixelsPerMeter2=[_,0,_],c&&(l.pixelsPerDegree2[1]=-l.pixelsPerDegree2[1],l.pixelsPerMeter2[1]=-l.pixelsPerMeter2[1])}return c&&(l.pixelsPerMeter[1]=-l.pixelsPerMeter[1],l.metersPerPixel[1]=-l.metersPerPixel[1],l.pixelsPerDegree[1]=-l.pixelsPerDegree[1],l.degreesPerPixel[1]=-l.degreesPerPixel[1]),l}var et,tt,nt,rt,it,ot,at,st,ut,ct,lt,pt,ft,ht,dt=n("HthE"),mt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],gt=(et=Object(o["injectable"])(),tt=Object(o["inject"])(u["a"].ICameraService),et((ot=function(){function e(){f()(this,e),this.needRefresh=!0,We()(this,"cameraService",it,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return d()(e,[{key:"refresh",value:function(){var e=this.cameraService.getZoom(),t=this.cameraService.getZoomScale(),n=this.cameraService.getCenter(),r=$e({latitude:n[1],zoom:e}),i=r.pixelsPerMeter,o=r.pixelsPerDegree;this.viewportCenter=n,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=i,this.pixelsPerDegree=o,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===dt["a"].LNGLAT||this.coordinateSystem===dt["a"].P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===dt["a"].LNGLAT_OFFSET?this.calculateLnglatOffset(n,e):this.coordinateSystem===dt["a"].P20_OFFSET&&this.calculateLnglatOffset(n,e,t,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(e){this.coordinateSystem=e}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(e,t,n,r){var i=$e({latitude:e[1],zoom:t,scale:n,flipY:r,highPrecision:!0}),o=i.pixelsPerMeter,a=i.pixelsPerDegree,s=i.pixelsPerDegree2,u=this.cameraService.getViewMatrix(),c=this.cameraService.getProjectionMatrix(),l=be["a"].multiply([],c,u),p=this.cameraService.projectFlat([Math.fround(e[0]),Math.fround(e[1])],Math.pow(2,t));this.viewportCenterProjection=be["d"].transformMat4([],[p[0],p[1],0,1],l),u=this.cameraService.getViewMatrixUncentered()||u,l=be["a"].multiply([],c,u),l=be["a"].multiply([],l,mt),this.cameraService.setViewProjectionMatrix(l),this.pixelsPerMeter=o,this.pixelsPerDegree=a,this.pixelsPerDegree2=s}}]),e}(),rt=ot,it=Xe()(rt.prototype,"cameraService",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nt=rt))||nt),vt=n("PJYZ"),yt=n.n(vt),_t=n("yLV6"),bt=n.n(_t),xt=n("V1cb");function wt(e){return function(){var t,n=oe()(e);if(St()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function St(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Et,Tt,kt,At,Ct,It,Mt,Pt,Ot,Lt,Rt,Dt,zt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Nt=(at=Object(o["injectable"])(),st=Object(o["inject"])(u["a"].IMapService),ut=Object(o["inject"])(u["a"].ILogService),at((ht=function(e){te()(n,e);var t=wt(n);function n(){var e;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),We()(e,"mapService",pt,yt()(e)),We()(e,"logger",ft,yt()(e)),e.hammertime=void 0,e.lastClickTime=0,e.lastClickXY=[-1,-1],e.clickTimer=void 0,e.onDrag=function(t){var n=e.interactionEvent(t);n.type=zt[n.type],e.emit(xt["a"].Drag,n)},e.onHammer=function(t){t.srcEvent.stopPropagation();var n=e.interactionEvent(t);e.emit(xt["a"].Hover,n)},e.onTouch=function(t){var n=t.touches[0];e.onHover({x:n.pageX,y:n.pageY,type:"touch"})},e.onHover=function(t){var n=t.x,r=t.y,i=t.type,o=e.mapService.getMapContainer();if(o){var a=o.getBoundingClientRect(),s=a.top,u=a.left;n-=u,r-=s}var c=e.mapService.containerToLngLat([n,r]);if("click"!==i)"touch"!==i?"click"!==i&&"dblclick"!==i&&e.emit(xt["a"].Hover,{x:n,y:r,lngLat:c,type:i}):e.isDoubleTap(n,r,c);else{if("ontouchstart"in document.documentElement===!0)return;e.isDoubleTap(n,r,c)}},e}return d()(n,[{key:"init",value:function(){this.addEventListenerOnMap()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(xt["a"].Hover)}},{key:"triggerHover",value:function(e){var t=e.x,n=e.y;this.emit(xt["a"].Hover,{x:t,y:n})}},{key:"triggerSelect",value:function(e){this.emit(xt["a"].Select,{featureId:e})}},{key:"triggerActive",value:function(e){this.emit(xt["a"].Active,{featureId:e})}},{key:"addEventListenerOnMap",value:function(){var e=this.mapService.getMapContainer();if(e){var t=new bt.a.Manager(e);t.add(new bt.a.Tap({event:"dblclick",taps:2})),t.add(new bt.a.Tap({event:"click"})),t.add(new bt.a.Pan({threshold:0,pointers:0})),t.add(new bt.a.Press({})),t.on("dblclick click",this.onHammer),t.on("panstart panmove panend pancancel",this.onDrag),e.addEventListener("mousemove",this.onHover),e.addEventListener("mousedown",this.onHover),e.addEventListener("mouseup",this.onHover),e.addEventListener("contextmenu",this.onHover),this.hammertime=t,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var e=this.mapService.getMapContainer();e&&(e.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),e.removeEventListener("mousedown",this.onHover),e.removeEventListener("mouseup",this.onHover),e.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(e){var t,n,r=e.type,i=e.pointerType;"touch"===i?(n=Math.floor(e.pointers[0].clientY),t=Math.floor(e.pointers[0].clientX)):(n=Math.floor(e.srcEvent.y),t=Math.floor(e.srcEvent.x));var o=this.mapService.getMapContainer();if(o){var a=o.getBoundingClientRect(),s=a.top,u=a.left;t-=u,n-=s}var c=this.mapService.containerToLngLat([t,n]);return{x:t,y:n,lngLat:c,type:r}}},{key:"isDoubleTap",value:function(e,t,n){var r=this,i=(new Date).getTime(),o="click";i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-e)<10&&Math.abs(this.lastClickXY[1]-t)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),o="dblclick",this.emit(xt["a"].Hover,{x:e,y:t,lngLat:n,type:o})):(this.lastClickTime=i,this.lastClickXY=[e,t],this.clickTimer=setTimeout((function(){o="click",r.emit(xt["a"].Hover,{x:e,y:t,lngLat:n,type:o})}),400))}}]),n}(i.a),lt=ht,pt=Xe()(lt.prototype,"mapService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft=Xe()(lt.prototype,"logger",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=lt))||ct),jt=n("o0o1"),Ft=n.n(jt),Bt=n("yXPU"),Ut=n.n(Bt),Vt=n("o+pz");function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zt,Ht,Wt,Yt,Xt,Kt,Jt,Qt,$t,en,tn,nn,rn,on,an,sn=(Et=Object(o["injectable"])(),Tt=Object(o["inject"])(u["a"].IRendererService),kt=Object(o["inject"])(u["a"].IGlobalConfigService),At=Object(o["inject"])(u["a"].IInteractionService),Ct=Object(o["inject"])(u["a"].ILayerService),Et((Dt=function(){function e(){var t=this;f()(this,e),We()(this,"rendererService",Pt,this),We()(this,"configService",Ot,this),We()(this,"interactionService",Lt,this),We()(this,"layerService",Rt,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(e,n){var r,i,o=n.x,a=n.y,s=n.lngLat,u=n.type,c=!1,l=t.rendererService,p=l.getViewportSize,f=l.readPixels,h=p(),d=h.width,g=h.height,v=e.getLayerConfig(),y=v.enableHighlight,_=v.enableSelect,b=o*window.devicePixelRatio,x=a*window.devicePixelRatio;if(b>d-1*window.devicePixelRatio||b<0||x>g-1*window.devicePixelRatio||x<0)return!1;if(i=f({x:Math.floor(b/t.pickBufferScale),y:Math.floor((g-(a+1)*window.devicePixelRatio)/t.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:t.pickingFBO}),0!==i[0]||0!==i[1]||0!==i[2]){var w=Object(m["j"])(i),S=e.getSource().getFeatureById(w);w!==e.getCurrentPickId()&&"mousemove"===u&&(u="mouseenter");var E={x:o,y:a,type:u,lngLat:s,featureId:w,feature:S};S&&(c=!0,e.setCurrentPickId(w),t.triggerHoverOnLayer(e,E))}else{var T={x:o,y:a,lngLat:s,type:null!==e.getCurrentPickId()&&"mousemove"===u?"mouseout":"un"+u,featureId:null,feature:null};t.triggerHoverOnLayer(e,qt({},T,{type:"unpick"})),t.triggerHoverOnLayer(e,T),e.setCurrentPickId(null)}if(y&&t.highlightPickedFeature(e,i),_&&"click"===u&&(null===(r=i)||void 0===r?void 0:r.toString())!==[0,0,0,0].toString()){var k=Object(m["j"])(i);null===e.getCurrentSelectedId()||k!==e.getCurrentSelectedId()?(t.selectFeature(e,i),e.setCurrentSelectedId(k)):(t.selectFeature(e,new Uint8Array([0,0,0,0])),e.setCurrentSelectedId(null))}return c}}return d()(e,[{key:"init",value:function(e){var t=this.rendererService,n=t.createTexture2D,r=t.createFramebuffer,i=t.getViewportSize,o=i(),a=o.width,s=o.height;this.pickBufferScale=this.configService.getSceneConfig(e).pickBufferScale||1,this.pickingFBO=r({color:n({width:Math.round(a/this.pickBufferScale),height:Math.round(s/this.pickBufferScale),wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})}),this.interactionService.on(xt["a"].Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var e=Ut()(Ft.a.mark((function e(t){return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.alreadyInPicking&&!this.layerService.alreadyInRendering){e.next=2;break}return e.abrupt("return");case 2:return this.alreadyInPicking=!0,e.next=5,this.pickingLayers(t);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"pickingLayers",value:function(){var e=Ut()(Ft.a.mark((function e(t){var n,r,i,o,a,s,u,c=this;return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=this.rendererService,r=n.getViewportSize,i=n.useFramebuffer,o=n.clear,a=r(),s=a.width,u=a.height,this.width===s&&this.height===u||(this.pickingFBO.resize({width:Math.round(s/this.pickBufferScale),height:Math.round(u/this.pickBufferScale)}),this.width=s,this.height=u),i(this.pickingFBO,(function(){var e=c.layerService.getLayers();e.filter((function(e){return e.needPick(t.type)})).reverse().some((function(e){o({framebuffer:c.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),e.hooks.beforePickingEncode.call(),e.renderModels(),e.hooks.afterPickingEncode.call();var n=c.pickFromPickingFBO(e,t);return n&&!e.getLayerConfig().enablePropagation}))}));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"triggerHoverOnLayer",value:function(e,t){e.emit(t.type,t)}},{key:"highlightPickedFeature",value:function(e,t){var n=_e()(t,3),r=n[0],i=n[1],o=n[2];e.hooks.beforeHighlight.call([r,i,o])}},{key:"selectFeature",value:function(e,t){var n=_e()(t,3),r=n[0],i=n[1],o=n[2];e.hooks.beforeSelect.call([r,i,o])}}]),e}(),Mt=Dt,Pt=Xe()(Mt.prototype,"rendererService",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Xe()(Mt.prototype,"configService",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=Xe()(Mt.prototype,"interactionService",[At],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=Xe()(Mt.prototype,"layerService",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=Mt))||It),un=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];f()(this,e),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=t}return d()(e,[{key:"start",value:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"===typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}(),cn=(Zt=Object(o["injectable"])(),Ht=Object(o["inject"])(u["a"].IRendererService),Wt=Object(o["inject"])(u["a"].IGlobalConfigService),Zt((Qt=function(){function e(){f()(this,e),this.clock=new un,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,We()(this,"renderService",Kt,this),We()(this,"configService",Jt,this)}return d()(e,[{key:"add",value:function(e){this.sceneInited&&e.init(),this.layers.push(e)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach((function(e){e.inited||e.init()}))}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(e){return this.layers.find((function(t){return t.id===e}))}},{key:"getLayerByName",value:function(e){return this.layers.find((function(t){return t.name===e}))}},{key:"remove",value:function(e){var t=this.layers.indexOf(e);t>-1&&this.layers.splice(t,1),e.emit("remove",null),e.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter((function(e){return e.inited})).filter((function(e){return e.isVisible()})).forEach((function(e){e.hooks.beforeRenderData.call(),e.hooks.beforeRender.call(),e.render(),e.hooks.afterRender.call()})),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort((function(e,t){return e.zIndex-t.zIndex})),this.renderLayers()}},{key:"destroy",value:function(){this.layers.forEach((function(e){return e.destroy()})),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){0===this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0===--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),e}(),Xt=Qt,Kt=Xe()(Xt.prototype,"renderService",[Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt=Xe()(Xt.prototype,"configService",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Xt))||Yt),ln=n("QILm"),pn=n.n(ln),fn=n("RIqP"),hn=n.n(fn),dn=n("J2iB"),mn=n.n(dn),gn=function(){function e(t){var n=this;f()(this,e),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:1/0},this.vertexAttribute=void 0,this.defaultCallback=function(e){var t;return 0===e.length?(null===(t=n.scale)||void 0===t?void 0:t.values)||[]:e.map((function(e,t){var r,i=(null===(r=n.scale)||void 0===r?void 0:r.scalers)[t].func,o=i(e);return o}))},this.setProps(t)}return d()(e,[{key:"setProps",value:function(e){Object.assign(this,e)}},{key:"mapping",value:function(e){var t;if(null===(t=this.scale)||void 0===t?void 0:t.callback){var n,r=null===(n=this.scale)||void 0===n?void 0:n.callback.apply(n,hn()(e));if(!mn()(r))return[r]}return this.defaultCallback(e)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),e}();function vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _n=($t={},l()($t,Vt["a"].FLOAT,4),l()($t,Vt["a"].UNSIGNED_BYTE,1),l()($t,Vt["a"].UNSIGNED_SHORT,2),$t),bn=(en=Object(o["injectable"])(),tn=Object(o["inject"])(u["a"].IRendererService),en((an=function(){function e(){f()(this,e),this.attributesAndIndices=void 0,We()(this,"rendererService",on,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return d()(e,[{key:"registerStyleAttribute",value:function(e){var t=this.getLayerStyleAttribute(e.name||"");return t?t.setProps(e):(t=new gn(e),this.attributes.push(t)),t}},{key:"updateStyleAttribute",value:function(e,t,n){var r=this.getLayerStyleAttribute(e);r||(r=this.registerStyleAttribute(yn({},t,{name:e})));var i=t.scale;i&&r&&(r.scale=i,r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0,n&&n.featureRange&&(r.featureRange=n.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(e){return this.attributes.find((function(t){return t.name===e}))}},{key:"getLayerAttributeScale",value:function(e){var t,n=this.getLayerStyleAttribute(e),r=null===n||void 0===n||null===(t=n.scale)||void 0===t?void 0:t.scalers;return r&&r[0]?r[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=this.attributes.find((function(t){return t.name===e}));if(i&&i.descriptor){var o=i.descriptor,a=o.update,s=o.buffer,u=o.size,c=void 0===u?0:u,l=_n[s.type||Vt["a"].FLOAT];if(a){var p=this.featureLayout,f=p.elements,h=p.sizePerElement,d=f.slice(n,r);if(!d.length)return;var m=d[0].offset,g=m*c*l,v=d.map((function(e,n){for(var r=e.featureIdx,i=e.vertices,o=e.normals,s=i.length/h,u=[],c=0;c<s;c++){var l=o?o.slice(3*c,3*c+3):[];u.push.apply(u,hn()(a(t[r],r,i.slice(c*h,c*h+h),n,l)))}return u})).reduce((function(e,t){return e.push.apply(e,hn()(t)),e}),[]);i.vertexAttribute.updateBuffer({data:v,offset:g})}}}},{key:"createAttributesAndIndices",value:function(e,t){var n=this;this.featureLayout={sizePerElement:0,elements:[]},t&&(this.triangulation=t);var r=this.attributes.map((function(e){return e.resetDescriptor(),e.descriptor})),i=0,o=[],a=[],s=[],u=3;e.forEach((function(e,t){var c=n.triangulation(e),l=c.indices,p=c.vertices,f=c.normals,h=c.size;l.forEach((function(e){a.push(e+i)})),p.forEach((function(e){o.push(e)})),f&&f.forEach((function(e){s.push(e)})),u=h;var d=p.length/h;n.featureLayout.sizePerElement=u,n.featureLayout.elements.push({featureIdx:t,vertices:p,normals:f,offset:i}),i+=d;for(var m=function(n){r.forEach((function(r,i){if(r&&r.update){var o,a=(null===f||void 0===f?void 0:f.slice(3*n,3*n+3))||[];(o=r.buffer.data).push.apply(o,hn()(r.update(e,t,p.slice(n*h,n*h+h),n,a)))}}))},g=0;g<d;g++)m(g)}));var c=this.rendererService,l=c.createAttribute,p=c.createBuffer,f=c.createElements,h={};r.forEach((function(e,t){if(e){var r=e.buffer,i=(e.update,e.name,pn()(e,["buffer","update","name"])),o=l(yn({buffer:p(r)},i));h[e.name||""]=o,n.attributes[t].vertexAttribute=o}}));var d=f({data:a,type:Vt["a"].UNSIGNED_INT,count:a.length});return this.attributesAndIndices={attributes:h,elements:d},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){this.attributes.forEach((function(e){e.vertexAttribute&&e.vertexAttribute.destroy()})),this.attributes=[]}}]),e}(),rn=an,on=Xe()(rn.prototype,"rendererService",[tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn=rn))||nn),xn=n("U8pU"),wn=n("KQm4"),Sn=n("rePB"),En=n("1OyB"),Tn=n("vuIU"),kn=n("5ku3"),An="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source",Cn=Object(kn["a"])();function In(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(r){return null}}var Mn=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(En["a"])(this,e),this.storage=In(r),this.id=t,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(Tn["a"])(e,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(e){return this.config={},this.updateConfiguration(e)}},{key:"updateConfiguration",value:function(e){if(Object.assign(this.config,e),this.storage){var t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}},{key:"_loadConfiguration",value:function(){var e={};if(this.storage){var t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}]),e}();function Pn(e){var t;return t=e<10?"".concat(e.toFixed(2),"ms"):e<100?"".concat(e.toFixed(1),"ms"):e<1e3?"".concat(e.toFixed(0),"ms"):"".concat((e/1e3).toFixed(2),"s"),t}function On(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(t-e.length,0);return"".concat(" ".repeat(n)).concat(e)}function Ln(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=e.src.replace(/\(/g,"%28").replace(/\)/g,"%29");e.width>r&&(n=Math.min(n,r/e.width));var o=e.width*n,a=e.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(t," %c+"),s]}var Rn={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Dn(e){return"string"===typeof e?Rn[e.toUpperCase()]||Rn.WHITE:e}function zn(e,t,n){return Cn||"string"!==typeof e||(t&&(t=Dn(t),e="\x1b[".concat(t,"m").concat(e,"\x1b[39m")),n&&(t=Dn(n),e="\x1b[".concat(n+10,"m").concat(e,"\x1b[49m"))),e}function Nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),i=!0,o=!1,a=void 0;try{for(var s,u=function(){var n=s.value;"function"===typeof e[n]&&(t.find((function(e){return n===e}))||(e[n]=e[n].bind(e)))},c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(l){o=!0,a=l}finally{try{i||null==c["return"]||c["return"]()}finally{if(o)throw a}}}function jn(e,t){if(!e)throw new Error(t||"Assertion failed")}var Fn=n("K9nA");function Bn(){var e;if(Cn&&Fn["b"].performance)e=Fn["b"].performance.now();else if(Fn["a"].hrtime){var t=Fn["a"].hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}var Un={debug:Cn&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Vn={enabled:!0,level:0};function Gn(){}var qn={},Zn={once:!0};function Hn(e){for(var t in e)for(var n in e[t])return n||"untitled";return"empty"}var Wn,Yn,Xn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.id;Object(En["a"])(this,e),this.id=n,this.VERSION=An,this._startTs=Bn(),this._deltaTs=Bn(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new Mn("__probe-".concat(this.id,"__"),Vn),this.userData={},this.timeStamp("".concat(this.id," started")),Nn(this),Object.seal(this)}return Object(Tn["a"])(e,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Bn()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Bn()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:e}),this}},{key:"setLevel",value:function(e){return this._storage.updateConfiguration({level:e}),this}},{key:"assert",value:function(e,t){jn(e,t)}},{key:"warn",value:function(e){return this._getLogFunction(0,e,Un.warn,arguments,Zn)}},{key:"error",value:function(e){return this._getLogFunction(0,e,Un.error,arguments)}},{key:"deprecated",value:function(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}},{key:"removed",value:function(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}},{key:"probe",value:function(e,t){return this._getLogFunction(e,t,Un.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(e,t){return this._getLogFunction(e,t,Un.debug,arguments)}},{key:"info",value:function(e,t){return this._getLogFunction(e,t,console.info,arguments)}},{key:"once",value:function(e,t){return this._getLogFunction(e,t,Un.debug||Un.info,arguments,Zn)}},{key:"table",value:function(e,t,n){return t?this._getLogFunction(e,t,console.table||Gn,n&&[n],{tag:Hn(t)}):Gn}},{key:"image",value:function(e){var t=e.logLevel,n=e.priority,r=e.image,i=e.message,o=void 0===i?"":i,a=e.scale,s=void 0===a?1:a;return this._shouldLog(t||n)?Cn?er({image:r,message:o,scale:s}):$n({image:r,message:o,scale:s}):Gn}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(e){return this._storage.config[e]}},{key:"set",value:function(e,t){this._storage.updateConfiguration(Object(Sn["a"])({},e,t))}},{key:"time",value:function(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}},{key:"timeEnd",value:function(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(e,t){return this._getLogFunction(e,t,console.timeStamp||Gn)}},{key:"group",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};n=Jn({logLevel:e,message:t,opts:n});var r=n,i=r.collapsed;return n.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}},{key:"groupCollapsed",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(e,t,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(e){return this._getLogFunction(e,"",console.groupEnd||Gn)}},{key:"withGroup",value:function(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(e){return this.isEnabled()&&this.getLevel()>=Kn(e)}},{key:"_getLogFunction",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(e)){var o;i=Jn({logLevel:e,message:t,args:r,opts:i}),n=n||i.method,jn(n),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=Bn();var a=i.tag||i.message;if(i.once){if(qn[a])return Gn;qn[a]=Bn()}return t=Qn(this.id,i.message,i),(o=n).bind.apply(o,[console,t].concat(Object(wn["a"])(i.args)))}return Gn}},{key:"level",set:function(e){this.setLevel(e)},get:function(){return this.getLevel()}},{key:"priority",set:function(e){this.level=e},get:function(){return this.level}}]),e}();function Kn(e){if(!e)return 0;var t;switch(Object(xn["a"])(e)){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return jn(Number.isFinite(t)&&t>=0),t}function Jn(e){var t=e.logLevel,n=e.message;e.logLevel=Kn(t);var r=e.args?Array.from(e.args):[];while(r.length&&r.shift()!==n);switch(e.args=r,Object(xn["a"])(t)){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t);break;default:}"function"===typeof e.message&&(e.message=e.message());var i=Object(xn["a"])(e.message);return jn("string"===i||"object"===i),Object.assign(e,e.opts)}function Qn(e,t,n){if("string"===typeof t){var r=n.time?On(Pn(n.total)):"";t=n.time?"".concat(e,": ").concat(r,"  ").concat(t):"".concat(e,": ").concat(t),t=zn(t,n.color,n.background)}return t}function $n(e){var t=e.image,r=(e.message,e.scale),i=void 0===r?1:r,o=null;try{o=n(2)}catch(a){}return o?function(){return o(t,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((function(e){return console.log(e)}))}:Gn}function er(e){var t=e.image,n=e.message,r=void 0===n?"":n,i=e.scale,o=void 0===i?1:i;if("string"===typeof t){var a=new Image;return a.onload=function(){var e,t=Ln(a,r,o);(e=console).log.apply(e,Object(wn["a"])(t))},a.src=t,Gn}var s,u=t.nodeName||"";if("img"===u.toLowerCase())return(s=console).log.apply(s,Object(wn["a"])(Ln(t,r,o))),Gn;if("canvas"===u.toLowerCase()){var c=new Image;return c.onload=function(){var e;return(e=console).log.apply(e,Object(wn["a"])(Ln(c,r,o)))},c.src=t.toDataURL(),Gn}return Gn}Xn.VERSION=An;var tr=new Xn({id:"L7"}).enable(!1);tr.priority=5;var nr,rr,ir,or,ar,sr,ur,cr,lr,pr,fr,hr,dr,mr,gr,vr,yr,_r,br,xr,wr,Sr,Er,Tr,kr,Ar,Cr,Ir,Mr,Pr,Or,Lr,Rr,Dr,zr,Nr,jr=(Wn=Object(o["injectable"])(),Wn(Yn=function(){function e(){f()(this,e)}return d()(e,[{key:"error",value:function(e){tr.error(e)()}},{key:"warn",value:function(e){tr.probe(1,e)()}},{key:"info",value:function(e){tr.info(3,e)()}},{key:"debug",value:function(e){tr.probe(4,e)()}}]),e}())||Yn),Fr=n("xp6e"),Br=n("iegG"),Ur=n.n(Br),Vr=(window.document.documentElement.style,0);function Gr(e){var t=e;if("string"===typeof e&&(t=document.getElementById(e)),t){var n=document.createElement("div");return n.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",n.id="l7-scene-".concat(Vr++),n.classList.add("l7-scene"),t.appendChild(n),n}return null}function qr(e){return function(){var t,n=oe()(e);if(Zr()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Zr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Hr=(nr=Object(o["injectable"])(),rr=Object(o["inject"])(u["a"].SceneID),ir=Object(o["inject"])(u["a"].IIconService),or=Object(o["inject"])(u["a"].IFontService),ar=Object(o["inject"])(u["a"].IControlService),sr=Object(o["inject"])(u["a"].ILogService),ur=Object(o["inject"])(u["a"].IGlobalConfigService),cr=Object(o["inject"])(u["a"].IMapService),lr=Object(o["inject"])(u["a"].ICoordinateSystemService),pr=Object(o["inject"])(u["a"].IRendererService),fr=Object(o["inject"])(u["a"].ILayerService),hr=Object(o["inject"])(u["a"].ICameraService),dr=Object(o["inject"])(u["a"].IInteractionService),mr=Object(o["inject"])(u["a"].IPickingService),gr=Object(o["inject"])(u["a"].IShaderModuleService),vr=Object(o["inject"])(u["a"].IMarkerService),yr=Object(o["inject"])(u["a"].IPopupService),nr((Nr=function(e){te()(n,e);var t=qr(n);function n(){var e;return f()(this,n),e=t.call(this),e.destroyed=!1,e.loaded=!1,We()(e,"id",xr,yt()(e)),We()(e,"iconService",wr,yt()(e)),We()(e,"fontService",Sr,yt()(e)),We()(e,"controlService",Er,yt()(e)),We()(e,"logger",Tr,yt()(e)),We()(e,"configService",kr,yt()(e)),We()(e,"map",Ar,yt()(e)),We()(e,"coordinateSystemService",Cr,yt()(e)),We()(e,"rendererService",Ir,yt()(e)),We()(e,"layerService",Mr,yt()(e)),We()(e,"cameraService",Pr,yt()(e)),We()(e,"interactionService",Or,yt()(e)),We()(e,"pickingService",Lr,yt()(e)),We()(e,"shaderModuleService",Rr,yt()(e)),We()(e,"markerService",Dr,yt()(e)),We()(e,"popupService",zr,yt()(e)),e.inited=!1,e.initPromise=void 0,e.rendering=!1,e.$container=void 0,e.hooks=void 0,e.handleWindowResized=function(){if(e.emit("resize"),e.$container){var t,n=window.devicePixelRatio,r=window.innerWidth,i=window.innerHeight;if(e.$container!==document.body){var o=e.$container.getBoundingClientRect();r=o.right-o.left,i=o.bottom-o.top}var a=null===(t=e.$container)||void 0===t?void 0:t.getElementsByTagName("canvas")[0];e.rendererService.viewport({x:0,y:0,width:n*r,height:n*i}),m["a"].triggerResize(),e.coordinateSystemService.needRefresh=!0,a&&(a.width=r*n,a.height=i*n),e.render()}},e.handleMapCameraChanged=function(t){e.cameraService.update(t),e.render()},e.hooks={init:new Fr["a"]},e}return d()(n,[{key:"init",value:function(e){var t=this;this.configService.setSceneConfig(this.id,e),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ut()(Ft.a.mark((function e(){return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){t.map.onCameraChanged((function(n){t.cameraService.init(),t.cameraService.update(n),e()})),t.map.init()}));case 2:t.map.onCameraChanged(t.handleMapCameraChanged),t.map.addMarkerContainer(),t.markerService.addMarkers(),t.markerService.addMarkerLayers(),t.popupService.initPopup(),t.interactionService.init(),t.interactionService.on(xt["a"].Drag,t.addSceneEvent.bind(t)),t.logger.debug("map ".concat(t.id," loaded"));case 10:case"end":return e.stop()}}),e)})))),this.hooks.init.tapPromise("initRenderer",Ut()(Ft.a.mark((function e(){var n;return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Gr(t.configService.getSceneConfig(t.id).id||""),t.$container=n,!n){e.next=9;break}return e.next=5,t.rendererService.init(n,t.configService.getSceneConfig(t.id));case 5:Ur()(t.$container,t.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(t.handleWindowResized),e.next=10;break;case 9:t.logger.error("\u5bb9\u5668 id \u4e0d\u5b58\u5728");case 10:t.pickingService.init(t.id),t.logger.debug("scene ".concat(t.id," renderer loaded"));case 12:case"end":return e.stop()}}),e)})))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(e){this.logger.debug("add layer ".concat(e.name," to scene ").concat(this.id)),this.layerService.add(e),this.render()}},{key:"render",value:function(){var e=Ut()(Ft.a.mark((function e(){return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.rendering&&!this.destroyed){e.next=2;break}return e.abrupt("return");case 2:if(this.rendering=!0,this.inited){e.next=13;break}return e.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(e){var t,n=null===(t=this.$container)||void 0===t?void 0:t.getElementsByTagName("canvas")[0];this.render();var r="jpg"===e?null===n||void 0===n?void 0:n.toDataURL("image/jpeg"):null===n||void 0===n?void 0:n.toDataURL("image/png");return r}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"destroy",value:function(){this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(Br["unbind"])(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)):this.destroyed=!0}},{key:"addSceneEvent",value:function(e){this.emit(e.type,e)}}]),n}(r["EventEmitter"]),br=Nr,xr=Xe()(br.prototype,"id",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wr=Xe()(br.prototype,"iconService",[ir],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sr=Xe()(br.prototype,"fontService",[or],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Er=Xe()(br.prototype,"controlService",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tr=Xe()(br.prototype,"logger",[sr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kr=Xe()(br.prototype,"configService",[ur],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar=Xe()(br.prototype,"map",[cr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cr=Xe()(br.prototype,"coordinateSystemService",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ir=Xe()(br.prototype,"rendererService",[pr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr=Xe()(br.prototype,"layerService",[fr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pr=Xe()(br.prototype,"cameraService",[hr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Or=Xe()(br.prototype,"interactionService",[dr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lr=Xe()(br.prototype,"pickingService",[mr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=Xe()(br.prototype,"shaderModuleService",[gr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr=Xe()(br.prototype,"markerService",[vr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=Xe()(br.prototype,"popupService",[yr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_r=br))||_r),Wr=n("7tbW"),Yr=n.n(Wr);function Xr(e){var t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break;default:}return t}var Kr,Jr,Qr,$r=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function ei(e){var t={};return e=e.replace($r,(function(e,n,r){var i=r.split(":"),o=i[0].trim(),a="";switch(i.length>1&&(a=i[1].trim()),n){case"bool":a="true"===a;break;case"float":case"int":a=Number(a);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":a=a?a.replace("[","").replace("]","").split(",").reduce((function(e,t){return e.push(Number(t.trim())),e}),[]):new Array(Xr(n)).fill(0);break;default:}return t[o]=a,"uniform ".concat(n," ").concat(o,";\n")})),{content:e,uniforms:t}}function ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ri,ii,oi,ai,si,ui,ci,li,pi="#define PI 3.14159265359",fi="#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",hi="#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",di="// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",mi="varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n",gi="attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n",vi="\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n",yi="#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n  return position;\n\n  // TODO: \u74e6\u7247\u5750\u6807\u7cfb & \u5e38\u89c4\u4e16\u754c\u5750\u6807\u7cfb\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}\n\n",_i="/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n",bi=/precision\s+(high|low|medium)p\s+float/,xi="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n",wi=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Si=(Kr=Object(o["injectable"])(),Kr((Qr=function(){function e(){f()(this,e),this.moduleCache={},this.rawContentCache={}}return d()(e,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:pi,fs:pi}),this.registerModule("decode",{vs:fi,fs:""}),this.registerModule("projection",{vs:yi,fs:""}),this.registerModule("project",{vs:vi,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:_i}),this.registerModule("lighting",{vs:di,fs:""}),this.registerModule("light",{vs:hi,fs:""}),this.registerModule("picking",{vs:gi,fs:mi})}},{key:"registerModule",value:function(e,t){if(!this.rawContentCache[e]){var n=t.vs,r=t.fs,i=t.uniforms,o=ei(n),a=o.content,s=o.uniforms,u=ei(r),c=u.content,l=u.uniforms;this.rawContentCache[e]={fs:c,uniforms:ni({},s,{},l,{},i),vs:a}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(e){var t=this;if(this.moduleCache[e])return this.moduleCache[e];var n=this.rawContentCache[e].vs,r=this.rawContentCache[e].fs,i=this.processModule(n,[],"vs"),o=i.content,a=i.includeList,s=this.processModule(r,[],"fs"),u=s.content,c=s.includeList,l=u,p=Yr()(a.concat(c).concat(e)).reduce((function(e,n){return ni({},e,{},t.rawContentCache[n].uniforms)}),{});return bi.test(u)||(l=xi+u),this.moduleCache[e]={fs:l.trim(),uniforms:p,vs:o.trim()},this.moduleCache[e]}},{key:"processModule",value:function(e,t,n){var r=this,i=e.replace(wi,(function(e,i){var o=i.split(" "),a=o[0].replace(/"/g,"");if(t.indexOf(a)>-1)return"";var s=r.rawContentCache[a][n];t.push(a);var u=r.processModule(s,t,n),c=u.content;return c}));return{content:i,includeList:t}}}]),e}(),Jr=Qr))||Jr),Ei=n("iWIM"),Ti=n.n(Ei),ki=n("bPkA"),Ai=(ri=Object(o["injectable"])(),ii=Object(o["inject"])(u["a"].IShaderModuleService),ri((ui=function(){function e(){f()(this,e),We()(this,"shaderModuleService",si,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return d()(e,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return ki["a"].Normal}},{key:"init",value:function(e,t){this.config=t,this.rendererService=e.getContainer().get(u["a"].IRendererService),this.cameraService=e.getContainer().get(u["a"].ICameraService),this.mapService=e.getContainer().get(u["a"].IMapService),this.interactionService=e.getContainer().get(u["a"].IInteractionService),this.layerService=e.getContainer().get(u["a"].ILayerService)}},{key:"render",value:function(e){}}]),e}(),ai=ui,si=Xe()(ai.prototype,"shaderModuleService",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=ai))||oi);function Ci(e){return function(){var t,n=oe()(e);if(Ii()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Ii(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Mi,Pi,Oi,Li,Ri,Di,zi=(ci=Object(o["injectable"])(),ci(li=function(e){te()(n,e);var t=Ci(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(e,t){Ti()(oe()(n.prototype),"init",this).call(this,e,t)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),n}(Ai))||li);function Ni(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=ji(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function ji(e,t){if(e){if("string"===typeof e)return Fi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fi(e,t):void 0}}function Fi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bi,Ui,Vi,Gi,qi,Zi,Hi=(Mi=Object(o["injectable"])(),Pi=Object(o["inject"])(u["a"].IPostProcessor),Mi((Di=function(){function e(){f()(this,e),this.passes=[],We()(this,"postProcessor",Ri,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return d()(e,[{key:"setLayer",value:function(e){this.layer=e}},{key:"setRenderFlag",value:function(e){this.renderFlag=e}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var e=Ut()(Ft.a.mark((function e(){var t,n,r;return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Ni(this.passes),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r.render(this.layer);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:this.layer.renderModels();case 18:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"resize",value:function(e,t){this.width===e&&this.height===t||(this.postProcessor.resize(e,t),this.width=e,this.height=t)}},{key:"add",value:function(e,t){e.getType()===ki["a"].PostProcessing?this.postProcessor.add(e,this.layer,t):(e.init(this.layer,t),this.passes.push(e))}},{key:"insert",value:function(e,t,n){e.init(this.layer,t),this.passes.splice(n,0,e)}},{key:"destroy",value:function(){this.passes.length=0}}]),e}(),Li=Di,Ri=Xe()(Li.prototype,"postProcessor",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oi=Li))||Oi);function Wi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wi(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xi(e){return function(){var t,n=oe()(e);if(Ki()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Ki(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ji,Qi,$i=(Bi=Object(o["injectable"])(),Ui=Object(o["inject"])(u["a"].ILogService),Bi((Zi=function(e){te()(n,e);var t=Xi(n);function n(){var e;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),We()(e,"logger",qi,yt()(e)),e.pickingFBO=void 0,e.layer=void 0,e.width=0,e.height=0,e.alreadyInRendering=!1,e.pickFromPickingFBO=function(t){var n=t.x,r=t.y,i=t.lngLat,o=t.type;if(e.layer.isVisible()&&e.layer.needPick(o)){var a,s=e.rendererService,u=s.getViewportSize,c=s.readPixels,l=s.useFramebuffer,p=u(),f=p.width,h=p.height,d=e.layer.getLayerConfig(),g=d.enableHighlight,v=d.enableSelect,y=n*window.devicePixelRatio,_=r*window.devicePixelRatio;if(!(y>f||y<0||_>h||_<0))l(e.pickingFBO,(function(){var t;if(a=c({x:Math.round(y),y:Math.round(h-(r+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(4),framebuffer:e.pickingFBO}),0!==a[0]||0!==a[1]||0!==a[2]){e.logger.debug("picked");var s=Object(m["j"])(a),u=e.layer.getSource().getFeatureById(s),l={x:n,y:r,type:o,lngLat:i,featureId:s,feature:u};u&&(e.layer.setCurrentPickId(s),e.triggerHoverOnLayer(l))}else{var p={x:n,y:r,lngLat:i,type:null===e.layer.getCurrentPickId()?"un"+o:"mouseout",featureId:null,feature:null};e.triggerHoverOnLayer(Yi({},p,{type:"unpick"})),e.triggerHoverOnLayer(p),e.layer.setCurrentPickId(null)}g&&e.highlightPickedFeature(a),v&&"click"===o&&(null===(t=a)||void 0===t?void 0:t.toString())!==[0,0,0,0].toString()&&e.selectFeature(a)}))}},e}return d()(n,[{key:"getType",value:function(){return ki["a"].Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(e,t){Ti()(oe()(n.prototype),"init",this).call(this,e,t),this.layer=e;var r=this.rendererService,i=r.createTexture2D,o=r.createFramebuffer,a=r.getViewportSize,s=a(),u=s.width,c=s.height;this.pickingFBO=o({color:i({width:u,height:c,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})}),this.interactionService.on(xt["a"].Hover,this.pickFromPickingFBO),this.interactionService.on(xt["a"].Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(xt["a"].Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(e){var t=this;if(!this.alreadyInRendering){var n=this.rendererService,r=n.getViewportSize,i=n.useFramebuffer,o=n.clear,a=r(),s=a.width,u=a.height;this.alreadyInRendering=!0,this.width===s&&this.height===u||(this.pickingFBO.resize({width:s,height:u}),this.width=s,this.height=u),i(this.pickingFBO,(function(){o({framebuffer:t.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n=t.layer.multiPassRenderer.getRenderFlag();t.layer.multiPassRenderer.setRenderFlag(!1),e.hooks.beforePickingEncode.call(),e.render(),e.hooks.afterPickingEncode.call(),t.layer.multiPassRenderer.setRenderFlag(n),t.alreadyInRendering=!1}))}}},{key:"triggerHoverOnLayer",value:function(e){this.layer.emit(e.type,e)}},{key:"highlightPickedFeature",value:function(e){var t=_e()(e,3),n=t[0],r=t[1],i=t[2];this.layer.hooks.beforeHighlight.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(e){var t=_e()(e,3),n=t[0],r=t[1],i=t[2];this.layer.hooks.beforeSelect.call([n,r,i]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(e){var t=e.featureId,n=Object(m["k"])(t);this.selectFeature(new Uint8Array(n))}},{key:"highlightFeatureHandle",value:function(e){var t=e.featureId,n=Object(m["k"])(t);this.highlightPickedFeature(new Uint8Array(n))}}]),n}(Ai),Gi=Zi,qi=Xe()(Gi.prototype,"logger",[Ui],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vi=Gi))||Vi),eo=n("+em5");function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function no(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ro(e){return function(){var t,n=oe()(e);if(io()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function io(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var oo,ao,so="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}",uo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",co=(Ji=Object(o["injectable"])(),Ji(Qi=function(e){te()(n,e);var t=ro(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:uo,fs:so});var e=this.shaderModuleService.getModule("blur-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:no({},r,{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(e){var t={};return mn()(e.blurRadius)||(t.u_BlurDir=[e.blurRadius,0]),t}}]),n}(eo["a"]))||Qi);function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function po(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fo(e){return function(){var t,n=oe()(e);if(ho()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function ho(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var mo,go,vo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}",yo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",_o=(oo=Object(o["injectable"])(),oo(ao=function(e){te()(n,e);var t=fo(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:yo,fs:vo});var e=this.shaderModuleService.getModule("blur-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:po({},r,{u_ViewportSize:[o,a]})}}},{key:"convertOptionsToUniforms",value:function(e){var t={};return mn()(e.blurRadius)||(t.u_BlurDir=[0,e.blurRadius]),t}}]),n}(eo["a"]))||ao);function bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wo(e){return function(){var t,n=oe()(e);if(So()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function So(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Eo,To,ko='varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}',Ao="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",Co=(mo=Object(o["injectable"])(),mo(go=function(e){te()(n,e);var t=wo(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:Ao,fs:ko});var e=this.shaderModuleService.getModule("colorhalftone-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:xo({},r,{u_ViewportSize:[o,a]})}}}]),n}(eo["a"]))||go);function Io(e){return function(){var t,n=oe()(e);if(Mo()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Mo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Po,Oo,Lo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",Ro="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",Do=(Eo=Object(o["injectable"])(),Eo(To=function(e){te()(n,e);var t=Io(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:Ro,fs:Lo}),this.shaderModuleService.getModule("copy-pass")}}]),n}(eo["a"]))||To);function zo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function No(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zo(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jo(e){return function(){var t,n=oe()(e);if(Fo()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Fo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Bo,Uo,Vo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}",Go="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",qo=(Po=Object(o["injectable"])(),Po(Oo=function(e){te()(n,e);var t=jo(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:Go,fs:Vo});var e=this.shaderModuleService.getModule("hexagonalpixelate-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:No({},r,{u_ViewportSize:[o,a]})}}}]),n}(eo["a"]))||Oo);function Zo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ho(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zo(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wo(e){return function(){var t,n=oe()(e);if(Yo()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Yo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Xo,Ko,Jo="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}",Qo="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",$o=(Bo=Object(o["injectable"])(),Bo(Uo=function(e){te()(n,e);var t=Wo(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Qo,fs:Jo});var e=this.shaderModuleService.getModule("ink-pass"),t=e.vs,n=e.fs,r=e.uniforms,i=this.rendererService.getViewportSize(),o=i.width,a=i.height;return{vs:t,fs:n,uniforms:Ho({},r,{u_ViewportSize:[o,a]})}}}]),n}(eo["a"]))||Uo);function ea(e){return function(){var t,n=oe()(e);if(ta()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function ta(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var na,ra,ia="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}",oa="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",aa=(Xo=Object(o["injectable"])(),Xo(Ko=function(e){te()(n,e);var t=ea(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:oa,fs:ia}),this.shaderModuleService.getModule("noise-pass")}}]),n}(eo["a"]))||Ko);function sa(e){return function(){var t,n=oe()(e);if(ua()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function ua(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ca,la,pa,fa,ha,da,ma,ga,va,ya="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",_a="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}",ba=(na=Object(o["injectable"])(),na(ra=function(e){te()(n,e);var t=sa(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:ya,fs:_a}),this.shaderModuleService.getModule("sepia-pass")}}]),n}(eo["a"]))||ra),xa=(ca=Object(o["injectable"])(),la=Object(o["inject"])(u["a"].IRendererService),pa=Object(o["postConstruct"])(),ca((ma=function(){function e(){f()(this,e),We()(this,"rendererService",da,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return d()(e,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var e=Ut()(Ft.a.mark((function e(t){var n,r;return Ft.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.passes.length)){e.next=10;break}return r=this.passes[n],r.setRenderToScreen(this.isLastEnabledPass(n)),e.next=6,r.render(t);case 6:n!==this.passes.length-1&&this.swap();case 7:n++,e.next=1;break;case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"resize",value:function(e,t){this.readFBO.resize({width:e,height:t}),this.writeFBO.resize({width:e,height:t})}},{key:"add",value:function(e,t,n){e.init(t,n),this.passes.push(e)}},{key:"insert",value:function(e,t,n,r){e.init(n,r),this.passes.splice(t,0,e)}},{key:"getPostProcessingPassByName",value:function(e){return this.passes.find((function(t){return t.getName()===e}))}},{key:"init",value:function(){var e=this.rendererService,t=e.createFramebuffer,n=e.createTexture2D;this.readFBO=t({color:n({width:1,height:1,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})}),this.writeFBO=t({color:n({width:1,height:1,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].isEnabled())return!1;return!0}},{key:"swap",value:function(){var e=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=e}}]),e}(),ha=ma,da=Xe()(ha.prototype,"rendererService",[la],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe()(ha.prototype,"init",[pa],Object.getOwnPropertyDescriptor(ha.prototype,"init"),ha.prototype),fa=ha))||fa);function wa(e){return function(){var t,n=oe()(e);if(Sa()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function Sa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ea,Ta,ka,Aa,Ca,Ia,Ma,Pa,Oa=(ga=Object(o["injectable"])(),ga(va=function(e){te()(n,e);var t=wa(n);function n(){return f()(this,n),t.apply(this,arguments)}return d()(n,[{key:"getType",value:function(){return ki["a"].Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(e,t){Ti()(oe()(n.prototype),"init",this).call(this,e,t)}},{key:"render",value:function(e){var t=this.rendererService,n=t.useFramebuffer,r=t.clear,i=e.multiPassRenderer.getPostProcessor().getReadFBO();n(i,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i}),e.multiPassRenderer.setRenderFlag(!1),e.render(),e.multiPassRenderer.setRenderFlag(!0)}))}}]),n}(Ai))||va);function La(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ra(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?La(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):La(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Da(e){return function(){var t,n=oe()(e);if(za()){var r=oe()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return re()(this,t)}}function za(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Na="uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n",ja="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",Fa="attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}";function Ba(e,t){var n=0,r=1/t,i=e;while(i>0)n+=r*(i%t),i=Math.floor(i/t),r/=t;return n}var Ua=1,Va=(Ea=Object(o["injectable"])(),Ta=Object(o["inject"])(u["a"].IShaderModuleService),ka=Object(o["inject"])(u["a"].ILogService),Ea((Pa=function(e){te()(n,e);var t=Da(n);function n(){var e;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),We()(e,"shaderModuleService",Ia,yt()(e)),We()(e,"logger",Ma,yt()(e)),e.haltonSequence=[],e.accumulatingId=0,e.frame=0,e.timer=void 0,e.sampleRenderTarget=void 0,e.prevRenderTarget=void 0,e.outputRenderTarget=void 0,e.copyRenderTarget=void 0,e.blendModel=void 0,e.outputModel=void 0,e.copyModel=void 0,e}return d()(n,[{key:"getType",value:function(){return ki["a"].Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(e,t){Ti()(oe()(n.prototype),"init",this).call(this,e,t);var r=this.rendererService,i=r.createFramebuffer,o=r.createTexture2D;this.sampleRenderTarget=i({color:o({width:1,height:1,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})}),this.prevRenderTarget=i({color:o({width:1,height:1,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})}),this.outputRenderTarget=i({color:o({width:1,height:1,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})}),this.copyRenderTarget=i({color:o({width:1,height:1,wrapS:Vt["a"].CLAMP_TO_EDGE,wrapT:Vt["a"].CLAMP_TO_EDGE})});for(var a=0;a<30;a++)this.haltonSequence.push([Ba(a,2),Ba(a,3)]);this.blendModel=this.createTriangleModel("blend-pass",Na),this.outputModel=this.createTriangleModel("copy-pass",ja,{blend:{enable:!0,func:{srcRGB:Vt["a"].ONE,dstRGB:Vt["a"].ONE_MINUS_SRC_ALPHA,srcAlpha:Vt["a"].ONE,dstAlpha:Vt["a"].ONE_MINUS_SRC_ALPHA},equation:{rgb:Vt["a"].FUNC_ADD,alpha:Vt["a"].FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",ja)}},{key:"render",value:function(e){var t=this,n=this.rendererService,r=n.clear,i=n.getViewportSize,o=n.useFramebuffer,a=i(),s=a.width,u=a.height;this.sampleRenderTarget.resize({width:s,height:u}),this.prevRenderTarget.resize({width:s,height:u}),this.outputRenderTarget.resize({width:s,height:u}),this.copyRenderTarget.resize({width:s,height:u}),this.resetFrame(),this.stopAccumulating();var c=e.multiPassRenderer.getPostProcessor().getReadFBO();o(c,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:c}),e.multiPassRenderer.setRenderFlag(!1),e.render(),e.multiPassRenderer.setRenderFlag(!0)}));var l=function n(r){t.accumulatingId&&r===t.accumulatingId&&(t.isFinished()||(t.doRender(e),requestAnimationFrame((function(){n(r)}))))};this.accumulatingId=Ua++,this.timer=window.setTimeout((function(){l(t.accumulatingId)}),50)}},{key:"doRender",value:function(e){var t=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var n=this.rendererService,r=n.clear,i=n.getViewportSize,o=n.useFramebuffer,a=i(),s=a.width,u=a.height,c=e.getLayerConfig(),l=c.jitterScale,p=void 0===l?1:l,f=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*f[0]-1)/s*p,(2*f[1]-1)/u*p),e.multiPassRenderer.setRenderFlag(!1),e.hooks.beforeRender.call(),o(this.sampleRenderTarget,(function(){r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:t.sampleRenderTarget}),e.render()})),e.hooks.afterRender.call(),e.multiPassRenderer.setRenderFlag(!0);var h=e.getLayerConfig();o(this.outputRenderTarget,(function(){t.blendModel.draw({uniforms:{u_opacity:h.opacity||1,u_MixRatio:0===t.frame?1:.9,u_Diffuse1:t.sampleRenderTarget,u_Diffuse2:0===t.frame?e.multiPassRenderer.getPostProcessor().getReadFBO():t.prevRenderTarget}})})),0===this.frame&&r({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(o(this.copyRenderTarget,(function(){t.outputModel.draw({uniforms:{u_Texture:t.outputRenderTarget}})})),o(e.multiPassRenderer.getPostProcessor().getReadFBO(),(function(){t.copyModel.draw({uniforms:{u_Texture:t.copyRenderTarget}})})),e.multiPassRenderer.getPostProcessor().render(e));var d=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=d,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(e,t,n){this.shaderModuleService.registerModule(e,{vs:Fa,fs:t});var r=this.shaderModuleService.getModule(e),i=r.vs,o=r.fs,a=r.uniforms,s=this.rendererService,u=s.createAttribute,c=s.createBuffer,l=s.createModel;return l(Ra({vs:i,fs:o,attributes:{a_Position:u({buffer:c({data:[-4,-4,4,-4,0,4],type:Vt["a"].FLOAT}),size:2})},uniforms:Ra({},a),depth:{enable:!1},count:3},n))}}]),n}(Ai),Ca=Pa,Ia=Xe()(Ca.prototype,"shaderModuleService",[Ta],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma=Xe()(Ca.prototype,"logger",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aa=Ca))||Aa),Ga=new o["Container"];Ga.bind(u["a"].IGlobalConfigService).to(Ze).inSingletonScope(),Ga.bind(u["a"].IShaderModuleService).to(Si).inSingletonScope(),Ga.bind(u["a"].ILogService).to(jr).inSingletonScope(),Object(o["decorate"])(Object(o["injectable"])(),r["EventEmitter"]),Ga.bind(u["a"].IEventEmitter).to(r["EventEmitter"]);var qa=s()(Ga,!1),Za=function(e){var t=qa.lazyInject(e);return function(e,n,r){t.call(this,e,n),r&&(r.initializer=function(){return e[n]})}},Ha=(t["c"]=Ga,0);function Wa(){var e=new o["Container"];return e.parent=Ga,e.bind(u["a"].SceneID).toConstantValue("".concat(Ha++)),e.bind(u["a"].ILayerService).to(cn).inSingletonScope(),e.bind(u["a"].ISceneService).to(Hr).inSingletonScope(),e.bind(u["a"].ICameraService).to(xe).inSingletonScope(),e.bind(u["a"].ICoordinateSystemService).to(gt).inSingletonScope(),e.bind(u["a"].IInteractionService).to(Nt).inSingletonScope(),e.bind(u["a"].IPickingService).to(sn).inSingletonScope(),e.bind(u["a"].IControlService).to(Re).inSingletonScope(),e.bind(u["a"].IMarkerService).to(De).inSingletonScope(),e.bind(u["a"].IIconService).to(ve).inSingletonScope(),e.bind(u["a"].IFontService).to($).inSingletonScope(),e.bind(u["a"].IPopupService).to(ze).inSingletonScope(),e.bind(u["a"].INormalPass).to(zi).whenTargetNamed("clear"),e.bind(u["a"].INormalPass).to($i).whenTargetNamed("pixelPicking"),e.bind(u["a"].INormalPass).to(Oa).whenTargetNamed("render"),e.bind(u["a"].INormalPass).to(Va).whenTargetNamed("taa"),e.bind(u["a"].IFactoryNormalPass).toFactory((function(e){return function(t){return e.container.getNamed(u["a"].INormalPass,t)}})),e.bind(u["a"].IPostProcessingPass).to(Do).whenTargetNamed("copy"),e.bind(u["a"].IPostProcessingPass).to(co).whenTargetNamed("blurH"),e.bind(u["a"].IPostProcessingPass).to(_o).whenTargetNamed("blurV"),e.bind(u["a"].IPostProcessingPass).to(aa).whenTargetNamed("noise"),e.bind(u["a"].IPostProcessingPass).to(ba).whenTargetNamed("sepia"),e.bind(u["a"].IPostProcessingPass).to(Co).whenTargetNamed("colorHalftone"),e.bind(u["a"].IPostProcessingPass).to(qo).whenTargetNamed("hexagonalPixelate"),e.bind(u["a"].IPostProcessingPass).to($o).whenTargetNamed("ink"),e.bind(u["a"].IFactoryPostProcessingPass).toFactory((function(e){return function(t){var n=e.container.getNamed(u["a"].IPostProcessingPass,t);return n.setName(t),n}})),e}function Ya(e){var t=new o["Container"];return t.parent=e,t.bind(u["a"].IStyleAttributeService).to(bn).inSingletonScope(),t.bind(u["a"].IMultiPassRenderer).to(Hi).inSingletonScope(),t.bind(u["a"].IPostProcessor).to(xa).inSingletonScope(),t}},fbrv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("Yk9n"),i=n("MON2"),o=n("FV85"),a=n("xfSm"),s=n("ujMp");t.getFunctionName=s.getFunctionName;var u=n("dX1H");function c(e,t){var n=s.getFunctionName(t),r=l(e,n,t,!1);return r}function l(e,t,n,r){var o=e.getConstructorMetadata(n),a=o.compilerGeneratedMetadata;if(void 0===a){var s=i.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(s)}var u=o.userGeneratedMetadata,c=Object.keys(u),l=0===n.length&&c.length>0,p=l?c.length:n.length,d=f(r,t,a,u,p),m=h(e,n),g=d.concat(m);return g}function p(e,t,n,a,s){var c=s[e.toString()]||[],l=m(c),p=!0!==l.unmanaged,f=a[e],h=l.inject||l.multiInject;if(f=h||f,f instanceof r.LazyServiceIdentifer&&(f=f.unwrap()),p){var d=f===Object,g=f===Function,v=void 0===f,y=d||g||v;if(!t&&y){var _=i.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".";throw new Error(_)}var b=new u.Target(o.TargetTypeEnum.ConstructorArgument,l.targetName,f);return b.metadata=c,b}return null}function f(e,t,n,r,i){for(var o=[],a=0;a<i;a++){var s=a,u=p(s,e,t,n,r);null!==u&&o.push(u)}return o}function h(e,t){for(var n=e.getPropertiesMetadata(t),r=[],i=Object.keys(n),a=0,s=i;a<s.length;a++){var c=s[a],l=n[c],p=m(n[c]),f=p.targetName||c,d=p.inject||p.multiInject,g=new u.Target(o.TargetTypeEnum.ClassProperty,f,d);g.metadata=l,r.push(g)}var v=Object.getPrototypeOf(t.prototype).constructor;if(v!==Object){var y=h(e,v);r=r.concat(y)}return r}function d(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var r=s.getFunctionName(n),i=l(e,r,n,!0),o=i.map((function(e){return e.metadata.filter((function(e){return e.key===a.UNMANAGED_TAG}))})),u=[].concat.apply([],o).length,c=i.length-u;return c>0?c:d(e,n)}return 0}function m(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[a.INJECT_TAG],multiInject:t[a.MULTI_INJECT_TAG],targetName:t[a.NAME_TAG],unmanaged:t[a.UNMANAGED_TAG]}}t.getDependencies=c,t.getBaseClassDependencyCount=d},fbvF:function(e,t,n){(function(t,n){e.exports=n()})(0,(function(){"use strict";var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]=t[n[r]];return e},n="\n";function r(e){return"undefined"!==typeof atob?atob(e):"base64:"+e}function i(e){var t=new Error("(regl) "+e);throw console.error(t),t}function o(e,t){e||i(t)}function a(e){return e?": "+e:""}function s(e,t,n){e in t||i("unknown parameter ("+e+")"+a(n)+". possible values: "+Object.keys(t).join())}function u(t,n){e(t)||i("invalid parameter type"+a(n)+". must be a typed array")}function c(e,t,n){typeof e!==t&&i("invalid parameter type"+a(n)+". expected "+t+", got "+typeof e)}function l(e,t){e>=0&&(0|e)===e||i("invalid parameter type, ("+e+")"+a(t)+". must be a nonnegative integer")}function p(e,t,n){t.indexOf(e)<0&&i("invalid value"+a(n)+". must be one of: "+t)}var f=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function h(e){Object.keys(e).forEach((function(e){f.indexOf(e)<0&&i('invalid regl constructor argument "'+e+'". must be one of '+f)}))}function d(e,t){e+="";while(e.length<t)e=" "+e;return e}function m(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function g(e,t){this.number=e,this.line=t,this.errors=[]}function v(e,t,n){this.file=e,this.line=t,this.message=n}function y(){var e=new Error,t=(e.stack||e).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return r?r[1]:"unknown"}function _(){var e=new Error,t=(e.stack||e).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return r?r[1]:"unknown"}function b(e,t){var n=e.split("\n"),i=1,o=0,a={unknown:new m,0:new m};a.unknown.name=a[0].name=t||y(),a.unknown.lines.push(new g(0,""));for(var s=0;s<n.length;++s){var u=n[s],c=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(u);if(c)switch(c[1]){case"line":var l=/(\d+)(\s+\d+)?/.exec(c[2]);l&&(i=0|l[1],l[2]&&(o=0|l[2],o in a||(a[o]=new m)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);p&&(a[o].name=p[1]?r(p[2]):p[2]);break}a[o].lines.push(new g(i++,u))}return Object.keys(a).forEach((function(e){var t=a[e];t.lines.forEach((function(e){t.index[e.number]=e}))})),a}function x(e){var t=[];return e.split("\n").forEach((function(e){if(!(e.length<5)){var n=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(e);n?t.push(new v(0|n[1],0|n[2],n[3].trim())):e.length>0&&t.push(new v("unknown",0,e))}})),t}function w(e,t){t.forEach((function(t){var n=e[t.file];if(n){var r=n.index[t.line];if(r)return r.errors.push(t),void(n.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)}))}function S(e,t,r,i,a){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var s=e.getShaderInfoLog(t),u=i===e.FRAGMENT_SHADER?"fragment":"vertex";M(r,"string",u+" shader source must be a string",a);var c=b(r,a),l=x(s);w(c,l),Object.keys(c).forEach((function(e){var t=c[e];if(t.hasErrors){var r=[""],i=[""];o("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach((function(e){if(e.errors.length>0){o(d(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(e.line+n,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach((function(r){var i=r.message,a=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(i);if(a){var s=a[1];switch(i=a[2],s){case"assign":s="=";break}t=Math.max(e.line.indexOf(s,t),0)}else t=0;o(d("| ",6)),o(d("^^^",t+3)+n,"font-weight:bold"),o(d("| ",6)),o(i+n,"font-weight:bold")})),o(d("| ",6)+n)}else o(d(e.number,4)+"|  "),o(e.line+n,"color:red")})),"undefined"===typeof document||window.chrome?console.log(r.join("")):(i[0]=r.join("%c"),console.log.apply(console,i))}function o(e,t){r.push(e),i.push(t||"")}})),o.raise("Error compiling "+u+" shader, "+c[0].name)}}function E(e,t,r,i,a){if(!e.getProgramParameter(t,e.LINK_STATUS)){var s=e.getProgramInfoLog(t),u=b(r,a),c=b(i,a),l='Error linking program with vertex shader, "'+c[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!==typeof document?console.log("%c"+l+n+"%c"+s,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(l+n+s),o.raise(l)}}function T(e){e._commandRef=y()}function k(e,t,n,r){function i(e){return e?r.id(e):0}function o(e,t){Object.keys(t).forEach((function(t){e[r.id(t)]=!0}))}T(e),e._fragId=i(e.static.frag),e._vertId=i(e.static.vert);var a=e._uniformSet={};o(a,t.static),o(a,t.dynamic);var s=e._attributeSet={};o(s,n.static),o(s,n.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic}function A(e,t){var n=_();i(e+" in command "+(t||y())+("unknown"===n?"":" called from "+n))}function C(e,t,n){e||A(t,n||y())}function I(e,t,n,r){e in t||A("unknown parameter ("+e+")"+a(n)+". possible values: "+Object.keys(t).join(),r||y())}function M(e,t,n,r){typeof e!==t&&A("invalid parameter type"+a(n)+". expected "+t+", got "+typeof e,r||y())}function P(e){e()}function O(e,t,n){e.texture?p(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):p(e.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var L=33071,R=9728,D=9984,z=9985,N=9986,j=9987,F=5120,B=5121,U=5122,V=5123,G=5124,q=5125,Z=5126,H=32819,W=32820,Y=33635,X=34042,K=36193,J={};function Q(e,t){return e===W||e===H||e===Y?2:e===X?4:J[e]*t}function $(e){return!(e&e-1)&&!!e}function ee(e,t,n){var r,i=t.width,a=t.height,s=t.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),e.wrapS===L&&e.wrapT===L||o($(i)&&$(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==i&&1!==a&&o(e.minFilter!==D&&e.minFilter!==N&&e.minFilter!==z&&e.minFilter!==j,"min filter requires mipmap"):(o($(i)&&$(a),"texture must be a square power of 2 to support mipmapping"),o(t.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),t.type===Z&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(e.minFilter===R&&e.magFilter===R,"filter not supported, must enable oes_texture_float_linear"),o(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(r=0;r<16;++r)if(u[r]){var c=i>>r,l=a>>r;o(t.mipmask&1<<r,"missing mipmap data");var p=u[r];if(o(p.width===c&&p.height===l,"invalid shape for mip images"),o(p.format===t.format&&p.internalformat===t.internalformat&&p.type===t.type,"incompatible type for mip image"),p.compressed);else if(p.data){var f=Math.ceil(Q(p.type,s)*c/p.unpackAlignment)*p.unpackAlignment;o(p.data.byteLength===f*l,"invalid data for image, buffer size is inconsistent with image format")}else p.element||p.copy}else e.genMipmaps||o(0===(t.mipmask&1<<r),"extra mipmap data");t.compressed&&o(!e.genMipmaps,"mipmap generation for compressed images not supported")}function te(e,t,n,r){var i=e.width,a=e.height,s=e.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(t.wrapS===L&&t.wrapT===L,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var c=n[u];o(c.width===i&&c.height===a,"inconsistent cube map face shape"),t.genMipmaps&&(o(!c.compressed,"can not generate mipmap for compressed textures"),o(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=c.images,p=0;p<16;++p){var f=l[p];if(f){var h=i>>p,d=a>>p;o(c.mipmask&1<<p,"missing mipmap data"),o(f.width===h&&f.height===d,"invalid shape for mip images"),o(f.format===e.format&&f.internalformat===e.internalformat&&f.type===e.type,"incompatible type for mip image"),f.compressed||(f.data?o(f.data.byteLength===h*d*Math.max(Q(f.type,s),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}J[F]=J[B]=1,J[U]=J[V]=J[K]=J[Y]=J[H]=J[W]=2,J[G]=J[q]=J[Z]=J[X]=4;var ne=t(o,{optional:P,raise:i,commandRaise:A,command:C,parameter:s,commandParameter:I,constructor:h,type:c,commandType:M,isTypedArray:u,nni:l,oneOf:p,shaderError:S,linkError:E,callSite:_,saveCommandRef:T,saveDrawInfo:k,framebufferFormat:O,guessCommand:y,texture2D:ee,textureCube:te}),re=0,ie=0;function oe(e,t){this.id=re++,this.type=e,this.data=t}function ae(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function se(e){if(0===e.length)return[];var t=e.charAt(0),n=e.charAt(e.length-1);if(e.length>1&&t===n&&('"'===t||"'"===t))return['"'+ae(e.substr(1,e.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(r)return se(e.substr(0,r.index)).concat(se(r[1])).concat(se(e.substr(r.index+r[0].length)));var i=e.split(".");if(1===i.length)return['"'+ae(e)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(se(i[a]));return o}function ue(e){return"["+se(e).join("][")+"]"}function ce(e,t){return new oe(e,ue(t+""))}function le(e){return"function"===typeof e&&!e._reglType||e instanceof oe}function pe(e,t){return"function"===typeof e?new oe(ie,e):e}var fe={DynamicVariable:oe,define:ce,isDynamic:le,unbox:pe,accessor:ue},he={next:"function"===typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"===typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},de="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function me(){var e={"":0},t=[""];return{id:function(n){var r=e[n];return r||(r=e[n]=t.length,t.push(n),r)},str:function(e){return t[e]}}}function ge(e,n,r){var i=document.createElement("canvas");function o(){var n=window.innerWidth,o=window.innerHeight;if(e!==document.body){var a=e.getBoundingClientRect();n=a.right-a.left,o=a.bottom-a.top}i.width=r*n,i.height=r*o,t(i.style,{width:n+"px",height:o+"px"})}function a(){window.removeEventListener("resize",o),e.removeChild(i)}return t(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",t(e.style,{margin:0,padding:0})),window.addEventListener("resize",o,!1),o(),{canvas:i,onDestroy:a}}function ve(e,t){function n(n){try{return e.getContext(n,t)}catch(r){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function ye(e){return"string"===typeof e.nodeName&&"function"===typeof e.appendChild&&"function"===typeof e.getBoundingClientRect}function _e(e){return"function"===typeof e.drawArrays||"function"===typeof e.drawElements}function be(e){return"string"===typeof e?e.split():(ne(Array.isArray(e),"invalid extension array"),e)}function xe(e){return"string"===typeof e?(ne("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function we(e){var t,n,r,i,o=e||{},a={},s=[],u=[],c="undefined"===typeof window?1:window.devicePixelRatio,l=!1,p=function(e){e&&ne.raise(e)},f=function(){};if("string"===typeof o?(ne("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),t=document.querySelector(o),ne(t,"invalid query string for element")):"object"===typeof o?ye(o)?t=o:_e(o)?(i=o,r=i.canvas):(ne.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=xe(o.canvas):"container"in o&&(n=xe(o.container)),"attributes"in o&&(a=o.attributes,ne.type(a,"object","invalid context attributes")),"extensions"in o&&(s=be(o.extensions)),"optionalExtensions"in o&&(u=be(o.optionalExtensions)),"onDone"in o&&(ne.type(o.onDone,"function","invalid or missing onDone callback"),p=o.onDone),"profile"in o&&(l=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,ne(c>0,"invalid pixel ratio"))):ne.raise("invalid arguments to regl"),t&&("canvas"===t.nodeName.toLowerCase()?r=t:n=t),!i){if(!r){ne("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");var h=ge(n||document.body,p,c);if(!h)return null;r=h.canvas,f=h.onDestroy}i=ve(r,a)}return i?{gl:i,canvas:r,container:n,extensions:s,optionalExtensions:u,pixelRatio:c,profile:l,onDone:p,onDestroy:f}:(f(),p("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Se(e,t){var n={};function r(t){ne.type(t,"string","extension name must be string");var r,i=t.toLowerCase();try{r=n[i]=e.getExtension(i)}catch(o){}return!!r}for(var i=0;i<t.extensions.length;++i){var o=t.extensions[i];if(!r(o))return t.onDestroy(),t.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(e){if(n[e]&&!r(e))throw new Error("(regl): error restoring extension "+e)}))}}}function Ee(e,t){for(var n=Array(e),r=0;r<e;++r)n[r]=t(r);return n}var Te=5120,ke=5121,Ae=5122,Ce=5123,Ie=5124,Me=5125,Pe=5126;function Oe(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function Le(e){var t,n;return t=(e>65535)<<4,e>>>=t,n=(e>255)<<3,e>>>=n,t|=n,n=(e>15)<<2,e>>>=n,t|=n,n=(e>3)<<1,e>>>=n,t|=n,t|e>>1}function Re(){var e=Ee(8,(function(){return[]}));function t(t){var n=Oe(t),r=e[Le(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(t){e[Le(t.byteLength)>>2].push(t)}function r(e,n){var r=null;switch(e){case Te:r=new Int8Array(t(n),0,n);break;case ke:r=new Uint8Array(t(n),0,n);break;case Ae:r=new Int16Array(t(2*n),0,n);break;case Ce:r=new Uint16Array(t(2*n),0,n);break;case Ie:r=new Int32Array(t(4*n),0,n);break;case Me:r=new Uint32Array(t(4*n),0,n);break;case Pe:r=new Float32Array(t(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r}function i(e){n(e.buffer)}return{alloc:t,free:n,allocType:r,freeType:i}}var De=Re();De.zero=Re();var ze=3408,Ne=3410,je=3411,Fe=3412,Be=3413,Ue=3414,Ve=3415,Ge=33901,qe=33902,Ze=3379,He=3386,We=34921,Ye=36347,Xe=36348,Ke=35661,Je=35660,Qe=34930,$e=36349,et=34076,tt=34024,nt=7936,rt=7937,it=7938,ot=35724,at=34047,st=36063,ut=34852,ct=3553,lt=34067,pt=34069,ft=33984,ht=6408,dt=5126,mt=5121,gt=36160,vt=36053,yt=36064,_t=16384,bt=function(e,t){var n=1;t.ext_texture_filter_anisotropic&&(n=e.getParameter(at));var r=1,i=1;t.webgl_draw_buffers&&(r=e.getParameter(ut),i=e.getParameter(st));var o=!!t.oes_texture_float;if(o){var a=e.createTexture();e.bindTexture(ct,a),e.texImage2D(ct,0,ht,1,1,0,ht,dt,null);var s=e.createFramebuffer();if(e.bindFramebuffer(gt,s),e.framebufferTexture2D(gt,yt,ct,a,0),e.bindTexture(ct,null),e.checkFramebufferStatus(gt)!==vt)o=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(_t);var u=De.allocType(dt,4);e.readPixels(0,0,1,1,ht,dt,u),e.getError()?o=!1:(e.deleteFramebuffer(s),e.deleteTexture(a),o=1===u[0]),De.freeType(u)}}var c="undefined"!==typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),l=!0;if(!c){var p=e.createTexture(),f=De.allocType(mt,36);e.activeTexture(ft),e.bindTexture(lt,p),e.texImage2D(pt,0,ht,3,3,0,ht,mt,f),De.freeType(f),e.bindTexture(lt,null),e.deleteTexture(p),l=!e.getError()}return{colorBits:[e.getParameter(Ne),e.getParameter(je),e.getParameter(Fe),e.getParameter(Be)],depthBits:e.getParameter(Ue),stencilBits:e.getParameter(Ve),subpixelBits:e.getParameter(ze),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:e.getParameter(Ge),lineWidthDims:e.getParameter(qe),maxViewportDims:e.getParameter(He),maxCombinedTextureUnits:e.getParameter(Ke),maxCubeMapSize:e.getParameter(et),maxRenderbufferSize:e.getParameter(tt),maxTextureUnits:e.getParameter(Qe),maxTextureSize:e.getParameter(Ze),maxAttributes:e.getParameter(We),maxVertexUniforms:e.getParameter(Ye),maxVertexTextureUnits:e.getParameter(Je),maxVaryingVectors:e.getParameter(Xe),maxFragmentUniforms:e.getParameter($e),glsl:e.getParameter(ot),renderer:e.getParameter(rt),vendor:e.getParameter(nt),version:e.getParameter(it),readFloat:o,npotTextureCube:l}};function xt(t){return!!t&&"object"===typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"===typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var wt=function(e){return Object.keys(e).map((function(t){return e[t]}))},St={shape:It,flatten:Ct};function Et(e,t,n){for(var r=0;r<t;++r)n[r]=e[r]}function Tt(e,t,n,r){for(var i=0,o=0;o<t;++o)for(var a=e[o],s=0;s<n;++s)r[i++]=a[s]}function kt(e,t,n,r,i,o){for(var a=o,s=0;s<t;++s)for(var u=e[s],c=0;c<n;++c)for(var l=u[c],p=0;p<r;++p)i[a++]=l[p]}function At(e,t,n,r,i){for(var o=1,a=n+1;a<t.length;++a)o*=t[a];var s=t[n];if(t.length-n===4){var u=t[n+1],c=t[n+2],l=t[n+3];for(a=0;a<s;++a)kt(e[a],u,c,l,r,i),i+=o}else for(a=0;a<s;++a)At(e[a],t,n+1,r,i),i+=o}function Ct(e,t,n,r){var i=1;if(t.length)for(var o=0;o<t.length;++o)i*=t[o];else i=0;var a=r||De.allocType(n,i);switch(t.length){case 0:break;case 1:Et(e,t[0],a);break;case 2:Tt(e,t[0],t[1],a);break;case 3:kt(e,t[0],t[1],t[2],a,0);break;default:At(e,t,0,a,0)}return a}function It(e){for(var t=[],n=e;n.length;n=n[0])t.push(n.length);return t}var Mt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Pt=5120,Ot=5122,Lt=5124,Rt=5121,Dt=5123,zt=5125,Nt=5126,jt=5126,Ft={int8:Pt,int16:Ot,int32:Lt,uint8:Rt,uint16:Dt,uint32:zt,float:Nt,float32:jt},Bt=35048,Ut=35040,Vt={dynamic:Bt,stream:Ut,static:35044},Gt=St.flatten,qt=St.shape,Zt=35044,Ht=35040,Wt=5121,Yt=5126,Xt=[];function Kt(e){return 0|Mt[Object.prototype.toString.call(e)]}function Jt(e,t){for(var n=0;n<t.length;++n)e[n]=t[n]}function Qt(e,t,n,r,i,o,a){for(var s=0,u=0;u<n;++u)for(var c=0;c<r;++c)e[s++]=t[i*u+o*c+a]}function $t(t,n,r,i){var o=0,a={};function s(e){this.id=o++,this.buffer=t.createBuffer(),this.type=e,this.usage=Zt,this.byteLength=0,this.dimension=1,this.dtype=Wt,this.persistentData=null,r.profile&&(this.stats={size:0})}s.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},s.prototype.destroy=function(){h(this)};var u=[];function c(e,t){var n=u.pop();return n||(n=new s(e)),n.bind(),f(n,t,Ht,0,1,!1),n}function l(e){u.push(e)}function p(e,n,r){e.byteLength=n.byteLength,t.bufferData(e.type,n,r)}function f(t,n,r,i,o,a){var s,u;if(t.usage=r,Array.isArray(n)){if(t.dtype=i||Yt,n.length>0)if(Array.isArray(n[0])){s=qt(n);for(var c=1,l=1;l<s.length;++l)c*=s[l];t.dimension=c,u=Gt(n,s,t.dtype),p(t,u,r),a?t.persistentData=u:De.freeType(u)}else if("number"===typeof n[0]){t.dimension=o;var f=De.allocType(t.dtype,n.length);Jt(f,n),p(t,f,r),a?t.persistentData=f:De.freeType(f)}else e(n[0])?(t.dimension=n[0].length,t.dtype=i||Kt(n[0])||Yt,u=Gt(n,[n.length,n[0].length],t.dtype),p(t,u,r),a?t.persistentData=u:De.freeType(u)):ne.raise("invalid buffer data")}else if(e(n))t.dtype=i||Kt(n),t.dimension=o,p(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(xt(n)){s=n.shape;var h=n.stride,d=n.offset,m=0,g=0,v=0,y=0;1===s.length?(m=s[0],g=1,v=h[0],y=0):2===s.length?(m=s[0],g=s[1],v=h[0],y=h[1]):ne.raise("invalid shape"),t.dtype=i||Kt(n.data)||Yt,t.dimension=g;var _=De.allocType(t.dtype,m*g);Qt(_,n.data,m,g,v,y,d),p(t,_,r),a?t.persistentData=_:De.freeType(_)}else n instanceof ArrayBuffer?(t.dtype=Wt,t.dimension=o,p(t,n,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(n)))):ne.raise("invalid buffer data")}function h(e){n.bufferCount--;for(var r=0;r<i.state.length;++r){var o=i.state[r];o.buffer===e&&(t.disableVertexAttribArray(r),o.buffer=null)}var s=e.buffer;ne(s,"buffer must not be deleted already"),t.deleteBuffer(s),e.buffer=null,delete a[e.id]}function d(i,o,u,c){n.bufferCount++;var l=new s(o);function p(n){var i=Zt,o=null,a=0,s=0,u=1;return Array.isArray(n)||e(n)||xt(n)||n instanceof ArrayBuffer?o=n:"number"===typeof n?a=0|n:n&&(ne.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(ne(null===o||Array.isArray(o)||e(o)||xt(o),"invalid data for buffer"),o=n.data),"usage"in n&&(ne.parameter(n.usage,Vt,"invalid buffer usage"),i=Vt[n.usage]),"type"in n&&(ne.parameter(n.type,Ft,"invalid buffer type"),s=Ft[n.type]),"dimension"in n&&(ne.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(ne.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),l.bind(),o?f(l,o,i,s,u,c):(a&&t.bufferData(l.type,a,i),l.dtype=s||Wt,l.usage=i,l.dimension=u,l.byteLength=a),r.profile&&(l.stats.size=l.byteLength*Xt[l.dtype]),p}function d(e,n){ne(n+e.byteLength<=l.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+n+" to a buffer of size "+l.byteLength),t.bufferSubData(l.type,n,e)}function m(t,n){var r,i=0|(n||0);if(l.bind(),e(t)||t instanceof ArrayBuffer)d(t,i);else if(Array.isArray(t)){if(t.length>0)if("number"===typeof t[0]){var o=De.allocType(l.dtype,t.length);Jt(o,t),d(o,i),De.freeType(o)}else if(Array.isArray(t[0])||e(t[0])){r=qt(t);var a=Gt(t,r,l.dtype);d(a,i),De.freeType(a)}else ne.raise("invalid buffer data")}else if(xt(t)){r=t.shape;var s=t.stride,u=0,c=0,f=0,h=0;1===r.length?(u=r[0],c=1,f=s[0],h=0):2===r.length?(u=r[0],c=r[1],f=s[0],h=s[1]):ne.raise("invalid shape");var m=Array.isArray(t.data)?l.dtype:Kt(t.data),g=De.allocType(m,u*c);Qt(g,t.data,u,c,f,h,t.offset),d(g,i),De.freeType(g)}else ne.raise("invalid data for buffer subdata");return p}return a[l.id]=l,u||p(i),p._reglType="buffer",p._buffer=l,p.subdata=m,r.profile&&(p.stats=l.stats),p.destroy=function(){h(l)},p}function m(){wt(a).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))}return r.profile&&(n.getTotalBufferSize=function(){var e=0;return Object.keys(a).forEach((function(t){e+=a[t].stats.size})),e}),{create:d,createStream:c,destroyStream:l,clear:function(){wt(a).forEach(h),u.forEach(h)},getBuffer:function(e){return e&&e._buffer instanceof s?e._buffer:null},restore:m,_initBuffer:f}}Xt[5120]=1,Xt[5122]=2,Xt[5124]=4,Xt[5121]=1,Xt[5123]=2,Xt[5125]=4,Xt[5126]=4;var en=0,tn=0,nn=1,rn=1,on=4,an=4,sn={points:en,point:tn,lines:nn,line:rn,triangles:on,triangle:an,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},un=0,cn=1,ln=4,pn=5120,fn=5121,hn=5122,dn=5123,mn=5124,gn=5125,vn=34963,yn=35040,_n=35044;function bn(t,n,r,i){var o={},a=0,s={uint8:fn,uint16:dn};function u(e){this.id=a++,o[this.id]=this,this.buffer=e,this.primType=ln,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(s.uint32=gn),u.prototype.bind=function(){this.buffer.bind()};var c=[];function l(e){var t=c.pop();return t||(t=new u(r.create(null,vn,!0,!1)._buffer)),f(t,e,yn,-1,-1,0,0),t}function p(e){c.push(e)}function f(i,o,a,s,u,c,l){if(i.buffer.bind(),o){var p=l;l||e(o)&&(!xt(o)||e(o.data))||(p=n.oes_element_index_uint?gn:dn),r._initBuffer(i.buffer,o,a,p,3)}else t.bufferData(vn,c,a),i.buffer.dtype=f||fn,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=c;var f=l;if(!l){switch(i.buffer.dtype){case fn:case pn:f=fn;break;case dn:case hn:f=dn;break;case gn:case mn:f=gn;break;default:ne.raise("unsupported type for element array")}i.buffer.dtype=f}i.type=f,ne(f!==gn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var h=u;h<0&&(h=i.buffer.byteLength,f===dn?h>>=1:f===gn&&(h>>=2)),i.vertCount=h;var d=s;if(s<0){d=ln;var m=i.buffer.dimension;1===m&&(d=un),2===m&&(d=cn),3===m&&(d=ln)}i.primType=d}function h(e){i.elementsCount--,ne(null!==e.buffer,"must not double destroy elements"),delete o[e.id],e.buffer.destroy(),e.buffer=null}function d(t,n){var o=r.create(null,vn,!0),a=new u(o._buffer);function c(t){if(t)if("number"===typeof t)o(t),a.primType=ln,a.vertCount=0|t,a.type=fn;else{var n=null,r=_n,i=-1,u=-1,l=0,p=0;Array.isArray(t)||e(t)||xt(t)?n=t:(ne.type(t,"object","invalid arguments for elements"),"data"in t&&(n=t.data,ne(Array.isArray(n)||e(n)||xt(n),"invalid data for element buffer")),"usage"in t&&(ne.parameter(t.usage,Vt,"invalid element buffer usage"),r=Vt[t.usage]),"primitive"in t&&(ne.parameter(t.primitive,sn,"invalid element buffer primitive"),i=sn[t.primitive]),"count"in t&&(ne("number"===typeof t.count&&t.count>=0,"invalid vertex count for elements"),u=0|t.count),"type"in t&&(ne.parameter(t.type,s,"invalid buffer type"),p=s[t.type]),"length"in t?l=0|t.length:(l=u,p===dn||p===hn?l*=2:p!==gn&&p!==mn||(l*=4))),f(a,n,r,i,u,l,p)}else o(),a.primType=ln,a.vertCount=0,a.type=fn;return c}return i.elementsCount++,c(t),c._reglType="elements",c._elements=a,c.subdata=function(e,t){return o.subdata(e,t),c},c.destroy=function(){h(a)},c}return{create:d,createStream:l,destroyStream:p,getElements:function(e){return"function"===typeof e&&e._elements instanceof u?e._elements:null},clear:function(){wt(o).forEach(h)}}}var xn=new Float32Array(1),wn=new Uint32Array(xn.buffer),Sn=5123;function En(e){for(var t=De.allocType(Sn,e.length),n=0;n<e.length;++n)if(isNaN(e[n]))t[n]=65535;else if(e[n]===1/0)t[n]=31744;else if(e[n]===-1/0)t[n]=64512;else{xn[0]=e[n];var r=wn[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)t[n]=i;else if(o<-14){var s=-14-o;t[n]=i+(a+1024>>s)}else t[n]=o>15?i+31744:i+(o+15<<10)+a}return t}function Tn(t){return Array.isArray(t)||e(t)}var kn=function(e){return!(e&e-1)&&!!e},An=34467,Cn=3553,In=34067,Mn=34069,Pn=6408,On=6406,Ln=6407,Rn=6409,Dn=6410,zn=32854,Nn=32855,jn=36194,Fn=32819,Bn=32820,Un=33635,Vn=34042,Gn=6402,qn=34041,Zn=35904,Hn=35906,Wn=36193,Yn=33776,Xn=33777,Kn=33778,Jn=33779,Qn=35986,$n=35987,er=34798,tr=35840,nr=35841,rr=35842,ir=35843,or=36196,ar=5121,sr=5123,ur=5125,cr=5126,lr=10242,pr=10243,fr=10497,hr=33071,dr=33648,mr=10240,gr=10241,vr=9728,yr=9729,_r=9984,br=9985,xr=9986,wr=9987,Sr=33170,Er=4352,Tr=4353,kr=4354,Ar=34046,Cr=3317,Ir=37440,Mr=37441,Pr=37443,Or=37444,Lr=33984,Rr=[_r,xr,br,wr],Dr=[0,Rn,Dn,Ln,Pn],zr={};function Nr(e){return"[object "+e+"]"}zr[Rn]=zr[On]=zr[Gn]=1,zr[qn]=zr[Dn]=2,zr[Ln]=zr[Zn]=3,zr[Pn]=zr[Hn]=4;var jr=Nr("HTMLCanvasElement"),Fr=Nr("CanvasRenderingContext2D"),Br=Nr("ImageBitmap"),Ur=Nr("HTMLImageElement"),Vr=Nr("HTMLVideoElement"),Gr=Object.keys(Mt).concat([jr,Fr,Br,Ur,Vr]),qr=[];qr[ar]=1,qr[cr]=4,qr[Wn]=2,qr[sr]=2,qr[ur]=4;var Zr=[];function Hr(e){return Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}function Wr(e){if(!Array.isArray(e))return!1;var t=e.length;return!(0===t||!Tn(e[0]))}function Yr(e){return Object.prototype.toString.call(e)}function Xr(e){return Yr(e)===jr}function Kr(e){return Yr(e)===Fr}function Jr(e){return Yr(e)===Br}function Qr(e){return Yr(e)===Ur}function $r(e){return Yr(e)===Vr}function ei(e){if(!e)return!1;var t=Yr(e);return Gr.indexOf(t)>=0||(Hr(e)||Wr(e)||xt(e))}function ti(e){return 0|Mt[Object.prototype.toString.call(e)]}function ni(e,t){var n=t.length;switch(e.type){case ar:case sr:case ur:case cr:var r=De.allocType(e.type,n);r.set(t),e.data=r;break;case Wn:e.data=En(t);break;default:ne.raise("unsupported texture type, must specify a typed array")}}function ri(e,t){return De.allocType(e.type===Wn?cr:e.type,t)}function ii(e,t){e.type===Wn?(e.data=En(t),De.freeType(t)):e.data=t}function oi(e,t,n,r,i,o){for(var a=e.width,s=e.height,u=e.channels,c=a*s*u,l=ri(e,c),p=0,f=0;f<s;++f)for(var h=0;h<a;++h)for(var d=0;d<u;++d)l[p++]=t[n*h+r*f+i*d+o];ii(e,l)}function ai(e,t,n,r,i,o){var a;if(a="undefined"!==typeof Zr[e]?Zr[e]:zr[e]*qr[t],o&&(a*=6),i){var s=0,u=n;while(u>=1)s+=a*u*u,u/=2;return s}return a*n*r}function si(n,r,i,o,a,s,u){var c={"don't care":Er,"dont care":Er,nice:kr,fast:Tr},l={repeat:fr,clamp:hr,mirror:dr},p={nearest:vr,linear:yr},f=t({mipmap:wr,"nearest mipmap nearest":_r,"linear mipmap nearest":br,"nearest mipmap linear":xr,"linear mipmap linear":wr},p),h={none:0,browser:Or},d={uint8:ar,rgba4:Fn,rgb565:Un,"rgb5 a1":Bn},m={alpha:On,luminance:Rn,"luminance alpha":Dn,rgb:Ln,rgba:Pn,rgba4:zn,"rgb5 a1":Nn,rgb565:jn},g={};r.ext_srgb&&(m.srgb=Zn,m.srgba=Hn),r.oes_texture_float&&(d.float32=d.float=cr),r.oes_texture_half_float&&(d["float16"]=d["half float"]=Wn),r.webgl_depth_texture&&(t(m,{depth:Gn,"depth stencil":qn}),t(d,{uint16:sr,uint32:ur,"depth stencil":Vn})),r.webgl_compressed_texture_s3tc&&t(g,{"rgb s3tc dxt1":Yn,"rgba s3tc dxt1":Xn,"rgba s3tc dxt3":Kn,"rgba s3tc dxt5":Jn}),r.webgl_compressed_texture_atc&&t(g,{"rgb atc":Qn,"rgba atc explicit alpha":$n,"rgba atc interpolated alpha":er}),r.webgl_compressed_texture_pvrtc&&t(g,{"rgb pvrtc 4bppv1":tr,"rgb pvrtc 2bppv1":nr,"rgba pvrtc 4bppv1":rr,"rgba pvrtc 2bppv1":ir}),r.webgl_compressed_texture_etc1&&(g["rgb etc1"]=or);var v=Array.prototype.slice.call(n.getParameter(An));Object.keys(g).forEach((function(e){var t=g[e];v.indexOf(t)>=0&&(m[e]=t)}));var y=Object.keys(m);i.textureFormats=y;var _=[];Object.keys(m).forEach((function(e){var t=m[e];_[t]=e}));var b=[];Object.keys(d).forEach((function(e){var t=d[e];b[t]=e}));var x=[];Object.keys(p).forEach((function(e){var t=p[e];x[t]=e}));var w=[];Object.keys(f).forEach((function(e){var t=f[e];w[t]=e}));var S=[];Object.keys(l).forEach((function(e){var t=l[e];S[t]=e}));var E=y.reduce((function(e,t){var n=m[t];return n===Rn||n===On||n===Rn||n===Dn||n===Gn||n===qn?e[n]=n:n===Nn||t.indexOf("rgba")>=0?e[n]=Pn:e[n]=Ln,e}),{});function T(){this.internalformat=Pn,this.format=Pn,this.type=ar,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Or,this.width=0,this.height=0,this.channels=0}function k(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function A(e,t){if("object"===typeof t&&t){if("premultiplyAlpha"in t&&(ne.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(ne.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(ne.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(ne.parameter(t.colorSpace,h,"invalid colorSpace"),e.colorSpace=h[t.colorSpace]),"type"in t){var n=t.type;ne(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),ne(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),ne(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(n,d,"invalid texture type"),e.type=d[n]}var o=e.width,a=e.height,s=e.channels,u=!1;"shape"in t?(ne(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),o=t.shape[0],a=t.shape[1],3===t.shape.length&&(s=t.shape[2],ne(s>0&&s<=4,"invalid number of channels"),u=!0),ne(o>=0&&o<=i.maxTextureSize,"invalid width"),ne(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in t&&(o=a=t.radius,ne(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in t&&(o=t.width,ne(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in t&&(a=t.height,ne(a>=0&&a<=i.maxTextureSize,"invalid height")),"channels"in t&&(s=t.channels,ne(s>0&&s<=4,"invalid number of channels"),u=!0)),e.width=0|o,e.height=0|a,e.channels=0|s;var c=!1;if("format"in t){var l=t.format;ne(r.webgl_depth_texture||!("depth"===l||"depth stencil"===l),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),ne.parameter(l,m,"invalid texture format");var p=e.internalformat=m[l];e.format=E[p],l in d&&("type"in t||(e.type=d[l])),l in g&&(e.compressed=!0),c=!0}!u&&c?e.channels=zr[e.format]:u&&!c?e.channels!==Dr[e.format]&&(e.format=e.internalformat=Dr[e.channels]):c&&u&&ne(e.channels===zr[e.format],"number of channels inconsistent with specified format")}}function C(e){n.pixelStorei(Ir,e.flipY),n.pixelStorei(Mr,e.premultiplyAlpha),n.pixelStorei(Pr,e.colorSpace),n.pixelStorei(Cr,e.unpackAlignment)}function I(){T.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function M(t,n){var r=null;if(ei(n)?r=n:n&&(ne.type(n,"object","invalid pixel data type"),A(t,n),"x"in n&&(t.xOffset=0|n.x),"y"in n&&(t.yOffset=0|n.y),ei(n.data)&&(r=n.data)),ne(!t.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){ne(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,s=a.viewportHeight;t.width=t.width||o-t.xOffset,t.height=t.height||s-t.yOffset,t.needsCopy=!0,ne(t.xOffset>=0&&t.xOffset<o&&t.yOffset>=0&&t.yOffset<s&&t.width>0&&t.width<=o&&t.height>0&&t.height<=s,"copy texture read out of bounds")}else if(r){if(e(r))t.channels=t.channels||4,t.data=r,"type"in n||t.type!==ar||(t.type=ti(r));else if(Hr(r))t.channels=t.channels||4,ni(t,r),t.alignment=1,t.needsFree=!0;else if(xt(r)){var u=r.data;Array.isArray(u)||t.type!==ar||(t.type=ti(u));var c,l,p,f,h,d,m=r.shape,g=r.stride;3===m.length?(p=m[2],d=g[2]):(ne(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),p=1,d=1),c=m[0],l=m[1],f=g[0],h=g[1],t.alignment=1,t.width=c,t.height=l,t.channels=p,t.format=t.internalformat=Dr[p],t.needsFree=!0,oi(t,u,f,h,d,r.offset)}else if(Xr(r)||Kr(r))Xr(r)?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(Jr(r))t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(Qr(r))t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if($r(r))t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(Wr(r)){var v=t.width||r[0].length,y=t.height||r.length,_=t.channels;_=Tn(r[0][0])?_||r[0][0].length:_||1;for(var b=St.shape(r),x=1,w=0;w<b.length;++w)x*=b[w];var S=ri(t,x);St.flatten(r,b,"",S),ii(t,S),t.alignment=1,t.width=v,t.height=y,t.channels=_,t.format=t.internalformat=Dr[_],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===cr?ne(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===Wn&&ne(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function P(e,t,r){var i=e.element,a=e.data,s=e.internalformat,u=e.format,c=e.type,l=e.width,p=e.height,f=e.channels;if(C(e),i)n.texImage2D(t,r,u,u,c,i);else if(e.compressed)n.compressedTexImage2D(t,r,s,l,p,0,a);else if(e.needsCopy)o(),n.copyTexImage2D(t,r,u,e.xOffset,e.yOffset,l,p,0);else{var h=!a;h&&(a=De.zero.allocType(c,l*p*f)),n.texImage2D(t,r,u,l,p,0,u,c,a),h&&a&&De.zero.freeType(a)}}function O(e,t,r,i,a){var s=e.element,u=e.data,c=e.internalformat,l=e.format,p=e.type,f=e.width,h=e.height;C(e),s?n.texSubImage2D(t,a,r,i,l,p,s):e.compressed?n.compressedTexSubImage2D(t,a,r,i,c,f,h,u):e.needsCopy?(o(),n.copyTexSubImage2D(t,a,r,i,e.xOffset,e.yOffset,f,h)):n.texSubImage2D(t,a,r,i,f,h,l,p,u)}var L=[];function R(){return L.pop()||new I}function D(e){e.needsFree&&De.freeType(e.data),I.call(e),L.push(e)}function z(){T.call(this),this.genMipmaps=!1,this.mipmapHint=Er,this.mipmask=0,this.images=Array(16)}function N(e,t,n){var r=e.images[0]=R();e.mipmask=1,r.width=e.width=t,r.height=e.height=n,r.channels=e.channels=4}function j(e,t){var n=null;if(ei(t))n=e.images[0]=R(),k(n,e),M(n,t),e.mipmask=1;else if(A(e,t),Array.isArray(t.mipmap))for(var r=t.mipmap,i=0;i<r.length;++i)n=e.images[i]=R(),k(n,e),n.width>>=i,n.height>>=i,M(n,r[i]),e.mipmask|=1<<i;else n=e.images[0]=R(),k(n,e),M(n,t),e.mipmask=1;k(e,e.images[0]),(e.compressed&&e.internalformat===Yn||e.internalformat===Xn||e.internalformat===Kn||e.internalformat===Jn)&&ne(e.width%4===0&&e.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function F(e,t){for(var n=e.images,r=0;r<n.length;++r){if(!n[r])return;P(n[r],t,r)}}var B=[];function U(){var e=B.pop()||new z;T.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function V(e){for(var t=e.images,n=0;n<t.length;++n)t[n]&&D(t[n]),t[n]=null;B.push(e)}function G(){this.minFilter=vr,this.magFilter=vr,this.wrapS=hr,this.wrapT=hr,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Er}function q(e,t){if("min"in t){var n=t.min;ne.parameter(n,f),e.minFilter=f[n],Rr.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var r=t.mag;ne.parameter(r,p),e.magFilter=p[r]}var o=e.wrapS,a=e.wrapT;if("wrap"in t){var s=t.wrap;"string"===typeof s?(ne.parameter(s,l),o=a=l[s]):Array.isArray(s)&&(ne.parameter(s[0],l),ne.parameter(s[1],l),o=l[s[0]],a=l[s[1]])}else{if("wrapS"in t){var u=t.wrapS;ne.parameter(u,l),o=l[u]}if("wrapT"in t){var h=t.wrapT;ne.parameter(h,l),a=l[h]}}if(e.wrapS=o,e.wrapT=a,"anisotropic"in t){var d=t.anisotropic;ne("number"===typeof d&&d>=1&&d<=i.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var m=!1;switch(typeof t.mipmap){case"string":ne.parameter(t.mipmap,c,"invalid mipmap hint"),e.mipmapHint=c[t.mipmap],e.genMipmaps=!0,m=!0;break;case"boolean":m=e.genMipmaps=t.mipmap;break;case"object":ne(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,m=!0;break;default:ne.raise("invalid mipmap type")}m&&!("min"in t)&&(e.minFilter=_r)}}function Z(e,t){n.texParameteri(t,gr,e.minFilter),n.texParameteri(t,mr,e.magFilter),n.texParameteri(t,lr,e.wrapS),n.texParameteri(t,pr,e.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(t,Ar,e.anisotropic),e.genMipmaps&&(n.hint(Sr,e.mipmapHint),n.generateMipmap(t))}var H=0,W={},Y=i.maxTextureUnits,X=Array(Y).map((function(){return null}));function K(e){T.call(this),this.mipmask=0,this.internalformat=Pn,this.id=H++,this.refCount=1,this.target=e,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new G,u.profile&&(this.stats={size:0})}function J(e){n.activeTexture(Lr),n.bindTexture(e.target,e.texture)}function Q(){var e=X[0];e?n.bindTexture(e.target,e.texture):n.bindTexture(Cn,null)}function $(e){var t=e.texture;ne(t,"must not double destroy texture");var r=e.unit,i=e.target;r>=0&&(n.activeTexture(Lr+r),n.bindTexture(i,null),X[r]=null),n.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete W[e.id],s.textureCount--}function ee(e,t){var r=new K(Cn);function o(e,t){var n=r.texInfo;G.call(n);var a=U();return"number"===typeof e?N(a,0|e,"number"===typeof t?0|t:0|e):e?(ne.type(e,"object","invalid arguments to regl.texture"),q(n,e),j(a,e)):N(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,k(r,a),ne.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,J(r),F(a,Cn),Z(n,Cn),Q(),V(a),u.profile&&(r.stats.size=ai(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=_[r.internalformat],o.type=b[r.type],o.mag=x[n.magFilter],o.min=w[n.minFilter],o.wrapS=S[n.wrapS],o.wrapT=S[n.wrapT],o}function a(e,t,n,i){ne(!!e,"must specify image data");var a=0|t,s=0|n,u=0|i,c=R();return k(c,r),c.width=0,c.height=0,M(c,e),c.width=c.width||(r.width>>u)-a,c.height=c.height||(r.height>>u)-s,ne(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),ne(a>=0&&s>=0&&a+c.width<=r.width&&s+c.height<=r.height,"texture.subimage write out of bounds"),ne(r.mipmask&1<<u,"missing mipmap data"),ne(c.data||c.element||c.needsCopy,"missing image data"),J(r),O(c,Cn,a,s,u),Q(),D(c),o}function c(e,t){var i,a=0|e,s=0|t||a;if(a===r.width&&s===r.height)return o;o.width=r.width=a,o.height=r.height=s,J(r);for(var c=r.channels,l=r.type,p=0;r.mipmask>>p;++p){var f=a>>p,h=s>>p;if(!f||!h)break;i=De.zero.allocType(l,f*h*c),n.texImage2D(Cn,p,r.format,f,h,0,r.format,r.type,i),i&&De.zero.freeType(i)}return Q(),u.profile&&(r.stats.size=ai(r.internalformat,r.type,a,s,!1,!1)),o}return W[r.id]=r,s.textureCount++,o(e,t),o.subimage=a,o.resize=c,o._reglType="texture2d",o._texture=r,u.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o}function te(e,t,r,o,a,c){var l=new K(In);W[l.id]=l,s.cubeCount++;var p=new Array(6);function f(e,t,n,r,o,a){var s,c=l.texInfo;for(G.call(c),s=0;s<6;++s)p[s]=U();if("number"!==typeof e&&e)if("object"===typeof e)if(t)j(p[0],e),j(p[1],t),j(p[2],n),j(p[3],r),j(p[4],o),j(p[5],a);else if(q(c,e),A(l,e),"faces"in e){var h=e.faces;for(ne(Array.isArray(h)&&6===h.length,"cube faces must be a length 6 array"),s=0;s<6;++s)ne("object"===typeof h[s]&&!!h[s],"invalid input for cube map face"),k(p[s],l),j(p[s],h[s])}else for(s=0;s<6;++s)j(p[s],e);else ne.raise("invalid arguments to cube map");else{var d=0|e||1;for(s=0;s<6;++s)N(p[s],d,d)}for(k(l,p[0]),i.npotTextureCube||ne(kn(l.width)&&kn(l.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?l.mipmask=(p[0].width<<1)-1:l.mipmask=p[0].mipmask,ne.textureCube(l,c,p,i),l.internalformat=p[0].internalformat,f.width=p[0].width,f.height=p[0].height,J(l),s=0;s<6;++s)F(p[s],Mn+s);for(Z(c,In),Q(),u.profile&&(l.stats.size=ai(l.internalformat,l.type,f.width,f.height,c.genMipmaps,!0)),f.format=_[l.internalformat],f.type=b[l.type],f.mag=x[c.magFilter],f.min=w[c.minFilter],f.wrapS=S[c.wrapS],f.wrapT=S[c.wrapT],s=0;s<6;++s)V(p[s]);return f}function h(e,t,n,r,i){ne(!!t,"must specify image data"),ne("number"===typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var o=0|n,a=0|r,s=0|i,u=R();return k(u,l),u.width=0,u.height=0,M(u,t),u.width=u.width||(l.width>>s)-o,u.height=u.height||(l.height>>s)-a,ne(l.type===u.type&&l.format===u.format&&l.internalformat===u.internalformat,"incompatible format for texture.subimage"),ne(o>=0&&a>=0&&o+u.width<=l.width&&a+u.height<=l.height,"texture.subimage write out of bounds"),ne(l.mipmask&1<<s,"missing mipmap data"),ne(u.data||u.element||u.needsCopy,"missing image data"),J(l),O(u,Mn+e,o,a,s),Q(),D(u),f}function d(e){var t=0|e;if(t!==l.width){f.width=l.width=t,f.height=l.height=t,J(l);for(var r=0;r<6;++r)for(var i=0;l.mipmask>>i;++i)n.texImage2D(Mn+r,i,l.format,t>>i,t>>i,0,l.format,l.type,null);return Q(),u.profile&&(l.stats.size=ai(l.internalformat,l.type,f.width,f.height,!1,!0)),f}}return f(e,t,r,o,a,c),f.subimage=h,f.resize=d,f._reglType="textureCube",f._texture=l,u.profile&&(f.stats=l.stats),f.destroy=function(){l.decRef()},f}function re(){for(var e=0;e<Y;++e)n.activeTexture(Lr+e),n.bindTexture(Cn,null),X[e]=null;wt(W).forEach($),s.cubeCount=0,s.textureCount=0}function ie(){for(var e=0;e<Y;++e){var t=X[e];t&&(t.bindCount=0,t.unit=-1,X[e]=null)}wt(W).forEach((function(e){e.texture=n.createTexture(),n.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!==(e.mipmask&1<<t))if(e.target===Cn)n.texImage2D(Cn,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var r=0;r<6;++r)n.texImage2D(Mn+r,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);Z(e.texInfo,e.target)}))}return t(K.prototype,{bind:function(){var e=this;e.bindCount+=1;var t=e.unit;if(t<0){for(var r=0;r<Y;++r){var i=X[r];if(i){if(i.bindCount>0)continue;i.unit=-1}X[r]=e,t=r;break}t>=Y&&ne.raise("insufficient number of texture units"),u.profile&&s.maxTextureUnits<t+1&&(s.maxTextureUnits=t+1),e.unit=t,n.activeTexture(Lr+t),n.bindTexture(e.target,e.texture)}return t},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$(this)}}),u.profile&&(s.getTotalTextureSize=function(){var e=0;return Object.keys(W).forEach((function(t){e+=W[t].stats.size})),e}),{create2D:ee,createCube:te,clear:re,getTexture:function(e){return null},restore:ie}}Zr[zn]=2,Zr[Nn]=2,Zr[jn]=2,Zr[qn]=4,Zr[Yn]=.5,Zr[Xn]=.5,Zr[Kn]=1,Zr[Jn]=1,Zr[Qn]=.5,Zr[$n]=1,Zr[er]=1,Zr[tr]=.5,Zr[nr]=.25,Zr[rr]=.5,Zr[ir]=.25,Zr[or]=.5;var ui=36161,ci=32854,li=32855,pi=36194,fi=33189,hi=36168,di=34041,mi=35907,gi=34836,vi=34842,yi=34843,_i=[];function bi(e,t,n){return _i[e]*t*n}_i[ci]=2,_i[li]=2,_i[pi]=2,_i[fi]=2,_i[hi]=1,_i[di]=4,_i[mi]=4,_i[gi]=16,_i[vi]=8,_i[yi]=6;var xi=function(e,t,n,r,i){var o={rgba4:ci,rgb565:pi,"rgb5 a1":li,depth:fi,stencil:hi,"depth stencil":di};t.ext_srgb&&(o["srgba"]=mi),t.ext_color_buffer_half_float&&(o["rgba16f"]=vi,o["rgb16f"]=yi),t.webgl_color_buffer_float&&(o["rgba32f"]=gi);var a=[];Object.keys(o).forEach((function(e){var t=o[e];a[t]=e}));var s=0,u={};function c(e){this.id=s++,this.refCount=1,this.renderbuffer=e,this.format=ci,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function l(t){var n=t.renderbuffer;ne(n,"must not double destroy renderbuffer"),e.bindRenderbuffer(ui,null),e.deleteRenderbuffer(n),t.renderbuffer=null,t.refCount=0,delete u[t.id],r.renderbufferCount--}function p(t,s){var l=new c(e.createRenderbuffer());function p(t,r){var s=0,u=0,c=ci;if("object"===typeof t&&t){var f=t;if("shape"in f){var h=f.shape;ne(Array.isArray(h)&&h.length>=2,"invalid renderbuffer shape"),s=0|h[0],u=0|h[1]}else"radius"in f&&(s=u=0|f.radius),"width"in f&&(s=0|f.width),"height"in f&&(u=0|f.height);"format"in f&&(ne.parameter(f.format,o,"invalid renderbuffer format"),c=o[f.format])}else"number"===typeof t?(s=0|t,u="number"===typeof r?0|r:s):t?ne.raise("invalid arguments to renderbuffer constructor"):s=u=1;if(ne(s>0&&u>0&&s<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),s!==l.width||u!==l.height||c!==l.format)return p.width=l.width=s,p.height=l.height=u,l.format=c,e.bindRenderbuffer(ui,l.renderbuffer),e.renderbufferStorage(ui,c,s,u),ne(0===e.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=bi(l.format,l.width,l.height)),p.format=a[l.format],p}function f(t,r){var o=0|t,a=0|r||o;return o===l.width&&a===l.height||(ne(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),p.width=l.width=o,p.height=l.height=a,e.bindRenderbuffer(ui,l.renderbuffer),e.renderbufferStorage(ui,l.format,o,a),ne(0===e.getError(),"invalid render buffer format"),i.profile&&(l.stats.size=bi(l.format,l.width,l.height))),p}return u[l.id]=l,r.renderbufferCount++,p(t,s),p.resize=f,p._reglType="renderbuffer",p._renderbuffer=l,i.profile&&(p.stats=l.stats),p.destroy=function(){l.decRef()},p}function f(){wt(u).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(ui,t.renderbuffer),e.renderbufferStorage(ui,t.format,t.width,t.height)})),e.bindRenderbuffer(ui,null)}return c.prototype.decRef=function(){--this.refCount<=0&&l(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach((function(t){e+=u[t].stats.size})),e}),{create:p,clear:function(){wt(u).forEach(l)},restore:f}},wi=36160,Si=36161,Ei=3553,Ti=34069,ki=36064,Ai=36096,Ci=36128,Ii=33306,Mi=36053,Pi=36054,Oi=36055,Li=36057,Ri=36061,Di=36193,zi=5121,Ni=5126,ji=6407,Fi=6408,Bi=6402,Ui=[ji,Fi],Vi=[];Vi[Fi]=4,Vi[ji]=3;var Gi=[];Gi[zi]=1,Gi[Ni]=4,Gi[Di]=2;var qi=32854,Zi=32855,Hi=36194,Wi=33189,Yi=36168,Xi=34041,Ki=35907,Ji=34836,Qi=34842,$i=34843,eo=[qi,Zi,Hi,Ki,Qi,$i,Ji],to={};function no(e,n,r,i,o,a){var s={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var l=["uint8"];function p(e,t,n){this.target=e,this.texture=t,this.renderbuffer=n;var r=0,i=0;t?(r=t.width,i=t.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function f(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function h(e,t,n){if(e)if(e.texture){var r=e.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);ne(i===t&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=e.renderbuffer._renderbuffer;ne(a.width===t&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function d(t,n){n&&(n.texture?e.framebufferTexture2D(wi,t,n.target,n.texture._texture.texture,0):e.framebufferRenderbuffer(wi,t,Si,n.renderbuffer._renderbuffer.renderbuffer))}function m(e){var t=Ei,n=null,r=null,i=e;"object"===typeof e&&(i=e.data,"target"in e&&(t=0|e.target)),ne.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,ne(t===Ei)):"textureCube"===o?(n=i,ne(t>=Ti&&t<Ti+6,"invalid cube map target")):"renderbuffer"===o?(r=i,t=Si):ne.raise("invalid regl object for attachment"),new p(t,n,r)}function g(e,t,n,r,a){if(n){var s=i.create2D({width:e,height:t,format:r,type:a});return s._texture.refCount=0,new p(Ei,s,null)}var u=o.create({width:e,height:t,format:r});return u._renderbuffer.refCount=0,new p(Si,null,u)}function v(e){return e&&(e.texture||e.renderbuffer)}function y(e,t,n){e&&(e.texture?e.texture.resize(t,n):e.renderbuffer&&e.renderbuffer.resize(t,n),e.width=t,e.height=n)}n.oes_texture_half_float&&l.push("half float","float16"),n.oes_texture_float&&l.push("float","float32");var _=0,b={};function x(){this.id=_++,b[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function w(e){e.colorAttachments.forEach(f),f(e.depthAttachment),f(e.stencilAttachment),f(e.depthStencilAttachment)}function S(t){var n=t.framebuffer;ne(n,"must not double destroy framebuffer"),e.deleteFramebuffer(n),t.framebuffer=null,a.framebufferCount--,delete b[t.id]}function E(t){var n;e.bindFramebuffer(wi,t.framebuffer);var i=t.colorAttachments;for(n=0;n<i.length;++n)d(ki+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)e.framebufferTexture2D(wi,ki+n,Ei,null,0);e.framebufferTexture2D(wi,Ii,Ei,null,0),e.framebufferTexture2D(wi,Ai,Ei,null,0),e.framebufferTexture2D(wi,Ci,Ei,null,0),d(Ai,t.depthAttachment),d(Ci,t.stencilAttachment),d(Ii,t.depthStencilAttachment);var o=e.checkFramebufferStatus(wi);e.isContextLost()||o===Mi||ne.raise("framebuffer configuration not supported, status = "+to[o]),e.bindFramebuffer(wi,s.next?s.next.framebuffer:null),s.cur=s.next,e.getError()}function T(e,i){var o=new x;function p(e,t){var i;ne(s.next!==o,"can not update framebuffer which is currently in use");var a=0,f=0,d=!0,y=!0,_=null,b=!0,x="rgba",S="uint8",T=1,k=null,A=null,C=null,I=!1;if("number"===typeof e)a=0|e,f=0|t||a;else if(e){ne.type(e,"object","invalid arguments for framebuffer");var M=e;if("shape"in M){var P=M.shape;ne(Array.isArray(P)&&P.length>=2,"invalid shape for framebuffer"),a=P[0],f=P[1]}else"radius"in M&&(a=f=M.radius),"width"in M&&(a=M.width),"height"in M&&(f=M.height);("color"in M||"colors"in M)&&(_=M.color||M.colors,Array.isArray(_)&&ne(1===_.length||n.webgl_draw_buffers,"multiple render targets not supported")),_||("colorCount"in M&&(T=0|M.colorCount,ne(T>0,"invalid color buffer count")),"colorTexture"in M&&(b=!!M.colorTexture,x="rgba4"),"colorType"in M&&(S=M.colorType,b?(ne(n.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),ne(n.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(ne(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),x="rgba16f"):"float"!==S&&"float32"!==S||(ne(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),x="rgba32f"),ne.oneOf(S,l,"invalid color type")),"colorFormat"in M&&(x=M.colorFormat,u.indexOf(x)>=0?b=!0:c.indexOf(x)>=0?b=!1:b?ne.oneOf(M.colorFormat,u,"invalid color format for texture"):ne.oneOf(M.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in M||"depthStencilTexture"in M)&&(I=!(!M.depthTexture&&!M.depthStencilTexture),ne(!I||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in M&&("boolean"===typeof M.depth?d=M.depth:(k=M.depth,y=!1)),"stencil"in M&&("boolean"===typeof M.stencil?y=M.stencil:(A=M.stencil,d=!1)),"depthStencil"in M&&("boolean"===typeof M.depthStencil?d=y=M.depthStencil:(C=M.depthStencil,d=!1,y=!1))}else a=f=1;var O=null,L=null,R=null,D=null;if(Array.isArray(_))O=_.map(m);else if(_)O=[m(_)];else for(O=new Array(T),i=0;i<T;++i)O[i]=g(a,f,b,x,S);ne(n.webgl_draw_buffers||O.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),ne(O.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||O[0].width,f=f||O[0].height,k?L=m(k):d&&!y&&(L=g(a,f,I,"depth","uint32")),A?R=m(A):y&&!d&&(R=g(a,f,!1,"stencil","uint8")),C?D=m(C):!k&&!A&&y&&d&&(D=g(a,f,I,"depth stencil","depth stencil")),ne(!!k+!!A+!!C<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var z=null;for(i=0;i<O.length;++i)if(h(O[i],a,f),ne(!O[i]||O[i].texture&&Ui.indexOf(O[i].texture._texture.format)>=0||O[i].renderbuffer&&eo.indexOf(O[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),O[i]&&O[i].texture){var N=Vi[O[i].texture._texture.format]*Gi[O[i].texture._texture.type];null===z?z=N:ne(z===N,"all color attachments much have the same number of bits per pixel.")}return h(L,a,f),ne(!L||L.texture&&L.texture._texture.format===Bi||L.renderbuffer&&L.renderbuffer._renderbuffer.format===Wi,"invalid depth attachment for framebuffer object"),h(R,a,f),ne(!R||R.renderbuffer&&R.renderbuffer._renderbuffer.format===Yi,"invalid stencil attachment for framebuffer object"),h(D,a,f),ne(!D||D.texture&&D.texture._texture.format===Xi||D.renderbuffer&&D.renderbuffer._renderbuffer.format===Xi,"invalid depth-stencil attachment for framebuffer object"),w(o),o.width=a,o.height=f,o.colorAttachments=O,o.depthAttachment=L,o.stencilAttachment=R,o.depthStencilAttachment=D,p.color=O.map(v),p.depth=v(L),p.stencil=v(R),p.depthStencil=v(D),p.width=o.width,p.height=o.height,E(o),p}function f(e,t){ne(s.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|e,1),r=Math.max(0|t||n,1);if(n===o.width&&r===o.height)return p;for(var i=o.colorAttachments,a=0;a<i.length;++a)y(i[a],n,r);return y(o.depthAttachment,n,r),y(o.stencilAttachment,n,r),y(o.depthStencilAttachment,n,r),o.width=p.width=n,o.height=p.height=r,E(o),p}return a.framebufferCount++,p(e,i),t(p,{resize:f,_reglType:"framebuffer",_framebuffer:o,destroy:function(){S(o),w(o)},use:function(e){s.setFBO({framebuffer:p},e)}})}function k(e){var o=Array(6);function a(e){var r;ne(o.indexOf(s.next)<0,"can not update framebuffer which is currently in use");var c,p={color:null},f=0,h=null,d="rgba",m="uint8",g=1;if("number"===typeof e)f=0|e;else if(e){ne.type(e,"object","invalid arguments for framebuffer");var v=e;if("shape"in v){var y=v.shape;ne(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),ne(y[0]===y[1],"cube framebuffer must be square"),f=y[0]}else"radius"in v&&(f=0|v.radius),"width"in v?(f=0|v.width,"height"in v&&ne(v.height===f,"must be square")):"height"in v&&(f=0|v.height);("color"in v||"colors"in v)&&(h=v.color||v.colors,Array.isArray(h)&&ne(1===h.length||n.webgl_draw_buffers,"multiple render targets not supported")),h||("colorCount"in v&&(g=0|v.colorCount,ne(g>0,"invalid color buffer count")),"colorType"in v&&(ne.oneOf(v.colorType,l,"invalid color type"),m=v.colorType),"colorFormat"in v&&(d=v.colorFormat,ne.oneOf(v.colorFormat,u,"invalid color format for texture"))),"depth"in v&&(p.depth=v.depth),"stencil"in v&&(p.stencil=v.stencil),"depthStencil"in v&&(p.depthStencil=v.depthStencil)}else f=1;if(h)if(Array.isArray(h))for(c=[],r=0;r<h.length;++r)c[r]=h[r];else c=[h];else{c=Array(g);var _={radius:f,format:d,type:m};for(r=0;r<g;++r)c[r]=i.createCube(_)}for(p.color=Array(c.length),r=0;r<c.length;++r){var b=c[r];ne("function"===typeof b&&"textureCube"===b._reglType,"invalid cube map"),f=f||b.width,ne(b.width===f&&b.height===f,"invalid cube map shape"),p.color[r]={target:Ti,data:c[r]}}for(r=0;r<6;++r){for(var x=0;x<c.length;++x)p.color[x].target=Ti+r;r>0&&(p.depth=o[0].depth,p.stencil=o[0].stencil,p.depthStencil=o[0].depthStencil),o[r]?o[r](p):o[r]=T(p)}return t(a,{width:f,height:f,color:c})}function c(e){var t,n=0|e;if(ne(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(t=0;t<i.length;++t)i[t].resize(n);for(t=0;t<6;++t)o[t].resize(n);return a.width=a.height=n,a}return a(e),t(a,{faces:o,resize:c,_reglType:"framebufferCube",destroy:function(){o.forEach((function(e){e.destroy()}))}})}function A(){s.cur=null,s.next=null,s.dirty=!0,wt(b).forEach((function(t){t.framebuffer=e.createFramebuffer(),E(t)}))}return t(s,{getFramebuffer:function(e){if("function"===typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof x)return t}return null},create:T,createCube:k,clear:function(){wt(b).forEach(S)},restore:A})}to[Mi]="complete",to[Pi]="incomplete attachment",to[Li]="incomplete dimensions",to[Oi]="incomplete, missing attachment",to[Ri]="unsupported";var ro=5126;function io(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ro,this.offset=0,this.stride=0,this.divisor=0}function oo(e,t,n,r){for(var i=n.maxAttributes,o=new Array(i),a=0;a<i;++a)o[a]=new io;return{Record:io,scope:{},state:o}}var ao=35632,so=35633,uo=35718,co=35721;function lo(e,t,n,r){var i={},o={};function a(e,t,n,r){this.name=e,this.id=t,this.location=n,this.info=r}function s(e,t){for(var n=0;n<e.length;++n)if(e[n].id===t.id)return void(e[n].location=t.location);e.push(t)}function u(n,r,a){var s=n===ao?i:o,u=s[r];if(!u){var c=t.str(r);u=e.createShader(n),e.shaderSource(u,c),e.compileShader(u),ne.shaderError(e,u,c,n,a),s[r]=u}return u}var c={},l=[],p=0;function f(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function h(n,i){var o,c,l=u(ao,n.fragId),p=u(so,n.vertId),f=n.program=e.createProgram();e.attachShader(f,l),e.attachShader(f,p),e.linkProgram(f),ne.linkError(e,f,t.str(n.fragId),t.str(n.vertId),i);var h=e.getProgramParameter(f,uo);r.profile&&(n.stats.uniformsCount=h);var d=n.uniforms;for(o=0;o<h;++o)if(c=e.getActiveUniform(f,o),c)if(c.size>1)for(var m=0;m<c.size;++m){var g=c.name.replace("[0]","["+m+"]");s(d,new a(g,t.id(g),e.getUniformLocation(f,g),c))}else s(d,new a(c.name,t.id(c.name),e.getUniformLocation(f,c.name),c));var v=e.getProgramParameter(f,co);r.profile&&(n.stats.attributesCount=v);var y=n.attributes;for(o=0;o<v;++o)c=e.getActiveAttrib(f,o),c&&s(y,new a(c.name,t.id(c.name),e.getAttribLocation(f,c.name),c))}function d(){i={},o={};for(var e=0;e<l.length;++e)h(l[e])}return r.profile&&(n.getMaxUniformsCount=function(){var e=0;return l.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},n.getMaxAttributesCount=function(){var e=0;return l.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var t=e.deleteShader.bind(e);wt(i).forEach(t),i={},wt(o).forEach(t),o={},l.forEach((function(t){e.deleteProgram(t.program)})),l.length=0,c={},n.shaderCount=0},program:function(e,t,r){ne.command(e>=0,"missing vertex shader",r),ne.command(t>=0,"missing fragment shader",r);var i=c[t];i||(i=c[t]={});var o=i[e];return o||(o=new f(t,e),n.shaderCount++,h(o,r),i[e]=o,l.push(o)),o},restore:d,shader:u,frag:-1,vert:-1}}var po=6408,fo=5121,ho=3333,mo=5126;function go(t,n,r,i,o,a,s){function u(u){var c;null===n.next?(ne(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=fo):(ne(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(ne(c===fo||c===mo,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===mo&&ne(s.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):ne(c===fo,"Reading from a framebuffer is only allowed for the type 'uint8'"));var l=0,p=0,f=i.framebufferWidth,h=i.framebufferHeight,d=null;e(u)?d=u:u&&(ne.type(u,"object","invalid arguments to regl.read()"),l=0|u.x,p=0|u.y,ne(l>=0&&l<i.framebufferWidth,"invalid x offset for regl.read"),ne(p>=0&&p<i.framebufferHeight,"invalid y offset for regl.read"),f=0|(u.width||i.framebufferWidth-l),h=0|(u.height||i.framebufferHeight-p),d=u.data||null),d&&(c===fo?ne(d instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===mo&&ne(d instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),ne(f>0&&f+l<=i.framebufferWidth,"invalid width for read pixels"),ne(h>0&&h+p<=i.framebufferHeight,"invalid height for read pixels"),r();var m=f*h*4;return d||(c===fo?d=new Uint8Array(m):c===mo&&(d=d||new Float32Array(m))),ne.isTypedArray(d,"data buffer for regl.read() must be a typedarray"),ne(d.byteLength>=m,"data buffer for regl.read() too small"),t.pixelStorei(ho,4),t.readPixels(l,p,f,h,po,c,d),d}function c(e){var t;return n.setFBO({framebuffer:e.framebuffer},(function(){t=u(e)})),t}function l(e){return e&&"framebuffer"in e?c(e):u(e)}return l}function vo(e){return Array.prototype.slice.call(e)}function yo(e){return vo(e).join("")}function _o(){var e=0,n=[],r=[];function i(t){for(var i=0;i<r.length;++i)if(r[i]===t)return n[i];var o="g"+e++;return n.push(o),r.push(t),o}function o(){var n=[];function r(){n.push.apply(n,vo(arguments))}var i=[];function o(){var t="v"+e++;return i.push(t),arguments.length>0&&(n.push(t,"="),n.push.apply(n,vo(arguments)),n.push(";")),t}return t(r,{def:o,toString:function(){return yo([i.length>0?"var "+i.join(",")+";":"",yo(n)])}})}function a(){var e=o(),n=o(),r=e.toString,i=n.toString;function a(t,r){n(t,r,"=",e.def(t,r),";")}return t((function(){e.apply(e,vo(arguments))}),{def:e.def,entry:e,exit:n,save:a,set:function(t,n,r){a(t,n),e(t,n,"=",r,";")},toString:function(){return r()+i()}})}function s(){var e=yo(arguments),n=a(),r=a(),i=n.toString,o=r.toString;return t(n,{then:function(){return n.apply(n,vo(arguments)),this},else:function(){return r.apply(r,vo(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),yo(["if(",e,"){",i(),"}",t])}})}var u=o(),c={};function l(e,n){var r=[];function i(){var e="a"+r.length;return r.push(e),e}n=n||0;for(var o=0;o<n;++o)i();var s=a(),u=s.toString,l=c[e]=t(s,{arg:i,toString:function(){return yo(["function(",r.join(),"){",u(),"}"])}});return l}function p(){var e=['"use strict";',u,"return {"];Object.keys(c).forEach((function(t){e.push('"',t,'":',c[t].toString(),",")})),e.push("}");var t=yo(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n"),i=Function.apply(null,n.concat(t));return i.apply(null,r)}return{global:u,link:i,block:o,proc:l,scope:a,cond:s,compile:p}}var bo="xyzw".split(""),xo=5121,wo=1,So=2,Eo=0,To=1,ko=2,Ao=3,Co=4,Io="dither",Mo="blend.enable",Po="blend.color",Oo="blend.equation",Lo="blend.func",Ro="depth.enable",Do="depth.func",zo="depth.range",No="depth.mask",jo="colorMask",Fo="cull.enable",Bo="cull.face",Uo="frontFace",Vo="lineWidth",Go="polygonOffset.enable",qo="polygonOffset.offset",Zo="sample.alpha",Ho="sample.enable",Wo="sample.coverage",Yo="stencil.enable",Xo="stencil.mask",Ko="stencil.func",Jo="stencil.opFront",Qo="stencil.opBack",$o="scissor.enable",ea="scissor.box",ta="viewport",na="profile",ra="framebuffer",ia="vert",oa="frag",aa="elements",sa="primitive",ua="count",ca="offset",la="instances",pa="Width",fa="Height",ha=ra+pa,da=ra+fa,ma=ta+pa,ga=ta+fa,va="drawingBuffer",ya=va+pa,_a=va+fa,ba=[Lo,Oo,Ko,Jo,Qo,Wo,ta,ea,qo],xa=34962,wa=34963,Sa=35632,Ea=35633,Ta=3553,ka=34067,Aa=2884,Ca=3042,Ia=3024,Ma=2960,Pa=2929,Oa=3089,La=32823,Ra=32926,Da=32928,za=5126,Na=35664,ja=35665,Fa=35666,Ba=5124,Ua=35667,Va=35668,Ga=35669,qa=35670,Za=35671,Ha=35672,Wa=35673,Ya=35674,Xa=35675,Ka=35676,Ja=35678,Qa=35680,$a=4,es=1028,ts=1029,ns=2304,rs=2305,is=32775,os=32776,as=519,ss=7680,us=0,cs=1,ls=32774,ps=513,fs=36160,hs=36064,ds={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ms=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],gs={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},vs={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ys={frag:Sa,vert:Ea},_s={cw:ns,ccw:rs};function bs(t){return Array.isArray(t)||e(t)||xt(t)}function xs(e){return e.sort((function(e,t){return e===ta?-1:t===ta?1:e<t?-1:1}))}function ws(e,t,n,r){this.thisDep=e,this.contextDep=t,this.propDep=n,this.append=r}function Ss(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Es(e){return new ws(!1,!1,!1,e)}function Ts(e,t){var n=e.type;if(n===Eo){var r=e.data.length;return new ws(!0,r>=1,r>=2,t)}if(n===Co){var i=e.data;return new ws(i.thisDep,i.contextDep,i.propDep,t)}return new ws(n===Ao,n===ko,n===To,t)}var ks=new ws(!1,!1,!1,(function(){}));function As(e,t,n,r,i,o,a,s,u,c,l,p,f,h,d){var m=c.Record,g={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(g.min=is,g.max=os);var v=n.angle_instanced_arrays,y=n.webgl_draw_buffers,_={dirty:!0,profile:d.profile},b={},x=[],w={},S={};function E(e){return e.replace(".","_")}function T(e,t,n){var r=E(e);x.push(e),b[r]=_[r]=!!n,w[r]=t}function k(e,t,n){var r=E(e);x.push(e),Array.isArray(n)?(_[r]=n.slice(),b[r]=n.slice()):_[r]=b[r]=n,S[r]=t}T(Io,Ia),T(Mo,Ca),k(Po,"blendColor",[0,0,0,0]),k(Oo,"blendEquationSeparate",[ls,ls]),k(Lo,"blendFuncSeparate",[cs,us,cs,us]),T(Ro,Pa,!0),k(Do,"depthFunc",ps),k(zo,"depthRange",[0,1]),k(No,"depthMask",!0),k(jo,jo,[!0,!0,!0,!0]),T(Fo,Aa),k(Bo,"cullFace",ts),k(Uo,Uo,rs),k(Vo,Vo,1),T(Go,La),k(qo,"polygonOffset",[0,0]),T(Zo,Ra),T(Ho,Da),k(Wo,"sampleCoverage",[1,!1]),T(Yo,Ma),k(Xo,"stencilMask",-1),k(Ko,"stencilFunc",[as,0,-1]),k(Jo,"stencilOpSeparate",[es,ss,ss,ss]),k(Qo,"stencilOpSeparate",[ts,ss,ss,ss]),T($o,Oa),k(ea,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),k(ta,ta,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var A={gl:e,context:f,strings:t,next:b,current:_,draw:p,elements:o,buffer:i,shader:l,attributes:c.state,uniforms:u,framebuffer:s,extensions:n,timer:h,isBufferArgs:bs},C={primTypes:sn,compareFuncs:gs,blendFuncs:ds,blendEquations:g,stencilOps:vs,glTypes:Ft,orientationType:_s};ne.optional((function(){A.isArrayLike=Tn})),y&&(C.backBuffer=[ts],C.drawBuffer=Ee(r.maxDrawbuffers,(function(e){return 0===e?[0]:Ee(e,(function(e){return hs+e}))})));var I=0;function M(){var e=_o(),n=e.link,r=e.global;e.id=I++,e.batchId="0";var i=n(A),o=e.shared={props:"a0"};Object.keys(A).forEach((function(e){o[e]=r.def(i,".",e)})),ne.optional((function(){e.CHECK=n(ne),e.commandStr=ne.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},C.invalidBlendCombinations=ms}));var a=e.next={},s=e.current={};Object.keys(S).forEach((function(e){Array.isArray(_[e])&&(a[e]=r.def(o.next,".",e),s[e]=r.def(o.current,".",e))}));var u=e.constants={};Object.keys(C).forEach((function(e){u[e]=r.def(JSON.stringify(C[e]))})),e.invoke=function(t,r){switch(r.type){case Eo:var i=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case To:return t.def(o.props,r.data);case ko:return t.def(o.context,r.data);case Ao:return t.def("this",r.data);case Co:return r.data.append(e,t),r.data.ref}},e.attribCache={};var l={};return e.scopeAttrib=function(e){var r=t.id(e);if(r in l)return l[r];var i=c.scope[r];i||(i=c.scope[r]=new m);var o=l[r]=n(i);return o},e}function P(e){var t,n=e.static,r=e.dynamic;if(na in n){var i=!!n[na];t=Es((function(e,t){return i})),t.enable=i}else if(na in r){var o=r[na];t=Ts(o,(function(e,t){return e.invoke(t,o)}))}return t}function O(e,t){var n=e.static,r=e.dynamic;if(ra in n){var i=n[ra];return i?(i=s.getFramebuffer(i),ne.command(i,"invalid framebuffer object"),Es((function(e,t){var n=e.link(i),r=e.shared;t.set(r.framebuffer,".next",n);var o=r.context;return t.set(o,"."+ha,n+".width"),t.set(o,"."+da,n+".height"),n}))):Es((function(e,t){var n=e.shared;t.set(n.framebuffer,".next","null");var r=n.context;return t.set(r,"."+ha,r+"."+ya),t.set(r,"."+da,r+"."+_a),"null"}))}if(ra in r){var o=r[ra];return Ts(o,(function(e,t){var n=e.invoke(t,o),r=e.shared,i=r.framebuffer,a=t.def(i,".getFramebuffer(",n,")");ne.optional((function(){e.assert(t,"!"+n+"||"+a,"invalid framebuffer object")})),t.set(i,".next",a);var s=r.context;return t.set(s,"."+ha,a+"?"+a+".width:"+s+"."+ya),t.set(s,"."+da,a+"?"+a+".height:"+s+"."+_a),a}))}return null}function L(e,t,n){var r=e.static,i=e.dynamic;function o(e){if(e in r){var o=r[e];ne.commandType(o,"object","invalid "+e,n.commandStr);var a,s,u=!0,c=0|o.x,l=0|o.y;return"width"in o?(a=0|o.width,ne.command(a>=0,"invalid "+e,n.commandStr)):u=!1,"height"in o?(s=0|o.height,ne.command(s>=0,"invalid "+e,n.commandStr)):u=!1,new ws(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,(function(e,t){var n=e.shared.context,r=a;"width"in o||(r=t.def(n,".",ha,"-",c));var i=s;return"height"in o||(i=t.def(n,".",da,"-",l)),[c,l,r,i]}))}if(e in i){var p=i[e],f=Ts(p,(function(t,n){var r=t.invoke(n,p);ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}));var i=t.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),s=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",ha,"-",o,")"),u=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",da,"-",a,")");return ne.optional((function(){t.assert(n,s+">=0&&"+u+">=0","invalid "+e)})),[o,a,s,u]}));return t&&(f.thisDep=f.thisDep||t.thisDep,f.contextDep=f.contextDep||t.contextDep,f.propDep=f.propDep||t.propDep),f}return t?new ws(t.thisDep,t.contextDep,t.propDep,(function(e,t){var n=e.shared.context;return[0,0,t.def(n,".",ha),t.def(n,".",da)]})):null}var a=o(ta);if(a){var s=a;a=new ws(a.thisDep,a.contextDep,a.propDep,(function(e,t){var n=s.append(e,t),r=e.shared.context;return t.set(r,"."+ma,n[2]),t.set(r,"."+ga,n[3]),n}))}return{viewport:a,scissor_box:o(ea)}}function R(e){var n=e.static,r=e.dynamic;function i(e){if(e in n){var i=t.id(n[e]);ne.optional((function(){l.shader(ys[e],i,ne.guessCommand())}));var o=Es((function(){return i}));return o.id=i,o}if(e in r){var a=r[e];return Ts(a,(function(t,n){var r=t.invoke(n,a),i=n.def(t.shared.strings,".id(",r,")");return ne.optional((function(){n(t.shared.shader,".shader(",ys[e],",",i,",",t.command,");")})),i}))}return null}var o,a=i(oa),s=i(ia),u=null;return Ss(a)&&Ss(s)?(u=l.program(s.id,a.id),o=Es((function(e,t){return e.link(u)}))):o=new ws(a&&a.thisDep||s&&s.thisDep,a&&a.contextDep||s&&s.contextDep,a&&a.propDep||s&&s.propDep,(function(e,t){var n,r,i=e.shared.shader;n=a?a.append(e,t):t.def(i,".",oa),r=s?s.append(e,t):t.def(i,".",ia);var o=i+".program("+r+","+n;return ne.optional((function(){o+=","+e.command})),t.def(o+")")})),{frag:a,vert:s,progVar:o,program:u}}function D(e,t){var n=e.static,r=e.dynamic;function i(){if(aa in n){var e=n[aa];bs(e)?e=o.getElements(o.create(e,!0)):e&&(e=o.getElements(e),ne.command(e,"invalid elements",t.commandStr));var i=Es((function(t,n){if(e){var r=t.link(e);return t.ELEMENTS=r,r}return t.ELEMENTS=null,null}));return i.value=e,i}if(aa in r){var a=r[aa];return Ts(a,(function(e,t){var n=e.shared,r=n.isBufferArgs,i=n.elements,o=e.invoke(t,a),s=t.def("null"),u=t.def(r,"(",o,")"),c=e.cond(u).then(s,"=",i,".createStream(",o,");").else(s,"=",i,".getElements(",o,");");return ne.optional((function(){e.assert(c.else,"!"+o+"||"+s,"invalid elements")})),t.entry(c),t.exit(e.cond(u).then(i,".destroyStream(",s,");")),e.ELEMENTS=s,s}))}return null}var a=i();function s(){if(sa in n){var e=n[sa];return ne.commandParameter(e,sn,"invalid primitve",t.commandStr),Es((function(t,n){return sn[e]}))}if(sa in r){var i=r[sa];return Ts(i,(function(e,t){var n=e.constants.primTypes,r=e.invoke(t,i);return ne.optional((function(){e.assert(t,r+" in "+n,"invalid primitive, must be one of "+Object.keys(sn))})),t.def(n,"[",r,"]")}))}return a?Ss(a)?a.value?Es((function(e,t){return t.def(e.ELEMENTS,".primType")})):Es((function(){return $a})):new ws(a.thisDep,a.contextDep,a.propDep,(function(e,t){var n=e.ELEMENTS;return t.def(n,"?",n,".primType:",$a)})):null}function u(e,i){if(e in n){var o=0|n[e];return ne.command(!i||o>=0,"invalid "+e,t.commandStr),Es((function(e,t){return i&&(e.OFFSET=o),o}))}if(e in r){var s=r[e];return Ts(s,(function(t,n){var r=t.invoke(n,s);return i&&(t.OFFSET=r,ne.optional((function(){t.assert(n,r+">=0","invalid "+e)}))),r}))}return i&&a?Es((function(e,t){return e.OFFSET="0",0})):null}var c=u(ca,!0);function l(){if(ua in n){var e=0|n[ua];return ne.command("number"===typeof e&&e>=0,"invalid vertex count",t.commandStr),Es((function(){return e}))}if(ua in r){var i=r[ua];return Ts(i,(function(e,t){var n=e.invoke(t,i);return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(a){if(Ss(a)){if(a)return c?new ws(c.thisDep,c.contextDep,c.propDep,(function(e,t){var n=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return ne.optional((function(){e.assert(t,n+">=0","invalid vertex offset/element buffer too small")})),n})):Es((function(e,t){return t.def(e.ELEMENTS,".vertCount")}));var o=Es((function(){return-1}));return ne.optional((function(){o.MISSING=!0})),o}var s=new ws(a.thisDep||c.thisDep,a.contextDep||c.contextDep,a.propDep||c.propDep,(function(e,t){var n=e.ELEMENTS;return e.OFFSET?t.def(n,"?",n,".vertCount-",e.OFFSET,":-1"):t.def(n,"?",n,".vertCount:-1")}));return ne.optional((function(){s.DYNAMIC=!0})),s}return null}return{elements:a,primitive:s(),count:l(),instances:u(la,!1),offset:c}}function z(e,t){var n=e.static,i=e.dynamic,o={};return x.forEach((function(e){var a=E(e);function s(t,r){if(e in n){var s=t(n[e]);o[a]=Es((function(){return s}))}else if(e in i){var u=i[e];o[a]=Ts(u,(function(e,t){return r(e,t,e.invoke(t,u))}))}}switch(e){case Fo:case Mo:case Io:case Yo:case Ro:case $o:case Go:case Zo:case Ho:case No:return s((function(n){return ne.commandType(n,"boolean",e,t.commandStr),n}),(function(t,n,r){return ne.optional((function(){t.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+e,t.commandStr)})),r}));case Do:return s((function(n){return ne.commandParameter(n,gs,"invalid "+e,t.commandStr),gs[n]}),(function(t,n,r){var i=t.constants.compareFuncs;return ne.optional((function(){t.assert(n,r+" in "+i,"invalid "+e+", must be one of "+Object.keys(gs))})),n.def(i,"[",r,"]")}));case zo:return s((function(e){return ne.command(Tn(e)&&2===e.length&&"number"===typeof e[0]&&"number"===typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e}),(function(e,t,n){ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")}));var r=t.def("+",n,"[0]"),i=t.def("+",n,"[1]");return[r,i]}));case Lo:return s((function(e){ne.commandType(e,"object","blend.func",t.commandStr);var n="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,i="dstRGB"in e?e.dstRGB:e.dst,o="dstAlpha"in e?e.dstAlpha:e.dst;return ne.commandParameter(n,ds,a+".srcRGB",t.commandStr),ne.commandParameter(r,ds,a+".srcAlpha",t.commandStr),ne.commandParameter(i,ds,a+".dstRGB",t.commandStr),ne.commandParameter(o,ds,a+".dstAlpha",t.commandStr),ne.command(-1===ms.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",t.commandStr),[ds[n],ds[i],ds[r],ds[o]]}),(function(t,n,r){var i=t.constants.blendFuncs;function o(o,a){var s=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return ne.optional((function(){t.assert(n,s+" in "+i,"invalid "+e+"."+o+a+", must be one of "+Object.keys(ds))})),s}ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),s=o("dst","RGB");ne.optional((function(){var e=t.constants.invalidBlendCombinations;t.assert(n,e+".indexOf("+a+'+", "+'+s+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(i,"[",a,"]"),c=n.def(i,"[",o("src","Alpha"),"]"),l=n.def(i,"[",s,"]"),p=n.def(i,"[",o("dst","Alpha"),"]");return[u,l,c,p]}));case Oo:return s((function(n){return"string"===typeof n?(ne.commandParameter(n,g,"invalid "+e,t.commandStr),[g[n],g[n]]):"object"===typeof n?(ne.commandParameter(n.rgb,g,e+".rgb",t.commandStr),ne.commandParameter(n.alpha,g,e+".alpha",t.commandStr),[g[n.rgb],g[n.alpha]]):void ne.commandRaise("invalid blend.equation",t.commandStr)}),(function(t,n,r){var i=t.constants.blendEquations,o=n.def(),a=n.def(),s=t.cond("typeof ",r,'==="string"');return ne.optional((function(){function n(e,n,r){t.assert(e,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(g))}n(s.then,e,r),t.assert(s.else,r+"&&typeof "+r+'==="object"',"invalid "+e),n(s.else,e+".rgb",r+".rgb"),n(s.else,e+".alpha",r+".alpha")})),s.then(o,"=",a,"=",i,"[",r,"];"),s.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(s),[o,a]}));case Po:return s((function(e){return ne.command(Tn(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),Ee(4,(function(t){return+e[t]}))}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),Ee(4,(function(e){return t.def("+",n,"[",e,"]")}))}));case Xo:return s((function(e){return ne.commandType(e,"number",a,t.commandStr),0|e}),(function(e,t,n){return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"',"invalid stencil.mask")})),t.def(n,"|0")}));case Ko:return s((function(n){ne.commandType(n,"object",a,t.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return ne.commandParameter(r,gs,e+".cmp",t.commandStr),ne.commandType(i,"number",e+".ref",t.commandStr),ne.commandType(o,"number",e+".mask",t.commandStr),[gs[r],i,o]}),(function(e,t,n){var r=e.constants.compareFuncs;ne.optional((function(){function i(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")}));var i=t.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",ss),o=t.def(n,".ref|0"),a=t.def('"mask" in ',n,"?",n,".mask|0:-1");return[i,o,a]}));case Jo:case Qo:return s((function(n){ne.commandType(n,"object",a,t.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return ne.commandParameter(r,vs,e+".fail",t.commandStr),ne.commandParameter(i,vs,e+".zfail",t.commandStr),ne.commandParameter(o,vs,e+".zpass",t.commandStr),[e===Qo?ts:es,vs[r],vs[i],vs[o]]}),(function(t,n,r){var i=t.constants.stencilOps;function o(o){return ne.optional((function(){t.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+e+"."+o+", must be one of "+Object.keys(vs))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",ss)}return ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)})),[e===Qo?ts:es,o("fail"),o("zfail"),o("zpass")]}));case qo:return s((function(e){ne.commandType(e,"object",a,t.commandStr);var n=0|e.factor,r=0|e.units;return ne.commandType(n,"number",a+".factor",t.commandStr),ne.commandType(r,"number",a+".units",t.commandStr),[n,r]}),(function(t,n,r){ne.optional((function(){t.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+e)}));var i=n.def(r,".factor|0"),o=n.def(r,".units|0");return[i,o]}));case Bo:return s((function(e){var n=0;return"front"===e?n=es:"back"===e&&(n=ts),ne.command(!!n,a,t.commandStr),n}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),t.def(n,'==="front"?',es,":",ts)}));case Vo:return s((function(e){return ne.command("number"===typeof e&&e>=r.lineWidthDims[0]&&e<=r.lineWidthDims[1],"invalid line width, must be a positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],t.commandStr),e}),(function(e,t,n){return ne.optional((function(){e.assert(t,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")})),n}));case Uo:return s((function(e){return ne.commandParameter(e,_s,a,t.commandStr),_s[e]}),(function(e,t,n){return ne.optional((function(){e.assert(t,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),t.def(n+'==="cw"?'+ns+":"+rs)}));case jo:return s((function(e){return ne.command(Tn(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map((function(e){return!!e}))}),(function(e,t,n){return ne.optional((function(){e.assert(t,e.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),Ee(4,(function(e){return"!!"+n+"["+e+"]"}))}));case Wo:return s((function(e){ne.command("object"===typeof e&&e,a,t.commandStr);var n="value"in e?e.value:1,r=!!e.invert;return ne.command("number"===typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[n,r]}),(function(e,t,n){ne.optional((function(){e.assert(t,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")}));var r=t.def('"value" in ',n,"?+",n,".value:1"),i=t.def("!!",n,".invert");return[r,i]}))}})),o}function N(e,t){var n=e.static,r=e.dynamic,i={};return Object.keys(n).forEach((function(e){var r,o=n[e];if("number"===typeof o||"boolean"===typeof o)r=Es((function(){return o}));else if("function"===typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=Es((function(e){return e.link(o)})):"framebuffer"===a||"framebufferCube"===a?(ne.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),r=Es((function(e){return e.link(o.color[0])}))):ne.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else Tn(o)?r=Es((function(t){var n=t.global.def("[",Ee(o.length,(function(n){return ne.command("number"===typeof o[n]||"boolean"===typeof o[n],"invalid uniform "+e,t.commandStr),o[n]})),"]");return n})):ne.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);r.value=o,i[e]=r})),Object.keys(r).forEach((function(e){var t=r[e];i[e]=Ts(t,(function(e,n){return e.invoke(n,t)}))})),i}function j(e,n){var r=e.static,o=e.dynamic,a={};return Object.keys(r).forEach((function(e){var o=r[e],s=t.id(e),u=new m;if(bs(o))u.state=wo,u.buffer=i.getBuffer(i.create(o,xa,!1,!0)),u.type=0;else{var c=i.getBuffer(o);if(c)u.state=wo,u.buffer=c,u.type=0;else if(ne.command("object"===typeof o&&o,"invalid data for attribute "+e,n.commandStr),"constant"in o){var l=o.constant;u.buffer="null",u.state=So,"number"===typeof l?u.x=l:(ne.command(Tn(l)&&l.length>0&&l.length<=4,"invalid constant for attribute "+e,n.commandStr),bo.forEach((function(e,t){t<l.length&&(u[e]=l[t])})))}else{c=bs(o.buffer)?i.getBuffer(i.create(o.buffer,xa,!1,!0)):i.getBuffer(o.buffer),ne.command(!!c,'missing buffer for attribute "'+e+'"',n.commandStr);var p=0|o.offset;ne.command(p>=0,'invalid offset for attribute "'+e+'"',n.commandStr);var f=0|o.stride;ne.command(f>=0&&f<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',n.commandStr);var h=0|o.size;ne.command(!("size"in o)||h>0&&h<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',n.commandStr);var d=!!o.normalized,g=0;"type"in o&&(ne.commandParameter(o.type,Ft,"invalid type for attribute "+e,n.commandStr),g=Ft[o.type]);var y=0|o.divisor;"divisor"in o&&(ne.command(0===y||v,'cannot specify divisor for attribute "'+e+'", instancing not supported',n.commandStr),ne.command(y>=0,'invalid divisor for attribute "'+e+'"',n.commandStr)),ne.optional((function(){var t=n.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(o).forEach((function(n){ne.command(r.indexOf(n)>=0,'unknown parameter "'+n+'" for attribute pointer "'+e+'" (valid parameters are '+r+")",t)}))})),u.buffer=c,u.state=wo,u.size=h,u.normalized=d,u.type=g||c.dtype,u.offset=p,u.stride=f,u.divisor=y}}a[e]=Es((function(e,t){var n=e.attribCache;if(s in n)return n[s];var r={isStream:!1};return Object.keys(u).forEach((function(e){r[e]=u[e]})),u.buffer&&(r.buffer=e.link(u.buffer),r.type=r.type||r.buffer+".dtype"),n[s]=r,r}))})),Object.keys(o).forEach((function(e){var t=o[e];function n(n,r){var i=n.invoke(r,t),o=n.shared,a=n.constants,s=o.isBufferArgs,u=o.buffer;ne.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+s+"("+i+")||"+u+".getBuffer("+i+")||"+u+".getBuffer("+i+".buffer)||"+s+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+e+'"')}));var c={isStream:r.def(!1)},l=new m;l.state=wo,Object.keys(l).forEach((function(e){c[e]=r.def(""+l[e])}));var p=c.buffer,f=c.type;function h(e){r(c[e],"=",i,".",e,"|0;")}return r("if(",s,"(",i,")){",c.isStream,"=true;",p,"=",u,".createStream(",xa,",",i,");",f,"=",p,".dtype;","}else{",p,"=",u,".getBuffer(",i,");","if(",p,"){",f,"=",p,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",So,";","if(typeof "+i+'.constant === "number"){',c[bo[0]],"=",i,".constant;",bo.slice(1).map((function(e){return c[e]})).join("="),"=0;","}else{",bo.map((function(e,t){return c[e]+"="+i+".constant.length>"+t+"?"+i+".constant["+t+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",p,"=",u,".createStream(",xa,",",i,".buffer);","}else{",p,"=",u,".getBuffer(",i,".buffer);","}",f,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",p,".dtype;",c.normalized,"=!!",i,".normalized;"),h("size"),h("offset"),h("stride"),h("divisor"),r("}}"),r.exit("if(",c.isStream,"){",u,".destroyStream(",p,");","}"),c}a[e]=Ts(t,n)})),a}function F(e){var t=e.static,n=e.dynamic,r={};return Object.keys(t).forEach((function(e){var n=t[e];r[e]=Es((function(e,t){return"number"===typeof n||"boolean"===typeof n?""+n:e.link(n)}))})),Object.keys(n).forEach((function(e){var t=n[e];r[e]=Ts(t,(function(e,n){return e.invoke(n,t)}))})),r}function B(e,t,n,r,i){var o=e.static,a=e.dynamic;ne.optional((function(){var e=[ra,ia,oa,aa,sa,ca,ua,la,na].concat(x);function t(t){Object.keys(t).forEach((function(t){ne.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',i.commandStr)}))}t(o),t(a)}));var s=O(e,i),u=L(e,s,i),c=D(e,i),l=z(e,i),p=R(e,i);function f(e){var t=u[e];t&&(l[e]=t)}f(ta),f(E(ea));var h=Object.keys(l).length>0,d={framebuffer:s,draw:c,shader:p,state:l,dirty:h};return d.profile=P(e,i),d.uniforms=N(n,i),d.attributes=j(t,i),d.context=F(r,i),d}function U(e,t,n){var r=e.shared,i=r.context,o=e.scope();Object.keys(n).forEach((function(r){t.save(i,"."+r);var a=n[r];o(i,".",r,"=",a.append(e,t),";")})),t(o)}function V(e,t,n,r){var i,o=e.shared,a=o.gl,s=o.framebuffer;y&&(i=t.def(o.extensions,".webgl_draw_buffers"));var u,c=e.constants,l=c.drawBuffer,p=c.backBuffer;u=n?n.append(e,t):t.def(s,".next"),r||t("if(",u,"!==",s,".cur){"),t("if(",u,"){",a,".bindFramebuffer(",fs,",",u,".framebuffer);"),y&&t(i,".drawBuffersWEBGL(",l,"[",u,".colorAttachments.length]);"),t("}else{",a,".bindFramebuffer(",fs,",null);"),y&&t(i,".drawBuffersWEBGL(",p,");"),t("}",s,".cur=",u,";"),r||t("}")}function G(e,t,n){var r=e.shared,i=r.gl,o=e.current,a=e.next,s=r.current,u=r.next,c=e.cond(s,".dirty");x.forEach((function(t){var r,l,p=E(t);if(!(p in n.state))if(p in a){r=a[p],l=o[p];var f=Ee(_[p].length,(function(e){return c.def(r,"[",e,"]")}));c(e.cond(f.map((function(e,t){return e+"!=="+l+"["+t+"]"})).join("||")).then(i,".",S[p],"(",f,");",f.map((function(e,t){return l+"["+t+"]="+e})).join(";"),";"))}else{r=c.def(u,".",p);var h=e.cond(r,"!==",s,".",p);c(h),p in w?h(e.cond(r).then(i,".enable(",w[p],");").else(i,".disable(",w[p],");"),s,".",p,"=",r,";"):h(i,".",S[p],"(",r,");",s,".",p,"=",r,";")}})),0===Object.keys(n.state).length&&c(s,".dirty=false;"),t(c)}function q(e,t,n,r){var i=e.shared,o=e.current,a=i.current,s=i.gl;xs(Object.keys(n)).forEach((function(i){var u=n[i];if(!r||r(u)){var c=u.append(e,t);if(w[i]){var l=w[i];Ss(u)?t(s,c?".enable(":".disable(",l,");"):t(e.cond(c).then(s,".enable(",l,");").else(s,".disable(",l,");")),t(a,".",i,"=",c,";")}else if(Tn(c)){var p=o[i];t(s,".",S[i],"(",c,");",c.map((function(e,t){return p+"["+t+"]="+e})).join(";"),";")}else t(s,".",S[i],"(",c,");",a,".",i,"=",c,";")}}))}function Z(e,t){v&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function H(e,t,n,r,i){var o,a,s,u=e.shared,c=e.stats,l=u.current,p=u.timer,f=n.profile;function d(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function m(e){o=t.def(),e(o,"=",d(),";"),"string"===typeof i?e(c,".count+=",i,";"):e(c,".count++;"),h&&(r?(a=t.def(),e(a,"=",p,".getNumPendingQueries();")):e(p,".beginQuery(",c,");"))}function g(e){e(c,".cpuTime+=",d(),"-",o,";"),h&&(r?e(p,".pushScopeStats(",a,",",p,".getNumPendingQueries(),",c,");"):e(p,".endQuery();"))}function v(e){var n=t.def(l,".profile");t(l,".profile=",e,";"),t.exit(l,".profile=",n,";")}if(f){if(Ss(f))return void(f.enable?(m(t),g(t.exit),v("true")):v("false"));s=f.append(e,t),v(s)}else s=t.def(l,".profile");var y=e.block();m(y),t("if(",s,"){",y,"}");var _=e.block();g(_),t.exit("if(",s,"){",_,"}")}function W(e,t,n,r,i){var o=e.shared;function a(e){switch(e){case Na:case Ua:case Za:return 2;case ja:case Va:case Ha:return 3;case Fa:case Ga:case Wa:return 4;default:return 1}}function s(n,r,i){var a=o.gl,s=t.def(n,".location"),u=t.def(o.attributes,"[",s,"]"),c=i.state,l=i.buffer,p=[i.x,i.y,i.z,i.w],f=["buffer","normalized","offset","stride"];function h(){t("if(!",u,".buffer){",a,".enableVertexAttribArray(",s,");}");var n,o=i.type;if(n=i.size?t.def(i.size,"||",r):r,t("if(",u,".type!==",o,"||",u,".size!==",n,"||",f.map((function(e){return u+"."+e+"!=="+i[e]})).join("||"),"){",a,".bindBuffer(",xa,",",l,".buffer);",a,".vertexAttribPointer(",[s,n,o,i.normalized,i.stride,i.offset],");",u,".type=",o,";",u,".size=",n,";",f.map((function(e){return u+"."+e+"="+i[e]+";"})).join(""),"}"),v){var c=i.divisor;t("if(",u,".divisor!==",c,"){",e.instancing,".vertexAttribDivisorANGLE(",[s,c],");",u,".divisor=",c,";}")}}function d(){t("if(",u,".buffer){",a,".disableVertexAttribArray(",s,");",u,".buffer=null;","}if(",bo.map((function(e,t){return u+"."+e+"!=="+p[t]})).join("||"),"){",a,".vertexAttrib4f(",s,",",p,");",bo.map((function(e,t){return u+"."+e+"="+p[t]+";"})).join(""),"}")}c===wo?h():c===So?d():(t("if(",c,"===",wo,"){"),h(),t("}else{"),d(),t("}"))}r.forEach((function(r){var o,u=r.name,c=n.attributes[u];if(c){if(!i(c))return;o=c.append(e,t)}else{if(!i(ks))return;var l=e.scopeAttrib(u);ne.optional((function(){e.assert(t,l+".state","missing attribute "+u)})),o={},Object.keys(new m).forEach((function(e){o[e]=t.def(l,".",e)}))}s(e.link(r),a(r.info.type),o)}))}function Y(e,n,r,i,o){for(var a,s=e.shared,u=s.gl,c=0;c<i.length;++c){var l,p=i[c],f=p.name,h=p.info.type,d=r.uniforms[f],m=e.link(p),g=m+".location";if(d){if(!o(d))continue;if(Ss(d)){var v=d.value;if(ne.command(null!==v&&"undefined"!==typeof v,'missing uniform "'+f+'"',e.commandStr),h===Ja||h===Qa){ne.command("function"===typeof v&&(h===Ja&&("texture2d"===v._reglType||"framebuffer"===v._reglType)||h===Qa&&("textureCube"===v._reglType||"framebufferCube"===v._reglType)),"invalid texture for uniform "+f,e.commandStr);var y=e.link(v._texture||v.color[0]._texture);n(u,".uniform1i(",g,",",y+".bind());"),n.exit(y,".unbind();")}else if(h===Ya||h===Xa||h===Ka){ne.optional((function(){ne.command(Tn(v),"invalid matrix for uniform "+f,e.commandStr),ne.command(h===Ya&&4===v.length||h===Xa&&9===v.length||h===Ka&&16===v.length,"invalid length for matrix uniform "+f,e.commandStr)}));var _=e.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),b=2;h===Xa?b=3:h===Ka&&(b=4),n(u,".uniformMatrix",b,"fv(",g,",false,",_,");")}else{switch(h){case za:ne.commandType(v,"number","uniform "+f,e.commandStr),a="1f";break;case Na:ne.command(Tn(v)&&2===v.length,"uniform "+f,e.commandStr),a="2f";break;case ja:ne.command(Tn(v)&&3===v.length,"uniform "+f,e.commandStr),a="3f";break;case Fa:ne.command(Tn(v)&&4===v.length,"uniform "+f,e.commandStr),a="4f";break;case qa:ne.commandType(v,"boolean","uniform "+f,e.commandStr),a="1i";break;case Ba:ne.commandType(v,"number","uniform "+f,e.commandStr),a="1i";break;case Za:ne.command(Tn(v)&&2===v.length,"uniform "+f,e.commandStr),a="2i";break;case Ua:ne.command(Tn(v)&&2===v.length,"uniform "+f,e.commandStr),a="2i";break;case Ha:ne.command(Tn(v)&&3===v.length,"uniform "+f,e.commandStr),a="3i";break;case Va:ne.command(Tn(v)&&3===v.length,"uniform "+f,e.commandStr),a="3i";break;case Wa:ne.command(Tn(v)&&4===v.length,"uniform "+f,e.commandStr),a="4i";break;case Ga:ne.command(Tn(v)&&4===v.length,"uniform "+f,e.commandStr),a="4i";break}n(u,".uniform",a,"(",g,",",Tn(v)?Array.prototype.slice.call(v):v,");")}continue}l=d.append(e,n)}else{if(!o(ks))continue;l=n.def(s.uniforms,"[",t.id(f),"]")}h===Ja?n("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}"):h===Qa&&n("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}"),ne.optional((function(){function t(t,r){e.assert(n,t,'bad data or missing for uniform "'+f+'".  '+r)}function r(e){t("typeof "+l+'==="'+e+'"',"invalid type, expected "+e)}function i(n,r){t(s.isArrayLike+"("+l+")&&"+l+".length==="+n,"invalid vector, should have length "+n,e.commandStr)}function o(n){t("typeof "+l+'==="function"&&'+l+'._reglType==="texture'+(n===Ta?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(h){case Ba:r("number");break;case Ua:i(2,"number");break;case Va:i(3,"number");break;case Ga:i(4,"number");break;case za:r("number");break;case Na:i(2,"number");break;case ja:i(3,"number");break;case Fa:i(4,"number");break;case qa:r("boolean");break;case Za:i(2,"boolean");break;case Ha:i(3,"boolean");break;case Wa:i(4,"boolean");break;case Ya:i(4,"number");break;case Xa:i(9,"number");break;case Ka:i(16,"number");break;case Ja:o(Ta);break;case Qa:o(ka);break}}));var x=1;switch(h){case Ja:case Qa:var w=n.def(l,"._texture");n(u,".uniform1i(",g,",",w,".bind());"),n.exit(w,".unbind();");continue;case Ba:case qa:a="1i";break;case Ua:case Za:a="2i",x=2;break;case Va:case Ha:a="3i",x=3;break;case Ga:case Wa:a="4i",x=4;break;case za:a="1f";break;case Na:a="2f",x=2;break;case ja:a="3f",x=3;break;case Fa:a="4f",x=4;break;case Ya:a="Matrix2fv";break;case Xa:a="Matrix3fv";break;case Ka:a="Matrix4fv";break}if(n(u,".uniform",a,"(",g,","),"M"===a.charAt(0)){var S=Math.pow(h-Ya+2,2),E=e.global.def("new Float32Array(",S,")");n("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",Ee(S,(function(e){return E+"["+e+"]="+l+"["+e+"]"})),",",E,")")}else n(x>1?Ee(x,(function(e){return l+"["+e+"]"})):l);n(");")}}function X(e,t,n,r){var i=e.shared,o=i.gl,a=i.draw,s=r.draw;function u(){var i,u=s.elements,c=t;return u?((u.contextDep&&r.contextDynamic||u.propDep)&&(c=n),i=u.append(e,c)):i=c.def(a,".",aa),i&&c("if("+i+")"+o+".bindBuffer("+wa+","+i+".buffer.buffer);"),i}function c(){var i,o=s.count,u=t;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(u=n),i=o.append(e,u),ne.optional((function(){o.MISSING&&e.assert(t,"false","missing vertex count"),o.DYNAMIC&&e.assert(u,i+">=0","missing vertex count")}))):(i=u.def(a,".",ua),ne.optional((function(){e.assert(u,i+">=0","missing vertex count")}))),i}var l=u();function p(i){var o=s[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(e,n):o.append(e,t):t.def(a,".",i)}var f,h,d=p(sa),m=p(ca),g=c();if("number"===typeof g){if(0===g)return}else n("if(",g,"){"),n.exit("}");v&&(f=p(la),h=e.instancing);var y=l+".type",_=s.elements&&Ss(s.elements);function b(){function e(){n(h,".drawElementsInstancedANGLE(",[d,g,y,m+"<<(("+y+"-"+xo+")>>1)",f],");")}function t(){n(h,".drawArraysInstancedANGLE(",[d,m,g,f],");")}l?_?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}function x(){function e(){n(o+".drawElements("+[d,g,y,m+"<<(("+y+"-"+xo+")>>1)"]+");")}function t(){n(o+".drawArrays("+[d,m,g]+");")}l?_?e():(n("if(",l,"){"),e(),n("}else{"),t(),n("}")):t()}v&&("number"!==typeof f||f>=0)?"string"===typeof f?(n("if(",f,">0){"),b(),n("}else if(",f,"<0){"),x(),n("}")):b():x()}function K(e,t,n,r,i){var o=M(),a=o.proc("body",i);return ne.optional((function(){o.commandStr=t.commandStr,o.command=o.link(t.commandStr)})),v&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),e(o,a,n,r),o.compile().body}function J(e,t,n,r){Z(e,t),W(e,t,n,r.attributes,(function(){return!0})),Y(e,t,n,r.uniforms,(function(){return!0})),X(e,t,t,n)}function Q(e,t){var n=e.proc("draw",1);Z(e,n),U(e,n,t.context),V(e,n,t.framebuffer),G(e,n,t),q(e,n,t.state),H(e,n,t,!1,!0);var r=t.shader.progVar.append(e,n);if(n(e.shared.gl,".useProgram(",r,".program);"),t.shader.program)J(e,n,t,t.shader.program);else{var i=e.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(e.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",e.link((function(n){return K(J,e,t,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function $(e,t,n,r){function i(){return!0}e.batchId="a1",Z(e,t),W(e,t,n,r.attributes,i),Y(e,t,n,r.uniforms,i),X(e,t,t,n)}function ee(e,t,n,r){Z(e,t);var i=n.contextDep,o=t.def(),a="a0",s="a1",u=t.def();e.shared.props=u,e.batchId=o;var c=e.scope(),l=e.scope();function p(e){return e.contextDep&&i||e.propDep}function f(e){return!p(e)}if(t(c.entry,"for(",o,"=0;",o,"<",s,";++",o,"){",u,"=",a,"[",o,"];",l,"}",c.exit),n.needsContext&&U(e,l,n.context),n.needsFramebuffer&&V(e,l,n.framebuffer),q(e,l,n.state,p),n.profile&&p(n.profile)&&H(e,l,n,!1,!0),r)W(e,c,n,r.attributes,f),W(e,l,n,r.attributes,p),Y(e,c,n,r.uniforms,f),Y(e,l,n,r.uniforms,p),X(e,c,l,n);else{var h=e.global.def("{}"),d=n.shader.progVar.append(e,l),m=l.def(d,".id"),g=l.def(h,"[",m,"]");l(e.shared.gl,".useProgram(",d,".program);","if(!",g,"){",g,"=",h,"[",m,"]=",e.link((function(t){return K($,e,n,t,2)})),"(",d,");}",g,".call(this,a0[",o,"],",o,");")}}function te(e,t){var n=e.proc("batch",2);e.batchId="0",Z(e,n);var r=!1,i=!0;Object.keys(t.context).forEach((function(e){r=r||t.context[e].propDep})),r||(U(e,n,t.context),i=!1);var o=t.framebuffer,a=!1;function s(e){return e.contextDep&&r||e.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||V(e,n,o)):V(e,n,null),t.state.viewport&&t.state.viewport.propDep&&(r=!0),G(e,n,t),q(e,n,t.state,(function(e){return!s(e)})),t.profile&&s(t.profile)||H(e,n,t,!1,"a1"),t.contextDep=r,t.needsContext=i,t.needsFramebuffer=a;var u=t.shader.progVar;if(u.contextDep&&r||u.propDep)ee(e,n,t,null);else{var c=u.append(e,n);if(n(e.shared.gl,".useProgram(",c,".program);"),t.shader.program)ee(e,n,t,t.shader.program);else{var l=e.global.def("{}"),p=n.def(c,".id"),f=n.def(l,"[",p,"]");n(e.cond(f).then(f,".call(this,a0,a1);").else(f,"=",l,"[",p,"]=",e.link((function(n){return K(ee,e,t,n,2)})),"(",c,");",f,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&n(e.shared.current,".dirty=true;")}function re(e,n){var r=e.proc("scope",3);e.batchId="a2";var i=e.shared,o=i.current;function a(t){var o=n.shader[t];o&&r.set(i.shader,"."+t,o.append(e,r))}U(e,r,n.context),n.framebuffer&&n.framebuffer.append(e,r),xs(Object.keys(n.state)).forEach((function(t){var o=n.state[t],a=o.append(e,r);Tn(a)?a.forEach((function(n,i){r.set(e.next[t],"["+i+"]",n)})):r.set(i.next,"."+t,a)})),H(e,r,n,!0,!0),[aa,ca,ua,la,sa].forEach((function(t){var o=n.draw[t];o&&r.set(i.draw,"."+t,""+o.append(e,r))})),Object.keys(n.uniforms).forEach((function(o){r.set(i.uniforms,"["+t.id(o)+"]",n.uniforms[o].append(e,r))})),Object.keys(n.attributes).forEach((function(t){var i=n.attributes[t].append(e,r),o=e.scopeAttrib(t);Object.keys(new m).forEach((function(e){r.set(o,"."+e,i[e])}))})),a(ia),a(oa),Object.keys(n.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",e.shared.context,",a0,",e.batchId,");")}function ie(e){if("object"===typeof e&&!Tn(e)){for(var t=Object.keys(e),n=0;n<t.length;++n)if(fe.isDynamic(e[t[n]]))return!0;return!1}}function oe(e,t,n){var r=t.static[n];if(r&&ie(r)){var i=e.global,o=Object.keys(r),a=!1,s=!1,u=!1,c=e.global.def("{}");o.forEach((function(t){var n=r[t];if(fe.isDynamic(n)){"function"===typeof n&&(n=r[t]=fe.unbox(n));var o=Ts(n,null);a=a||o.thisDep,u=u||o.propDep,s=s||o.contextDep}else{switch(i(c,".",t,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(e.link(n));break}i(";")}})),t.dynamic[n]=new fe.DynamicVariable(Co,{thisDep:a,contextDep:s,propDep:u,ref:c,append:l}),delete t.static[n]}function l(e,t){o.forEach((function(n){var i=r[n];if(fe.isDynamic(i)){var o=e.invoke(t,i);t(c,".",n,"=",o,";")}}))}}function ae(e,t,n,r,i){var o=M();o.stats=o.link(i),Object.keys(t.static).forEach((function(e){oe(o,t,e)})),ba.forEach((function(t){oe(o,e,t)}));var a=B(e,t,n,r,o);return Q(o,a),re(o,a),te(o,a),o.compile()}return{next:b,current:_,procs:function(){var e=M(),t=e.proc("poll"),n=e.proc("refresh"),i=e.block();t(i),n(i);var o,a=e.shared,s=a.gl,u=a.next,c=a.current;i(c,".dirty=false;"),V(e,t),V(e,n,null,!0),v&&(o=e.link(v));for(var l=0;l<r.maxAttributes;++l){var p=n.def(a.attributes,"[",l,"]"),f=e.cond(p,".buffer");f.then(s,".enableVertexAttribArray(",l,");",s,".bindBuffer(",xa,",",p,".buffer.buffer);",s,".vertexAttribPointer(",l,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(s,".disableVertexAttribArray(",l,");",s,".vertexAttrib4f(",l,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),n(f),v&&n(o,".vertexAttribDivisorANGLE(",l,",",p,".divisor);")}return Object.keys(w).forEach((function(r){var o=w[r],a=i.def(u,".",r),l=e.block();l("if(",a,"){",s,".enable(",o,")}else{",s,".disable(",o,")}",c,".",r,"=",a,";"),n(l),t("if(",a,"!==",c,".",r,"){",l,"}")})),Object.keys(S).forEach((function(r){var o,a,l=S[r],p=_[r],f=e.block();if(f(s,".",l,"("),Tn(p)){var h=p.length;o=e.global.def(u,".",r),a=e.global.def(c,".",r),f(Ee(h,(function(e){return o+"["+e+"]"})),");",Ee(h,(function(e){return a+"["+e+"]="+o+"["+e+"];"})).join("")),t("if(",Ee(h,(function(e){return o+"["+e+"]!=="+a+"["+e+"]"})).join("||"),"){",f,"}")}else o=i.def(u,".",r),a=i.def(c,".",r),f(o,");",c,".",r,"=",o,";"),t("if(",o,"!==",a,"){",f,"}");n(f)})),e.compile()}(),compile:ae}}function Cs(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Is=34918,Ms=34919,Ps=35007,Os=function(e,t){if(!t.ext_disjoint_timer_query)return null;var n=[];function r(){return n.pop()||t.ext_disjoint_timer_query.createQueryEXT()}function i(e){n.push(e)}var o=[];function a(e){var n=r();t.ext_disjoint_timer_query.beginQueryEXT(Ps,n),o.push(n),h(o.length-1,o.length,e)}function s(){t.ext_disjoint_timer_query.endQueryEXT(Ps)}function u(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var c=[];function l(){return c.pop()||new u}function p(e){c.push(e)}var f=[];function h(e,t,n){var r=l();r.startQueryIndex=e,r.endQueryIndex=t,r.sum=0,r.stats=n,f.push(r)}var d=[],m=[];function g(){var e,n,r=o.length;if(0!==r){m.length=Math.max(m.length,r+1),d.length=Math.max(d.length,r+1),d[0]=0,m[0]=0;var a=0;for(e=0,n=0;n<o.length;++n){var s=o[n];t.ext_disjoint_timer_query.getQueryObjectEXT(s,Ms)?(a+=t.ext_disjoint_timer_query.getQueryObjectEXT(s,Is),i(s)):o[e++]=s,d[n+1]=a,m[n+1]=e}for(o.length=e,e=0,n=0;n<f.length;++n){var u=f[n],c=u.startQueryIndex,l=u.endQueryIndex;u.sum+=d[l]-d[c];var h=m[c],g=m[l];g===h?(u.stats.gpuTime+=u.sum/1e6,p(u)):(u.startQueryIndex=h,u.endQueryIndex=g,f[e++]=u)}f.length=e}}return{beginQuery:a,endQuery:s,pushScopeStats:h,update:g,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var e=0;e<n.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(n[e]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},Ls=16384,Rs=256,Ds=1024,zs=34962,Ns="webglcontextlost",js="webglcontextrestored",Fs=1,Bs=2,Us=3;function Vs(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function Gs(e){var n=we(e);if(!n)return null;var r=n.gl,i=r.getContextAttributes(),o=r.isContextLost(),a=Se(r,n);if(!a)return null;var s=me(),u=Cs(),c=a.extensions,l=Os(r,c),p=de(),f=r.drawingBufferWidth,h=r.drawingBufferHeight,d={tick:0,time:0,viewportWidth:f,viewportHeight:h,framebufferWidth:f,framebufferHeight:h,drawingBufferWidth:f,drawingBufferHeight:h,pixelRatio:n.pixelRatio},m={},g={elements:null,primitive:4,count:-1,offset:0,instances:-1},v=bt(r,c),y=oo(r,c,v,s),_=$t(r,u,n,y),b=bn(r,c,_,u),x=lo(r,s,u,n),w=si(r,c,v,(function(){T.procs.poll()}),d,u,n),S=xi(r,c,v,u,n),E=no(r,c,v,w,S,u),T=As(r,s,c,v,_,b,w,E,m,y,x,g,d,l,n),k=go(r,E,T.procs.poll,d,i,c,v),A=T.next,C=r.canvas,I=[],M=[],P=[],O=[n.onDestroy],L=null;function R(){if(0===I.length)return l&&l.update(),void(L=null);L=he.next(R),H();for(var e=I.length-1;e>=0;--e){var t=I[e];t&&t(d,null,0)}r.flush(),l&&l.update()}function D(){!L&&I.length>0&&(L=he.next(R))}function z(){L&&(he.cancel(R),L=null)}function N(e){e.preventDefault(),o=!0,z(),M.forEach((function(e){e()}))}function j(e){r.getError(),o=!1,a.restore(),x.restore(),_.restore(),w.restore(),S.restore(),E.restore(),l&&l.restore(),T.procs.refresh(),D(),P.forEach((function(e){e()}))}function F(){I.length=0,z(),C&&(C.removeEventListener(Ns,N),C.removeEventListener(js,j)),x.clear(),E.clear(),S.clear(),w.clear(),b.clear(),_.clear(),l&&l.clear(),O.forEach((function(e){e()}))}function B(e){function n(e){var n=t({},e);function r(e){if(e in n){var t=n[e];delete n[e],Object.keys(t).forEach((function(r){n[e+"."+r]=t[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),n}function r(e){var t={},n={};return Object.keys(e).forEach((function(r){var i=e[r];fe.isDynamic(i)?n[r]=fe.unbox(i,r):t[r]=i})),{dynamic:n,static:t}}ne(!!e,"invalid args to regl({...})"),ne.type(e,"object","invalid args to regl({...})");var i=r(e.context||{}),a=r(e.uniforms||{}),s=r(e.attributes||{}),u=r(n(e)),c={gpuTime:0,cpuTime:0,count:0},l=T.compile(u,s,a,i,c),p=l.draw,f=l.batch,h=l.scope,d=[];function m(e){while(d.length<e)d.push(null);return d}function g(e,t){var n;if(o&&ne.raise("context lost"),"function"===typeof e)return h.call(this,null,e,0);if("function"===typeof t){if("number"===typeof e){for(n=0;n<e;++n)h.call(this,null,t,n);return}if(Array.isArray(e)){for(n=0;n<e.length;++n)h.call(this,e[n],t,n);return}return h.call(this,e,t,0)}if("number"===typeof e){if(e>0)return f.call(this,m(0|e),0|e)}else{if(!Array.isArray(e))return p.call(this,e);if(e.length)return f.call(this,e,e.length)}}return t(g,{stats:c})}C&&(C.addEventListener(Ns,N,!1),C.addEventListener(js,j,!1));var U=E.setFBO=B({framebuffer:fe.define.call(null,Fs,"framebuffer")});function V(e,t){var n=0;T.procs.poll();var i=t.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=Ls),"depth"in t&&(r.clearDepth(+t.depth),n|=Rs),"stencil"in t&&(r.clearStencil(0|t.stencil),n|=Ds),ne(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function G(e){if(ne("object"===typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var n=0;n<6;++n)U(t({framebuffer:e.framebuffer.faces[n]},e),V);else U(e,V);else V(null,e)}function q(e){function t(){var t=Vs(I,e);function n(){var e=Vs(I,n);I[e]=I[I.length-1],I.length-=1,I.length<=0&&z()}ne(t>=0,"cannot cancel a frame twice"),I[t]=n}return ne.type(e,"function","regl.frame() callback must be a function"),I.push(e),D(),{cancel:t}}function Z(){var e=A.viewport,t=A.scissor_box;e[0]=e[1]=t[0]=t[1]=0,d.viewportWidth=d.framebufferWidth=d.drawingBufferWidth=e[2]=t[2]=r.drawingBufferWidth,d.viewportHeight=d.framebufferHeight=d.drawingBufferHeight=e[3]=t[3]=r.drawingBufferHeight}function H(){d.tick+=1,d.time=Y(),Z(),T.procs.poll()}function W(){Z(),T.procs.refresh(),l&&l.update()}function Y(){return(de()-p)/1e3}function X(e,t){var n;switch(ne.type(t,"function","listener callback must be a function"),e){case"frame":return q(t);case"lost":n=M;break;case"restore":n=P;break;case"destroy":n=O;break;default:ne.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(t),{cancel:function(){for(var e=0;e<n.length;++e)if(n[e]===t)return n[e]=n[n.length-1],void n.pop()}}}W();var K=t(B,{clear:G,prop:fe.define.bind(null,Fs),context:fe.define.bind(null,Bs),this:fe.define.bind(null,Us),draw:B({}),buffer:function(e){return _.create(e,zs,!1,!1)},elements:function(e){return b.create(e,!1)},texture:w.create2D,cube:w.createCube,renderbuffer:S.create,framebuffer:E.create,framebufferCube:E.createCube,attributes:i,frame:q,on:X,limits:v,hasExtension:function(e){return v.extensions.indexOf(e.toLowerCase())>=0},read:k,destroy:F,_gl:r,_refresh:W,poll:function(){H(),l&&l.update()},now:Y,stats:u});return n.onDone(null,K),K}return Gs}))},fdMe:function(e,t,n){"use strict";function r(e,t){var n=t.callback;return n&&(e.dataArray=e.dataArray.map(n)),e}n.d(t,"a",(function(){return r}))},fo6e:function(e,t){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function r(e){return n.test(e)}e.exports=r},g4R6:function(e,t){function n(e,t,n){return e===e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}e.exports=n},gFfm:function(e,t){function n(e,t){var n=-1,r=null==e?0:e.length;while(++n<r)if(!1===t(e[n],n,e))break;return e}e.exports=n},gMG2:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r={},i={},o=34,a=10,s=13;function u(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function c(e,t){var n=u(e);return function(r,i){return t(n(r),i,e)}}function l(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function p(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function f(e){return e<0?"-"+p(-e,6):e>9999?"+"+p(e,6):p(e,4)}function h(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":f(e.getUTCFullYear(),4)+"-"+p(e.getUTCMonth()+1,2)+"-"+p(e.getUTCDate(),2)+(i?"T"+p(t,2)+":"+p(n,2)+":"+p(r,2)+"."+p(i,3)+"Z":r?"T"+p(t,2)+":"+p(n,2)+":"+p(r,2)+"Z":n||t?"T"+p(t,2)+":"+p(n,2)+"Z":"")}var d=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function p(e,t){var n,r,i=f(e,(function(e,i){if(n)return n(e,i-1);r=e,n=t?c(e,t):u(e)}));return i.columns=r||[],i}function f(e,t){var u,c=[],l=e.length,p=0,f=0,h=l<=0,d=!1;function m(){if(h)return i;if(d)return d=!1,r;var t,u,c=p;if(e.charCodeAt(c)===o){while(p++<l&&e.charCodeAt(p)!==o||e.charCodeAt(++p)===o);return(t=p)>=l?h=!0:(u=e.charCodeAt(p++))===a?d=!0:u===s&&(d=!0,e.charCodeAt(p)===a&&++p),e.slice(c+1,t-1).replace(/""/g,'"')}while(p<l){if((u=e.charCodeAt(t=p++))===a)d=!0;else if(u===s)d=!0,e.charCodeAt(p)===a&&++p;else if(u!==n)continue;return e.slice(c,t)}return h=!0,e.slice(c,l)}e.charCodeAt(l-1)===a&&--l,e.charCodeAt(l-1)===s&&--l;while((u=m())!==i){var g=[];while(u!==r&&u!==i)g.push(u),u=m();t&&null==(g=t(g,f++))||c.push(g)}return c}function d(t,n){return t.map((function(t){return n.map((function(e){return _(t[e])})).join(e)}))}function m(t,n){return null==n&&(n=l(t)),[n.map(_).join(e)].concat(d(t,n)).join("\n")}function g(e,t){return null==t&&(t=l(e)),d(e,t).join("\n")}function v(e){return e.map(y).join("\n")}function y(t){return t.map(_).join(e)}function _(e){return null==e?"":e instanceof Date?h(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:p,parseRows:f,format:m,formatBody:g,formatRows:v,formatRow:y,formatValue:_}},m=d(","),g=m.parse,v=(m.parseRows,m.format,m.formatBody,m.formatRows,m.formatRow,m.formatValue,n("5zYK"));function y(e,t){var n=g(e);return Object(v["a"])(n,t)}},gzZq:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2"),i=n("FV85"),o=n("D9lx"),a=n("LKzl"),s=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=e,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!==typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!==typeof e)throw new Error(r.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=i.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},new a.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=s},h1nZ:function(e,t,n){"use strict";var r=n("fX6N");n.d(t,"container",(function(){return r["c"]})),n.d(t,"createSceneContainer",(function(){return r["b"]})),n.d(t,"createLayerContainer",(function(){return r["a"]})),n.d(t,"lazyInject",(function(){return r["d"]}));n("+em5");var i=n("bB6j");n.d(t,"TYPES",(function(){return i["a"]}));n("8/Fi");var o=n("PUg6");n.d(t,"BlendType",(function(){return o["a"]}));var a=n("cZlC");n.d(t,"AttributeType",(function(){return a["a"]})),n.d(t,"ScaleTypes",(function(){return a["b"]})),n.d(t,"StyleScaleType",(function(){return a["c"]}));var s=n("O1je");n.o(s,"CameraUniform")&&n.d(t,"CameraUniform",(function(){return s["CameraUniform"]})),n.o(s,"CoordinateSystem")&&n.d(t,"CoordinateSystem",(function(){return s["CoordinateSystem"]})),n.o(s,"CoordinateUniform")&&n.d(t,"CoordinateUniform",(function(){return s["CoordinateUniform"]})),n.o(s,"LineLayer")&&n.d(t,"LineLayer",(function(){return s["LineLayer"]})),n.o(s,"MapServiceEvent")&&n.d(t,"MapServiceEvent",(function(){return s["MapServiceEvent"]})),n.o(s,"PointLayer")&&n.d(t,"PointLayer",(function(){return s["PointLayer"]})),n.o(s,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return s["PolygonLayer"]})),n.o(s,"Popup")&&n.d(t,"Popup",(function(){return s["Popup"]})),n.o(s,"PositionType")&&n.d(t,"PositionType",(function(){return s["PositionType"]})),n.o(s,"Scene")&&n.d(t,"Scene",(function(){return s["Scene"]})),n.o(s,"SceneEventList")&&n.d(t,"SceneEventList",(function(){return s["SceneEventList"]})),n.o(s,"gl")&&n.d(t,"gl",(function(){return s["gl"]}));var u=n("L56e");n.d(t,"MapServiceEvent",(function(){return u["a"]}));var c=n("HthE");n.d(t,"CoordinateSystem",(function(){return c["a"]})),n.d(t,"CoordinateUniform",(function(){return c["b"]}));var l=n("/33/");n.o(l,"CameraUniform")&&n.d(t,"CameraUniform",(function(){return l["CameraUniform"]})),n.o(l,"LineLayer")&&n.d(t,"LineLayer",(function(){return l["LineLayer"]})),n.o(l,"PointLayer")&&n.d(t,"PointLayer",(function(){return l["PointLayer"]})),n.o(l,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return l["PolygonLayer"]})),n.o(l,"Popup")&&n.d(t,"Popup",(function(){return l["Popup"]})),n.o(l,"PositionType")&&n.d(t,"PositionType",(function(){return l["PositionType"]})),n.o(l,"Scene")&&n.d(t,"Scene",(function(){return l["Scene"]})),n.o(l,"SceneEventList")&&n.d(t,"SceneEventList",(function(){return l["SceneEventList"]})),n.o(l,"gl")&&n.d(t,"gl",(function(){return l["gl"]}));var p=n("EfZ0");n.d(t,"CameraUniform",(function(){return p["a"]}));var f=n("riiI");n.o(f,"LineLayer")&&n.d(t,"LineLayer",(function(){return f["LineLayer"]})),n.o(f,"PointLayer")&&n.d(t,"PointLayer",(function(){return f["PointLayer"]})),n.o(f,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return f["PolygonLayer"]})),n.o(f,"Popup")&&n.d(t,"Popup",(function(){return f["Popup"]})),n.o(f,"PositionType")&&n.d(t,"PositionType",(function(){return f["PositionType"]})),n.o(f,"Scene")&&n.d(t,"Scene",(function(){return f["Scene"]})),n.o(f,"SceneEventList")&&n.d(t,"SceneEventList",(function(){return f["SceneEventList"]})),n.o(f,"gl")&&n.d(t,"gl",(function(){return f["gl"]}));var h=n("eg+a");n.d(t,"SceneEventList",(function(){return h["a"]}));var d=n("bYl4");n.o(d,"LineLayer")&&n.d(t,"LineLayer",(function(){return d["LineLayer"]})),n.o(d,"PointLayer")&&n.d(t,"PointLayer",(function(){return d["PointLayer"]})),n.o(d,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return d["PolygonLayer"]})),n.o(d,"Popup")&&n.d(t,"Popup",(function(){return d["Popup"]})),n.o(d,"PositionType")&&n.d(t,"PositionType",(function(){return d["PositionType"]})),n.o(d,"Scene")&&n.d(t,"Scene",(function(){return d["Scene"]})),n.o(d,"gl")&&n.d(t,"gl",(function(){return d["gl"]}));var m=n("FI6e");n.o(m,"LineLayer")&&n.d(t,"LineLayer",(function(){return m["LineLayer"]})),n.o(m,"PointLayer")&&n.d(t,"PointLayer",(function(){return m["PointLayer"]})),n.o(m,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return m["PolygonLayer"]})),n.o(m,"Popup")&&n.d(t,"Popup",(function(){return m["Popup"]})),n.o(m,"PositionType")&&n.d(t,"PositionType",(function(){return m["PositionType"]})),n.o(m,"Scene")&&n.d(t,"Scene",(function(){return m["Scene"]})),n.o(m,"gl")&&n.d(t,"gl",(function(){return m["gl"]}));var g=n("D+ow");n.o(g,"LineLayer")&&n.d(t,"LineLayer",(function(){return g["LineLayer"]})),n.o(g,"PointLayer")&&n.d(t,"PointLayer",(function(){return g["PointLayer"]})),n.o(g,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return g["PolygonLayer"]})),n.o(g,"Popup")&&n.d(t,"Popup",(function(){return g["Popup"]})),n.o(g,"PositionType")&&n.d(t,"PositionType",(function(){return g["PositionType"]})),n.o(g,"Scene")&&n.d(t,"Scene",(function(){return g["Scene"]})),n.o(g,"gl")&&n.d(t,"gl",(function(){return g["gl"]}));var v=n("AFH1");n.d(t,"PositionType",(function(){return v["a"]}));var y=n("8uyu");n.o(y,"LineLayer")&&n.d(t,"LineLayer",(function(){return y["LineLayer"]})),n.o(y,"PointLayer")&&n.d(t,"PointLayer",(function(){return y["PointLayer"]})),n.o(y,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return y["PolygonLayer"]})),n.o(y,"Popup")&&n.d(t,"Popup",(function(){return y["Popup"]})),n.o(y,"Scene")&&n.d(t,"Scene",(function(){return y["Scene"]})),n.o(y,"gl")&&n.d(t,"gl",(function(){return y["gl"]}));var _=n("J7lC");n.o(_,"LineLayer")&&n.d(t,"LineLayer",(function(){return _["LineLayer"]})),n.o(_,"PointLayer")&&n.d(t,"PointLayer",(function(){return _["PointLayer"]})),n.o(_,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return _["PolygonLayer"]})),n.o(_,"Popup")&&n.d(t,"Popup",(function(){return _["Popup"]})),n.o(_,"Scene")&&n.d(t,"Scene",(function(){return _["Scene"]})),n.o(_,"gl")&&n.d(t,"gl",(function(){return _["gl"]}));var b=n("QGbF");n.o(b,"LineLayer")&&n.d(t,"LineLayer",(function(){return b["LineLayer"]})),n.o(b,"PointLayer")&&n.d(t,"PointLayer",(function(){return b["PointLayer"]})),n.o(b,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return b["PolygonLayer"]})),n.o(b,"Popup")&&n.d(t,"Popup",(function(){return b["Popup"]})),n.o(b,"Scene")&&n.d(t,"Scene",(function(){return b["Scene"]})),n.o(b,"gl")&&n.d(t,"gl",(function(){return b["gl"]}));n("V1cb");var x=n("bzyH");n.o(x,"LineLayer")&&n.d(t,"LineLayer",(function(){return x["LineLayer"]})),n.o(x,"PointLayer")&&n.d(t,"PointLayer",(function(){return x["PointLayer"]})),n.o(x,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return x["PolygonLayer"]})),n.o(x,"Popup")&&n.d(t,"Popup",(function(){return x["Popup"]})),n.o(x,"Scene")&&n.d(t,"Scene",(function(){return x["Scene"]})),n.o(x,"gl")&&n.d(t,"gl",(function(){return x["gl"]}));var w=n("0eqD");n.o(w,"LineLayer")&&n.d(t,"LineLayer",(function(){return w["LineLayer"]})),n.o(w,"PointLayer")&&n.d(t,"PointLayer",(function(){return w["PointLayer"]})),n.o(w,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return w["PolygonLayer"]})),n.o(w,"Popup")&&n.d(t,"Popup",(function(){return w["Popup"]})),n.o(w,"Scene")&&n.d(t,"Scene",(function(){return w["Scene"]})),n.o(w,"gl")&&n.d(t,"gl",(function(){return w["gl"]}));var S=n("/Uc5");n.o(S,"LineLayer")&&n.d(t,"LineLayer",(function(){return S["LineLayer"]})),n.o(S,"PointLayer")&&n.d(t,"PointLayer",(function(){return S["PointLayer"]})),n.o(S,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return S["PolygonLayer"]})),n.o(S,"Popup")&&n.d(t,"Popup",(function(){return S["Popup"]})),n.o(S,"Scene")&&n.d(t,"Scene",(function(){return S["Scene"]})),n.o(S,"gl")&&n.d(t,"gl",(function(){return S["gl"]}));var E=n("RMtq");n.o(E,"LineLayer")&&n.d(t,"LineLayer",(function(){return E["LineLayer"]})),n.o(E,"PointLayer")&&n.d(t,"PointLayer",(function(){return E["PointLayer"]})),n.o(E,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return E["PolygonLayer"]})),n.o(E,"Popup")&&n.d(t,"Popup",(function(){return E["Popup"]})),n.o(E,"Scene")&&n.d(t,"Scene",(function(){return E["Scene"]})),n.o(E,"gl")&&n.d(t,"gl",(function(){return E["gl"]}));var T=n("1jvM");n.o(T,"LineLayer")&&n.d(t,"LineLayer",(function(){return T["LineLayer"]})),n.o(T,"PointLayer")&&n.d(t,"PointLayer",(function(){return T["PointLayer"]})),n.o(T,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return T["PolygonLayer"]})),n.o(T,"Popup")&&n.d(t,"Popup",(function(){return T["Popup"]})),n.o(T,"Scene")&&n.d(t,"Scene",(function(){return T["Scene"]})),n.o(T,"gl")&&n.d(t,"gl",(function(){return T["gl"]}));n("bPkA");var k=n("PSsN");n.o(k,"LineLayer")&&n.d(t,"LineLayer",(function(){return k["LineLayer"]})),n.o(k,"PointLayer")&&n.d(t,"PointLayer",(function(){return k["PointLayer"]})),n.o(k,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return k["PolygonLayer"]})),n.o(k,"Popup")&&n.d(t,"Popup",(function(){return k["Popup"]})),n.o(k,"Scene")&&n.d(t,"Scene",(function(){return k["Scene"]})),n.o(k,"gl")&&n.d(t,"gl",(function(){return k["gl"]}));var A=n("6NqC");n.o(A,"LineLayer")&&n.d(t,"LineLayer",(function(){return A["LineLayer"]})),n.o(A,"PointLayer")&&n.d(t,"PointLayer",(function(){return A["PointLayer"]})),n.o(A,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return A["PolygonLayer"]})),n.o(A,"Popup")&&n.d(t,"Popup",(function(){return A["Popup"]})),n.o(A,"Scene")&&n.d(t,"Scene",(function(){return A["Scene"]})),n.o(A,"gl")&&n.d(t,"gl",(function(){return A["gl"]}));var C=n("bTtR");n.o(C,"LineLayer")&&n.d(t,"LineLayer",(function(){return C["LineLayer"]})),n.o(C,"PointLayer")&&n.d(t,"PointLayer",(function(){return C["PointLayer"]})),n.o(C,"PolygonLayer")&&n.d(t,"PolygonLayer",(function(){return C["PolygonLayer"]})),n.o(C,"Popup")&&n.d(t,"Popup",(function(){return C["Popup"]})),n.o(C,"Scene")&&n.d(t,"Scene",(function(){return C["Scene"]})),n.o(C,"gl")&&n.d(t,"gl",(function(){return C["gl"]}));var I=n("o+pz");n.d(t,"gl",(function(){return I["a"]}))},h7MG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("doU7"),i=n("MON2"),o=n("FV85"),a=n("xfSm"),s=n("qK8v"),u=n("ujMp"),c=n("oy+k"),l=n("GXnB"),p=n("yMAV"),f=n("fbrv"),h=n("xiII"),d=n("dX1H");function m(e){return e._bindingDictionary}function g(e,t,n,r,i,o){var s=e?a.MULTI_INJECT_TAG:a.INJECT_TAG,u=new l.Metadata(s,n),c=new d.Target(t,r,n,u);if(void 0!==i){var p=new l.Metadata(i,o);c.metadata.push(p)}return c}function v(e,t,n,i,o){var a=b(n.container,o.serviceIdentifier),s=[];return a.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"===typeof o.serviceIdentifier&&e.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(o.serviceIdentifier).toSelf(),a=b(n.container,o.serviceIdentifier)),s=t?a:a.filter((function(e){var t=new h.Request(e.serviceIdentifier,n,i,e,o);return e.constraint(t)})),y(o.serviceIdentifier,s,o,n.container),s}function y(e,t,n,o){switch(t.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var a=u.getServiceIdentifierAsString(e),s=i.NOT_REGISTERED;throw s+=u.listMetadataForTarget(a,n),s+=u.listRegisteredBindingsForServiceIdentifier(o,a,b),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;a=u.getServiceIdentifierAsString(e),s=i.AMBIGUOUS_MATCH+" "+a;throw s+=u.listRegisteredBindingsForServiceIdentifier(o,a,b),new Error(s)}}function _(e,t,n,r,a,s){var u,c;if(null===a){u=v(e,t,r,null,s),c=new h.Request(n,r,null,u,s);var l=new p.Plan(r,c);r.addPlan(l)}else u=v(e,t,r,a,s),c=a.addChildRequest(s.serviceIdentifier,u,s);u.forEach((function(t){var n=null;if(s.isArray())n=c.addChildRequest(t.serviceIdentifier,t,s);else{if(t.cache)return;n=c}if(t.type===o.BindingTypeEnum.Instance&&null!==t.implementationType){var a=f.getDependencies(e,t.implementationType);if(!r.container.options.skipBaseClassChecks){var u=f.getBaseClassDependencyCount(e,t.implementationType);if(a.length<u){var l=i.ARGUMENTS_LENGTH_MISMATCH(f.getFunctionName(t.implementationType));throw new Error(l)}}a.forEach((function(t){_(e,!1,t.serviceIdentifier,r,n,t)}))}}))}function b(e,t){var n=[],r=m(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=b(e.parent,t)),n}function x(e,t,n,r,i,o,a,l){void 0===l&&(l=!1);var p=new c.Context(t),f=g(n,r,i,"",o,a);try{return _(e,l,i,p,null,f),p}catch(h){throw s.isStackOverflowExeption(h)&&p.plan&&u.circularDependencyToException(p.plan.rootRequest),h}}function w(e,t,n,r){var i=new d.Target(o.TargetTypeEnum.Variable,"",t,new l.Metadata(n,r)),a=new c.Context(e),s=new h.Request(t,a,null,[],i);return s}t.getBindingDictionary=m,t.plan=x,t.createMockRequest=w},iegG:function(e,t){function n(e){var t=e.target||e.srcElement;t.__resizeRAF__&&cancelAnimationFrame(t.__resizeRAF__),t.__resizeRAF__=requestAnimationFrame((function(){var n=t.__resizeTrigger__,r=n&&n.__resizeListeners__;r&&r.forEach((function(t){t.call(n,e)}))}))}t=function(e,t){var r,i=this,o=i.document,a=o.attachEvent;function s(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",n)}if("undefined"!==typeof navigator&&(r=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!e.__resizeListeners__)if(e.__resizeListeners__=[],a)e.__resizeTrigger__=e,e.attachEvent("onresize",n);else{"static"===getComputedStyle(e).position&&(e.style.position="relative");var u=e.__resizeTrigger__=o.createElement("object");u.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),u.setAttribute("class","resize-sensor"),u.setAttribute("tabindex","-1"),u.__resizeElement__=e,u.onload=s,u.type="text/html",r&&e.appendChild(u),u.data="about:blank",r||e.appendChild(u)}e.__resizeListeners__.push(t)};e.exports="undefined"===typeof window?t:t.bind(window),e.exports.unbind=function(e,t){var r=document.attachEvent,i=e.__resizeListeners__||[];if(t){var o=i.indexOf(t);-1!==o&&i.splice(o,1)}else i=e.__resizeListeners__=[];if(!i.length){if(r)e.detachEvent("onresize",n);else if(e.__resizeTrigger__){var a=e.__resizeTrigger__.contentDocument,s=a&&a.defaultView;s&&(s.removeEventListener("resize",n),delete s.__resizeTrigger__),e.__resizeTrigger__=!e.removeChild(e.__resizeTrigger__)}delete e.__resizeListeners__}}},"jIg/":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(e){return function(t,n,a){var s=new i.Metadata(r.MULTI_INJECT_TAG,e);"number"===typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}t.multiInject=a},jYx5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(){return function(e,t,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"===typeof n?o.tagParameter(e,t,n,a):o.tagProperty(e,t,a)}}t.optional=a},"jbM+":function(e,t,n){var r=n("R/W3");function i(e,t){var n=null==e?0:e.length;return!!n&&r(e,t,0)>-1}e.exports=i},"k5/I":function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return $}));var r,i=n("lSNA"),o=n.n(i),a=n("lwsE"),s=n.n(a),u=n("W8MJ"),c=n.n(u),l=n("7W2i"),p=n.n(l),f=n("a1gu"),h=n.n(f),d=n("Nsbk"),m=n.n(d),g=n("h1nZ"),v=n("Hel2"),y=n("uhBA");function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){return function(){var t,n=m()(e);if(w()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function w(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(function(e){e["TOPRIGHT"]="topright",e["TOPLEFT"]="topleft",e["BOTTOMRIGHT"]="bottomright",e["BOTTOMLEFT"]="bottomleft"})(r||(r={}));var S=0,E=function(e){p()(n,e);var t=x(n);function n(e){var r;return s()(this,n),r=t.call(this),r.controlOption=void 0,r.container=void 0,r.sceneContainer=void 0,r.mapsService=void 0,r.renderService=void 0,r.layerService=void 0,r.controlService=void 0,r.isShow=void 0,r.controlOption=b({},r.getDefault(),{},e||{}),r}return c()(n,[{key:"getDefault",value:function(){return{position:r.TOPRIGHT,name:"".concat(S++)}}},{key:"setPosition",value:function(e){var t=this.controlService;return t&&t.removeControl(this),this.controlOption.position=e,t&&t.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(e){this.mapsService=e.get(g["TYPES"].IMapService),this.renderService=e.get(g["TYPES"].IRendererService),this.layerService=e.get(g["TYPES"].ILayerService),this.controlService=e.get(g["TYPES"].IControlService),this.sceneContainer=e,this.isShow=!0,this.container=this.onAdd();var t=this.container,n=this.controlOption.position,r=this.controlService.controlCorners[n];return v["a"].addClass(t,"l7-control"),-1!==n.indexOf("bottom")?r.insertBefore(t,r.firstChild):r.appendChild(t),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var e=this.container;v["a"].addClass(e,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var e=this.container;v["a"].removeClass(e,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;v["a"].remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(e){if(this.mapsService&&e&&e.screenX>0&&e.screenY>0){var t=this.mapsService.getContainer();null!==t&&t.focus()}}}]),n}(y["EventEmitter"]),T=n("PJYZ"),k=n.n(T);function A(e){return function(){var t,n=m()(e);if(C()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function C(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(function(e){p()(n,e);var t=A(n);function n(e){var r;return s()(this,n),r=t.call(this,e),r.layerControlInputs=void 0,r.layers=void 0,r.lastZIndex=void 0,r.handlingClick=void 0,r.layersLink=void 0,r.baseLayersList=void 0,r.separator=void 0,r.overlaysList=void 0,r.form=void 0,r.layerControlInputs=[],r.layers=[],r.lastZIndex=0,r.handlingClick=!1,r.initLayers(),Object(v["h"])(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],k()(r)),r}c()(n,[{key:"getDefault",value:function(){return{collapsed:!0,position:g["PositionType"].TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var e=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach((function(t){t.layer.on("remove",e.onLayerChange),t.layer.on("add",e.onLayerChange)})),this.container}},{key:"addVisualLayer",value:function(e,t){return this.addLayer(e,t,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var e=this.renderService.getViewportSize(),t=e.height;v["a"].addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var n=t-(this.container.offsetTop+50);return n<this.form.clientHeight?(v["a"].addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=n+"px"):v["a"].removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return v["a"].removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var e=this;this.mapsService&&(this.mapsService.off("click",this.collapse),this.layers.forEach((function(t){t.layer.off("remove",e.onLayerChange),t.layer.off("add",e.onLayerChange)})))}},{key:"initLayout",value:function(){var e="l7-control-layers",t=this.container=v["a"].create("div",e),n=this.controlOption.collapsed;t.setAttribute("aria-haspopup","true");var r=this.form=v["a"].create("form",e+"-list");n&&(this.mapsService.on("click",this.collapse),t.addEventListener("mouseenter",this.expand),t.addEventListener("mouseleave",this.collapse)),this.layersLink=v["a"].create("a",e+"-toggle",t);var i=this.layersLink;i.title="Layers",n||this.expand(),this.baseLayersList=v["a"].create("div",e+"-base",r),this.separator=v["a"].create("div",e+"-separator",r),this.overlaysList=v["a"].create("div",e+"-overlays",r),t.appendChild(r)}},{key:"initLayers",value:function(){var e=this,t=this.controlOption,n=t.baseLayers,r=void 0===n?{}:n,i=t.overlayers,o=void 0===i?{}:i;Object.keys(r).forEach((function(t,n){e.addLayer(r[t],t,!1)})),Object.keys(o).forEach((function(t,n){e.addLayer(o[t],t,!0)}))}},{key:"update",value:function(){if(!this.container)return this;var e,t,n,r;v["a"].empty(this.baseLayersList),v["a"].empty(this.overlaysList),this.layerControlInputs=[];var i=0;for(n=0;n<this.layers.length;n++)r=this.layers[n],this.addItem(r),t=t||r.overlay,e=e||!r.overlay,i+=r.overlay?0:1;return this.controlOption.hideSingleBase&&(e=e&&i>1,this.baseLayersList.style.display=e?"":"none"),this.separator.style.display=t&&e?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var e,t,n=this.layerControlInputs,r=this.mapsService.getZoom(),i=n.length-1;i>=0;i--)if(e=n[i],t=this.layerService.getLayer(e.layerId),t&&t.inited){var o=t.getMinZoom(),a=t.getMaxZoom();e.disabled=r<o||r>a}}},{key:"addLayer",value:function(e,t,n){this.mapsService&&(e.on("add",this.onLayerChange),e.on("remove",this.onLayerChange)),this.layers.push({layer:e,name:t,overlay:n});var r=this.controlOption,i=r.sortLayers,o=r.sortFunction,a=r.autoZIndex;i&&this.layers.sort((function(e,t){return o(e.layer,t.layer,e.name,t.name)})),a&&e.setZIndex&&(this.lastZIndex++,e.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(e){this.handlingClick||this.update();var t=this.layerService.getLayer(e.target.layerId),n=(null===t||void 0===t?void 0:t.overlay)?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this.emit(n,t)}},{key:"createRadioElement",value:function(e,t){var n='<input type="radio" class="l7-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",r=document.createElement("div");return r.innerHTML=n,r.firstChild}},{key:"addItem",value:function(e){var t,n=document.createElement("label"),r=this.layerService.getLayer(e.layer.id),i=r&&r.inited&&e.layer.isVisible();e.overlay?(t=document.createElement("input"),t.type="checkbox",t.className="l7-control-layers-selector",t.defaultChecked=i):t=this.createRadioElement("l7-base-layers",i),this.layerControlInputs.push(t),t.layerId=e.layer.id,t.addEventListener("click",this.onInputClick);var o=document.createElement("span");o.innerHTML=" "+e.name;var a=document.createElement("div");n.appendChild(a),a.appendChild(t),a.appendChild(o);var s=e.overlay?this.overlaysList:this.baseLayersList;return s.appendChild(n),this.checkDisabledLayers(),n}},{key:"onInputClick",value:function(){var e,t,n=this.layerControlInputs,r=[],i=[];this.handlingClick=!0;for(var o=n.length-1;o>=0;o--)e=n[o],t=this.layerService.getLayer(e.layerId),e.checked?r.push(t):e.checked||i.push(t);i.forEach((function(e){e.hide()})),r.forEach((function(e){e.show()})),this.handlingClick=!1}}])})(E);function I(e){return function(){var t,n=m()(e);if(M()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var P=function(e){p()(n,e);var t=I(n);function n(){return s()(this,n),t.apply(this,arguments)}return c()(n,[{key:"getDefault",value:function(){return{position:r.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var e="l7-control-logo",t=v["a"].create("div",e),n=v["a"].create("a","l7-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://antv.alipay.com/l7",n.setAttribute("aria-label","AntV logo"),n.setAttribute("rel","noopener nofollow"),t.appendChild(n),t}},{key:"onRemove",value:function(){return null}}]),n}(E);function O(e){return function(){var t,n=m()(e);if(L()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function L(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(function(e){p()(n,e);var t=O(n);function n(e){var r;return s()(this,n),r=t.call(this,e),r.mScale=void 0,r.iScale=void 0,Object(v["h"])(["update"],k()(r)),r}c()(n,[{key:"getDefault",value:function(){return{position:r.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var e="l7-control-scale",t=v["a"].create("div",e);this.addScales(e+"-line",t);var n=this.controlOption.updateWhenIdle;return this.mapsService.on(n?"moveend":"mapmove",this.update),this.mapsService.on(n?"zoomend":"zoomchange",this.update),this.update(),t}},{key:"onRemove",value:function(){var e=this.controlOption.updateWhenIdle;this.mapsService.off(e?"zoomend":"zoomchange",this.update),this.mapsService.off(e?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var e=this.mapsService,t=this.controlOption.maxWidth,n=e.getSize()[1]/2,r=e.containerToLngLat([0,n]),i=e.containerToLngLat([t,n]),o=Object(v["o"])([r.lng,r.lat],[i.lng,i.lat]);this.updateScales(o)}},{key:"updateScales",value:function(e){var t=this.controlOption,n=t.metric,r=t.imperial;n&&e&&this.updateMetric(e),r&&e&&this.updateImperial(e)}},{key:"updateMetric",value:function(e){var t=this.getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this.updateScale(this.mScale,n,t/e)}},{key:"updateImperial",value:function(e){var t,n,r,i=3.2808399*e;i>5280?(t=i/5280,n=this.getRoundNum(t),this.updateScale(this.iScale,n+" mi",n/t)):(r=this.getRoundNum(i),this.updateScale(this.iScale,r+" ft",r/i))}},{key:"updateScale",value:function(e,t,n){var r=this.controlOption.maxWidth;e.style.width=Math.round(r*n)+"px",e.innerHTML=t}},{key:"getRoundNum",value:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,t*n}},{key:"addScales",value:function(e,t){var n=this.controlOption,r=n.metric,i=n.imperial;r&&(this.mScale=v["a"].create("div",e,t)),i&&(this.iScale=v["a"].create("div",e,t))}}])})(E);function R(e){return function(){var t,n=m()(e);if(D()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(function(e){p()(n,e);var t=R(n);function n(e){var r;return s()(this,n),r=t.call(this,e),r.disabled=void 0,r.zoomInButton=void 0,r.zoomOutButton=void 0,Object(v["h"])(["updateDisabled","zoomIn","zoomOut"],k()(r)),r}c()(n,[{key:"getDefault",value:function(){return{position:r.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var e="l7-control-zoom",t=v["a"].create("div",e+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,e+"-in",t,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,e+"-out",t,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),t}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(e,t,n,r,i){var o=v["a"].create("a",n,r);return o.innerHTML=e,o.title=t,o.href="javascript:void(0)",o.addEventListener("click",i),o}},{key:"updateDisabled",value:function(){var e=this.mapsService,t="l7-disabled";v["a"].removeClass(this.zoomInButton,t),v["a"].removeClass(this.zoomOutButton,t),(this.disabled||e.getZoom()<=e.getMinZoom())&&v["a"].addClass(this.zoomOutButton,t),(this.disabled||e.getZoom()>=e.getMaxZoom())&&v["a"].addClass(this.zoomInButton,t)}}])})(E);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){return function(){var t,n=m()(e);if(F()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var B=function(e){p()(n,e);var t=j(n);function n(e){var r;return s()(this,n),r=t.call(this),r.markerOption=void 0,r.defaultMarker=void 0,r.popup=void 0,r.mapsService=void 0,r.lngLat=void 0,r.scene=void 0,r.added=!1,r.eventHandle=function(e){r.emit(e.type,{target:e,data:r.markerOption.extData,lngLat:r.lngLat})},r.markerOption=N({},r.getDefault(),{},e),Object(v["h"])(["update","onMove","onUp","addDragHandler","onMapClick"],k()(r)),r.init(),r}return c()(n,[{key:"getDefault",value:function(){return{element:void 0,anchor:v["f"].BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(e){this.scene=e,this.mapsService=e.get(g["TYPES"].IMapService);var t=this.markerOption,n=t.element;t.draggable;return this.mapsService.getMarkerContainer().appendChild(n),this.registerMarkerEvent(n),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var e=this.markerOption.element;return e&&v["a"].remove(e),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(e){var t=this;if(!this.added)return this.once("added",(function(){t.setElement(e)})),this;var n=this.markerOption.element;return n&&v["a"].remove(n),this.markerOption.element=e,this.init(),this.mapsService.getMarkerContainer().appendChild(e),this.registerMarkerEvent(e),this.update(),this}},{key:"openPopup",value:function(){var e=this;if(!this.added)return this.once("added",(function(){e.openPopup()})),this;var t=this.popup;return t?(t.isOpen()||t.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var e=this;this.added||this.once("added",(function(){e.closePopup()}));var t=this.popup;return t&&t.remove(),this}},{key:"setPopup",value:function(e){return this.popup=e,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var e=this.popup;return e?(e.isOpen()?e.remove():e.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(e){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(e){this.markerOption.extData=e}},{key:"update",value:function(){if(this.mapsService){var e=this.markerOption,t=e.element,n=e.anchor;this.updatePosition(),v["a"].setTransform(t,"".concat(v["e"][n]))}}},{key:"onMapClick",value:function(e){var t=this.markerOption.element;this.popup&&t&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var e=this.markerOption,t=e.element,n=e.offsets,r=this.lngLat,i=r.lng,o=r.lat,a=this.mapsService.getBounds(),s=this.mapsService.getZoom();if((i<a[0][0]||i>a[1][0]||o<a[0][1]||o>a[1][1])&&s>3)t&&(t.style.display="none");else{var u=this.mapsService.lngLatToContainer([i,o]);t&&(t.style.display="block",t.style.left=u.x+n[0]+"px",t.style.top=u.y-n[1]+"px")}}}},{key:"init",value:function(){var e=this,t=this.markerOption.element,n=this.markerOption,r=n.color,i=n.anchor;if(!t){this.defaultMarker=!0,t=v["a"].create("div"),this.markerOption.element=t;var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height","48px"),o.setAttributeNS(null,"width","48px"),o.setAttributeNS(null,"viewBox","0 0 1024 1024");var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),a.setAttributeNS(null,"fill",r),o.appendChild(a),t.appendChild(o)}v["a"].addClass(t,"l7-marker"),t.addEventListener("click",(function(t){e.onMapClick(t)})),t.addEventListener("click",this.eventHandle),Object(v["g"])(t,i,"marker")}},{key:"registerMarkerEvent",value:function(e){e.addEventListener("mousemove",this.eventHandle),e.addEventListener("click",this.eventHandle),e.addEventListener("mousedown",this.eventHandle),e.addEventListener("mouseup",this.eventHandle),e.addEventListener("dblclick",this.eventHandle),e.addEventListener("contextmenu",this.eventHandle),e.addEventListener("mouseover",this.eventHandle),e.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var e=this.getElement();e.removeEventListener("mousemove",this.eventHandle),e.removeEventListener("click",this.eventHandle),e.removeEventListener("mousedown",this.eventHandle),e.removeEventListener("mouseup",this.eventHandle),e.removeEventListener("dblclick",this.eventHandle),e.removeEventListener("contextmenu",this.eventHandle),e.removeEventListener("mouseover",this.eventHandle),e.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(e){throw new Error("Method not implemented.")}},{key:"onUp",value:function(e){throw new Error("Method not implemented.")}}]),n}(y["EventEmitter"]),U=n("QkVN"),V=n.n(U),G=n("mpbz"),q=n.n(G);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e){return function(){var t,n=m()(e);if(Y()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function Y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(function(e){p()(n,e);var t=W(n);function n(e){var r,i;return s()(this,n),i=t.call(this),i.markers=[],i.markerLayerOption=void 0,i.clusterIndex=void 0,i.points=[],i.clusterMarkers=[],i.mapsService=void 0,i.scene=void 0,i.zoom=void 0,i.bbox=void 0,i.markerLayerOption=V()(i.getDefault(),e),Object(v["h"])(["update"],k()(i)),i.zoom=(null===(r=i.markerLayerOption.clusterOption)||void 0===r?void 0:r.zoom)||-99,i}c()(n,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(e){return this.scene=e,this.mapsService=e.get(g["TYPES"].IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(e){var t=this.markerLayerOption.cluster;t&&this.addPoint(e,this.markers.length),this.markers.push(e)}},{key:"removeMarker",value:function(e){this.markers.indexOf(e);var t=this.markers.indexOf(e);t>-1&&this.markers.splice(t,1)}},{key:"getMarkers",value:function(){var e=this.markerLayerOption.cluster;return e?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var e=this;this.getMarkers().forEach((function(t){t.addTo(e.scene)}))}},{key:"clear",value:function(){this.markers.forEach((function(e){e.remove()})),this.mapsService.off("camerachange",this.update),this.markers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(e,t){var n=e.getLnglat(),r=n.lng,i=n.lat,o={geometry:{type:"Point",coordinates:[r,i]},properties:H({},e.getExtData(),{marker_id:t})};this.points.push(o)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var e=this.markerLayerOption.clusterOption,t=e.radius,n=e.minZoom,r=void 0===n?0:n,i=e.maxZoom;this.clusterIndex=new q.a({radius:t,minZoom:r,maxZoom:i}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(e,t){var n=this,r=e[0].concat(e[1]),i=this.clusterIndex.getClusters(r,t);this.clusterMarkers.forEach((function(e){e.remove()})),this.clusterMarkers=[],i.forEach((function(e){var t,r=n.markerLayerOption.clusterOption,i=r.field,a=r.method;if(e.properties&&(null===(t=e.properties)||void 0===t?void 0:t.cluster_id)){var s,u=n.getLeaves(null===(s=e.properties)||void 0===s?void 0:s.cluster_id);if(e.properties.clusterData=u,i&&a){var c=null===u||void 0===u?void 0:u.map((function(e){var t=o()({},i,e.properties[i]);return t})),l=v["c"].getColumn(c,i),p=v["c"].getSatByColumn(a,l),f="point_"+a;e.properties[f]=p.toFixed(2)}}var h=n.clusterMarker(e);n.clusterMarkers.push(h),h.addTo(n.scene)}))}},{key:"getLeaves",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e?this.clusterIndex.getLeaves(e,t,n):null}},{key:"clusterMarker",value:function(e){var t=this.markerLayerOption.clusterOption,n=t,r=n.element,i=void 0===r?this.generateElement.bind(this):r,o=new B({element:i(e)}).setLnglat({lng:e.geometry.coordinates[0],lat:e.geometry.coordinates[1]});return o}},{key:"normalMarker",value:function(e){var t=e.properties.marker_id;return this.markers[t]}},{key:"update",value:function(){var e=this.mapsService.getZoom(),t=this.mapsService.getBounds();(!this.bbox||Math.abs(e-this.zoom)>=1||!Object(v["i"])(this.bbox,t))&&(this.bbox=Object(v["p"])(t,.5),this.zoom=Math.floor(e),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(e){var t=v["a"].create("div","l7-marker-cluster"),n=v["a"].create("div","",t),r=v["a"].create("span","",n),i=this.markerLayerOption.clusterOption,o=i.field,a=i.method;e.properties.point_count=e.properties.point_count||1;var s=o&&a?e.properties["point_"+a]||e.properties[o]:e.properties.point_count;return r.textContent=s,t}}])})(y["EventEmitter"]);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e){return function(){var t,n=m()(e);if(Q()){var r=m()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h()(this,t)}}function Q(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var $=function(e){p()(n,e);var t=J(n);function n(e){var r;return s()(this,n),r=t.call(this),r.popupOption=void 0,r.mapsService=void 0,r.lngLat=void 0,r.content=void 0,r.closeButton=void 0,r.timeoutInstance=void 0,r.container=void 0,r.tip=void 0,r.scene=void 0,r.popupOption=K({},r.getdefault(),{},e),Object(v["h"])(["update","onClickClose","remove"],k()(r)),r}return c()(n,[{key:"addTo",value:function(e){var t=this;return this.mapsService=e.get(g["TYPES"].IMapService),this.mapsService.on("camerachange",this.update),this.scene=e,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout((function(){t.mapsService.on("click",t.onClickClose)}),30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(e){var t,n=window.document.createDocumentFragment(),r=window.document.createElement("body");r.innerHTML=e;while(1){if(t=r.firstChild,!t)break;n.appendChild(t)}return this.setDOMContent(n)}},{key:"setLnglat",value:function(e){return this.lngLat=e,Array.isArray(e)&&(this.lngLat={lng:e[0],lat:e[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(e){return this.setDOMContent(window.document.createTextNode(e))}},{key:"setMaxWidth",value:function(e){return this.popupOption.maxWidth=e,this.update(),this}},{key:"setDOMContent",value:function(e){return this.createContent(),this.content.appendChild(e),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&v["a"].remove(this.content),this.content=v["a"].create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=v["a"].create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(e,t,n){var r=window.document.createElement(e);return void 0!==t&&(r.className=t),n&&n.appendChild(r),r}},{key:"removeDom",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:v["f"].BOTTOM,className:""}}},{key:"onClickClose",value:function(e){e.stopPropagation&&e.stopPropagation(),this.remove()}},{key:"update",value:function(){var e=this,t=this.lngLat,n=this.popupOption,r=n.className,i=n.maxWidth,o=n.anchor;if(this.mapsService&&t&&this.content){var a=this.mapsService.getMarkerContainer();!this.container&&a&&(this.container=this.creatDom("div","l7-popup",a.parentNode),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),r&&r.split(" ").forEach((function(t){return e.container.classList.add(t)})),this.container.addEventListener("mousedown",(function(e){e.stopPropagation()})),this.container.addEventListener("click",(function(e){e.stopPropagation()}))),i&&this.container.style.maxWidth!==i&&(this.container.style.maxWidth=i),this.updatePosition(),v["a"].setTransform(this.container,"".concat(v["e"][o])),Object(v["g"])(this.container,o,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var e=this.lngLat,t=e.lng,n=e.lat,r=this.popupOption.offsets,i=this.mapsService.lngLatToContainer([t,n]);this.container.style.left=i.x+r[0]+"px",this.container.style.top=i.y-r[1]+"px"}}}]),n}(y["EventEmitter"]);n("BGjm")('/* @antv/l7-component */\n.l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n }\n\n.l7-marker {\n\tposition: absolute !important;\n\ttop: 0;\n\tleft: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n    -webkit-flex-direction: column-reverse;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: reverse;\n        -ms-flex-direction: column-reverse;\n            flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n\t/* layers control */\n\n.l7-control-layers {\n\t-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);\n\t        box-shadow: 0 1px 5px rgba(0,0,0,0.4);\n\tbackground: #fff;\n\tborder-radius: 5px;\n\t}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n    -webkit-flex-direction: column;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n\n\n.l7-popup-anchor-left {\n    -webkit-flex-direction: row;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: row;\n            flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n    -webkit-flex-direction: row-reverse;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: reverse;\n        -ms-flex-direction: row-reverse;\n            flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-flex;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-top: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n\t-webkit-align-self: flex-start;\n\t-ms-flex-item-align: start;\n\t    align-self: flex-start;\n\tborder-top: none;\n\tborder-left: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n\t-webkit-align-self: flex-end;\n\t-ms-flex-item-align: end;\n\t    align-self: flex-end;\n\tborder-top: none;\n\tborder-right: none;\n\tborder-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-bottom: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n\t-webkit-align-self: flex-start;\n\t-ms-flex-item-align: start;\n\t    align-self: flex-start;\n\tborder-bottom: none;\n\tborder-left: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n\t-webkit-align-self: flex-end;\n\t-ms-flex-item-align: end;\n\t    align-self: flex-end;\n\tborder-bottom: none;\n\tborder-right: none;\n\tborder-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-left: none;\n\tborder-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n\t-webkit-align-self: center;\n\t-ms-flex-item-align: center;\n\t    align-self: center;\n\tborder-right: none;\n\tborder-left-color: #fff;\n}\n\n.l7-popup-close-button {\n\tposition: absolute;\n\tright: 0;\n\ttop: 0;\n\tborder: 0;\n\tpadding: 0;\n\tfont-size: 25px;\n\tline-height: 20px;\n\tborder-radius: 0 3px 0 0;\n\tcursor: pointer;\n\tbackground-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n\tbackground-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n\tposition: relative;\n\tbackground: #fff;\n\tborder-radius: 3px;\n\t-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\t        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\tpadding: 10px 10px 15px;\n\tpointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n\tborder-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n\tborder-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n\tborder-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n\tborder-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n\tdisplay: none;\n}\n\n.l7-popup-track-pointer * {\n\tpointer-events: none;\n\t-webkit-user-select: none;\n\t   -moz-user-select: none;\n\t    -ms-user-select: none;\n\t        user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n\tdisplay: -webkit-box;\n\tdisplay: -webkit-flex;\n\tdisplay: -ms-flexbox;\n\tdisplay: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n\tdisplay: none;\n}\n\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n\t-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);\n\t        box-shadow: 0 1px 5px rgba(0,0,0,0.65);\n\tborder-radius: 4px;\n\t}\n.l7-bar a,\n.l7-bar a:hover {\n\tbackground-color: #fff;\n\twidth: 30px;\n\theight: 30px;\n  font-size: 20px;\n\tdisplay: block;\n\ttext-align: center;\n\ttext-decoration: none;\n\tcolor: #8E9DAB;\n\t}\n.l7-bar a,\n.l7-control-layers-toggle {\n\tbackground-position: 50% 50%;\n\tbackground-repeat: no-repeat;\n\tdisplay: block;\n\t}\n.l7-bar a:hover {\n\tbackground-color: #f4f4f4;\n\t}\n.l7-bar a:first-child {\n\tborder-top-left-radius: 2px;\n\tborder-top-right-radius: 2px;\n\t}\n.l7-bar a:last-child {\n\tborder-bottom-left-radius: 2px;\n\tborder-bottom-right-radius: 2px;\n\tborder-bottom: none;\n\t}\n.l7-bar a.l7-disabled {\n\tcursor: default;\n\tbackground-color: #f4f4f4;\n\tcolor: #bbb;\n\t}\n\n\n/* control positioning */\n\n.l7-control-container {\n\tfont: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n\tdisplay: none;\n}\n.l7-control {\n\tposition: relative;\n\tz-index: 800;\n\tpointer-events: visiblePainted; /* IE 9-10 doesn\'t have auto */\n\tpointer-events: auto;\n\t}\n.l7-control {\n\tfloat: left;\n\tclear: both;\n\t}.l7-top,\n  .l7-bottom {\n    position: absolute;\n    z-index: 1000;\n    pointer-events: none;\n    }\n  .l7-top {\n    top: 0;\n    }\n  .l7-right {\n    right: 0;\n    }\n  .l7-bottom {\n    bottom: 0;\n    }\n  .l7-left {\n    left: 0;\n    }\n\n  .l7-control {\n    float: left;\n    clear: both;\n    }\n  .l7-right .l7-control {\n    float: right;\n    }\n  .l7-top .l7-control {\n    margin-top: 10px;\n    }\n  .l7-bottom .l7-control {\n    margin-bottom: 10px;\n    }\n  .l7-left .l7-control {\n    margin-left: 10px;\n    }\n  .l7-right .l7-control {\n    margin-right: 10px;\n    }\n\n  /* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n\tbackground: #fff;\n\tbackground: rgba(255, 255, 255, 0.7);\n\tmargin: 0;\n\t}\n.l7-control-attribution,\n.l7-control-scale-line {\n\tpadding: 0 5px;\n  color: #333;\n\t}\n.l7-control-attribution a {\n\ttext-decoration: none;\n\t}\n.l7-control-attribution a:hover {\n\ttext-decoration: underline;\n\t}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n\t}\n.l7-left .l7-control-scale {\n\tmargin-left: 5px;\n\t}\n.l7-bottom .l7-control-scale {\n\tmargin-bottom: 5px;\n\t}\n.l7-control-scale-line {\n\tborder: 2px solid #000;\n  border-top: none;\n  color: #000;\n\tline-height: 1.1;\n\tpadding: 2px 5px 1px;\n\tfont-size: 11px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\t-webkit-box-sizing: border-box;\n\t        box-sizing: border-box;\n\n\tbackground: #fff;\n\t}\n.l7-control-scale-line:not(:first-child) {\n\tborder-top: 2px solid #777;\n\tborder-bottom: none;\n\tmargin-top: -2px;\n\t}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n\tborder-bottom: 2px solid #777;\n\t}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n\t-webkit-box-shadow: none;\n\t        box-shadow: none;\n\t}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n\tborder: 2px solid rgba(0,0,0,0.2);\n\tbackground-clip: padding-box;\n  }\n  /*logo */\n\n  .l7-ctrl-logo {\n    background-size: 100% 100%;\n    width: 89px;\n    height: 16px;\n    margin: 0 0 -3px -3px;\n    display: -webkit-box;\n    display: -webkit-flex;\n    display: -ms-flexbox;\n    display: flex;\n    background-repeat: no-repeat;\n    cursor: pointer;\n    background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC\');\n}\n\n\n\t/* layers control */\n\n.l7-control-layers {\n\t-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);\n\t        box-shadow: 0 1px 8px rgba(0,0,0,0.4);\n\tbackground: #fff;\n\tborder-radius: 2px;\n\t}\n.l7-control-layers-toggle {\n\tbackground-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC\');\n\twidth: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n\t}\n\n.l7-touch .l7-control-layers-toggle {\n\twidth: 44px;\n\theight: 44px;\n\t}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n\tdisplay: none;\n\t}\n.l7-control-layers-expanded .l7-control-layers-list {\n\tdisplay: block;\n\tposition: relative;\n\t}\n.l7-control-layers-expanded {\n\tpadding: 6px 10px 6px 6px;\n\tcolor: #59626B;\n\tbackground: #fff;\n\t}\n.l7-control-layers-scrollbar {\n\toverflow-y: scroll;\n\toverflow-x: hidden;\n\tpadding-right: 5px;\n\t}\n.l7-control-layers-selector {\n\tmargin-top: 2px;\n\tposition: relative;\n\ttop: 1px;\n\t}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n  }\n.l7-control-layers label input[type="radio"], input[type="checkbox"]{\n  width: 14px;\n  height: 14px;\n  margin: 0;\n  vertical-align: middle;\n}\n.l7-control-layers-separator {\n\theight: 0;\n\tborder-top: 1px solid #D8D8D8;\n\tmargin: 5px -10px 5px -6px;\n}\n')},"kQ+U":function(e,t,n){"use strict";n.d(t,"a",(function(){return he}));var r,i,o,a,s,u,c,l,p,f,h,d,m,g,v=n("lSNA"),y=n.n(v),_=n("lwsE"),b=n.n(_),x=n("W8MJ"),w=n.n(x),S=n("k5/I"),E=n("h1nZ"),T=n("o0o1"),k=n.n(T),A=n("yXPU"),C=n.n(A),I=n("4cb6"),M=n("fbvF"),P=n.n(M),O=function(){function e(t,n){b()(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,o=n.stride,a=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return w()(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(e){this.buffer.subData(e)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),L=(r={},y()(r,E["gl"].POINTS,"points"),y()(r,E["gl"].LINES,"lines"),y()(r,E["gl"].LINE_LOOP,"line loop"),y()(r,E["gl"].LINE_STRIP,"line strip"),y()(r,E["gl"].TRIANGLES,"triangles"),y()(r,E["gl"].TRIANGLE_FAN,"triangle fan"),y()(r,E["gl"].TRIANGLE_STRIP,"triangle strip"),r),R=(i={},y()(i,E["gl"].STATIC_DRAW,"static"),y()(i,E["gl"].DYNAMIC_DRAW,"dynamic"),y()(i,E["gl"].STREAM_DRAW,"stream"),i),D=(o={},y()(o,E["gl"].BYTE,"int8"),y()(o,E["gl"].UNSIGNED_INT,"int16"),y()(o,E["gl"].INT,"int32"),y()(o,E["gl"].UNSIGNED_BYTE,"uint8"),y()(o,E["gl"].UNSIGNED_SHORT,"uint16"),y()(o,E["gl"].UNSIGNED_INT,"uint32"),y()(o,E["gl"].FLOAT,"float"),o),z=(a={},y()(a,E["gl"].ALPHA,"alpha"),y()(a,E["gl"].LUMINANCE,"luminance"),y()(a,E["gl"].LUMINANCE_ALPHA,"luminance alpha"),y()(a,E["gl"].RGB,"rgb"),y()(a,E["gl"].RGBA,"rgba"),y()(a,E["gl"].RGBA4,"rgba4"),y()(a,E["gl"].RGB5_A1,"rgb5 a1"),y()(a,E["gl"].RGB565,"rgb565"),y()(a,E["gl"].DEPTH_COMPONENT,"depth"),y()(a,E["gl"].DEPTH_STENCIL,"depth stencil"),a),N=(s={},y()(s,E["gl"].DONT_CARE,"dont care"),y()(s,E["gl"].NICEST,"nice"),y()(s,E["gl"].FASTEST,"fast"),s),j=(u={},y()(u,E["gl"].NEAREST,"nearest"),y()(u,E["gl"].LINEAR,"linear"),y()(u,E["gl"].LINEAR_MIPMAP_LINEAR,"mipmap"),y()(u,E["gl"].NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),y()(u,E["gl"].LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),y()(u,E["gl"].NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),u),F=(c={},y()(c,E["gl"].REPEAT,"repeat"),y()(c,E["gl"].CLAMP_TO_EDGE,"clamp"),y()(c,E["gl"].MIRRORED_REPEAT,"mirror"),c),B=(l={},y()(l,E["gl"].NONE,"none"),y()(l,E["gl"].BROWSER_DEFAULT_WEBGL,"browser"),l),U=(p={},y()(p,E["gl"].NEVER,"never"),y()(p,E["gl"].ALWAYS,"always"),y()(p,E["gl"].LESS,"less"),y()(p,E["gl"].LEQUAL,"lequal"),y()(p,E["gl"].GREATER,"greater"),y()(p,E["gl"].GEQUAL,"gequal"),y()(p,E["gl"].EQUAL,"equal"),y()(p,E["gl"].NOTEQUAL,"notequal"),p),V=(f={},y()(f,E["gl"].FUNC_ADD,"add"),y()(f,E["gl"].MIN_EXT,"min"),y()(f,E["gl"].MAX_EXT,"max"),y()(f,E["gl"].FUNC_SUBTRACT,"subtract"),y()(f,E["gl"].FUNC_REVERSE_SUBTRACT,"reverse subtract"),f),G=(h={},y()(h,E["gl"].ZERO,"zero"),y()(h,E["gl"].ONE,"one"),y()(h,E["gl"].SRC_COLOR,"src color"),y()(h,E["gl"].ONE_MINUS_SRC_COLOR,"one minus src color"),y()(h,E["gl"].SRC_ALPHA,"src alpha"),y()(h,E["gl"].ONE_MINUS_SRC_ALPHA,"one minus src alpha"),y()(h,E["gl"].DST_COLOR,"dst color"),y()(h,E["gl"].ONE_MINUS_DST_COLOR,"one minus dst color"),y()(h,E["gl"].DST_ALPHA,"dst alpha"),y()(h,E["gl"].ONE_MINUS_DST_ALPHA,"one minus dst alpha"),y()(h,E["gl"].CONSTANT_COLOR,"constant color"),y()(h,E["gl"].ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),y()(h,E["gl"].CONSTANT_ALPHA,"constant alpha"),y()(h,E["gl"].ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),y()(h,E["gl"].SRC_ALPHA_SATURATE,"src alpha saturate"),h),q=(d={},y()(d,E["gl"].NEVER,"never"),y()(d,E["gl"].ALWAYS,"always"),y()(d,E["gl"].LESS,"less"),y()(d,E["gl"].LEQUAL,"lequal"),y()(d,E["gl"].GREATER,"greater"),y()(d,E["gl"].GEQUAL,"gequal"),y()(d,E["gl"].EQUAL,"equal"),y()(d,E["gl"].NOTEQUAL,"notequal"),d),Z=(m={},y()(m,E["gl"].ZERO,"zero"),y()(m,E["gl"].KEEP,"keep"),y()(m,E["gl"].REPLACE,"replace"),y()(m,E["gl"].INVERT,"invert"),y()(m,E["gl"].INCR,"increment"),y()(m,E["gl"].DECR,"decrement"),y()(m,E["gl"].INCR_WRAP,"increment wrap"),y()(m,E["gl"].DECR_WRAP,"decrement wrap"),m),H=(g={},y()(g,E["gl"].FRONT,"front"),y()(g,E["gl"].BACK,"back"),g),W=function(){function e(t,n){b()(this,e),this.buffer=void 0;var r=n.data,i=n.usage,o=n.type;this.buffer=t.buffer({data:r,usage:R[i||E["gl"].STATIC_DRAW],type:D[o||E["gl"].UNSIGNED_BYTE]})}return w()(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(e){var t=e.data,n=e.offset;this.buffer.subdata(t,n)}}]),e}(),Y=function(){function e(t,n){b()(this,e),this.elements=void 0;var r=n.data,i=n.usage,o=n.type,a=n.count;this.elements=t.elements({data:r,usage:R[i||E["gl"].STATIC_DRAW],type:D[o||E["gl"].UNSIGNED_BYTE],count:a})}return w()(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(e){var t=e.data;this.elements.subdata(t)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),X=function(){function e(t,n){b()(this,e),this.framebuffer=void 0;var r=n.width,i=n.height,o=n.color,a=n.colors,s=(n.depth,n.stencil,{width:r,height:i});Array.isArray(a)&&(s.colors=a.map((function(e){return e.get()}))),o&&"boolean"!==typeof o&&(s.color=o.get()),this.framebuffer=t.framebuffer(s)}return w()(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.framebuffer.resize(t,n)}}]),e}(),K=n("cDf5"),J=n.n(K),Q=n("c6wG"),$=n.n(Q),ee=n("YO3V"),te=n.n(ee);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie,oe,ae,se=function(){function e(t,n){b()(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,i=n.fs,o=n.attributes,a=n.uniforms,s=n.primitive,u=n.count,c=n.elements,l=n.depth,p=n.blend,f=n.stencil,h=n.cull,d=n.instances,m={};a&&(this.uniforms=this.extractUniforms(a),Object.keys(a).forEach((function(e){m[e]=t.prop(e)})));var g={};Object.keys(o).forEach((function(e){g[e]=o[e].get()}));var v={attributes:g,frag:i,uniforms:m,vert:r,primitive:L[void 0===s?E["gl"].TRIANGLES:s]};d&&(v.instances=d),u&&(v.count=u),c&&(v.elements=c.get()),this.initDepthDrawParams({depth:l},v),this.initBlendDrawParams({blend:p},v),this.initStencilDrawParams({stencil:f},v),this.initCullDrawParams({cull:h},v),this.drawCommand=t(v)}return w()(e,[{key:"addUniforms",value:function(e){this.uniforms=re({},this.uniforms,{},this.extractUniforms(e))}},{key:"draw",value:function(e){var t=re({},this.uniforms,{},this.extractUniforms(e.uniforms||{})),n={};Object.keys(t).forEach((function(e){var r=J()(t[e]);"boolean"===r||"number"===r||Array.isArray(t[e])||t[e].BYTES_PER_ELEMENT?n[e]=t[e]:n[e]=t[e].get()})),this.drawCommand(n)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(e,t){var n=e.depth;n&&(t.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:U[n.func||E["gl"].LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(e,t){var n=e.blend;if(n){var r=n.enable,i=n.func,o=n.equation,a=n.color,s=void 0===a?[0,0,0,0]:a;t.blend={enable:!!r,func:{srcRGB:G[i&&i.srcRGB||E["gl"].SRC_ALPHA],srcAlpha:G[i&&i.srcAlpha||E["gl"].SRC_ALPHA],dstRGB:G[i&&i.dstRGB||E["gl"].ONE_MINUS_SRC_ALPHA],dstAlpha:G[i&&i.dstAlpha||E["gl"].ONE_MINUS_SRC_ALPHA]},equation:{rgb:V[o&&o.rgb||E["gl"].FUNC_ADD],alpha:V[o&&o.alpha||E["gl"].FUNC_ADD]},color:s}}}},{key:"initStencilDrawParams",value:function(e,t){var n=e.stencil;if(n){var r=n.enable,i=n.mask,o=void 0===i?-1:i,a=n.func,s=void 0===a?{cmp:E["gl"].ALWAYS,ref:0,mask:-1}:a,u=n.opFront,c=void 0===u?{fail:E["gl"].KEEP,zfail:E["gl"].KEEP,zpass:E["gl"].KEEP}:u,l=n.opBack,p=void 0===l?{fail:E["gl"].KEEP,zfail:E["gl"].KEEP,zpass:E["gl"].KEEP}:l;t.stencil={enable:!!r,mask:o,func:re({},s,{cmp:q[s.cmp]}),opFront:{fail:Z[c.fail],zfail:Z[c.zfail],zpass:Z[c.zpass]},opBack:{fail:Z[p.fail],zfail:Z[p.zfail],zpass:Z[p.zpass]}}}}},{key:"initCullDrawParams",value:function(e,t){var n=e.cull;if(n){var r=n.enable,i=n.face,o=void 0===i?E["gl"].BACK:i;t.cull={enable:!!r,face:H[o]}}}},{key:"extractUniforms",value:function(e){var t=this,n={};return Object.keys(e).forEach((function(r){t.extractUniformsRecursively(r,e[r],n,"")})),n}},{key:"extractUniformsRecursively",value:function(e,t,n,r){var i=this;null===t||"number"===typeof t||"boolean"===typeof t||Array.isArray(t)&&"number"===typeof t[0]||$()(t)||""===t||"resize"in t?n["".concat(r&&r+".").concat(e)]=t:(te()(t)&&Object.keys(t).forEach((function(o){i.extractUniformsRecursively(o,t[o],n,"".concat(r&&r+".").concat(e))})),Array.isArray(t)&&t.forEach((function(t,o){Object.keys(t).forEach((function(a){i.extractUniformsRecursively(a,t[a],n,"".concat(r&&r+".").concat(e,"[").concat(o,"]"))}))})))}}]),e}(),ue=function(){function e(t,n){b()(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,o=void 0===i?E["gl"].UNSIGNED_BYTE:i,a=n.width,s=n.height,u=n.flipY,c=void 0!==u&&u,l=n.format,p=void 0===l?E["gl"].RGBA:l,f=n.mipmap,h=void 0!==f&&f,d=n.wrapS,m=void 0===d?E["gl"].CLAMP_TO_EDGE:d,g=n.wrapT,v=void 0===g?E["gl"].CLAMP_TO_EDGE:g,y=n.aniso,_=void 0===y?0:y,x=n.alignment,w=void 0===x?1:x,S=n.premultiplyAlpha,T=void 0!==S&&S,k=n.mag,A=void 0===k?E["gl"].NEAREST:k,C=n.min,I=void 0===C?E["gl"].NEAREST:C,M=n.colorSpace,P=void 0===M?E["gl"].BROWSER_DEFAULT_WEBGL:M;this.width=a,this.height=s;var O={width:a,height:s,type:D[o],format:z[p],wrapS:F[m],wrapT:F[v],mag:j[A],min:j[I],alignment:w,flipY:c,colorSpace:B[P],premultiplyAlpha:T,aniso:_};r&&(O.data=r),"number"===typeof h?O.mipmap=N[h]:"boolean"===typeof h&&(O.mipmap=h),this.texture=t.texture(O)}return w()(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(e){var t=e.width,n=e.height;this.texture.resize(t,n),this.width=t,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),ce=(ie=Object(I["injectable"])(),ie((ae=function(){function e(){var t=this;b()(this,e),this.gl=void 0,this.$container=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(e){return new se(t.gl,e)},this.createAttribute=function(e){return new O(t.gl,e)},this.createBuffer=function(e){return new W(t.gl,e)},this.createElements=function(e){return new Y(t.gl,e)},this.createTexture2D=function(e){return new ue(t.gl,e)},this.createFramebuffer=function(e){return new X(t.gl,e)},this.useFramebuffer=function(e,n){t.gl({framebuffer:e?e.get():null})(n)},this.clear=function(e){var n=e.color,r=e.depth,i=e.stencil,o=e.framebuffer,a=void 0===o?null:o,s={color:n,depth:r,stencil:i};s.framebuffer=null===a?a:a.get(),t.gl.clear(s)},this.viewport=function(e){var n,r=e.x,i=e.y,o=e.width,a=e.height,s=null===(n=t.$container)||void 0===n?void 0:n.getElementsByTagName("canvas")[0];s&&(s.width=o,s.height=a,s.style.width=o/2+"px",s.style.height=a/2+"px"),t.gl._gl.viewport(r,i,o,a),t.width=o,t.height=a,t.gl._refresh()},this.readPixels=function(e){var n=e.framebuffer,r=e.x,i=e.y,o=e.width,a=e.height,s={x:r,y:i,width:o,height:a};return n&&(s.framebuffer=n.get()),t.gl.read(s)},this.getViewportSize=function(){return{width:t.gl._gl.drawingBufferWidth,height:t.gl._gl.drawingBufferHeight}},this.getContainer=function(){return t.$container},this.getCanvas=function(){var e;return(null===(e=t.$container)||void 0===e?void 0:e.getElementsByTagName("canvas")[0])||null},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl.destroy()}}return w()(e,[{key:"init",value:function(){var e=C()(k.a.mark((function e(t,n){return k.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$container=t,e.next=3,new Promise((function(e,r){P()({container:t,attributes:{alpha:!0,antialias:n.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:n.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(t,n){!t&&n||r(t),e(n)}})}));case 3:this.gl=e.sent;case 4:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var e=this.getGLContext();e.disable(e.CULL_FACE)}},{key:"setDirty",value:function(e){this.isDirty=e}},{key:"getDirty",value:function(){return this.isDirty}}]),e}(),oe=ae))||oe),le=n("Hel2");function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(){function e(t){b()(this,e),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var n=t.id,r=t.map,i=Object(E["createSceneContainer"])();this.container=i,r.setContainer(i,n),i.bind(E["TYPES"].IRendererService).to(ce).inSingletonScope(),this.sceneService=i.get(E["TYPES"].ISceneService),this.mapService=i.get(E["TYPES"].IMapService),this.iconService=i.get(E["TYPES"].IIconService),this.fontService=i.get(E["TYPES"].IFontService),this.controlService=i.get(E["TYPES"].IControlService),this.layerService=i.get(E["TYPES"].ILayerService),this.markerService=i.get(E["TYPES"].IMarkerService),this.interactionService=i.get(E["TYPES"].IInteractionService),this.popupService=i.get(E["TYPES"].IPopupService),this.initComponent(n),this.sceneService.init(t),this.initControl()}return w()(e,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(e){return this.sceneService.exportPng(e)}},{key:"exportMap",value:function(e){return this.sceneService.exportPng(e)}},{key:"registerRenderService",value:function(e){var t=this;if(this.sceneService.loaded){var n=new e(this);n.init()}else this.on("loaded",(function(){var n=new e(t);n.init()}))}},{key:"addLayer",value:function(e){var t=Object(E["createLayerContainer"])(this.container);e.setContainer(t),this.sceneService.addLayer(e)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(e){return this.layerService.getLayer(e)}},{key:"getLayerByName",value:function(e){return this.layerService.getLayerByName(e)}},{key:"removeLayer",value:function(e){this.layerService.remove(e)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(e,t){this.iconService.addImage(e,t)}},{key:"hasImage",value:function(e){this.iconService.hasImage(e)}},{key:"removeImage",value:function(e){this.iconService.removeImage(e)}},{key:"addIconFontGlyphs",value:function(e,t){this.fontService.addIconGlyphs(t)}},{key:"addControl",value:function(e){this.controlService.addControl(e,this.container)}},{key:"removeControl",value:function(e){this.controlService.removeControl(e)}},{key:"getControlByName",value:function(e){return this.controlService.getControlByName(e)}},{key:"addMarker",value:function(e){this.markerService.addMarker(e)}},{key:"addMarkerLayer",value:function(e){this.markerService.addMarkerLayer(e)}},{key:"removeMarkerLayer",value:function(e){this.markerService.removeMarkerLayer(e)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(e){this.popupService.addPopup(e)}},{key:"on",value:function(e,t){-1===E["SceneEventList"].indexOf(e)?this.mapService.on(e,t):this.sceneService.on(e,t)}},{key:"off",value:function(e,t){-1===E["SceneEventList"].indexOf(e)?this.mapService.off(e,t):this.sceneService.off(e,t)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(e){return this.mapService.setCenter(e)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(e){return this.mapService.setPitch(e)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(e){this.mapService.setRotation(e)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(e){this.mapService.panTo(e)}},{key:"panBy",value:function(e){this.mapService.panTo(e)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(e){this.mapService.setZoom(e)}},{key:"fitBounds",value:function(e,t){var n=this.sceneService.getSceneConfig(),r=n.fitBoundsOptions,i=n.animate;this.mapService.fitBounds(e,t||fe({},r,{animate:i}))}},{key:"setZoomAndCenter",value:function(e,t){this.mapService.setZoomAndCenter(e,t)}},{key:"setMapStyle",value:function(e){this.mapService.setMapStyle(e)}},{key:"setMapStatus",value:function(e){this.mapService.setMapStatus(e)}},{key:"pixelToLngLat",value:function(e){return this.mapService.pixelToLngLat(e)}},{key:"lngLatToPixel",value:function(e){return this.mapService.lngLatToPixel(e)}},{key:"containerToLngLat",value:function(e){return this.mapService.containerToLngLat(e)}},{key:"lngLatToContainer",value:function(e){return this.mapService.lngLatToContainer(e)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(e,t){this.container.bind(E["TYPES"].IPostProcessingPass).to(e).whenTargetNamed(t)}},{key:"initComponent",value:function(e){this.controlService.init({container:le["a"].getContainer(e)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var e=this.sceneService.getSceneConfig(),t=e.logoVisible,n=e.logoPosition;t&&this.addControl(new S["a"]({position:n}))}},{key:"map",get:function(){return this.mapService.map}}]),e}()},l94r:function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var r=n("lSNA"),i=n.n(r),o=n("lwsE"),a=n.n(o),s=n("W8MJ"),u=n.n(s),c=n("7W2i"),l=n.n(c),p=n("a1gu"),f=n.n(p),h=n("Nsbk"),d=n.n(h),m=n("4qC0"),g=n.n(m),v=n("lSCD"),y=n.n(v),_=n("BkRI"),b=n.n(_),x=n("xp6e"),w=n("Hel2"),S=n("uhBA"),E=n("rlAn"),T=n("qxNg");function k(e){if(0===e.length)throw new Error("max requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t}function A(e){if(0===e.length)throw new Error("min requires at least one data point");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t}function C(e){if(0===e.length)return 0;for(var t,n=e[0],r=0,i=1;i<e.length;i++)t=n+1*e[i],Math.abs(n)>=Math.abs(e[i])?r+=n-t+e[i]:r+=e[i]-t+n,n=t;return n+1*r}function I(e){if(0===e.length)throw new Error("mean requires at least one data point");return C(e)/e.length}var M={min:A,max:k,mean:I,sum:C};function P(e,t){return e.map((function(e){return 1*e[t]}))}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e){return function(){var t,n=d()(e);if(D()){var r=d()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f()(this,t)}}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var z=function(e){l()(n,e);var t=R(n);function n(e,r){var i;return a()(this,n),i=t.call(this),i.data=void 0,i.extent=void 0,i.hooks={init:new x["c"]},i.parser={type:"geojson"},i.transforms=[],i.cluster=!1,i.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},i.originData=void 0,i.rawData=void 0,i.clusterIndex=void 0,i.rawData=b()(e),i.originData=e,r&&(r.parser&&(i.parser=r.parser),r.transforms&&(i.transforms=r.transforms),i.cluster=r.cluster||!1,r.clusterOptions&&(i.cluster=!0,i.clusterOptions=L({},i.clusterOptions,{},r.clusterOptions))),i.hooks.init.tap("parser",(function(){i.excuteParser()})),i.hooks.init.tap("cluster",(function(){i.initCluster()})),i.hooks.init.tap("transform",(function(){i.executeTrans()})),i.init(),i}return u()(n,[{key:"setData",value:function(e){this.rawData=e,this.originData=b()(e),this.init(),this.emit("update")}},{key:"getClusters",value:function(e){return this.clusterIndex.getClusters(this.extent,e)}},{key:"getClustersLeaves",value:function(e){return this.clusterIndex.getLeaves(e,1/0)}},{key:"updateClusterData",value:function(e){var t=this,n=this.clusterOptions,r=n.method,i=void 0===r?"sum":r,o=n.field,a=this.clusterIndex.getClusters(this.extent,Math.floor(e));this.clusterOptions.zoom=e,a.forEach((function(e){e.id||(e.properties.point_count=1)})),(o||y()(i))&&(a=a.map((function(e){var n=e.id;if(n){var r,a=t.clusterIndex.getLeaves(n,1/0),s=a.map((function(e){return e.properties}));if(g()(i)&&o){var u=P(s,o);r=M[i](u)}y()(i)&&(r=i(s)),e.properties.stat=r}else e.properties.point_count=1;return e}))),this.data=Object(E["getParser"])("geojson")({type:"FeatureCollection",features:a}),this.executeTrans()}},{key:"getFeatureById",value:function(e){var t=this.parser.type,n=void 0===t?"geojson":t;return"geojson"!==n||this.cluster||0!==this.transforms.length?e<this.data.dataArray.length?this.data.dataArray[e]:"null":e<this.originData.features.length?this.originData.features[e]:"null"}},{key:"getFeatureId",value:function(e,t){var n=this.data.dataArray.find((function(t){return t[e]===name}));return null===n||void 0===n?void 0:n._id}},{key:"excuteParser",value:function(){var e=this.parser,t=e.type||"geojson",n=Object(E["getParser"])(t);this.data=n(this.originData,e),this.extent=Object(w["l"])(this.data.dataArray)}},{key:"executeTrans",value:function(){var e=this,t=this.transforms;t.forEach((function(t){var n=t.type,r=Object(E["getTransform"])(n)(e.data,t);Object.assign(e.data,r)}))}},{key:"initCluster",value:function(){if(this.cluster){var e=this.clusterOptions||{};this.clusterIndex=Object(T["a"])(this.data,e)}}},{key:"init",value:function(){this.hooks.init.call(this)}}]),n}(S["EventEmitter"])},lJbI:function(e,t,n){"use strict";function r(e,t){var n=t.extent,r=t.width,i=t.height,o=t.min,a=t.max,s={_id:1,dataArray:[{_id:1,data:Array.from(e),width:r,height:i,min:o,max:a,coordinates:[[n[0],n[1]],[n[2],n[3]]]}]};return s}n.d(t,"a",(function(){return r}))},lg4T:function(e,t,n){"use strict";n.d(t,"a",(function(){return qe}));var r,i,o,a,s,u,c=n("lwsE"),l=n.n(c),p=n("W8MJ"),f=n.n(p),h=n("7W2i"),d=n.n(h),m=n("a1gu"),g=n.n(m),v=n("Nsbk"),y=n.n(v),_=n("lSNA"),b=n.n(_),x=n("yG8O"),w=n.n(x),S=n("U+yc"),E=n.n(S),T=(n("1ABj"),n("h1nZ"));function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=(r=Object(T["lazyInject"])(T["TYPES"].ILogService),i=Object(T["lazyInject"])(T["TYPES"].IGlobalConfigService),u=function(){function e(t){l()(this,e),w()(this,"logger",a,this),w()(this,"configService",s,this),this.config=void 0,this.config=t}return f()(e,[{key:"setContainer",value:function(e,t){e.bind(T["TYPES"].MapConfig).toConstantValue(A({},this.config,{id:t})),e.bind(T["TYPES"].IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),e}(),o=u,a=E()(o.prototype,"logger",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=E()(o.prototype,"configService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o),I=n("o0o1"),M=n.n(I),P=n("QILm"),O=n.n(P),L=n("yXPU"),R=n.n(L),D=n("Hel2"),z=n("IOcx"),N=n("4cb6"),j=n("4ZJM"),F=n.n(j),B=n("1OyB"),U=n("vuIU"),V=n("md7G"),G=n("foSv"),q=n("Ji7U"),Z=n("JX7q"),H=n("ODXe"),W=n("bl9R");function Y(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function X(e,t){var n=W["transformMat4"]([],t,e);return W["scale"](n,n,1/n[3]),n}var K=n("ZaHm"),J=n("ZxFD"),Q=n("n+fv");function $(e,t){if(!e)throw new Error(t||"viewport-mercator-project: assertion failed.")}var ee=Math.PI,te=ee/4,ne=ee/180,re=180/ee,ie=512,oe=4003e4,ae=1.5;function se(e){return Math.pow(2,e)}function ue(e,t){var n=Object(H["a"])(e,2),r=n[0],i=n[1];$(Number.isFinite(r)&&Number.isFinite(t)),$(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),t*=ie;var o=r*ne,a=i*ne,s=t*(o+ee)/(2*ee),u=t*(ee-Math.log(Math.tan(te+.5*a)))/(2*ee);return[s,u]}function ce(e,t){var n=Object(H["a"])(e,2),r=n[0],i=n[1];t*=ie;var o=r/t*(2*ee)-ee,a=2*(Math.atan(Math.exp(ee-i/t*(2*ee)))-te);return[o*re,a*re]}function le(e){var t=e.latitude,n=e.longitude,r=e.zoom,i=e.scale,o=e.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:se(r),$(Number.isFinite(t)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=ie*i,c=Math.cos(t*ne),l=u/360,p=l/c,f=u/oe/c;if(s.pixelsPerMeter=[f,-f,f],s.metersPerPixel=[1/f,-1/f,1/f],s.pixelsPerDegree=[l,-p,f],s.degreesPerPixel=[1/l,-1/p,1/f],a){var h=ne*Math.tan(t*ne)/c,d=l*h/2,m=u/oe*h,g=m/p*f;s.pixelsPerDegree2=[0,-d,m],s.pixelsPerMeter2=[g,0,g]}return s}function pe(e){var t=e.height,n=e.pitch,r=e.bearing,i=e.altitude,o=e.center,a=void 0===o?null:o,s=e.flipY,u=void 0!==s&&s,c=Y();return K["translate"](c,c,[0,0,-i]),K["scale"](c,c,[1,1,1/t]),K["rotateX"](c,c,-n*ne),K["rotateZ"](c,c,r*ne),u&&K["scale"](c,c,[1,-1,1]),a&&K["translate"](c,c,Q["negate"]([],a)),c}function fe(e){var t=e.width,n=e.height,r=e.altitude,i=void 0===r?ae:r,o=e.pitch,a=void 0===o?0:o,s=e.nearZMultiplier,u=void 0===s?1:s,c=e.farZMultiplier,l=void 0===c?1:c,p=a*ne,f=Math.atan(.5/i),h=Math.sin(f)*i/Math.sin(Math.PI/2-p-f),d=Math.cos(Math.PI/2-p)*h+i;return{fov:2*Math.atan(n/2/i),aspect:t/n,focalDistance:i,near:u,far:d*l}}function he(e){var t=e.width,n=e.height,r=e.pitch,i=e.altitude,o=e.nearZMultiplier,a=e.farZMultiplier,s=fe({width:t,height:n,altitude:i,pitch:r,nearZMultiplier:o,farZMultiplier:a}),u=s.fov,c=s.aspect,l=s.near,p=s.far,f=K["perspective"]([],u,c,l,p);return f}function de(e,t){var n=Object(H["a"])(e,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return $(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),X(t,[r,i,a,1])}function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(H["a"])(e,3),i=r[0],o=r[1],a=r[2];if($(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){var s=X(t,[i,o,a,1]);return s}var u=X(t,[i,o,0,1]),c=X(t,[i,o,1,1]),l=u[2],p=c[2],f=l===p?0:((n||0)-l)/(p-l);return J["lerp"]([],u,c,f)}var ge=Y(),ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width,r=t.height,i=t.viewMatrix,o=void 0===i?ge:i,a=t.projectionMatrix,s=void 0===a?ge:a;Object(B["a"])(this,e),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=s;var u=Y();K["multiply"](u,u,this.projectionMatrix),K["multiply"](u,u,this.viewMatrix),this.viewProjectionMatrix=u;var c=Y();K["scale"](c,c,[this.width/2,-this.height/2,1]),K["translate"](c,c,[1,-1,0]),K["multiply"](c,c,this.viewProjectionMatrix);var l=K["invert"](Y(),c);if(!l)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=c,this.pixelUnprojectionMatrix=l,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(U["a"])(e,[{key:"equals",value:function(t){return t instanceof e&&(t.width===this.width&&t.height===this.height&&K["equals"](t.projectionMatrix,this.projectionMatrix)&&K["equals"](t.viewMatrix,this.viewMatrix))}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=void 0===n||n,i=this.projectPosition(e),o=de(i,this.pixelProjectionMatrix),a=Object(H["a"])(o,2),s=a[0],u=a[1],c=r?u:this.height-u;return 2===e.length?[s,c]:[s,c,o[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=void 0===n||n,i=t.targetZ,o=Object(H["a"])(e,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.pixelsPerMeter,p=me([a,c,u],this.pixelUnprojectionMatrix,l),f=this.unprojectPosition(p),h=Object(H["a"])(f,3),d=h[0],m=h[1],g=h[2];return Number.isFinite(u)?[d,m,g]:Number.isFinite(i)?[d,m,i]:[d,m]}},{key:"projectPosition",value:function(e){var t=this.projectFlat(e),n=Object(H["a"])(t,2),r=n[0],i=n[1],o=(e[2]||0)*this.pixelsPerMeter;return[r,i,o]}},{key:"unprojectPosition",value:function(e){var t=this.unprojectFlat(e),n=Object(H["a"])(t,2),r=n[0],i=n[1],o=(e[2]||0)/this.pixelsPerMeter;return[r,i,o]}},{key:"projectFlat",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return e}},{key:"unprojectFlat",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return e}}]),e}();function ye(e){var t=e.width,n=e.height,r=e.bounds,i=e.minExtent,o=void 0===i?0:i,a=e.maxZoom,s=void 0===a?24:a,u=e.padding,c=void 0===u?0:u,l=e.offset,p=void 0===l?[0,0]:l,f=Object(H["a"])(r,2),h=Object(H["a"])(f[0],2),d=h[0],m=h[1],g=Object(H["a"])(f[1],2),v=g[0],y=g[1];if(Number.isFinite(c)){var _=c;c={top:_,bottom:_,left:_,right:_}}else $(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var b=new Le({width:t,height:n,longitude:0,latitude:0,zoom:0}),x=b.project([d,y]),w=b.project([v,m]),S=[Math.max(Math.abs(w[0]-x[0]),o),Math.max(Math.abs(w[1]-x[1]),o)],E=[t-c.left-c.right-2*Math.abs(p[0]),n-c.top-c.bottom-2*Math.abs(p[1])];$(E[0]>0&&E[1]>0);var T=E[0]/S[0],k=E[1]/S[1],A=(c.right-c.left)/2/T,C=(c.bottom-c.top)/2/k,I=[(w[0]+x[0])/2+A,(w[1]+x[1])/2+C],M=b.unproject(I),P=b.zoom+Math.log2(Math.abs(Math.min(T,k)));return{longitude:M[0],latitude:M[1],zoom:Math.min(P,s)}}var _e,be,xe,we,Se,Ee,Te,ke,Ae,Ce,Ie,Me,Pe,Oe,Le=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=void 0===o?0:o,s=n.longitude,u=void 0===s?0:s,c=n.zoom,l=void 0===c?0:c,p=n.pitch,f=void 0===p?0:p,h=n.bearing,d=void 0===h?0:h,m=n.altitude,g=void 0===m?1.5:m,v=n.nearZMultiplier,y=n.farZMultiplier;Object(B["a"])(this,t),r=r||1,i=i||1;var _=se(l);g=Math.max(.75,g);var b=ue([u,a],_);b[2]=0;var x=he({width:r,height:i,pitch:f,bearing:d,altitude:g,nearZMultiplier:v||1/i,farZMultiplier:y||1.01}),w=pe({height:i,center:b,pitch:f,bearing:d,altitude:g,flipY:!0});return e=Object(V["a"])(this,Object(G["a"])(t).call(this,{width:r,height:i,viewMatrix:w,projectionMatrix:x})),e.latitude=a,e.longitude=u,e.zoom=l,e.pitch=f,e.bearing=d,e.altitude=g,e.scale=_,e.center=b,e.pixelsPerMeter=le(Object(Z["a"])(Object(Z["a"])(e))).pixelsPerMeter[2],Object.freeze(Object(Z["a"])(Object(Z["a"])(e))),e}return Object(q["a"])(t,e),Object(U["a"])(t,[{key:"projectFlat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return ue(e,t)}},{key:"unprojectFlat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return ce(e,t)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t=e.lngLat,n=e.pos,r=me(n,this.pixelUnprojectionMatrix),i=ue(t,this.scale),o=J["add"]([],i,J["negate"]([],r)),a=J["add"]([],this.center,o);return ce(a,this.scale)}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,n=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:n})}},{key:"fitBounds",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=ye(Object.assign({width:r,height:i,bounds:e},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new t({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),t}(ve),Re=function(){function e(){l()(this,e),this.viewport=void 0}return f()(e,[{key:"syncWithMapCamera",value:function(e){var t=e.center,n=e.zoom,r=e.pitch,i=e.bearing,o=e.viewportHeight,a=e.viewportWidth;this.viewport=new Le({width:a,height:o,longitude:t&&t[0],latitude:t&&t[1],zoom:n,pitch:r,bearing:i})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(e,t){return this.viewport.projectFlat(e,t)}}]),e}(),De={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}};function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n("BGjm")("/* @antv/l7-maps */\n.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:\"\";cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),n("BGjm")("/* @antv/l7-maps */\n.mapboxgl-ctrl-logo {\n display: none !important;\n}\n");var je={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Fe=12,Be="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Ue=(_e=Object(N["injectable"])(),be=Object(N["inject"])(T["TYPES"].MapConfig),xe=Object(N["inject"])(T["TYPES"].IGlobalConfigService),we=Object(N["inject"])(T["TYPES"].ILogService),Se=Object(N["inject"])(T["TYPES"].ICoordinateSystemService),Ee=Object(N["inject"])(T["TYPES"].IEventEmitter),_e((Oe=function(){function e(){var t=this;l()(this,e),this.map=void 0,w()(this,"config",Ae,this),w()(this,"configService",Ce,this),w()(this,"logger",Ie,this),w()(this,"coordinateSystemService",Me,this),w()(this,"eventEmitter",Pe,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var e=t.map.getCenter().wrap(),n=e.lat,r=e.lng;t.viewport.syncWithMapCamera({bearing:t.map.getBearing(),center:[r,n],viewportHeight:t.map.transform.height,pitch:t.map.getPitch(),viewportWidth:t.map.transform.width,zoom:t.map.getZoom(),cameraHeight:0}),t.viewport.getZoom()>Fe?t.coordinateSystemService.setCoordinateSystem(T["CoordinateSystem"].LNGLAT_OFFSET):t.coordinateSystemService.setCoordinateSystem(T["CoordinateSystem"].LNGLAT),t.cameraChangedCallback(t.viewport)}}return f()(e,[{key:"addMarkerContainer",value:function(){var e=this.map.getCanvasContainer();this.markerContainer=D["a"].create("div","l7-marker-container",e)}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(e,t){-1!==T["MapServiceEvent"].indexOf(e)?this.eventEmitter.on(e,t):this.map.on(je[e]||e,t)}},{key:"off",value:function(e,t){this.map.off(je[e]||e,t)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var e=this.map.transform;return[e.width,e.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(e){return this.map.setZoom(e)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(e){this.map.setCenter(e)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(e){this.map.setBearing(e)}},{key:"zoomIn",value:function(e,t){this.map.zoomIn(e,t)}},{key:"zoomOut",value:function(e,t){this.map.zoomOut(e,t)}},{key:"setPitch",value:function(e){return this.map.setPitch(e)}},{key:"panTo",value:function(e){this.map.panTo(e)}},{key:"panBy",value:function(e){this.panTo(e)}},{key:"fitBounds",value:function(e,t){this.map.fitBounds(e,t)}},{key:"setMaxZoom",value:function(e){this.map.setMaxZoom(e)}},{key:"setMinZoom",value:function(e){this.map.setMinZoom(e)}},{key:"setMapStatus",value:function(e){!0===e.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===e.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===e.dragEnable&&this.map.dragPan.disable(),!0===e.dragEnable&&this.map.dragPan.enable(),!1===e.rotateEnable&&this.map.dragRotate.disable(),!0===e.dragEnable&&this.map.dragRotate.enable(),!1===e.keyboardEnable&&this.map.keyboard.disable(),!0===e.keyboardEnable&&this.map.keyboard.enable(),!1===e.zoomEnable&&this.map.scrollZoom.disable(),!0===e.zoomEnable&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(e,t){this.map.flyTo({zoom:e,center:t})}},{key:"setMapStyle",value:function(e){this.map.setStyle(this.getMapStyle(e))}},{key:"pixelToLngLat",value:function(e){return this.map.unproject(e)}},{key:"lngLatToPixel",value:function(e){return this.map.project(e)}},{key:"containerToLngLat",value:function(e){return this.map.unproject(e)}},{key:"lngLatToContainer",value:function(e){return this.map.project(e)}},{key:"lngLatToMercator",value:function(e,t){var n=F.a.MercatorCoordinate.fromLngLat(e,t),r=n.x,i=void 0===r?0:r,o=n.y,a=void 0===o?0:o,s=n.z,u=void 0===s?0:s;return{x:i,y:a,z:u}}},{key:"getModelMatrix",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0,z:0},o=F.a.MercatorCoordinate.fromLngLat(e,t),a=o.meterInMercatorCoordinateUnits(),s=z["a"].create();return z["a"].translate(s,s,z["c"].fromValues(o.x-i.x,o.y-i.y,o.z||0-i.z)),z["a"].scale(s,s,z["c"].fromValues(a*r[0],-a*r[1],a*r[2])),z["a"].rotateX(s,s,n[0]),z["a"].rotateY(s,s,n[1]),z["a"].rotateZ(s,s,n[2]),s}},{key:"init",value:function(){var e=R()(M.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l,p,f,h;return M.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.config,n=t.id,r=void 0===n?"map":n,i=t.attributionControl,o=void 0!==i&&i,a=t.style,s=void 0===a?"light":a,u=t.token,c=void 0===u?Be:u,l=t.rotation,p=void 0===l?0:l,f=t.mapInstance,h=O()(t,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new Re,f||F.a||this.logger.error(this.configService.getSceneWarninfo("SDK")),c!==Be||"blank"===s||F.a.accessToken||f||this.logger.warn(this.configService.getSceneWarninfo("MapToken")),f||F.a.accessToken||(F.a.accessToken=c),f?(this.map=f,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(r),this.map=new F.a.Map(Ne({container:this.$mapContainer,style:this.getMapStyle(s),attributionControl:o,bearing:p},h))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).emit.apply(t,[e].concat(r))}},{key:"once",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.eventEmitter).once.apply(t,[e].concat(r))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(e){var t=this.map.getCanvas(),n="jpg"===e?null===t||void 0===t?void 0:t.toDataURL("image/jpeg"):null===t||void 0===t?void 0:t.toDataURL("image/png");return n}},{key:"onCameraChanged",value:function(e){this.cameraChangedCallback=e}},{key:"creatAmapContainer",value:function(e){var t=e;return"string"===typeof e&&(t=document.getElementById(e)),t}},{key:"getMapStyle",value:function(e){return"string"!==typeof e?e:De[e]?De[e]:e}}]),e}(),ke=Oe,Ae=E()(ke.prototype,"config",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=E()(ke.prototype,"configService",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ie=E()(ke.prototype,"logger",[we],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=E()(ke.prototype,"coordinateSystemService",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pe=E()(ke.prototype,"eventEmitter",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Te=ke))||Te);function Ve(e){return function(){var t,n=y()(e);if(Ge()){var r=y()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g()(this,t)}}function Ge(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var qe=function(e){d()(n,e);var t=Ve(n);function n(){return l()(this,n),t.apply(this,arguments)}return f()(n,[{key:"getServiceConstructor",value:function(){return Ue}}]),n}(C)},mNvP:function(e,t,n){(function(e,t){var n;(function(n){(function(e){var r="object"===typeof t?t:"object"===typeof self?self:"object"===typeof this?this:Function("return this;")(),i=o(n);function o(e,t){return function(n,r){"function"!==typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}"undefined"===typeof r.Reflect?r.Reflect=n:i=o(r.Reflect,i),e(i)})((function(t){var n=Object.prototype.hasOwnProperty,r="function"===typeof Symbol,i=r&&"undefined"!==typeof Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&"undefined"!==typeof Symbol.iterator?Symbol.iterator:"@@iterator",a="function"===typeof Object.create,s={__proto__:[]}instanceof Array,u=!a&&!s,c={create:a?function(){return oe(Object.create(null))}:s?function(){return oe({__proto__:null})}:function(){return oe({})},has:u?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),p="object"===typeof e&&Object({GITHUB_TOKEN:"942bb2823b531cc69cf2ac0aa73ae1332844fa5f",npm_package_scripts_docker_prod_build:"docker-compose -f ./docker/docker-compose.yml build",npm_package_scripts_docker_dev:"docker-compose -f ./docker/docker-compose.dev.yml up",npm_package_dependencies__types_lodash_debounce:"^4.0.6",npm_package_devDependencies_cross_port_killer:"^1.1.1",npm_config_cache_lock_stale:"60000",npm_config_ham_it_up:"",GA_KEY:"UA-72788897-6",ACTIONS_RUNTIME_TOKEN:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaOHdqOHQzYy1xWVhxU0wtQk55Z1pTWWNhRSJ9.eyJuYW1laWQiOiIyMWUyYjU5ZC0zZmNkLTQ1NDAtYWE0ZS03YWNjNWU1OWFjZTMiLCJzY3AiOiJBY3Rpb25zLlVwbG9hZEFydGlmYWN0czowMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAvMTpCdWlsZC9CdWlsZC8zNzc0IExvY2F0aW9uU2VydmljZS5Db25uZWN0IFByb2plY3QuR2VuZXJpY1JlYWQ6MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIFJlYWRBbmRVcGRhdGVCdWlsZEJ5VXJpOjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMC8xOkJ1aWxkL0J1aWxkLzM3NzQiLCJJZGVudGl0eVR5cGVDbGFpbSI6Ik1pY3Jvc29mdC5UZWFtRm91bmRhdGlvbi5TZXJ2aWNlSWRlbnRpdHkiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9zaWQiOiIzZjExZDZkMy1jYjJjLTQyZDgtYjM4MS0yZjU5NmI1NjRhYzU6QWN0aW9uczplZGZjZmFhOS1lZDQ1LTQ1ZWQtYmY2My0wZjQyZjgyOGMxNGMiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3ByaW1hcnlzaWQiOiIyMWUyYjU5ZC0zZmNkLTQ1NDAtYWE0ZS03YWNjNWU1OWFjZTMiLCJhdWkiOiJlOGYyNGMwNi02YTM0LTQzZTktODBlZC0yZWE3ODcxZDA4MzkiLCJzaWQiOiI1OTUyMTMxOC02NTYxLTQwYmUtYjI4My00NzMzNGFmMmU4MzAiLCJhYyI6Ilt7XCJTY29wZVwiOlwicmVmcy9oZWFkcy9tYXN0ZXJcIixcIlBlcm1pc3Npb25cIjozfV0iLCJvcmNoaWQiOiJhMDIwZGJmZC05YjU1LTQ4YTctODM5ZS0zYWYyMzJhNjk5YWYuYnVpbGQtYW5kLWRlcGxveS5fX2RlZmF1bHQiLCJpc3MiOiJ2c3Rva2VuLmFjdGlvbnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwiYXVkIjoidnN0b2tlbi5hY3Rpb25zLmdpdGh1YnVzZXJjb250ZW50LmNvbXx2c286ZWRmY2ZhYTktZWQ0NS00NWVkLWJmNjMtMGY0MmY4MjhjMTRjIiwibmJmIjoxNTg3OTU0NzY0LCJleHAiOjE1ODc5Nzc1NjR9.MbQQqrPmCUZ5lpyUWZW368UtG8cmFUHhI5hqTsh2Uf_WDxrT_hSzOlhQTPwMpxx1aDn5jSHxrdlGcSBEYYIASn9gLVVzSTaiHfnXsKGRBl0VDdoMTxFUcCbJoKAUSHHb813a6D4QV2PUQBj25sMrSUauju0hPgtXg2B7vhOKfyR3Y4hzCQk-u85ItVg08IgGmoTnl7Ay4ydKen3jaW4oizocdErOSDzlhD3Ss6J2mzWKpH_8M70w0jCMyRbFEOk1Hp-xP_Zf0q4zOcOIzGuCJAUbLWtu6I-dWqMfSnGmi1APqQQk8Z4aRdTigGP3jSgx6ovICTSmUp_pItbXABWlRw",npm_package_devDependencies__types_qs:"^6.5.3",npm_package_devDependencies_chalk:"^4.0.0",npm_config_legacy_bundling:"",npm_config_sign_git_tag:"",ACTIONS_CACHE_URL:"https://artifactcache.actions.githubusercontent.com/6ox3nltdSCqlq9JnytEd3HXU2vAMTbWRdkFGiQZ4Z57LU2Z2qP/",npm_package_scripts_pretest:"node ./tests/beforeTest",npm_package_dependencies_mockjs:"^1.0.1-beta3",npm_config_user_agent:"npm/6.13.4 node/v10.19.0 linux x64 ci/github-actions",npm_config_always_auth:"",CI:"true",NODE_VERSION:"10.19.0",npm_package_scripts_lint_staged:"lint-staged",npm_package_dependencies_nzh:"^1.0.3",npm_config_bin_links:"true",npm_config_key:"",HOSTNAME:"727e1f058d15",FOLDER:"dist/",BRANCH:"gh-pages",YARN_VERSION:"1.21.1",npm_package_scripts_start_dev:"cross-env REACT_APP_ENV=dev MOCK=none umi dev",npm_package_dependencies__antv_data_set:"^0.11.0",npm_package_devDependencies_gh_pages:"^2.0.1",npm_config_description:"true",npm_config_fetch_retries:"2",npm_config_heading:"npm",npm_config_init_version:"1.0.0",npm_config_allow_same_version:"",npm_config_if_present:"",npm_config_user:"",npm_node_execpath:"/usr/local/bin/node",npm_package_scripts_test_all:"node ./tests/run-tests.js",npm_package_dependencies_react_helmet_async:"^1.0.4",npm_package_devDependencies__types_express:"^4.17.0",npm_config_prefer_online:"",npm_config_noproxy:"",HOME:"/github/home",OLDPWD:"/github/workspace",npm_package_dependencies__ant_design_icons:"^4.0.0",npm_package_devDependencies_jsdom_global:"^3.0.2",npm_config_force:"",RUNNER_TEMP:"/home/runner/work/_temp",GITHUB_EVENT_PATH:"/github/workflow/event.json",npm_package_scripts_lint_staged_js:"eslint --ext .js,.jsx,.ts,.tsx ",npm_config_only:"",npm_config_read_only:"",GITHUB_REPOSITORY_OWNER:"ant-design",npm_package_scripts_test_component:"umi test ./src/components",npm_package_engines_node:">=10.0.0",npm_config_cache_min:"10",npm_config_init_license:"ISC",NODE_OPTIONS:"--max_old_space_size=4096",npm_package_devDependencies__umijs_preset_ant_design_pro:"^1.2.0",npm_config_editor:"vi",npm_config_rollback:"true",npm_config_tag_version_prefix:"v",GITHUB_HEAD_REF:"",npm_package_scripts_lint_fix:"eslint --fix --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src && npm run lint:style",npm_package_scripts_lint_style:'stylelint --fix "src/**/*.less" --syntax less',npm_package_dependencies_umi_plugin_pro:"^2.0.1",npm_config_cache_max:"Infinity",npm_config_userconfig:"/github/home/.npmrc",npm_config_timing:"",npm_package_scripts_postinstall:"umi g tmp",npm_package_dependencies_moment:"^2.24.0",npm_package_dependencies_use_merge_value:"^1.0.1",npm_config_tmp:"/tmp",npm_config_engine_strict:"",npm_config_init_author_name:"",npm_config_init_author_url:"",npm_config_preid:"",GIT_CONFIG_EMAIL:"qixian.cs@outlook.com",npm_package_description:"An out-of-box UI solution for enterprise applications",npm_package_scripts_docker_push:"npm run docker-hub:build && npm run docker:tag && docker push antdesign/ant-design-pro",npm_package_scripts_start_pre:"cross-env REACT_APP_ENV=pre umi dev",npm_package_dependencies_antd:"^4.0.0",npm_package_dependencies_qs:"^6.9.0",npm_package_dependencies_react_fittext:"^1.0.0",npm_package_dependencies_umi_request:"^1.0.8",npm_config_depth:"Infinity",npm_config_package_lock_only:"",npm_config_save_dev:"",npm_config_usage:"",npm_package_dependencies_bizcharts:"^3.5.3-beta.0",npm_package_devDependencies__types_history:"^4.7.2",npm_package_devDependencies__types_react_dom:"^16.8.4",npm_package_readmeFilename:"README.fr-FR.md",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_package_lock:"true",npm_config_cafile:"",npm_config_otp:"",npm_config_progress:"",npm_config_https_proxy:"",npm_config_save_prod:"",npm_package_scripts_dev:"npm run start:dev",npm_package_scripts_docker_build:"docker-compose -f ./docker/docker-compose.dev.yml build",npm_package_scripts_fetch_blocks:"pro fetch-blocks --branch=umi@3 && npm run prettier",npm_package_dependencies__antv_l7_maps:"^2.0.0",npm_package_devDependencies_prettier:"^2.0.1",npm_config_audit:"true",npm_config_sso_type:"oauth",npm_config_cidr:"",npm_config_onload_script:"",ACTIONS_RUNTIME_URL:"https://pipelines.actions.githubusercontent.com/6ox3nltdSCqlq9JnytEd3HXU2vAMTbWRdkFGiQZ4Z57LU2Z2qP/",RUNNER_OS:"Linux",npm_package_scripts_site:"npm run fetch:blocks && npm run build",npm_package_devDependencies_carlo:"^0.9.46",npm_package_checkFiles_0:"src/**/*.js*",npm_config_rebuild_bundle:"true",npm_config_shell:"bash",npm_config_save_bundle:"",GITHUB_WORKFLOW:"Deploy CI",npm_package_private:"true",npm_package_scripts_lint_prettier:'prettier --check "**/*" --end-of-line auto',npm_package_scripts_start_test:"cross-env REACT_APP_ENV=test MOCK=none umi dev",npm_package_devDependencies__types_jest:"^25.1.0",npm_package_devDependencies_mockjs:"^1.0.1-beta3",npm_package_checkFiles_1:"src/**/*.ts*",npm_config_format_package_lock:"true",npm_config_prefix:"/usr/local",npm_config_dry_run:"",npm_package_scripts_lint:"umi g tmp && npm run lint:js && npm run lint:style && npm run lint:prettier",npm_package_devDependencies__umijs_plugin_blocks:"^2.0.5",npm_package_devDependencies_puppeteer_core:"^3.0.0",npm_package_checkFiles_2:"src/**/*.less",npm_config_scope:"",npm_config_cache_lock_wait:"10000",npm_config_registry:"https://registry.npmjs.org/",npm_config_browser:"",npm_config_ignore_prepublish:"",npm_config_save_optional:"",npm_config_searchopts:"",npm_config_versions:"",GITHUB_RUN_ID:"88676759",npm_package_scripts_gh_pages:"cp CNAME ./dist/ && gh-pages -d dist",npm_package_devDependencies__types_lodash:"^4.14.144",npm_package_devDependencies_detect_installer:"^1.0.1",npm_package_devDependencies_stylelint:"^13.0.0",npm_package_checkFiles_3:"config/**/*.js*",npm_config_cache:"/github/home/.npm",npm_config_proxy:"",npm_config_send_metrics:"",GIT_CONFIG_NAME:"qixian.cs",GITHUB_BASE_REF:"",npm_package_scripts_start:"umi dev",npm_package_dependencies_bizcharts_plugin_slider:"^2.1.1-beta.1",npm_package_checkFiles_4:"scripts/**/*.js",npm_package_create_umi_ignore_0:".dockerignore",npm_config_global_style:"",npm_config_ignore_scripts:"",npm_config_version:"",npm_package_dependencies_umi_plugin_antd_theme:"^2.1.2",npm_package_devDependencies__types_classnames:"^2.2.7",npm_package_devDependencies__types_react_helmet:"^5.0.13",npm_package_create_umi_ignore_1:".git",npm_config_viewer:"man",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_config_local_address:"",PATH:"/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/github/workspace/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/github/workspace/node_modules/.bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",RUNNER_TOOL_CACHE:"/opt/hostedtoolcache",ANT_DESIGN_PRO_ONLY_DO_NOT_USE_IN_YOUR_PRODUCTION:"site",NODE:"/usr/local/bin/node",npm_package_name:"ant-design-pro",npm_package_scripts_lint_js:"eslint --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src",npm_package_dependencies_dva:"^2.4.0",npm_package_create_umi_ignore_2:".github",npm_config_audit_level:"low",npm_config_prefer_offline:"",GITHUB_ACTION:"JamesIvesgithub-pages-deploy-action",GITHUB_RUN_NUMBER:"184",npm_package_scripts_analyze:"cross-env ANALYZE=1 umi build",npm_package_dependencies__ant_design_pro_layout:"^5.0.8",npm_package_dependencies_lodash_isequal:"^4.5.0",npm_package_create_umi_ignore_3:".gitpod.yml",npm_config_color:"true",npm_config_sign_git_commit:"",npm_package_scripts_i18n_remove:"pro i18n-remove --locale=zh-CN --write",npm_package_create_umi_ignore_4:"CODE_OF_CONDUCT.md",npm_config_fetch_retry_mintimeout:"10000",npm_config_maxsockets:"50",npm_config_sso_poll_frequency:"500",npm_config_offline:"",npm_package_lint_staged______less:"stylelint --syntax less",npm_package_dependencies_react_dom:"^16.8.6",npm_package_devDependencies__umijs_fabric:"^2.0.5",npm_package_devDependencies_eslint:"^6.8.0",npm_package_create_umi_ignoreScript_0:"docker*",npm_package_create_umi_ignore_5:"Dockerfile",npm_config_umask:"0022",GITHUB_REPOSITORY:"ant-design/ant-design-pro",npm_package_scripts_docker_prod_dev:"docker-compose -f ./docker/docker-compose.yml up",npm_package_scripts_tsc:"tsc",npm_package_browserslist_0:"> 1%",npm_package_dependencies_lodash_debounce:"^4.0.8",npm_package_create_umi_ignoreScript_1:"functions*",npm_package_create_umi_ignore_6:"Dockerfile.*",npm_package_gitHead:"d4c972a0e771c76edf687073edb8b555d6b9ba93",npm_config_fund:"true",npm_config_fetch_retry_maxtimeout:"60000",npm_config_loglevel:"notice",npm_config_logs_max:"10",npm_config_message:"%s",npm_lifecycle_script:"umi build",npm_package_scripts_test:"umi test",npm_package_browserslist_1:"last 2 versions",npm_package_dependencies_react_router:"^4.3.1",npm_package_create_umi_ignoreScript_2:"site",npm_package_create_umi_ignore_7:"lambda",npm_config_ca:"",npm_config_cert:"",npm_config_global:"",npm_config_link:"",GITHUB_ACTIONS:"true",npm_package_version:"4.0.0",npm_package_husky_hooks_pre_commit:"npm run lint-staged",npm_package_browserslist_2:"not ie <= 10",npm_package_devDependencies__types_react:"^16.9.17",npm_package_devDependencies__umijs_preset_react:"^1.4.8",npm_package_create_umi_ignoreScript_3:"generateMock",npm_package_create_umi_ignore_8:"LICENSE",npm_config_save:"true",npm_config_access:"",npm_config_also:"",npm_config_unicode:"",npm_lifecycle_event:"build",npm_package_scripts_build:"umi build",npm_package_scripts_prettier:'prettier -c --write "**/*"',npm_package_scripts_start_no_ui:"cross-env UMI_UI=none umi dev",npm_package_dependencies__ant_design_pro_table:"2.2.1",npm_package_devDependencies_lint_staged:"^10.0.0",npm_package_create_umi_ignore_9:"netlify.toml",npm_config_argv:'{"remain":[],"cooked":["run","build"],"original":["run","build"]}',npm_config_searchlimit:"20",npm_config_update_notifier:"true",npm_config_before:"",npm_config_long:"",npm_config_production:"",npm_config_unsafe_perm:"",GITHUB_WORKSPACE:"/github/workspace",GITHUB_JOB:"build-and-deploy",npm_package_dependencies_lodash:"^4.17.11",npm_package_devDependencies__ant_design_pro_cli:"^1.0.18",npm_package_create_umi_ignore_10:"README.*.md",npm_config_auth_type:"legacy",npm_config_node_version:"10.19.0",npm_config_tag:"latest",GITHUB_SHA:"d4c972a0e771c76edf687073edb8b555d6b9ba93",npm_package_dependencies_gg_editor:"^2.0.2",npm_package_devDependencies_express:"^4.17.1",npm_package_create_umi_ignore_11:"azure-pipelines.yml",npm_config_git_tag_version:"true",npm_config_commit_hooks:"true",npm_config_shrinkwrap:"true",npm_config_script_shell:"",GITHUB_ACTOR:"chenshuai2144",GITHUB_REF:"refs/heads/master",npm_package_lint_staged_______js_jsx_tsx_ts_less_md_json__0:"prettier --write",npm_package_dependencies_classnames:"^2.2.6",npm_package_create_umi_ignore_12:"docker",npm_config_fetch_retry_factor:"10",npm_config_strict_ssl:"true",npm_config_save_exact:"",npm_package_dependencies__antv_l7:"^2.0.0",npm_package_dependencies_lodash_decorators:"^6.0.0",npm_package_create_umi_ignore_13:"CNAME",npm_config_globalconfig:"/usr/local/etc/npmrc",npm_config_init_module:"/github/home/.npm-init.js",npm_config_dev:"",npm_config_parseable:"",RUNNER_WORKSPACE:"/home/runner/work/ant-design-pro",PWD:"/github/workspace",npm_package_dependencies_numeral:"^2.0.6",npm_package_dependencies_path_to_regexp:"2.4.0",npm_package_devDependencies_enzyme:"^3.11.0",npm_package_devDependencies_pro_download:"1.0.1",npm_package_create_umi_ignoreDependencies_0:"netlify*",npm_package_create_umi_ignore_14:"create-umi",npm_config_globalignorefile:"/usr/local/etc/npmignore",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",GITHUB_EVENT_NAME:"push",npm_package_lint_staged_______js_jsx_ts_tsx_:"npm run lint-staged:js",npm_package_dependencies_omit_js:"^1.0.2",npm_package_devDependencies__umijs_preset_ui:"^2.0.9",npm_package_create_umi_ignoreDependencies_1:"serverless",npm_config_cache_lock_retries:"10",npm_config_searchstaleness:"900",npm_package_dependencies_prop_types:"^15.5.10",npm_package_devDependencies_cross_env:"^7.0.0",npm_config_save_prefix:"^",npm_config_scripts_prepend_node_path:"warn-only",npm_config_node_options:"",npm_package_scripts_deploy:"npm run site && npm run gh-pages",npm_package_scripts_docker_tag:"docker tag ant-design-pro antdesign/ant-design-pro",npm_package_dependencies__types_lodash_isequal:"^4.5.5",npm_config_group:"",npm_config_init_author_email:"",npm_config_searchexclude:"",PROGRESS:"none",npm_package_scripts_start_no_mock:"cross-env MOCK=none umi dev",npm_package_dependencies_umi:"3.1.1",npm_config_git:"git",npm_config_optional:"true",BUILD_SCRIPT:"yarn && npm uninstall husky && yarn add umi-plugin-antd-theme umi-plugin-pro  && npm run site && git checkout . && git clean -df",INIT_CWD:"/github/workspace",npm_package_scripts_docker_hub_build:"docker build  -f Dockerfile.hub -t  ant-design-pro ./",npm_package_dependencies_react:"^16.8.6",npm_config_json:"",NODE_ENV:"production",UMI_VERSION:"3.1.1",UMI_DIR:"/github/workspace/node_modules/umi"})&&"true"===Object({GITHUB_TOKEN:"942bb2823b531cc69cf2ac0aa73ae1332844fa5f",npm_package_scripts_docker_prod_build:"docker-compose -f ./docker/docker-compose.yml build",npm_package_scripts_docker_dev:"docker-compose -f ./docker/docker-compose.dev.yml up",npm_package_dependencies__types_lodash_debounce:"^4.0.6",npm_package_devDependencies_cross_port_killer:"^1.1.1",npm_config_cache_lock_stale:"60000",npm_config_ham_it_up:"",GA_KEY:"UA-72788897-6",ACTIONS_RUNTIME_TOKEN:"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaOHdqOHQzYy1xWVhxU0wtQk55Z1pTWWNhRSJ9.eyJuYW1laWQiOiIyMWUyYjU5ZC0zZmNkLTQ1NDAtYWE0ZS03YWNjNWU1OWFjZTMiLCJzY3AiOiJBY3Rpb25zLlVwbG9hZEFydGlmYWN0czowMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAvMTpCdWlsZC9CdWlsZC8zNzc0IExvY2F0aW9uU2VydmljZS5Db25uZWN0IFByb2plY3QuR2VuZXJpY1JlYWQ6MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwIFJlYWRBbmRVcGRhdGVCdWlsZEJ5VXJpOjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMC8xOkJ1aWxkL0J1aWxkLzM3NzQiLCJJZGVudGl0eVR5cGVDbGFpbSI6Ik1pY3Jvc29mdC5UZWFtRm91bmRhdGlvbi5TZXJ2aWNlSWRlbnRpdHkiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9zaWQiOiIzZjExZDZkMy1jYjJjLTQyZDgtYjM4MS0yZjU5NmI1NjRhYzU6QWN0aW9uczplZGZjZmFhOS1lZDQ1LTQ1ZWQtYmY2My0wZjQyZjgyOGMxNGMiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3ByaW1hcnlzaWQiOiIyMWUyYjU5ZC0zZmNkLTQ1NDAtYWE0ZS03YWNjNWU1OWFjZTMiLCJhdWkiOiJlOGYyNGMwNi02YTM0LTQzZTktODBlZC0yZWE3ODcxZDA4MzkiLCJzaWQiOiI1OTUyMTMxOC02NTYxLTQwYmUtYjI4My00NzMzNGFmMmU4MzAiLCJhYyI6Ilt7XCJTY29wZVwiOlwicmVmcy9oZWFkcy9tYXN0ZXJcIixcIlBlcm1pc3Npb25cIjozfV0iLCJvcmNoaWQiOiJhMDIwZGJmZC05YjU1LTQ4YTctODM5ZS0zYWYyMzJhNjk5YWYuYnVpbGQtYW5kLWRlcGxveS5fX2RlZmF1bHQiLCJpc3MiOiJ2c3Rva2VuLmFjdGlvbnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tIiwiYXVkIjoidnN0b2tlbi5hY3Rpb25zLmdpdGh1YnVzZXJjb250ZW50LmNvbXx2c286ZWRmY2ZhYTktZWQ0NS00NWVkLWJmNjMtMGY0MmY4MjhjMTRjIiwibmJmIjoxNTg3OTU0NzY0LCJleHAiOjE1ODc5Nzc1NjR9.MbQQqrPmCUZ5lpyUWZW368UtG8cmFUHhI5hqTsh2Uf_WDxrT_hSzOlhQTPwMpxx1aDn5jSHxrdlGcSBEYYIASn9gLVVzSTaiHfnXsKGRBl0VDdoMTxFUcCbJoKAUSHHb813a6D4QV2PUQBj25sMrSUauju0hPgtXg2B7vhOKfyR3Y4hzCQk-u85ItVg08IgGmoTnl7Ay4ydKen3jaW4oizocdErOSDzlhD3Ss6J2mzWKpH_8M70w0jCMyRbFEOk1Hp-xP_Zf0q4zOcOIzGuCJAUbLWtu6I-dWqMfSnGmi1APqQQk8Z4aRdTigGP3jSgx6ovICTSmUp_pItbXABWlRw",npm_package_devDependencies__types_qs:"^6.5.3",npm_package_devDependencies_chalk:"^4.0.0",npm_config_legacy_bundling:"",npm_config_sign_git_tag:"",ACTIONS_CACHE_URL:"https://artifactcache.actions.githubusercontent.com/6ox3nltdSCqlq9JnytEd3HXU2vAMTbWRdkFGiQZ4Z57LU2Z2qP/",npm_package_scripts_pretest:"node ./tests/beforeTest",npm_package_dependencies_mockjs:"^1.0.1-beta3",npm_config_user_agent:"npm/6.13.4 node/v10.19.0 linux x64 ci/github-actions",npm_config_always_auth:"",CI:"true",NODE_VERSION:"10.19.0",npm_package_scripts_lint_staged:"lint-staged",npm_package_dependencies_nzh:"^1.0.3",npm_config_bin_links:"true",npm_config_key:"",HOSTNAME:"727e1f058d15",FOLDER:"dist/",BRANCH:"gh-pages",YARN_VERSION:"1.21.1",npm_package_scripts_start_dev:"cross-env REACT_APP_ENV=dev MOCK=none umi dev",npm_package_dependencies__antv_data_set:"^0.11.0",npm_package_devDependencies_gh_pages:"^2.0.1",npm_config_description:"true",npm_config_fetch_retries:"2",npm_config_heading:"npm",npm_config_init_version:"1.0.0",npm_config_allow_same_version:"",npm_config_if_present:"",npm_config_user:"",npm_node_execpath:"/usr/local/bin/node",npm_package_scripts_test_all:"node ./tests/run-tests.js",npm_package_dependencies_react_helmet_async:"^1.0.4",npm_package_devDependencies__types_express:"^4.17.0",npm_config_prefer_online:"",npm_config_noproxy:"",HOME:"/github/home",OLDPWD:"/github/workspace",npm_package_dependencies__ant_design_icons:"^4.0.0",npm_package_devDependencies_jsdom_global:"^3.0.2",npm_config_force:"",RUNNER_TEMP:"/home/runner/work/_temp",GITHUB_EVENT_PATH:"/github/workflow/event.json",npm_package_scripts_lint_staged_js:"eslint --ext .js,.jsx,.ts,.tsx ",npm_config_only:"",npm_config_read_only:"",GITHUB_REPOSITORY_OWNER:"ant-design",npm_package_scripts_test_component:"umi test ./src/components",npm_package_engines_node:">=10.0.0",npm_config_cache_min:"10",npm_config_init_license:"ISC",NODE_OPTIONS:"--max_old_space_size=4096",npm_package_devDependencies__umijs_preset_ant_design_pro:"^1.2.0",npm_config_editor:"vi",npm_config_rollback:"true",npm_config_tag_version_prefix:"v",GITHUB_HEAD_REF:"",npm_package_scripts_lint_fix:"eslint --fix --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src && npm run lint:style",npm_package_scripts_lint_style:'stylelint --fix "src/**/*.less" --syntax less',npm_package_dependencies_umi_plugin_pro:"^2.0.1",npm_config_cache_max:"Infinity",npm_config_userconfig:"/github/home/.npmrc",npm_config_timing:"",npm_package_scripts_postinstall:"umi g tmp",npm_package_dependencies_moment:"^2.24.0",npm_package_dependencies_use_merge_value:"^1.0.1",npm_config_tmp:"/tmp",npm_config_engine_strict:"",npm_config_init_author_name:"",npm_config_init_author_url:"",npm_config_preid:"",GIT_CONFIG_EMAIL:"qixian.cs@outlook.com",npm_package_description:"An out-of-box UI solution for enterprise applications",npm_package_scripts_docker_push:"npm run docker-hub:build && npm run docker:tag && docker push antdesign/ant-design-pro",npm_package_scripts_start_pre:"cross-env REACT_APP_ENV=pre umi dev",npm_package_dependencies_antd:"^4.0.0",npm_package_dependencies_qs:"^6.9.0",npm_package_dependencies_react_fittext:"^1.0.0",npm_package_dependencies_umi_request:"^1.0.8",npm_config_depth:"Infinity",npm_config_package_lock_only:"",npm_config_save_dev:"",npm_config_usage:"",npm_package_dependencies_bizcharts:"^3.5.3-beta.0",npm_package_devDependencies__types_history:"^4.7.2",npm_package_devDependencies__types_react_dom:"^16.8.4",npm_package_readmeFilename:"README.fr-FR.md",npm_config_metrics_registry:"https://registry.npmjs.org/",npm_config_package_lock:"true",npm_config_cafile:"",npm_config_otp:"",npm_config_progress:"",npm_config_https_proxy:"",npm_config_save_prod:"",npm_package_scripts_dev:"npm run start:dev",npm_package_scripts_docker_build:"docker-compose -f ./docker/docker-compose.dev.yml build",npm_package_scripts_fetch_blocks:"pro fetch-blocks --branch=umi@3 && npm run prettier",npm_package_dependencies__antv_l7_maps:"^2.0.0",npm_package_devDependencies_prettier:"^2.0.1",npm_config_audit:"true",npm_config_sso_type:"oauth",npm_config_cidr:"",npm_config_onload_script:"",ACTIONS_RUNTIME_URL:"https://pipelines.actions.githubusercontent.com/6ox3nltdSCqlq9JnytEd3HXU2vAMTbWRdkFGiQZ4Z57LU2Z2qP/",RUNNER_OS:"Linux",npm_package_scripts_site:"npm run fetch:blocks && npm run build",npm_package_devDependencies_carlo:"^0.9.46",npm_package_checkFiles_0:"src/**/*.js*",npm_config_rebuild_bundle:"true",npm_config_shell:"bash",npm_config_save_bundle:"",GITHUB_WORKFLOW:"Deploy CI",npm_package_private:"true",npm_package_scripts_lint_prettier:'prettier --check "**/*" --end-of-line auto',npm_package_scripts_start_test:"cross-env REACT_APP_ENV=test MOCK=none umi dev",npm_package_devDependencies__types_jest:"^25.1.0",npm_package_devDependencies_mockjs:"^1.0.1-beta3",npm_package_checkFiles_1:"src/**/*.ts*",npm_config_format_package_lock:"true",npm_config_prefix:"/usr/local",npm_config_dry_run:"",npm_package_scripts_lint:"umi g tmp && npm run lint:js && npm run lint:style && npm run lint:prettier",npm_package_devDependencies__umijs_plugin_blocks:"^2.0.5",npm_package_devDependencies_puppeteer_core:"^3.0.0",npm_package_checkFiles_2:"src/**/*.less",npm_config_scope:"",npm_config_cache_lock_wait:"10000",npm_config_registry:"https://registry.npmjs.org/",npm_config_browser:"",npm_config_ignore_prepublish:"",npm_config_save_optional:"",npm_config_searchopts:"",npm_config_versions:"",GITHUB_RUN_ID:"88676759",npm_package_scripts_gh_pages:"cp CNAME ./dist/ && gh-pages -d dist",npm_package_devDependencies__types_lodash:"^4.14.144",npm_package_devDependencies_detect_installer:"^1.0.1",npm_package_devDependencies_stylelint:"^13.0.0",npm_package_checkFiles_3:"config/**/*.js*",npm_config_cache:"/github/home/.npm",npm_config_proxy:"",npm_config_send_metrics:"",GIT_CONFIG_NAME:"qixian.cs",GITHUB_BASE_REF:"",npm_package_scripts_start:"umi dev",npm_package_dependencies_bizcharts_plugin_slider:"^2.1.1-beta.1",npm_package_checkFiles_4:"scripts/**/*.js",npm_package_create_umi_ignore_0:".dockerignore",npm_config_global_style:"",npm_config_ignore_scripts:"",npm_config_version:"",npm_package_dependencies_umi_plugin_antd_theme:"^2.1.2",npm_package_devDependencies__types_classnames:"^2.2.7",npm_package_devDependencies__types_react_helmet:"^5.0.13",npm_package_create_umi_ignore_1:".git",npm_config_viewer:"man",npm_config_node_gyp:"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_config_local_address:"",PATH:"/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/github/workspace/node_modules/.bin:/usr/local/lib/node_modules/npm/node_modules/npm-lifecycle/node-gyp-bin:/github/workspace/node_modules/.bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",RUNNER_TOOL_CACHE:"/opt/hostedtoolcache",ANT_DESIGN_PRO_ONLY_DO_NOT_USE_IN_YOUR_PRODUCTION:"site",NODE:"/usr/local/bin/node",npm_package_name:"ant-design-pro",npm_package_scripts_lint_js:"eslint --cache --ext .js,.jsx,.ts,.tsx --format=pretty ./src",npm_package_dependencies_dva:"^2.4.0",npm_package_create_umi_ignore_2:".github",npm_config_audit_level:"low",npm_config_prefer_offline:"",GITHUB_ACTION:"JamesIvesgithub-pages-deploy-action",GITHUB_RUN_NUMBER:"184",npm_package_scripts_analyze:"cross-env ANALYZE=1 umi build",npm_package_dependencies__ant_design_pro_layout:"^5.0.8",npm_package_dependencies_lodash_isequal:"^4.5.0",npm_package_create_umi_ignore_3:".gitpod.yml",npm_config_color:"true",npm_config_sign_git_commit:"",npm_package_scripts_i18n_remove:"pro i18n-remove --locale=zh-CN --write",npm_package_create_umi_ignore_4:"CODE_OF_CONDUCT.md",npm_config_fetch_retry_mintimeout:"10000",npm_config_maxsockets:"50",npm_config_sso_poll_frequency:"500",npm_config_offline:"",npm_package_lint_staged______less:"stylelint --syntax less",npm_package_dependencies_react_dom:"^16.8.6",npm_package_devDependencies__umijs_fabric:"^2.0.5",npm_package_devDependencies_eslint:"^6.8.0",npm_package_create_umi_ignoreScript_0:"docker*",npm_package_create_umi_ignore_5:"Dockerfile",npm_config_umask:"0022",GITHUB_REPOSITORY:"ant-design/ant-design-pro",npm_package_scripts_docker_prod_dev:"docker-compose -f ./docker/docker-compose.yml up",npm_package_scripts_tsc:"tsc",npm_package_browserslist_0:"> 1%",npm_package_dependencies_lodash_debounce:"^4.0.8",npm_package_create_umi_ignoreScript_1:"functions*",npm_package_create_umi_ignore_6:"Dockerfile.*",npm_package_gitHead:"d4c972a0e771c76edf687073edb8b555d6b9ba93",npm_config_fund:"true",npm_config_fetch_retry_maxtimeout:"60000",npm_config_loglevel:"notice",npm_config_logs_max:"10",npm_config_message:"%s",npm_lifecycle_script:"umi build",npm_package_scripts_test:"umi test",npm_package_browserslist_1:"last 2 versions",npm_package_dependencies_react_router:"^4.3.1",npm_package_create_umi_ignoreScript_2:"site",npm_package_create_umi_ignore_7:"lambda",npm_config_ca:"",npm_config_cert:"",npm_config_global:"",npm_config_link:"",GITHUB_ACTIONS:"true",npm_package_version:"4.0.0",npm_package_husky_hooks_pre_commit:"npm run lint-staged",npm_package_browserslist_2:"not ie <= 10",npm_package_devDependencies__types_react:"^16.9.17",npm_package_devDependencies__umijs_preset_react:"^1.4.8",npm_package_create_umi_ignoreScript_3:"generateMock",npm_package_create_umi_ignore_8:"LICENSE",npm_config_save:"true",npm_config_access:"",npm_config_also:"",npm_config_unicode:"",npm_lifecycle_event:"build",npm_package_scripts_build:"umi build",npm_package_scripts_prettier:'prettier -c --write "**/*"',npm_package_scripts_start_no_ui:"cross-env UMI_UI=none umi dev",npm_package_dependencies__ant_design_pro_table:"2.2.1",npm_package_devDependencies_lint_staged:"^10.0.0",npm_package_create_umi_ignore_9:"netlify.toml",npm_config_argv:'{"remain":[],"cooked":["run","build"],"original":["run","build"]}',npm_config_searchlimit:"20",npm_config_update_notifier:"true",npm_config_before:"",npm_config_long:"",npm_config_production:"",npm_config_unsafe_perm:"",GITHUB_WORKSPACE:"/github/workspace",GITHUB_JOB:"build-and-deploy",npm_package_dependencies_lodash:"^4.17.11",npm_package_devDependencies__ant_design_pro_cli:"^1.0.18",npm_package_create_umi_ignore_10:"README.*.md",npm_config_auth_type:"legacy",npm_config_node_version:"10.19.0",npm_config_tag:"latest",GITHUB_SHA:"d4c972a0e771c76edf687073edb8b555d6b9ba93",npm_package_dependencies_gg_editor:"^2.0.2",npm_package_devDependencies_express:"^4.17.1",npm_package_create_umi_ignore_11:"azure-pipelines.yml",npm_config_git_tag_version:"true",npm_config_commit_hooks:"true",npm_config_shrinkwrap:"true",npm_config_script_shell:"",GITHUB_ACTOR:"chenshuai2144",GITHUB_REF:"refs/heads/master",npm_package_lint_staged_______js_jsx_tsx_ts_less_md_json__0:"prettier --write",npm_package_dependencies_classnames:"^2.2.6",npm_package_create_umi_ignore_12:"docker",npm_config_fetch_retry_factor:"10",npm_config_strict_ssl:"true",npm_config_save_exact:"",npm_package_dependencies__antv_l7:"^2.0.0",npm_package_dependencies_lodash_decorators:"^6.0.0",npm_package_create_umi_ignore_13:"CNAME",npm_config_globalconfig:"/usr/local/etc/npmrc",npm_config_init_module:"/github/home/.npm-init.js",npm_config_dev:"",npm_config_parseable:"",RUNNER_WORKSPACE:"/home/runner/work/ant-design-pro",PWD:"/github/workspace",npm_package_dependencies_numeral:"^2.0.6",npm_package_dependencies_path_to_regexp:"2.4.0",npm_package_devDependencies_enzyme:"^3.11.0",npm_package_devDependencies_pro_download:"1.0.1",npm_package_create_umi_ignoreDependencies_0:"netlify*",npm_package_create_umi_ignore_14:"create-umi",npm_config_globalignorefile:"/usr/local/etc/npmignore",npm_execpath:"/usr/local/lib/node_modules/npm/bin/npm-cli.js",GITHUB_EVENT_NAME:"push",npm_package_lint_staged_______js_jsx_ts_tsx_:"npm run lint-staged:js",npm_package_dependencies_omit_js:"^1.0.2",npm_package_devDependencies__umijs_preset_ui:"^2.0.9",npm_package_create_umi_ignoreDependencies_1:"serverless",npm_config_cache_lock_retries:"10",npm_config_searchstaleness:"900",npm_package_dependencies_prop_types:"^15.5.10",npm_package_devDependencies_cross_env:"^7.0.0",npm_config_save_prefix:"^",npm_config_scripts_prepend_node_path:"warn-only",npm_config_node_options:"",npm_package_scripts_deploy:"npm run site && npm run gh-pages",npm_package_scripts_docker_tag:"docker tag ant-design-pro antdesign/ant-design-pro",npm_package_dependencies__types_lodash_isequal:"^4.5.5",npm_config_group:"",npm_config_init_author_email:"",npm_config_searchexclude:"",PROGRESS:"none",npm_package_scripts_start_no_mock:"cross-env MOCK=none umi dev",npm_package_dependencies_umi:"3.1.1",npm_config_git:"git",npm_config_optional:"true",BUILD_SCRIPT:"yarn && npm uninstall husky && yarn add umi-plugin-antd-theme umi-plugin-pro  && npm run site && git checkout . && git clean -df",INIT_CWD:"/github/workspace",npm_package_scripts_docker_hub_build:"docker build  -f Dockerfile.hub -t  ant-design-pro ./",npm_package_dependencies_react:"^16.8.6",npm_config_json:"",NODE_ENV:"production",UMI_VERSION:"3.1.1",UMI_DIR:"/github/workspace/node_modules/umi"})["REFLECT_METADATA_USE_MAP_POLYFILL"],f=p||"function"!==typeof Map||"function"!==typeof Map.prototype.entries?ne():Map,h=p||"function"!==typeof Set||"function"!==typeof Set.prototype.entries?re():Set,d=p||"function"!==typeof WeakMap?ie():WeakMap,m=new d;function g(e,t,n,r){if(N(n)){if(!H(e))throw new TypeError;if(!Y(t))throw new TypeError;return k(e,t)}if(!H(e))throw new TypeError;if(!B(t))throw new TypeError;if(!B(r)&&!N(r)&&!j(r))throw new TypeError;return j(r)&&(r=void 0),n=Z(n),A(e,t,n,r)}function v(e,t){function n(n,r){if(!B(n))throw new TypeError;if(!N(r)&&!X(r))throw new TypeError;L(e,t,n,r)}return n}function y(e,t,n,r){if(!B(n))throw new TypeError;return N(r)||(r=Z(r)),L(e,t,n,r)}function _(e,t,n){if(!B(t))throw new TypeError;return N(n)||(n=Z(n)),I(e,t,n)}function b(e,t,n){if(!B(t))throw new TypeError;return N(n)||(n=Z(n)),M(e,t,n)}function x(e,t,n){if(!B(t))throw new TypeError;return N(n)||(n=Z(n)),P(e,t,n)}function w(e,t,n){if(!B(t))throw new TypeError;return N(n)||(n=Z(n)),O(e,t,n)}function S(e,t){if(!B(e))throw new TypeError;return N(t)||(t=Z(t)),R(e,t)}function E(e,t){if(!B(e))throw new TypeError;return N(t)||(t=Z(t)),D(e,t)}function T(e,t,n){if(!B(t))throw new TypeError;N(n)||(n=Z(n));var r=C(t,n,!1);if(N(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=m.get(t);return i.delete(n),i.size>0||m.delete(t),!0}function k(e,t){for(var n=e.length-1;n>=0;--n){var r=e[n],i=r(t);if(!N(i)&&!j(i)){if(!Y(i))throw new TypeError;t=i}}return t}function A(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=e[i],a=o(t,n,r);if(!N(a)&&!j(a)){if(!B(a))throw new TypeError;r=a}}return r}function C(e,t,n){var r=m.get(e);if(N(r)){if(!n)return;r=new f,m.set(e,r)}var i=r.get(t);if(N(i)){if(!n)return;i=new f,r.set(t,i)}return i}function I(e,t,n){var r=M(e,t,n);if(r)return!0;var i=te(t);return!j(i)&&I(e,i,n)}function M(e,t,n){var r=C(t,n,!1);return!N(r)&&G(r.has(e))}function P(e,t,n){var r=M(e,t,n);if(r)return O(e,t,n);var i=te(t);return j(i)?void 0:P(e,i,n)}function O(e,t,n){var r=C(t,n,!1);if(!N(r))return r.get(e)}function L(e,t,n,r){var i=C(n,r,!0);i.set(e,t)}function R(e,t){var n=D(e,t),r=te(e);if(null===r)return n;var i=R(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new h,a=[],s=0,u=n;s<u.length;s++){var c=u[s],l=o.has(c);l||(o.add(c),a.push(c))}for(var p=0,f=i;p<f.length;p++){c=f[p],l=o.has(c);l||(o.add(c),a.push(c))}return a}function D(e,t){var n=[],r=C(e,t,!1);if(N(r))return n;var i=r.keys(),o=J(i),a=0;while(1){var s=$(o);if(!s)return n.length=a,n;var u=Q(s);try{n[a]=u}catch(c){try{ee(o)}finally{throw c}}a++}}function z(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function N(e){return void 0===e}function j(e){return null===e}function F(e){return"symbol"===typeof e}function B(e){return"object"===typeof e?null!==e:"function"===typeof e}function U(e,t){switch(z(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var n=3===t?"string":5===t?"number":"default",r=K(e,i);if(void 0!==r){var o=r.call(e,n);if(B(o))throw new TypeError;return o}return V(e,"default"===n?"number":n)}function V(e,t){if("string"===t){var n=e.toString;if(W(n)){var r=n.call(e);if(!B(r))return r}var i=e.valueOf;if(W(i)){r=i.call(e);if(!B(r))return r}}else{i=e.valueOf;if(W(i)){r=i.call(e);if(!B(r))return r}var o=e.toString;if(W(o)){r=o.call(e);if(!B(r))return r}}throw new TypeError}function G(e){return!!e}function q(e){return""+e}function Z(e){var t=U(e,3);return F(t)?t:q(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"===typeof e}function Y(e){return"function"===typeof e}function X(e){switch(z(e)){case 3:return!0;case 4:return!0;default:return!1}}function K(e,t){var n=e[t];if(void 0!==n&&null!==n){if(!W(n))throw new TypeError;return n}}function J(e){var t=K(e,o);if(!W(t))throw new TypeError;var n=t.call(e);if(!B(n))throw new TypeError;return n}function Q(e){return e.value}function $(e){var t=e.next();return!t.done&&t}function ee(e){var t=e["return"];t&&t.call(e)}function te(e){var t=Object.getPrototypeOf(e);if("function"!==typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!==typeof i||i===e?t:i}function ne(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function a(e,t){return[e,t]}}function re(){return function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function ie(){var e=16,t=c.create(),r=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){var n=o(e,!0);return n[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+u()}while(c.has(t,e));return t[e]=!0,e}function o(e,t){if(!n.call(e,r)){if(!t)return;Object.defineProperty(e,r,{value:c.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"===typeof Uint8Array?"undefined"!==typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!==typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function u(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function oe(e){return e.__=void 0,delete e.__,e}t("decorate",g),t("metadata",v),t("defineMetadata",y),t("hasMetadata",_),t("hasOwnMetadata",b),t("getMetadata",x),t("getOwnMetadata",w),t("getMetadataKeys",S),t("getOwnMetadataKeys",E),t("deleteMetadata",T)}))})(n||(n={}))}).call(this,n("Q2Ig"),n("yLpj"))},mhV4:function(e,t,n){var r=n("ZK94");function i(e){var t,n=0;switch(e.type){case"Polygon":return o(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=o(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(t=0;t<e.geometries.length;t++)n+=i(e.geometries[t]);return n}}function o(e){var t=0;if(e&&e.length>0){t+=Math.abs(a(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(a(e[n]))}return t}function a(e){var t,n,i,o,a,u,c,l=0,p=e.length;if(p>2){for(c=0;c<p;c++)c===p-2?(o=p-2,a=p-1,u=0):c===p-1?(o=p-1,a=0,u=1):(o=c,a=c+1,u=c+2),t=e[o],n=e[a],i=e[u],l+=(s(i[0])-s(t[0]))*Math.sin(s(n[1]));l=l*r.RADIUS*r.RADIUS/2}return l}function s(e){return e*Math.PI/180}e.exports.geometry=i,e.exports.ring=a},mpbz:function(e,t,n){(function(t,n){e.exports=n()})(0,(function(){"use strict";function e(n,r,i,o,a,s){if(!(a-o<=i)){var u=o+a>>1;t(n,r,u,o,a,s%2),e(n,r,i,o,u-1,s+1),e(n,r,i,u+1,a,s+1)}}function t(e,r,i,o,a,s){while(a>o){if(a-o>600){var u=a-o+1,c=i-o+1,l=Math.log(u),p=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*p*(u-p)/u)*(c-u/2<0?-1:1),h=Math.max(o,Math.floor(i-c*p/u+f)),d=Math.min(a,Math.floor(i+(u-c)*p/u+f));t(e,r,i,h,d,s)}var m=r[2*i+s],g=o,v=a;n(e,r,o,i),r[2*a+s]>m&&n(e,r,o,a);while(g<v){n(e,r,g,v),g++,v--;while(r[2*g+s]<m)g++;while(r[2*v+s]>m)v--}r[2*o+s]===m?n(e,r,o,v):(v++,n(e,r,v,a)),v<=i&&(o=v+1),i<=v&&(a=v-1)}}function n(e,t,n,i){r(e,n,i),r(t,2*n,2*i),r(t,2*n+1,2*i+1)}function r(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function i(e,t,n,r,i,o,a){var s,u,c=[0,e.length-1,0],l=[];while(c.length){var p=c.pop(),f=c.pop(),h=c.pop();if(f-h<=a)for(var d=h;d<=f;d++)s=t[2*d],u=t[2*d+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(e[d]);else{var m=Math.floor((h+f)/2);s=t[2*m],u=t[2*m+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(e[m]);var g=(p+1)%2;(0===p?n<=s:r<=u)&&(c.push(h),c.push(m-1),c.push(g)),(0===p?i>=s:o>=u)&&(c.push(m+1),c.push(f),c.push(g))}}return l}function o(e,t,n,r,i,o){var s=[0,e.length-1,0],u=[],c=i*i;while(s.length){var l=s.pop(),p=s.pop(),f=s.pop();if(p-f<=o)for(var h=f;h<=p;h++)a(t[2*h],t[2*h+1],n,r)<=c&&u.push(e[h]);else{var d=Math.floor((f+p)/2),m=t[2*d],g=t[2*d+1];a(m,g,n,r)<=c&&u.push(e[d]);var v=(l+1)%2;(0===l?n-i<=m:r-i<=g)&&(s.push(f),s.push(d-1),s.push(v)),(0===l?n+i>=m:r+i>=g)&&(s.push(d+1),s.push(p),s.push(v))}}return u}function a(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}var s=function(e){return e[0]},u=function(e){return e[1]},c=function(t,n,r,i,o){void 0===n&&(n=s),void 0===r&&(r=u),void 0===i&&(i=64),void 0===o&&(o=Float64Array),this.nodeSize=i,this.points=t;for(var a=t.length<65536?Uint16Array:Uint32Array,c=this.ids=new a(t.length),l=this.coords=new o(2*t.length),p=0;p<t.length;p++)c[p]=p,l[2*p]=n(t[p]),l[2*p+1]=r(t[p]);e(c,l,i,0,c.length-1,0)};c.prototype.range=function(e,t,n,r){return i(this.ids,this.coords,e,t,n,r,this.nodeSize)},c.prototype.within=function(e,t,n){return o(this.ids,this.coords,e,t,n,this.nodeSize)};var l={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},p=function(e){this.options=b(Object.create(l),e),this.trees=new Array(this.options.maxZoom+1)};function f(e,t,n,r,i){return{x:e,y:t,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function h(e,t){var n=e.geometry.coordinates,r=n[0],i=n[1];return{x:g(r),y:v(i),zoom:1/0,index:t,parentId:-1}}function d(e){return{type:"Feature",id:e.id,properties:m(e),geometry:{type:"Point",coordinates:[y(e.x),_(e.y)]}}}function m(e){var t=e.numPoints,n=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return b(b({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:n})}function g(e){return e/360+.5}function v(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function y(e){return 360*(e-.5)}function _(e){var t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function b(e,t){for(var n in t)e[n]=t[n];return e}function x(e){return e.x}function w(e){return e.y}return p.prototype.load=function(e){var t=this.options,n=t.log,r=t.minZoom,i=t.maxZoom,o=t.nodeSize;n&&console.time("total time");var a="prepare "+e.length+" points";n&&console.time(a),this.points=e;for(var s=[],u=0;u<e.length;u++)e[u].geometry&&s.push(h(e[u],u));this.trees[i+1]=new c(s,x,w,o,Float32Array),n&&console.timeEnd(a);for(var l=i;l>=r;l--){var p=+Date.now();s=this._cluster(s,l),this.trees[l]=new c(s,x,w,o,Float32Array),n&&console.log("z%d: %d clusters in %dms",l,s.length,+Date.now()-p)}return n&&console.timeEnd("total time"),this},p.prototype.getClusters=function(e,t){var n=((e[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){var a=this.getClusters([n,r,180,o],t),s=this.getClusters([-180,r,i,o],t);return a.concat(s)}for(var u=this.trees[this._limitZoom(t)],c=u.range(g(n),v(o),g(i),v(r)),l=[],p=0,f=c;p<f.length;p+=1){var h=f[p],m=u.points[h];l.push(m.numPoints?d(m):this.points[m.index])}return l},p.prototype.getChildren=function(e){var t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[t];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(o.x,o.y,a),u=[],c=0,l=s;c<l.length;c+=1){var p=l[c],f=i.points[p];f.parentId===e&&u.push(f.numPoints?d(f):this.points[f.index])}if(0===u.length)throw new Error(r);return u},p.prototype.getLeaves=function(e,t,n){t=t||10,n=n||0;var r=[];return this._appendLeaves(r,e,t,n,0),r},p.prototype.getTile=function(e,t,n){var r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),o=this.options,a=o.extent,s=o.radius,u=s/a,c=(n-u)/i,l=(n+1+u)/i,p={features:[]};return this._addTileFeatures(r.range((t-u)/i,c,(t+1+u)/i,l),r.points,t,n,i,p),0===t&&this._addTileFeatures(r.range(1-u/i,c,1,l),r.points,i,n,i,p),t===i-1&&this._addTileFeatures(r.range(0,c,u/i,l),r.points,-1,n,i,p),p.features.length?p:null},p.prototype.getClusterExpansionZoom=function(e){var t=this._getOriginZoom(e)-1;while(t<=this.options.maxZoom){var n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t},p.prototype._appendLeaves=function(e,t,n,r,i){for(var o=this.getChildren(t),a=0,s=o;a<s.length;a+=1){var u=s[a],c=u.properties;if(c&&c.cluster?i+c.point_count<=r?i+=c.point_count:i=this._appendLeaves(e,c.cluster_id,n,r,i):i<r?i++:e.push(u),e.length===n)break}return i},p.prototype._addTileFeatures=function(e,t,n,r,i,o){for(var a=0,s=e;a<s.length;a+=1){var u=s[a],c=t[u],l=c.numPoints,p={type:1,geometry:[[Math.round(this.options.extent*(c.x*i-n)),Math.round(this.options.extent*(c.y*i-r))]],tags:l?m(c):this.points[c.index].properties},f=void 0;l?f=c.id:this.options.generateId?f=c.index:this.points[c.index].id&&(f=this.points[c.index].id),void 0!==f&&(p.id=f),o.features.push(p)}},p.prototype._limitZoom=function(e){return Math.max(this.options.minZoom,Math.min(e,this.options.maxZoom+1))},p.prototype._cluster=function(e,t){for(var n=[],r=this.options,i=r.radius,o=r.extent,a=r.reduce,s=i/(o*Math.pow(2,t)),u=0;u<e.length;u++){var c=e[u];if(!(c.zoom<=t)){c.zoom=t;for(var l=this.trees[t+1],p=l.within(c.x,c.y,s),h=c.numPoints||1,d=c.x*h,m=c.y*h,g=a&&h>1?this._map(c,!0):null,v=(u<<5)+(t+1)+this.points.length,y=0,_=p;y<_.length;y+=1){var b=_[y],x=l.points[b];if(!(x.zoom<=t)){x.zoom=t;var w=x.numPoints||1;d+=x.x*w,m+=x.y*w,h+=w,x.parentId=v,a&&(g||(g=this._map(c,!0)),a(g,this._map(x)))}}1===h?n.push(c):(c.parentId=v,n.push(f(d/h,m/h,v,h,g)))}}return n},p.prototype._getOriginId=function(e){return e-this.points.length>>5},p.prototype._getOriginZoom=function(e){return(e-this.points.length)%32},p.prototype._map=function(e,t){if(e.numPoints)return t?b({},e.properties):e.properties;var n=this.points[e.index].properties,r=this.options.map(n);return t&&r===n?b({},r):r},p}))},"n+fv":function(e,t,n){"use strict";n.r(t),n.d(t,"create",(function(){return i})),n.d(t,"clone",(function(){return o})),n.d(t,"length",(function(){return a})),n.d(t,"fromValues",(function(){return s})),n.d(t,"copy",(function(){return u})),n.d(t,"set",(function(){return c})),n.d(t,"add",(function(){return l})),n.d(t,"subtract",(function(){return p})),n.d(t,"multiply",(function(){return f})),n.d(t,"divide",(function(){return h})),n.d(t,"ceil",(function(){return d})),n.d(t,"floor",(function(){return m})),n.d(t,"min",(function(){return g})),n.d(t,"max",(function(){return v})),n.d(t,"round",(function(){return y})),n.d(t,"scale",(function(){return _})),n.d(t,"scaleAndAdd",(function(){return b})),n.d(t,"distance",(function(){return x})),n.d(t,"squaredDistance",(function(){return w})),n.d(t,"squaredLength",(function(){return S})),n.d(t,"negate",(function(){return E})),n.d(t,"inverse",(function(){return T})),n.d(t,"normalize",(function(){return k})),n.d(t,"dot",(function(){return A})),n.d(t,"cross",(function(){return C})),n.d(t,"lerp",(function(){return I})),n.d(t,"hermite",(function(){return M})),n.d(t,"bezier",(function(){return P})),n.d(t,"random",(function(){return O})),n.d(t,"transformMat4",(function(){return L})),n.d(t,"transformMat3",(function(){return R})),n.d(t,"transformQuat",(function(){return D})),n.d(t,"rotateX",(function(){return z})),n.d(t,"rotateY",(function(){return N})),n.d(t,"rotateZ",(function(){return j})),n.d(t,"angle",(function(){return F})),n.d(t,"zero",(function(){return B})),n.d(t,"str",(function(){return U})),n.d(t,"exactEquals",(function(){return V})),n.d(t,"equals",(function(){return G})),n.d(t,"sub",(function(){return q})),n.d(t,"mul",(function(){return Z})),n.d(t,"div",(function(){return H})),n.d(t,"dist",(function(){return W})),n.d(t,"sqrDist",(function(){return Y})),n.d(t,"len",(function(){return X})),n.d(t,"sqrLen",(function(){return K})),n.d(t,"forEach",(function(){return J}));var r=n("yU0y");function i(){var e=new r["a"](3);return r["a"]!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function o(e){var t=new r["a"](3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function s(e,t,n){var i=new r["a"](3);return i[0]=e,i[1]=t,i[2]=n,i}function u(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function c(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function l(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function p(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function f(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function h(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function d(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function m(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function g(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function v(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function y(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function _(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function b(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e}function x(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function w(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function S(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function E(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function T(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function k(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function A(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function C(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e}function I(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e}function M(e,t,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return e[0]=t[0]*s+n[0]*u+r[0]*c+i[0]*l,e[1]=t[1]*s+n[1]*u+r[1]*c+i[1]*l,e[2]=t[2]*s+n[2]*u+r[2]*c+i[2]*l,e}function P(e,t,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,p=3*u*a,f=u*o;return e[0]=t[0]*c+n[0]*l+r[0]*p+i[0]*f,e[1]=t[1]*c+n[1]*l+r[1]*p+i[1]*f,e[2]=t[2]*c+n[2]*l+r[2]*p+i[2]*f,e}function O(e,t){t=t||1;var n=2*r["c"]()*Math.PI,i=2*r["c"]()-1,o=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=i*t,e}function L(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e}function R(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e}function D(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],c=t[2],l=i*c-o*u,p=o*s-r*c,f=r*u-i*s,h=i*f-o*p,d=o*l-r*f,m=r*p-i*l,g=2*a;return l*=g,p*=g,f*=g,h*=2,d*=2,m*=2,e[0]=s+l+h,e[1]=u+p+d,e[2]=c+f+m,e}function z(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}function N(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}function j(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e}function F(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],a=t[1],s=t[2],u=Math.sqrt(n*n+r*r+i*i),c=Math.sqrt(o*o+a*a+s*s),l=u*c,p=l&&A(e,t)/l;return Math.acos(Math.min(Math.max(p,-1),1))}function B(e){return e[0]=0,e[1]=0,e[2]=0,e}function U(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function V(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function G(e,t){var n=e[0],i=e[1],o=e[2],a=t[0],s=t[1],u=t[2];return Math.abs(n-a)<=r["b"]*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r["b"]*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r["b"]*Math.max(1,Math.abs(o),Math.abs(u))}var q=p,Z=f,H=h,W=x,Y=w,X=a,K=S,J=function(){var e=i();return function(t,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}()},n2J3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(){return function(e,t,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(e,t,n,a)}}t.unmanaged=a},"o+pz":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e["DEPTH_BUFFER_BIT"]=256]="DEPTH_BUFFER_BIT",e[e["STENCIL_BUFFER_BIT"]=1024]="STENCIL_BUFFER_BIT",e[e["COLOR_BUFFER_BIT"]=16384]="COLOR_BUFFER_BIT",e[e["POINTS"]=0]="POINTS",e[e["LINES"]=1]="LINES",e[e["LINE_LOOP"]=2]="LINE_LOOP",e[e["LINE_STRIP"]=3]="LINE_STRIP",e[e["TRIANGLES"]=4]="TRIANGLES",e[e["TRIANGLE_STRIP"]=5]="TRIANGLE_STRIP",e[e["TRIANGLE_FAN"]=6]="TRIANGLE_FAN",e[e["ZERO"]=0]="ZERO",e[e["ONE"]=1]="ONE",e[e["SRC_COLOR"]=768]="SRC_COLOR",e[e["ONE_MINUS_SRC_COLOR"]=769]="ONE_MINUS_SRC_COLOR",e[e["SRC_ALPHA"]=770]="SRC_ALPHA",e[e["ONE_MINUS_SRC_ALPHA"]=771]="ONE_MINUS_SRC_ALPHA",e[e["DST_ALPHA"]=772]="DST_ALPHA",e[e["ONE_MINUS_DST_ALPHA"]=773]="ONE_MINUS_DST_ALPHA",e[e["DST_COLOR"]=774]="DST_COLOR",e[e["ONE_MINUS_DST_COLOR"]=775]="ONE_MINUS_DST_COLOR",e[e["SRC_ALPHA_SATURATE"]=776]="SRC_ALPHA_SATURATE",e[e["FUNC_ADD"]=32774]="FUNC_ADD",e[e["BLEND_EQUATION"]=32777]="BLEND_EQUATION",e[e["BLEND_EQUATION_RGB"]=32777]="BLEND_EQUATION_RGB",e[e["BLEND_EQUATION_ALPHA"]=34877]="BLEND_EQUATION_ALPHA",e[e["FUNC_SUBTRACT"]=32778]="FUNC_SUBTRACT",e[e["FUNC_REVERSE_SUBTRACT"]=32779]="FUNC_REVERSE_SUBTRACT",e[e["MAX_EXT"]=32776]="MAX_EXT",e[e["MIN_EXT"]=32775]="MIN_EXT",e[e["BLEND_DST_RGB"]=32968]="BLEND_DST_RGB",e[e["BLEND_SRC_RGB"]=32969]="BLEND_SRC_RGB",e[e["BLEND_DST_ALPHA"]=32970]="BLEND_DST_ALPHA",e[e["BLEND_SRC_ALPHA"]=32971]="BLEND_SRC_ALPHA",e[e["CONSTANT_COLOR"]=32769]="CONSTANT_COLOR",e[e["ONE_MINUS_CONSTANT_COLOR"]=32770]="ONE_MINUS_CONSTANT_COLOR",e[e["CONSTANT_ALPHA"]=32771]="CONSTANT_ALPHA",e[e["ONE_MINUS_CONSTANT_ALPHA"]=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e["BLEND_COLOR"]=32773]="BLEND_COLOR",e[e["ARRAY_BUFFER"]=34962]="ARRAY_BUFFER",e[e["ELEMENT_ARRAY_BUFFER"]=34963]="ELEMENT_ARRAY_BUFFER",e[e["ARRAY_BUFFER_BINDING"]=34964]="ARRAY_BUFFER_BINDING",e[e["ELEMENT_ARRAY_BUFFER_BINDING"]=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e["STREAM_DRAW"]=35040]="STREAM_DRAW",e[e["STATIC_DRAW"]=35044]="STATIC_DRAW",e[e["DYNAMIC_DRAW"]=35048]="DYNAMIC_DRAW",e[e["BUFFER_SIZE"]=34660]="BUFFER_SIZE",e[e["BUFFER_USAGE"]=34661]="BUFFER_USAGE",e[e["CURRENT_VERTEX_ATTRIB"]=34342]="CURRENT_VERTEX_ATTRIB",e[e["FRONT"]=1028]="FRONT",e[e["BACK"]=1029]="BACK",e[e["FRONT_AND_BACK"]=1032]="FRONT_AND_BACK",e[e["CULL_FACE"]=2884]="CULL_FACE",e[e["BLEND"]=3042]="BLEND",e[e["DITHER"]=3024]="DITHER",e[e["STENCIL_TEST"]=2960]="STENCIL_TEST",e[e["DEPTH_TEST"]=2929]="DEPTH_TEST",e[e["SCISSOR_TEST"]=3089]="SCISSOR_TEST",e[e["POLYGON_OFFSET_FILL"]=32823]="POLYGON_OFFSET_FILL",e[e["SAMPLE_ALPHA_TO_COVERAGE"]=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e["SAMPLE_COVERAGE"]=32928]="SAMPLE_COVERAGE",e[e["NO_ERROR"]=0]="NO_ERROR",e[e["INVALID_ENUM"]=1280]="INVALID_ENUM",e[e["INVALID_VALUE"]=1281]="INVALID_VALUE",e[e["INVALID_OPERATION"]=1282]="INVALID_OPERATION",e[e["OUT_OF_MEMORY"]=1285]="OUT_OF_MEMORY",e[e["CW"]=2304]="CW",e[e["CCW"]=2305]="CCW",e[e["LINE_WIDTH"]=2849]="LINE_WIDTH",e[e["ALIASED_POINT_SIZE_RANGE"]=33901]="ALIASED_POINT_SIZE_RANGE",e[e["ALIASED_LINE_WIDTH_RANGE"]=33902]="ALIASED_LINE_WIDTH_RANGE",e[e["CULL_FACE_MODE"]=2885]="CULL_FACE_MODE",e[e["FRONT_FACE"]=2886]="FRONT_FACE",e[e["DEPTH_RANGE"]=2928]="DEPTH_RANGE",e[e["DEPTH_WRITEMASK"]=2930]="DEPTH_WRITEMASK",e[e["DEPTH_CLEAR_VALUE"]=2931]="DEPTH_CLEAR_VALUE",e[e["DEPTH_FUNC"]=2932]="DEPTH_FUNC",e[e["STENCIL_CLEAR_VALUE"]=2961]="STENCIL_CLEAR_VALUE",e[e["STENCIL_FUNC"]=2962]="STENCIL_FUNC",e[e["STENCIL_FAIL"]=2964]="STENCIL_FAIL",e[e["STENCIL_PASS_DEPTH_FAIL"]=2965]="STENCIL_PASS_DEPTH_FAIL",e[e["STENCIL_PASS_DEPTH_PASS"]=2966]="STENCIL_PASS_DEPTH_PASS",e[e["STENCIL_REF"]=2967]="STENCIL_REF",e[e["STENCIL_VALUE_MASK"]=2963]="STENCIL_VALUE_MASK",e[e["STENCIL_WRITEMASK"]=2968]="STENCIL_WRITEMASK",e[e["STENCIL_BACK_FUNC"]=34816]="STENCIL_BACK_FUNC",e[e["STENCIL_BACK_FAIL"]=34817]="STENCIL_BACK_FAIL",e[e["STENCIL_BACK_PASS_DEPTH_FAIL"]=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e["STENCIL_BACK_PASS_DEPTH_PASS"]=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e["STENCIL_BACK_REF"]=36003]="STENCIL_BACK_REF",e[e["STENCIL_BACK_VALUE_MASK"]=36004]="STENCIL_BACK_VALUE_MASK",e[e["STENCIL_BACK_WRITEMASK"]=36005]="STENCIL_BACK_WRITEMASK",e[e["VIEWPORT"]=2978]="VIEWPORT",e[e["SCISSOR_BOX"]=3088]="SCISSOR_BOX",e[e["COLOR_CLEAR_VALUE"]=3106]="COLOR_CLEAR_VALUE",e[e["COLOR_WRITEMASK"]=3107]="COLOR_WRITEMASK",e[e["UNPACK_ALIGNMENT"]=3317]="UNPACK_ALIGNMENT",e[e["PACK_ALIGNMENT"]=3333]="PACK_ALIGNMENT",e[e["MAX_TEXTURE_SIZE"]=3379]="MAX_TEXTURE_SIZE",e[e["MAX_VIEWPORT_DIMS"]=3386]="MAX_VIEWPORT_DIMS",e[e["SUBPIXEL_BITS"]=3408]="SUBPIXEL_BITS",e[e["RED_BITS"]=3410]="RED_BITS",e[e["GREEN_BITS"]=3411]="GREEN_BITS",e[e["BLUE_BITS"]=3412]="BLUE_BITS",e[e["ALPHA_BITS"]=3413]="ALPHA_BITS",e[e["DEPTH_BITS"]=3414]="DEPTH_BITS",e[e["STENCIL_BITS"]=3415]="STENCIL_BITS",e[e["POLYGON_OFFSET_UNITS"]=10752]="POLYGON_OFFSET_UNITS",e[e["POLYGON_OFFSET_FACTOR"]=32824]="POLYGON_OFFSET_FACTOR",e[e["TEXTURE_BINDING_2D"]=32873]="TEXTURE_BINDING_2D",e[e["SAMPLE_BUFFERS"]=32936]="SAMPLE_BUFFERS",e[e["SAMPLES"]=32937]="SAMPLES",e[e["SAMPLE_COVERAGE_VALUE"]=32938]="SAMPLE_COVERAGE_VALUE",e[e["SAMPLE_COVERAGE_INVERT"]=32939]="SAMPLE_COVERAGE_INVERT",e[e["COMPRESSED_TEXTURE_FORMATS"]=34467]="COMPRESSED_TEXTURE_FORMATS",e[e["DONT_CARE"]=4352]="DONT_CARE",e[e["FASTEST"]=4353]="FASTEST",e[e["NICEST"]=4354]="NICEST",e[e["GENERATE_MIPMAP_HINT"]=33170]="GENERATE_MIPMAP_HINT",e[e["BYTE"]=5120]="BYTE",e[e["UNSIGNED_BYTE"]=5121]="UNSIGNED_BYTE",e[e["SHORT"]=5122]="SHORT",e[e["UNSIGNED_SHORT"]=5123]="UNSIGNED_SHORT",e[e["INT"]=5124]="INT",e[e["UNSIGNED_INT"]=5125]="UNSIGNED_INT",e[e["FLOAT"]=5126]="FLOAT",e[e["DEPTH_COMPONENT"]=6402]="DEPTH_COMPONENT",e[e["ALPHA"]=6406]="ALPHA",e[e["RGB"]=6407]="RGB",e[e["RGBA"]=6408]="RGBA",e[e["LUMINANCE"]=6409]="LUMINANCE",e[e["LUMINANCE_ALPHA"]=6410]="LUMINANCE_ALPHA",e[e["UNSIGNED_SHORT_4_4_4_4"]=32819]="UNSIGNED_SHORT_4_4_4_4",e[e["UNSIGNED_SHORT_5_5_5_1"]=32820]="UNSIGNED_SHORT_5_5_5_1",e[e["UNSIGNED_SHORT_5_6_5"]=33635]="UNSIGNED_SHORT_5_6_5",e[e["FRAGMENT_SHADER"]=35632]="FRAGMENT_SHADER",e[e["VERTEX_SHADER"]=35633]="VERTEX_SHADER",e[e["MAX_VERTEX_ATTRIBS"]=34921]="MAX_VERTEX_ATTRIBS",e[e["MAX_VERTEX_UNIFORM_VECTORS"]=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e["MAX_VARYING_VECTORS"]=36348]="MAX_VARYING_VECTORS",e[e["MAX_COMBINED_TEXTURE_IMAGE_UNITS"]=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e["MAX_VERTEX_TEXTURE_IMAGE_UNITS"]=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e["MAX_TEXTURE_IMAGE_UNITS"]=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e["MAX_FRAGMENT_UNIFORM_VECTORS"]=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e["SHADER_TYPE"]=35663]="SHADER_TYPE",e[e["DELETE_STATUS"]=35712]="DELETE_STATUS",e[e["LINK_STATUS"]=35714]="LINK_STATUS",e[e["VALIDATE_STATUS"]=35715]="VALIDATE_STATUS",e[e["ATTACHED_SHADERS"]=35717]="ATTACHED_SHADERS",e[e["ACTIVE_UNIFORMS"]=35718]="ACTIVE_UNIFORMS",e[e["ACTIVE_ATTRIBUTES"]=35721]="ACTIVE_ATTRIBUTES",e[e["SHADING_LANGUAGE_VERSION"]=35724]="SHADING_LANGUAGE_VERSION",e[e["CURRENT_PROGRAM"]=35725]="CURRENT_PROGRAM",e[e["NEVER"]=512]="NEVER",e[e["LESS"]=513]="LESS",e[e["EQUAL"]=514]="EQUAL",e[e["LEQUAL"]=515]="LEQUAL",e[e["GREATER"]=516]="GREATER",e[e["NOTEQUAL"]=517]="NOTEQUAL",e[e["GEQUAL"]=518]="GEQUAL",e[e["ALWAYS"]=519]="ALWAYS",e[e["KEEP"]=7680]="KEEP",e[e["REPLACE"]=7681]="REPLACE",e[e["INCR"]=7682]="INCR",e[e["DECR"]=7683]="DECR",e[e["INVERT"]=5386]="INVERT",e[e["INCR_WRAP"]=34055]="INCR_WRAP",e[e["DECR_WRAP"]=34056]="DECR_WRAP",e[e["VENDOR"]=7936]="VENDOR",e[e["RENDERER"]=7937]="RENDERER",e[e["VERSION"]=7938]="VERSION",e[e["NEAREST"]=9728]="NEAREST",e[e["LINEAR"]=9729]="LINEAR",e[e["NEAREST_MIPMAP_NEAREST"]=9984]="NEAREST_MIPMAP_NEAREST",e[e["LINEAR_MIPMAP_NEAREST"]=9985]="LINEAR_MIPMAP_NEAREST",e[e["NEAREST_MIPMAP_LINEAR"]=9986]="NEAREST_MIPMAP_LINEAR",e[e["LINEAR_MIPMAP_LINEAR"]=9987]="LINEAR_MIPMAP_LINEAR",e[e["TEXTURE_MAG_FILTER"]=10240]="TEXTURE_MAG_FILTER",e[e["TEXTURE_MIN_FILTER"]=10241]="TEXTURE_MIN_FILTER",e[e["TEXTURE_WRAP_S"]=10242]="TEXTURE_WRAP_S",e[e["TEXTURE_WRAP_T"]=10243]="TEXTURE_WRAP_T",e[e["TEXTURE_2D"]=3553]="TEXTURE_2D",e[e["TEXTURE"]=5890]="TEXTURE",e[e["TEXTURE_CUBE_MAP"]=34067]="TEXTURE_CUBE_MAP",e[e["TEXTURE_BINDING_CUBE_MAP"]=34068]="TEXTURE_BINDING_CUBE_MAP",e[e["TEXTURE_CUBE_MAP_POSITIVE_X"]=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e["TEXTURE_CUBE_MAP_NEGATIVE_X"]=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e["TEXTURE_CUBE_MAP_POSITIVE_Y"]=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e["TEXTURE_CUBE_MAP_NEGATIVE_Y"]=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e["TEXTURE_CUBE_MAP_POSITIVE_Z"]=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e["TEXTURE_CUBE_MAP_NEGATIVE_Z"]=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e["MAX_CUBE_MAP_TEXTURE_SIZE"]=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e["TEXTURE0"]=33984]="TEXTURE0",e[e["TEXTURE1"]=33985]="TEXTURE1",e[e["TEXTURE2"]=33986]="TEXTURE2",e[e["TEXTURE3"]=33987]="TEXTURE3",e[e["TEXTURE4"]=33988]="TEXTURE4",e[e["TEXTURE5"]=33989]="TEXTURE5",e[e["TEXTURE6"]=33990]="TEXTURE6",e[e["TEXTURE7"]=33991]="TEXTURE7",e[e["TEXTURE8"]=33992]="TEXTURE8",e[e["TEXTURE9"]=33993]="TEXTURE9",e[e["TEXTURE10"]=33994]="TEXTURE10",e[e["TEXTURE11"]=33995]="TEXTURE11",e[e["TEXTURE12"]=33996]="TEXTURE12",e[e["TEXTURE13"]=33997]="TEXTURE13",e[e["TEXTURE14"]=33998]="TEXTURE14",e[e["TEXTURE15"]=33999]="TEXTURE15",e[e["TEXTURE16"]=34e3]="TEXTURE16",e[e["TEXTURE17"]=34001]="TEXTURE17",e[e["TEXTURE18"]=34002]="TEXTURE18",e[e["TEXTURE19"]=34003]="TEXTURE19",e[e["TEXTURE20"]=34004]="TEXTURE20",e[e["TEXTURE21"]=34005]="TEXTURE21",e[e["TEXTURE22"]=34006]="TEXTURE22",e[e["TEXTURE23"]=34007]="TEXTURE23",e[e["TEXTURE24"]=34008]="TEXTURE24",e[e["TEXTURE25"]=34009]="TEXTURE25",e[e["TEXTURE26"]=34010]="TEXTURE26",e[e["TEXTURE27"]=34011]="TEXTURE27",e[e["TEXTURE28"]=34012]="TEXTURE28",e[e["TEXTURE29"]=34013]="TEXTURE29",e[e["TEXTURE30"]=34014]="TEXTURE30",e[e["TEXTURE31"]=34015]="TEXTURE31",e[e["ACTIVE_TEXTURE"]=34016]="ACTIVE_TEXTURE",e[e["REPEAT"]=10497]="REPEAT",e[e["CLAMP_TO_EDGE"]=33071]="CLAMP_TO_EDGE",e[e["MIRRORED_REPEAT"]=33648]="MIRRORED_REPEAT",e[e["FLOAT_VEC2"]=35664]="FLOAT_VEC2",e[e["FLOAT_VEC3"]=35665]="FLOAT_VEC3",e[e["FLOAT_VEC4"]=35666]="FLOAT_VEC4",e[e["INT_VEC2"]=35667]="INT_VEC2",e[e["INT_VEC3"]=35668]="INT_VEC3",e[e["INT_VEC4"]=35669]="INT_VEC4",e[e["BOOL"]=35670]="BOOL",e[e["BOOL_VEC2"]=35671]="BOOL_VEC2",e[e["BOOL_VEC3"]=35672]="BOOL_VEC3",e[e["BOOL_VEC4"]=35673]="BOOL_VEC4",e[e["FLOAT_MAT2"]=35674]="FLOAT_MAT2",e[e["FLOAT_MAT3"]=35675]="FLOAT_MAT3",e[e["FLOAT_MAT4"]=35676]="FLOAT_MAT4",e[e["SAMPLER_2D"]=35678]="SAMPLER_2D",e[e["SAMPLER_CUBE"]=35680]="SAMPLER_CUBE",e[e["VERTEX_ATTRIB_ARRAY_ENABLED"]=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e["VERTEX_ATTRIB_ARRAY_SIZE"]=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e["VERTEX_ATTRIB_ARRAY_STRIDE"]=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e["VERTEX_ATTRIB_ARRAY_TYPE"]=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e["VERTEX_ATTRIB_ARRAY_NORMALIZED"]=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e["VERTEX_ATTRIB_ARRAY_POINTER"]=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e["VERTEX_ATTRIB_ARRAY_BUFFER_BINDING"]=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e["COMPILE_STATUS"]=35713]="COMPILE_STATUS",e[e["LOW_FLOAT"]=36336]="LOW_FLOAT",e[e["MEDIUM_FLOAT"]=36337]="MEDIUM_FLOAT",e[e["HIGH_FLOAT"]=36338]="HIGH_FLOAT",e[e["LOW_INT"]=36339]="LOW_INT",e[e["MEDIUM_INT"]=36340]="MEDIUM_INT",e[e["HIGH_INT"]=36341]="HIGH_INT",e[e["FRAMEBUFFER"]=36160]="FRAMEBUFFER",e[e["RENDERBUFFER"]=36161]="RENDERBUFFER",e[e["RGBA4"]=32854]="RGBA4",e[e["RGB5_A1"]=32855]="RGB5_A1",e[e["RGB565"]=36194]="RGB565",e[e["DEPTH_COMPONENT16"]=33189]="DEPTH_COMPONENT16",e[e["STENCIL_INDEX"]=6401]="STENCIL_INDEX",e[e["STENCIL_INDEX8"]=36168]="STENCIL_INDEX8",e[e["DEPTH_STENCIL"]=34041]="DEPTH_STENCIL",e[e["RENDERBUFFER_WIDTH"]=36162]="RENDERBUFFER_WIDTH",e[e["RENDERBUFFER_HEIGHT"]=36163]="RENDERBUFFER_HEIGHT",e[e["RENDERBUFFER_INTERNAL_FORMAT"]=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e["RENDERBUFFER_RED_SIZE"]=36176]="RENDERBUFFER_RED_SIZE",e[e["RENDERBUFFER_GREEN_SIZE"]=36177]="RENDERBUFFER_GREEN_SIZE",e[e["RENDERBUFFER_BLUE_SIZE"]=36178]="RENDERBUFFER_BLUE_SIZE",e[e["RENDERBUFFER_ALPHA_SIZE"]=36179]="RENDERBUFFER_ALPHA_SIZE",e[e["RENDERBUFFER_DEPTH_SIZE"]=36180]="RENDERBUFFER_DEPTH_SIZE",e[e["RENDERBUFFER_STENCIL_SIZE"]=36181]="RENDERBUFFER_STENCIL_SIZE",e[e["FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE"]=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e["FRAMEBUFFER_ATTACHMENT_OBJECT_NAME"]=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e["FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL"]=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e["FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE"]=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e["COLOR_ATTACHMENT0"]=36064]="COLOR_ATTACHMENT0",e[e["DEPTH_ATTACHMENT"]=36096]="DEPTH_ATTACHMENT",e[e["STENCIL_ATTACHMENT"]=36128]="STENCIL_ATTACHMENT",e[e["DEPTH_STENCIL_ATTACHMENT"]=33306]="DEPTH_STENCIL_ATTACHMENT",e[e["NONE"]=0]="NONE",e[e["FRAMEBUFFER_COMPLETE"]=36053]="FRAMEBUFFER_COMPLETE",e[e["FRAMEBUFFER_INCOMPLETE_ATTACHMENT"]=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e["FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"]=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e["FRAMEBUFFER_INCOMPLETE_DIMENSIONS"]=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e["FRAMEBUFFER_UNSUPPORTED"]=36061]="FRAMEBUFFER_UNSUPPORTED",e[e["FRAMEBUFFER_BINDING"]=36006]="FRAMEBUFFER_BINDING",e[e["RENDERBUFFER_BINDING"]=36007]="RENDERBUFFER_BINDING",e[e["MAX_RENDERBUFFER_SIZE"]=34024]="MAX_RENDERBUFFER_SIZE",e[e["INVALID_FRAMEBUFFER_OPERATION"]=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e["UNPACK_FLIP_Y_WEBGL"]=37440]="UNPACK_FLIP_Y_WEBGL",e[e["UNPACK_PREMULTIPLY_ALPHA_WEBGL"]=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e["CONTEXT_LOST_WEBGL"]=37442]="CONTEXT_LOST_WEBGL",e[e["UNPACK_COLORSPACE_CONVERSION_WEBGL"]=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e["BROWSER_DEFAULT_WEBGL"]=37444]="BROWSER_DEFAULT_WEBGL"}(r||(r={}))},"oCl/":function(e,t,n){var r=n("CH3K"),i=n("LcsW"),o=n("MvSz"),a=n("0ycA"),s=Object.getOwnPropertySymbols,u=s?function(e){var t=[];while(e)r(t,o(e)),e=i(e);return t}:a;e.exports=u},oShl:function(e,t,n){var r=n("Nsbk"),i=n("SksO"),o=n("xfeJ"),a=n("sXyB");function s(t){var n="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},oaX6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=n("GXnB"),o=n("Ztfv");function a(e){return function(t,n,a){var s=new i.Metadata(r.NAME_TAG,e);o.tagParameter(t,n,a,s)}}t.targetName=a},"otv/":function(e,t,n){var r=n("nmnc"),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;function a(e){return o?Object(o.call(e)):{}}e.exports=a},"oy+k":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("d9O0"),i=function(){function e(e){this.id=r.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=i},q4HE:function(e,t){var n="\\ud800-\\udfff",r="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",a=r+i+o,s="\\ufe0e\\ufe0f",u="["+n+"]",c="["+a+"]",l="\\ud83c[\\udffb-\\udfff]",p="(?:"+c+"|"+l+")",f="[^"+n+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",d="[\\ud800-\\udbff][\\udc00-\\udfff]",m="\\u200d",g=p+"?",v="["+s+"]?",y="(?:"+m+"(?:"+[f,h,d].join("|")+")"+v+g+")*",_=v+g+y,b="(?:"+[f+c+"?",c,h,d,u].join("|")+")",x=RegExp(l+"(?="+l+")|"+b+_,"g");function w(e){var t=x.lastIndex=0;while(x.test(e))++t;return t}e.exports=w},qK8v:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2");function i(e){return e instanceof RangeError||e.message===r.STACK_OVERFLOW}t.isStackOverflowExeption=i},qRkn:function(e,t,n){var r=n("3cYt"),i={\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"},o=r(i);e.exports=o},qd8s:function(e,t,n){(function(e,n){var r=200,i="__lodash_hash_undefined__",o=800,a=16,s=9007199254740991,u="[object Arguments]",c="[object Array]",l="[object AsyncFunction]",p="[object Boolean]",f="[object Date]",h="[object Error]",d="[object Function]",m="[object GeneratorFunction]",g="[object Map]",v="[object Number]",y="[object Null]",_="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",E="[object Undefined]",T="[object WeakMap]",k="[object ArrayBuffer]",A="[object DataView]",C="[object Float32Array]",I="[object Float64Array]",M="[object Int8Array]",P="[object Int16Array]",O="[object Int32Array]",L="[object Uint8Array]",R="[object Uint8ClampedArray]",D="[object Uint16Array]",z="[object Uint32Array]",N=/[\\^$.*+?()[\]{}|]/g,j=/^\[object .+?Constructor\]$/,F=/^(?:0|[1-9]\d*)$/,B={};B[C]=B[I]=B[M]=B[P]=B[O]=B[L]=B[R]=B[D]=B[z]=!0,B[u]=B[c]=B[k]=B[p]=B[A]=B[f]=B[h]=B[d]=B[g]=B[v]=B[_]=B[x]=B[w]=B[S]=B[T]=!1;var U="object"==typeof e&&e&&e.Object===Object&&e,V="object"==typeof self&&self&&self.Object===Object&&self,G=U||V||Function("return this")(),q=t&&!t.nodeType&&t,Z=q&&"object"==typeof n&&n&&!n.nodeType&&n,H=Z&&Z.exports===q,W=H&&U.process,Y=function(){try{var e=Z&&Z.require&&Z.require("util").types;return e||W&&W.binding&&W.binding("util")}catch(t){}}(),X=Y&&Y.isTypedArray;function K(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function J(e,t){var n=-1,r=Array(e);while(++n<e)r[n]=t(n);return r}function Q(e){return function(t){return e(t)}}function $(e,t){return null==e?void 0:e[t]}function ee(e,t){return function(n){return e(t(n))}}var te=Array.prototype,ne=Function.prototype,re=Object.prototype,ie=G["__core-js_shared__"],oe=ne.toString,ae=re.hasOwnProperty,se=function(){var e=/[^.]+$/.exec(ie&&ie.keys&&ie.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ue=re.toString,ce=oe.call(Object),le=RegExp("^"+oe.call(ae).replace(N,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pe=H?G.Buffer:void 0,fe=G.Symbol,he=G.Uint8Array,de=pe?pe.allocUnsafe:void 0,me=ee(Object.getPrototypeOf,Object),ge=Object.create,ve=re.propertyIsEnumerable,ye=te.splice,_e=fe?fe.toStringTag:void 0,be=function(){try{var e=bt(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),xe=pe?pe.isBuffer:void 0,we=Math.max,Se=Date.now,Ee=bt(G,"Map"),Te=bt(Object,"create"),ke=function(){function e(){}return function(t){if(!Gt(t))return{};if(ge)return ge(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Ae(e){var t=-1,n=null==e?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Ce(){this.__data__=Te?Te(null):{},this.size=0}function Ie(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Me(e){var t=this.__data__;if(Te){var n=t[e];return n===i?void 0:n}return ae.call(t,e)?t[e]:void 0}function Pe(e){var t=this.__data__;return Te?void 0!==t[e]:ae.call(t,e)}function Oe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Te&&void 0===t?i:t,this}function Le(e){var t=-1,n=null==e?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Re(){this.__data__=[],this.size=0}function De(e){var t=this.__data__,n=et(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():ye.call(t,n,1),--this.size,!0}function ze(e){var t=this.__data__,n=et(t,e);return n<0?void 0:t[n][1]}function Ne(e){return et(this.__data__,e)>-1}function je(e,t){var n=this.__data__,r=et(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function Fe(e){var t=-1,n=null==e?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Be(){this.size=0,this.__data__={hash:new Ae,map:new(Ee||Le),string:new Ae}}function Ue(e){var t=_t(this,e)["delete"](e);return this.size-=t?1:0,t}function Ve(e){return _t(this,e).get(e)}function Ge(e){return _t(this,e).has(e)}function qe(e,t){var n=_t(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function Ze(e){var t=this.__data__=new Le(e);this.size=t.size}function He(){this.__data__=new Le,this.size=0}function We(e){var t=this.__data__,n=t["delete"](e);return this.size=t.size,n}function Ye(e){return this.__data__.get(e)}function Xe(e){return this.__data__.has(e)}function Ke(e,t){var n=this.__data__;if(n instanceof Le){var i=n.__data__;if(!Ee||i.length<r-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Fe(i)}return n.set(e,t),this.size=n.size,this}function Je(e,t){var n=Nt(e),r=!n&&zt(e),i=!n&&!r&&Bt(e),o=!n&&!r&&!i&&Ht(e),a=n||r||i||o,s=a?J(e.length,String):[],u=s.length;for(var c in e)!t&&!ae.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||St(c,u))||s.push(c);return s}function Qe(e,t,n){(void 0!==n&&!Dt(e[t],n)||void 0===n&&!(t in e))&&tt(e,t,n)}function $e(e,t,n){var r=e[t];ae.call(e,t)&&Dt(r,n)&&(void 0!==n||t in e)||tt(e,t,n)}function et(e,t){var n=e.length;while(n--)if(Dt(e[n][0],t))return n;return-1}function tt(e,t,n){"__proto__"==t&&be?be(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}Ae.prototype.clear=Ce,Ae.prototype["delete"]=Ie,Ae.prototype.get=Me,Ae.prototype.has=Pe,Ae.prototype.set=Oe,Le.prototype.clear=Re,Le.prototype["delete"]=De,Le.prototype.get=ze,Le.prototype.has=Ne,Le.prototype.set=je,Fe.prototype.clear=Be,Fe.prototype["delete"]=Ue,Fe.prototype.get=Ve,Fe.prototype.has=Ge,Fe.prototype.set=qe,Ze.prototype.clear=He,Ze.prototype["delete"]=We,Ze.prototype.get=Ye,Ze.prototype.has=Xe,Ze.prototype.set=Ke;var nt=yt();function rt(e){return null==e?void 0===e?E:y:_e&&_e in Object(e)?xt(e):It(e)}function it(e){return qt(e)&&rt(e)==u}function ot(e){if(!Gt(e)||kt(e))return!1;var t=Ut(e)?le:j;return t.test(Rt(e))}function at(e){return qt(e)&&Vt(e.length)&&!!B[rt(e)]}function st(e){if(!Gt(e))return Ct(e);var t=At(e),n=[];for(var r in e)("constructor"!=r||!t&&ae.call(e,r))&&n.push(r);return n}function ut(e,t,n,r,i){e!==t&&nt(t,(function(o,a){if(i||(i=new Ze),Gt(o))ct(e,t,a,n,ut,r,i);else{var s=r?r(Pt(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),Qe(e,a,s)}}),Yt)}function ct(e,t,n,r,i,o,a){var s=Pt(e,n),u=Pt(t,n),c=a.get(u);if(c)Qe(e,n,c);else{var l=o?o(s,u,n+"",e,t,a):void 0,p=void 0===l;if(p){var f=Nt(u),h=!f&&Bt(u),d=!f&&!h&&Ht(u);l=u,f||h||d?Nt(s)?l=s:Ft(s)?l=mt(s):h?(p=!1,l=ft(u,!0)):d?(p=!1,l=dt(u,!0)):l=[]:Zt(u)||zt(u)?(l=s,zt(s)?l=Wt(s):Gt(s)&&!Ut(s)||(l=wt(u))):p=!1}p&&(a.set(u,l),i(l,u,r,o,a),a["delete"](u)),Qe(e,n,l)}}function lt(e,t){return Ot(Mt(e,t,Jt),e+"")}var pt=be?function(e,t){return be(e,"toString",{configurable:!0,enumerable:!1,value:Kt(t),writable:!0})}:Jt;function ft(e,t){if(t)return e.slice();var n=e.length,r=de?de(n):new e.constructor(n);return e.copy(r),r}function ht(e){var t=new e.constructor(e.byteLength);return new he(t).set(new he(e)),t}function dt(e,t){var n=t?ht(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function mt(e,t){var n=-1,r=e.length;t||(t=Array(r));while(++n<r)t[n]=e[n];return t}function gt(e,t,n,r){var i=!n;n||(n={});var o=-1,a=t.length;while(++o<a){var s=t[o],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),i?tt(n,s,u):$e(n,s,u)}return n}function vt(e){return lt((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Et(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);while(++r<i){var s=n[r];s&&e(t,s,r,o)}return t}))}function yt(e){return function(t,n,r){var i=-1,o=Object(t),a=r(t),s=a.length;while(s--){var u=a[e?s:++i];if(!1===n(o[u],u,o))break}return t}}function _t(e,t){var n=e.__data__;return Tt(t)?n["string"==typeof t?"string":"hash"]:n.map}function bt(e,t){var n=$(e,t);return ot(n)?n:void 0}function xt(e){var t=ae.call(e,_e),n=e[_e];try{e[_e]=void 0;var r=!0}catch(o){}var i=ue.call(e);return r&&(t?e[_e]=n:delete e[_e]),i}function wt(e){return"function"!=typeof e.constructor||At(e)?{}:ke(me(e))}function St(e,t){var n=typeof e;return t=null==t?s:t,!!t&&("number"==n||"symbol"!=n&&F.test(e))&&e>-1&&e%1==0&&e<t}function Et(e,t,n){if(!Gt(n))return!1;var r=typeof t;return!!("number"==r?jt(n)&&St(t,n.length):"string"==r&&t in n)&&Dt(n[t],e)}function Tt(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function kt(e){return!!se&&se in e}function At(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||re;return e===n}function Ct(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}function It(e){return ue.call(e)}function Mt(e,t,n){return t=we(void 0===t?e.length-1:t,0),function(){var r=arguments,i=-1,o=we(r.length-t,0),a=Array(o);while(++i<o)a[i]=r[t+i];i=-1;var s=Array(t+1);while(++i<t)s[i]=r[i];return s[t]=n(a),K(e,this,s)}}function Pt(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var Ot=Lt(pt);function Lt(e){var t=0,n=0;return function(){var r=Se(),i=a-(r-n);if(n=r,i>0){if(++t>=o)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Rt(e){if(null!=e){try{return oe.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Dt(e,t){return e===t||e!==e&&t!==t}var zt=it(function(){return arguments}())?it:function(e){return qt(e)&&ae.call(e,"callee")&&!ve.call(e,"callee")},Nt=Array.isArray;function jt(e){return null!=e&&Vt(e.length)&&!Ut(e)}function Ft(e){return qt(e)&&jt(e)}var Bt=xe||Qt;function Ut(e){if(!Gt(e))return!1;var t=rt(e);return t==d||t==m||t==l||t==b}function Vt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=s}function Gt(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function qt(e){return null!=e&&"object"==typeof e}function Zt(e){if(!qt(e)||rt(e)!=_)return!1;var t=me(e);if(null===t)return!0;var n=ae.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&oe.call(n)==ce}var Ht=X?Q(X):at;function Wt(e){return gt(e,Yt(e))}function Yt(e){return jt(e)?Je(e,!0):st(e)}var Xt=vt((function(e,t,n,r){ut(e,t,n,r)}));function Kt(e){return function(){return e}}function Jt(e){return e}function Qt(){return!1}n.exports=Xt}).call(this,n("yLpj"),n("YuTi")(e))},qxNg:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("lSNA"),i=n.n(r),o=n("SpH2"),a=n.n(o);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){var n=t.radius,r=void 0===n?40:n,i=t.maxZoom,o=void 0===i?18:i,s=t.minZoom,u=void 0===s?0:s,c=t.zoom,p=void 0===c?2:c;if(e.pointIndex){var f=e.pointIndex.getClusters(e.extent,Math.floor(p));return e.dataArray=l(f),e}var h=new a.a({radius:r,minZoom:u,maxZoom:o}),d={type:"FeatureCollection",features:[]};return d.features=e.dataArray.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:e.coordinates},properties:{}}})),h.load(d.features),h}function l(e){return e.map((function(e,t){return u({coordinates:e.geometry.coordinates,_id:t+1},e.properties)}))}},riiI:function(e,t){},rlAn:function(e,t,n){"use strict";var r=n("ISu3"),i=n("gMG2"),o=n("5gLl"),a=n("BpBL"),s=n("5zYK"),u=n("lJbI"),c=n("l94r"),l=n("qxNg"),p=n("Y8BV"),f=n("VIsB"),h=n("+VLl"),d=n("aF1E"),m=n("fdMe");n.d(t,"getTransform",(function(){return r["b"]})),n.d(t,"getParser",(function(){return r["a"]}));n("U1ZX");t["default"]=c["a"],Object(r["c"])("geojson",o["a"]),Object(r["c"])("image",a["a"]),Object(r["c"])("csv",i["a"]),Object(r["c"])("json",s["a"]),Object(r["c"])("raster",u["a"]),Object(r["d"])("cluster",l["a"]),Object(r["d"])("filter",p["a"]),Object(r["d"])("join",d["a"]),Object(r["d"])("map",m["a"]),Object(r["d"])("grid",f["a"]),Object(r["d"])("hexagon",h["a"])},rxlC:function(e,t,n){"use strict";e.exports=i,e.exports.default=i;var r=1e20;function i(e,t,n,r,i,o){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(e,t,n,r,i,o,s){for(var u=0;u<t;u++){for(var c=0;c<n;c++)r[c]=e[c*t+u];for(a(r,i,o,s,n),c=0;c<n;c++)e[c*t+u]=i[c]}for(c=0;c<n;c++){for(u=0;u<t;u++)r[u]=e[c*t+u];for(a(r,i,o,s,t),u=0;u<t;u++)e[c*t+u]=Math.sqrt(i[u])}}function a(e,t,n,i,o){n[0]=0,i[0]=-r,i[1]=+r;for(var a=1,s=0;a<o;a++){var u=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);while(u<=i[s])s--,u=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);s++,n[s]=a,i[s]=u,i[s+1]=+r}for(a=0,s=0;a<o;a++){while(i[s+1]<a)s++;t[a]=(a-n[s])*(a-n[s])+e[n[s]]}}i.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var a=t.data[4*i+3]/255;this.gridOuter[i]=1===a?0:0===a?r:Math.pow(Math.max(0,.5-a),2),this.gridInner[i]=1===a?r:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var s=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return n}},sGsY:function(e,t,n){"use strict";var r=n("q1tI"),i=n("TSYQ"),o=n.n(i),a=n("H84U"),s=n("B6l+"),u=n.n(s),c=function(e){var t,n=e.value,i=e.formatter,o=e.precision,a=e.decimalSeparator,s=e.groupSeparator,c=void 0===s?"":s,l=e.prefixCls;if("function"===typeof i)t=i(n);else{var p=String(n),f=p.match(/^(-?)(\d*)(\.(\d+))?$/);if(f&&"-"!==p){var h=f[1],d=f[2]||"0",m=f[4]||"";d=d.replace(/\B(?=(\d{3})+(?!\d))/g,c),"number"===typeof o&&(m=u()(m,o,"0").slice(0,o)),m&&(m="".concat(a).concat(m)),t=[r["createElement"]("span",{key:"int",className:"".concat(l,"-content-value-int")},h,d),m&&r["createElement"]("span",{key:"decimal",className:"".concat(l,"-content-value-decimal")},m)]}else t=p}return r["createElement"]("span",{className:"".concat(l,"-content-value")},t)},l=c;function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}var h=function(e){var t=e.prefixCls,n=e.className,i=e.style,a=e.valueStyle,s=e.value,u=void 0===s?0:s,c=e.title,h=e.valueRender,d=e.prefix,m=e.suffix,g=e.direction,v=r["createElement"](l,f({},e,{value:u}));h&&(v=h(v));var y=o()(t,n,p({},"".concat(t,"-rtl"),"rtl"===g));return r["createElement"]("div",{className:y,style:i},c&&r["createElement"]("div",{className:"".concat(t,"-title")},c),r["createElement"]("div",{style:a,className:"".concat(t,"-content")},d&&r["createElement"]("span",{className:"".concat(t,"-content-prefix")},d),v,m&&r["createElement"]("span",{className:"".concat(t,"-content-suffix")},m)))};h.defaultProps={decimalSeparator:".",groupSeparator:","};var d=Object(a["c"])({prefixCls:"statistic"})(h),m=d,g=n("QQZ/"),v=n.n(g);function y(e,t){return S(e)||w(e,t)||b(e,t)||_()}function _(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,t){if(e){if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)if(n.push(a.value),t&&n.length===t)break}catch(u){i=!0,o=u}finally{try{r||null==s["return"]||s["return"]()}finally{if(i)throw o}}return n}}function S(e){if(Array.isArray(e))return e}var E=[["Y",31536e6],["M",2592e6],["D",864e5],["H",36e5],["m",6e4],["s",1e3],["S",1]];function T(e,t){var n=e,r=/\[[^\]]*]/g,i=(t.match(r)||[]).map((function(e){return e.slice(1,-1)})),o=t.replace(r,"[]"),a=E.reduce((function(e,t){var r=y(t,2),i=r[0],o=r[1];if(-1!==e.indexOf(i)){var a=Math.floor(n/o);return n-=a*o,e.replace(new RegExp("".concat(i,"+"),"g"),(function(e){var t=e.length;return v()(a.toString(),t,"0")}))}return e}),o),s=0;return a.replace(r,(function(){var e=i[s];return s+=1,e}))}function k(e,t){var n=t.format,r=void 0===n?"":n,i=new Date(e).getTime(),o=Date.now(),a=Math.max(i-o,0);return T(a,r)}function A(e){return A="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function C(){return C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},C.apply(this,arguments)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),e}function O(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}function L(e,t){return L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},L(e,t)}function R(e){return function(){var t,n=j(e);if(N()){var r=j(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return D(this,t)}}function D(e,t){return!t||"object"!==A(t)&&"function"!==typeof t?z(e):t}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var F=1e3/30;function B(e){return new Date(e).getTime()}var U=function(e){O(n,e);var t=R(n);function n(){var e;return I(this,n),e=t.apply(this,arguments),e.syncTimer=function(){var t=e.props.value,n=B(t);n>=Date.now()?e.startTimer():e.stopTimer()},e.startTimer=function(){e.countdownId||(e.countdownId=window.setInterval((function(){e.forceUpdate()}),F))},e.stopTimer=function(){var t=e.props,n=t.onFinish,r=t.value;if(e.countdownId){clearInterval(e.countdownId),e.countdownId=void 0;var i=B(r);n&&i<Date.now()&&n()}},e.formatCountdown=function(t,n){var r=e.props.format;return k(t,C(C({},n),{format:r}))},e.valueRender=function(e){return r["cloneElement"](e,{title:void 0})},e}return P(n,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return r["createElement"](m,C({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),n}(r["Component"]);U.defaultProps={format:"HH:mm:ss"};var V=U;m.Countdown=V;t["a"]=m},sKgW:function(e,t){var n=9007199254740991,r=Math.floor;function i(e,t){var i="";if(!e||t<1||t>n)return i;do{t%2&&(i+=e),t=r(t/2),t&&(e+=e)}while(t);return i}e.exports=i},sXyB:function(e,t,n){var r=n("SksO"),i=n("b48C");function o(t,n,a){return i()?e.exports=o=Reflect.construct:e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=Function.bind.apply(e,i),a=new o;return n&&r(a,n.prototype),a},o.apply(null,arguments)}e.exports=o},sgoq:function(e,t,n){var r=n("asDA"),i=n("TKrE"),o=n("6nK8"),a="['\u2019]",s=RegExp(a,"g");function u(e){return function(t){return r(o(i(t).replace(s,"")),e,"")}}e.exports=u},sxDa:function(e,t,n){"use strict";n.d(t,"b",(function(){return Cn})),n.d(t,"c",(function(){return Jn})),n.d(t,"a",(function(){return kt}));var r,i,o,a,s,u,c=n("h1nZ"),l=n("lwsE"),p=n.n(l),f=n("W8MJ"),h=n.n(f),d=n("7W2i"),m=n.n(d),g=n("a1gu"),v=n.n(g),y=n("Nsbk"),_=n.n(y),b=n("QILm"),x=n.n(b),w=n("lSNA"),S=n.n(w),E=n("yG8O"),T=n.n(E),k=n("PJYZ"),A=n.n(k),C=n("U+yc"),I=n.n(C),M=(n("1ABj"),n("GoyQ")),P=n.n(M),O=n("lSCD"),L=n.n(O),R=n("xp6e"),D=n("Hel2"),z=n("uhBA"),N=n("4U9+"),j=n.n(N),F=n("4cb6");function B(e){return e.map((function(e){return"string"===typeof e&&(e=[e,{}]),e}))}var U,V,G,q,Z,H,W,Y,X,K=(r=Object(F["injectable"])(),i=Object(F["inject"])(c["TYPES"].IGlobalConfigService),r((u=function(){function e(){p()(this,e),T()(this,"configService",s,this),this.enabled=void 0}return h()(e,[{key:"apply",value:function(e,t){var n=this,r=(t.rendererService,t.postProcessingPassFactory),i=t.normalPassFactory;e.hooks.init.tap("MultiPassRendererPlugin",(function(){var t=e.getLayerConfig(),o=t.enableMultiPassRenderer,a=t.passes,s=void 0===a?[]:a;n.enabled=!!o&&!1!==e.getLayerConfig().enableMultiPassRenderer,n.enabled&&(e.multiPassRenderer=n.createMultiPassRenderer(e,s,r,i),e.multiPassRenderer.setRenderFlag(!0))})),e.hooks.beforeRender.tap("MultiPassRendererPlugin",(function(){}))}},{key:"createMultiPassRenderer",value:function(e,t,n,r){var i=e.multiPassRenderer,o=e.getLayerConfig(),a=o.enablePicking;o.enableTAA;return a&&i.add(r("pixelPicking")),i}}]),e}(),a=u,s=I()(a.prototype,"configService",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=a))||o),J=(U={},S()(U,c["BlendType"].additive,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE,srcAlpha:1,dstAlpha:1}}),S()(U,c["BlendType"].normal,{enable:!0,func:{srcRGB:c["gl"].SRC_ALPHA,dstRGB:c["gl"].ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),S()(U,c["BlendType"].subtractive,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE,srcAlpha:c["gl"].ZERO,dstAlpha:c["gl"].ONE_MINUS_SRC_COLOR},equation:{rgb:c["gl"].FUNC_SUBTRACT,alpha:c["gl"].FUNC_SUBTRACT}}),S()(U,c["BlendType"].max,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE},equation:{rgb:c["gl"].MAX_EXT}}),S()(U,c["BlendType"].min,{enable:!0,func:{srcRGB:c["gl"].ONE,dstRGB:c["gl"].ONE},equation:{rgb:c["gl"].MIN_EXT}}),U),Q={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}};function $(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=ee(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function ee(e,t){if(e){if("string"===typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e){return function(){var t,n=_()(e);if(oe()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function oe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ae,se,ue,ce,le,pe,fe=0,he=(V=Object(c["lazyInject"])(c["TYPES"].ILogService),G=Object(c["lazyInject"])(c["TYPES"].IGlobalConfigService),q=Object(c["lazyInject"])(c["TYPES"].IShaderModuleService),X=function(e){m()(n,e);var t=ie(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p()(this,n),e=t.call(this),e.id="".concat(fe++),e.name="".concat(fe),e.type=void 0,e.visible=!0,e.zIndex=0,e.minZoom=void 0,e.maxZoom=void 0,e.inited=!1,e.layerModelNeedUpdate=!1,e.pickedFeatureID=null,e.selectedFeatureID=null,e.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},e.hooks={init:new R["b"],afterInit:new R["b"],beforeRender:new R["b"],beforeRenderData:new R["d"],afterRender:new R["c"],beforePickingEncode:new R["c"],afterPickingEncode:new R["c"],beforeHighlight:new R["c"](["pickedColor"]),afterHighlight:new R["c"],beforeSelect:new R["c"](["pickedColor"]),afterSelect:new R["c"],beforeDestroy:new R["c"],afterDestroy:new R["c"]},e.models=[],e.multiPassRenderer=void 0,e.plugins=void 0,e.sourceOption=void 0,e.layerModel=void 0,T()(e,"logger",H,A()(e)),T()(e,"configService",W,A()(e)),T()(e,"shaderModuleService",Y,A()(e)),e.cameraService=void 0,e.coordinateService=void 0,e.iconService=void 0,e.fontService=void 0,e.rendererService=void 0,e.layerService=void 0,e.interactionService=void 0,e.mapService=void 0,e.styleAttributeService=void 0,e.layerSource=void 0,e.postProcessingPassFactory=void 0,e.normalPassFactory=void 0,e.animateOptions={enable:!1},e.container=void 0,e.encodedData=void 0,e.configSchema=void 0,e.currentPickId=null,e.rawConfig=void 0,e.needUpdateConfig=void 0,e.pendingStyleAttributes=[],e.scaleOptions={},e.animateStartTime=void 0,e.aniamateStatus=!1,e.sourceEvent=function(){e.dataState.dataSourceNeedUpdate=!0;var t=e.getLayerConfig(),n=t.autoFit,r=t.fitBoundsOptions;n&&e.fitBounds(r),e.emit("dataUpdate"),e.reRender()},e.name=r.name||e.id,e.zIndex=r.zIndex||0,e.rawConfig=r,e}return h()(n,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(e){if(this.inited){var t=this.container.get(c["TYPES"].SceneID);this.configService.setLayerConfig(t,this.id,re({},this.configService.getLayerConfig(this.id),{},this.needUpdateConfig,{},e)),this.needUpdateConfig={}}else this.needUpdateConfig=re({},this.needUpdateConfig,{},e)}},{key:"setContainer",value:function(e){this.container=e}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(e){return this.plugins.push(e),this}},{key:"init",value:function(){var e=this,t=this.container.get(c["TYPES"].SceneID),n=this.rawConfig.enableMultiPassRenderer,r=void 0!==n&&n;this.configService.setLayerConfig(t,this.id,{enableMultiPassRenderer:r}),this.iconService=this.container.get(c["TYPES"].IIconService),this.fontService=this.container.get(c["TYPES"].IFontService),this.rendererService=this.container.get(c["TYPES"].IRendererService),this.layerService=this.container.get(c["TYPES"].ILayerService),this.interactionService=this.container.get(c["TYPES"].IInteractionService),this.mapService=this.container.get(c["TYPES"].IMapService),this.cameraService=this.container.get(c["TYPES"].ICameraService),this.coordinateService=this.container.get(c["TYPES"].ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(c["TYPES"].IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(c["TYPES"].IFactoryNormalPass),this.styleAttributeService=this.container.get(c["TYPES"].IStyleAttributeService),this.multiPassRenderer=this.container.get(c["TYPES"].IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach((function(t){var n=t.attributeName,r=t.attributeField,i=t.attributeValues,o=t.updateOptions;e.styleAttributeService.updateStyleAttribute(n,{scale:re({field:r},e.splitValuesAndCallbackInAttribute(i,e.getLayerConfig()[n]))},o)})),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(c["TYPES"].ILayerPlugin);var i,o=$(this.plugins);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(s){o.e(s)}finally{o.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(re({},this.getDefaultConfig(),{},this.rawConfig));var e=this.getLayerConfig(),t=e.animateOption;(null===t||void 0===t?void 0:t.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(e,t,n){return this.updateStyleAttribute("color",e,t,n),this}},{key:"size",value:function(e,t,n){return this.updateStyleAttribute("size",e,t,n),this}},{key:"filter",value:function(e,t,n){return this.updateStyleAttribute("filter",e,t,n),this}},{key:"shape",value:function(e,t,n){return this.updateStyleAttribute("shape",e,t,n),this}},{key:"label",value:function(e,t,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:e,attributeValues:t,updateOptions:n}),this}},{key:"animate",value:function(e){var t={};return P()(e)?(t.enable=!0,t=re({},t,{},e)):t.enable=e,this.updateLayerConfig({animateOption:t}),this}},{key:"source",value:function(e,t){return this.sourceOption={data:e,options:t},this}},{key:"setData",value:function(e,t){var n=this;return this.inited?this.layerSource.setData(e):this.on("inited",(function(){n.layerSource.setData(e)})),this}},{key:"style",value:function(e){var t=this,n=e.passes,r=x()(e,["passes"]);return n&&B(n).forEach((function(e){var n=t.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(e[0]);n&&n.updateOptions(e[1])})),this.rawConfig=re({},this.rawConfig,{},r),this.container&&this.updateLayerConfig(this.rawConfig),this}},{key:"scale",value:function(e,t){return P()(e)?this.scaleOptions=re({},this.scaleOptions,{},e):this.scaleOptions[e]=t,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(e){var t={};return t.enableHighlight=!!P()(e)||e,P()(e)?(t.enableHighlight=!0,e.color&&(t.highlightColor=e.color)):t.enableHighlight=!!e,this.updateLayerConfig(t),this}},{key:"setActive",value:function(e,t){var n=this;if(P()(e)){var r=e.x,i=void 0===r?0:r,o=e.y,a=void 0===o?0:o;this.updateLayerConfig({highlightColor:P()(t)?t.color:this.getLayerConfig().highlightColor}),this.pick({x:i,y:a})}else this.updateLayerConfig({pickedFeatureID:e,highlightColor:P()(t)?t.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(D["k"])(e)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"select",value:function(e){var t={};return t.enableSelect=!!P()(e)||e,P()(e)?(t.enableSelect=!0,e.color&&(t.selectColor=e.color)):t.enableSelect=!!e,this.updateLayerConfig(t),this}},{key:"setSelect",value:function(e,t){var n=this;if(P()(e)){var r=e.x,i=void 0===r?0:r,o=e.y,a=void 0===o?0:o;this.updateLayerConfig({selectColor:P()(t)?t.color:this.getLayerConfig().selectColor}),this.pick({x:i,y:a})}else this.updateLayerConfig({pickedFeatureID:e,selectColor:P()(t)?t.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(D["k"])(e)).then((function(){setTimeout((function(){n.reRender()}),1)}))}},{key:"setBlend",value:function(e){this.updateLayerConfig({blend:e}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(e){return this.zIndex=e,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(e){this.currentPickId=e}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(e){this.selectedFeatureID=e}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var e=this.mapService.getZoom(),t=this.getLayerConfig(),n=t.visible,r=t.minZoom,i=void 0===r?-1/0:r,o=t.maxZoom,a=void 0===o?1/0:o;return!!n&&e>=i&&e<=a}},{key:"setMinZoom",value:function(e){return this.updateLayerConfig({minZoom:e}),this}},{key:"getMinZoom",value:function(){var e=this.getLayerConfig(),t=e.minZoom;return t}},{key:"getMaxZoom",value:function(){var e=this.getLayerConfig(),t=e.maxZoom;return t}},{key:"get",value:function(e){var t=this.getLayerConfig();return t[e]}},{key:"setMaxZoom",value:function(e){return this.updateLayerConfig({maxZoom:e}),this}},{key:"fitBounds",value:function(e){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var t=this.getSource(),n=t.extent;return this.mapService.fitBounds([[n[0],n[1]],[n[2],n[3]]],e),this}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.models.forEach((function(e){return e.destroy()})),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes(),this.models.forEach((function(e){return e.destroy()}))}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter((function(e){return e.needRescale||e.needRemapping||e.needRegenerateVertices})).length}},{key:"setSource",value:function(e){this.layerSource=e;var t=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(t),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(e){this.encodedData=e}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=j()([Q,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(e){var t=this.styleAttributeService.getLayerAttributeScale(e);if(!t)return[];if(t.ticks){var n=t.ticks().map((function(n){return S()({value:n},e,t(n))}));return n}if(t.invertExtent){var r=t.range().map((function(n){return S()({value:t.invertExtent(n)},e,n)}));return r}}},{key:"pick",value:function(e){var t=e.x,n=e.y;this.interactionService.triggerHover({x:t,y:n})}},{key:"buildLayerModel",value:function(e){var t=e.moduleName,n=e.vertexShader,r=e.fragmentShader,i=e.triangulation,o=x()(e,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(t,{vs:n,fs:r});var a=this.shaderModuleService.getModule(t),s=a.vs,u=a.fs,l=a.uniforms,p=this.rendererService.createModel,f=this.styleAttributeService.createAttributesAndIndices(this.encodedData,i),h=f.attributes,d=f.elements;return p(re({attributes:h,uniforms:l,fs:u,vs:s,elements:d,blend:J[c["BlendType"].normal]},o))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(e){var t=this.getLayerConfig(),n=t.enableHighlight,r=void 0===n||n,i=t.enableSelect,o=void 0===i||i,a=-1!==this.eventNames().indexOf(e)||-1!==this.eventNames().indexOf("un"+e);return"click"!==e&&"dblclick"!==e||!o||(a=!0),"mousemove"!==e||!r&&-1===this.eventNames().indexOf("mouseenter")&&-1===this.eventNames().indexOf("unmousemove")&&-1===this.eventNames().indexOf("mouseout")||(a=!0),this.isVisible()&&a}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var e=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach((function(t){t.draw({uniforms:e.layerModel.getUninforms()})})),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(e,t){return{values:L()(e)?void 0:e||t,callback:L()(e)?e:void 0}}},{key:"updateStyleAttribute",value:function(e,t,n,r){this.inited?this.styleAttributeService.updateStyleAttribute(e,{scale:re({field:t},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[t]))},r):this.pendingStyleAttributes.push({attributeName:e,attributeField:t,attributeValues:n,updateOptions:r})}}]),n}(z["EventEmitter"]),Z=X,H=I()(Z.prototype,"logger",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=I()(Z.prototype,"configService",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=I()(Z.prototype,"shaderModuleService",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z),de=(ae=Object(c["lazyInject"])(c["TYPES"].IGlobalConfigService),se=Object(c["lazyInject"])(c["TYPES"].IShaderModuleService),pe=function(){function e(t){p()(this,e),this.triangulation=void 0,this.layer=void 0,T()(this,"configService",ce,this),T()(this,"shaderModuleService",le,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=t,this.rendererService=t.getContainer().get(c["TYPES"].IRendererService),this.styleAttributeService=t.getContainer().get(c["TYPES"].IStyleAttributeService),this.mapService=t.getContainer().get(c["TYPES"].IMapService),this.iconService=t.getContainer().get(c["TYPES"].IIconService),this.fontService=t.getContainer().get(c["TYPES"].IFontService),this.cameraService=t.getContainer().get(c["TYPES"].ICameraService),this.layerService=t.getContainer().get(c["TYPES"].ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return h()(e,[{key:"getBlend",value:function(){var e=this.layer.getLayerConfig(),t=e.blend,n=void 0===t?"normal":t;return J[c["BlendType"][n]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(e){return[e.enable?0:1,e.duration||4,e.interval||.2,e.trailLength||.1]}},{key:"startModelAnimate",value:function(){var e=this.layer.getLayerConfig(),t=e.animateOption;t.enable&&this.layer.setAnimateStartTime()}}]),e}(),ue=pe,ce=I()(ue.prototype,"configService",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=I()(ue.prototype,"shaderModuleService",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ue),me=(n("J4zp"),n("RIqP")),ge=n.n(me),ve=n("VmRL"),ye=n.n(ve),_e=n("IOcx"),be=n("UB5X"),xe=n.n(be);function we(e){if(xe()(e[0]))return e;if(xe()(e[0][0]))throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8");if(xe()(e[0][0][0])){var t=e,n=0,r=0,i=0;return t.forEach((function(e){e.forEach((function(e){n+=e[0],r+=e[1],i++}))})),[n/i,r/i,0]}throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8")}function Se(e,t,n,r,i){_e["b"].add(e,n,r),_e["b"].normalize(e,e),t=_e["b"].fromValues(-e[1],e[0]);var o=_e["b"].fromValues(-n[1],n[0]);return i/_e["b"].dot(t,o)}function Ee(e,t){return _e["b"].set(e,-t[1],t[0])}function Te(e,t,n){var r=Object(D["d"])([t[0],t[1]]),i=Object(D["d"])([n[0],n[1]]);return _e["b"].sub(e,r,i),_e["b"].normalize(e,e),e}function ke(e,t,n,r,i,o){Ae(t,n,i,-o),Ae(t,n,i,o),e.push(r[0],r[1],0),e.push(r[0],r[1],0)}function Ae(e,t,n,r){e.push(n[0],n[1],0),t.push(r)}function Ce(e,t){var n=Object(D["d"])([t[0],t[1]]),r=Object(D["d"])([e[0],e[1]]),i=n[0]-r[0],o=n[1]-r[1];return Math.sqrt(i*i+o*o)}function Ie(e,t){return e[0]===t[0]&&e[1]===t[1]}var Me,Pe,Oe,Le=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=_e["b"].fromValues(0,0),o=_e["b"].fromValues(0,0),a=_e["b"].fromValues(0,0),s=_e["b"].create(),u=!1,c=null,l=_e["b"].create(),p=n||0,f=3,h=[],d=[],m=[],g=[],v=[0,0];t&&(e=e.slice(),e.push(e[0]));for(var y=e.length,_=1;_<y;_++){var b=p,x=_e["b"].fromValues(e[_-1][0],e[_-1][1]),w=_e["b"].fromValues(e[_][0],e[_][1]),S=_<e.length-1?_e["b"].fromValues(e[_+1][0],e[_+1][1]):null;if(!Ie(x,w)){if(S){var E=_+1;while(S&&Ie(w,S))S=E<e.length-1?_e["b"].fromValues(e[++E][0],e[E][1]):null}var T=0;if(r){var k=Ce(w,x);T=k+v[v.length-1]}if(Te(i,w,x),c||(c=_e["b"].create(),Ee(c,i)),u||(u=!0,ke(d,h,g,x,c,1)),m.push(b+0,b+2,b+1),S){Te(o,S,w);var A=Se(a,_e["b"].fromValues(s[0],s[1]),i,o,1),C=_e["b"].dot(a,c)<0?-1:1,I=Math.abs(A)>f;if(Math.abs(A)>1e3){ke(d,h,g,w,c,1),m.push(b+1,b+2,b+3),m.push(b+2,b+4,b+3),Ee(l,o),_e["b"].copy(c,l),ke(d,h,g,w,c,1),v.push(T,T,T,T),p+=4;continue}I?(A=f,ke(d,h,g,w,c,1),m.push(b+1,b+2,b+3),m.push.apply(m,ge()(1===C?[b+2,b+4,b+5]:[b+4,b+5,b+3])),Ee(l,o),_e["b"].copy(c,l),ke(d,h,g,w,c,1),v.push(T,T,T,T),p+=4):(ke(d,h,g,w,c,1),m.push(b+1,b+2,b+3),Ae(h,g,c,A*-C),d.push(w[0],w[1],0),m.push(b+2,b+4,b+3),m.push(b+4,b+5,b+6),Ee(l,o),_e["b"].copy(c,l),ke(d,h,g,w,c,1),v.push(T,T,T,T,T),p+=5)}else Ee(c,i),ke(d,h,g,w,c,1),v.push(T,T),m.push(b+1,b+2,b+3),p+=2}}for(var M=[],P=0;P<g.length;P++){var O=v[v.length-1];M.push(d[3*P],d[3*P+1],d[3*P+2],v[P],g[P],O)}return{normals:h,attrIndex:m,attrPos:M}};function Re(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e[0][0],r=e[0][e[0].length-1];n[0]===r[0]&&n[1]===r[1]&&(e[0]=e[0].slice(0,e[0].length-1));for(var i=e[0].length,o=ye.a.flatten(e),a=o.vertices,s=o.dimensions,u=[],c=[],l=[],p=0;p<a.length/s;p++)2===s?u.push(a[2*p],a[2*p+1],1,-1,-1):u.push(a[3*p],a[3*p+1],1,-1,-1),l.push(0,0,1);var f=ye()(o.vertices,o.holes,o.dimensions);c.push.apply(c,ge()(f));for(var h=function(e){var n=o.vertices.slice(e*s,(e+1)*s),r=o.vertices.slice((e+1)*s,(e+2)*s);0===r.length&&(r=o.vertices.slice(0,s));var i=u.length/5;u.push(n[0],n[1],1,0,0,r[0],r[1],1,.1,0,n[0],n[1],0,0,.8,r[0],r[1],0,.1,.8);var a=De([r[0],r[1],1],[n[0],n[1],0],[n[0],n[1],1],t);l.push.apply(l,ge()(a).concat(ge()(a),ge()(a),ge()(a))),c.push.apply(c,ge()([1,2,0,3,2,1].map((function(e){return e+i}))))},d=0;d<i;d++)h(d);return{positions:u,index:c,normals:l}}function De(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=_e["c"].create(),o=_e["c"].create(),a=_e["c"].create();r&&(e=Object(D["n"])(e),t=Object(D["n"])(t),n=Object(D["n"])(n));var s=_e["c"].fromValues.apply(_e["c"],ge()(e)),u=_e["c"].fromValues.apply(_e["c"],ge()(t)),c=_e["c"].fromValues.apply(_e["c"],ge()(n));_e["c"].sub(i,c,u),_e["c"].sub(o,s,u),_e["c"].cross(a,i,o);var l=_e["c"].create();return _e["c"].normalize(l,a),l}function ze(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2*Math.PI/e,r=[],i=0;i<e;i++)r.push(n*i+t*Math.PI/12);var o=r.map((function(e){var t=Math.sin(e+Math.PI/4),n=Math.cos(e+Math.PI/4);return[t,n,0]}));return o}function Ne(){return ze(30)}function je(){return ze(4)}function Fe(){return ze(3)}function Be(){return ze(6,1)}function Ue(){return ze(5)}(function(e){e["CYLINDER"]="cylinder",e["SQUARECOLUMN"]="squareColumn",e["TRIANGLECOLUMN"]="triangleColumn",e["HEXAGONCOLUMN"]="hexagonColumn",e["PENTAGONCOLUMN"]="pentagonColumn"})(Pe||(Pe={})),function(e){e["CIRCLE"]="circle",e["SQUARE"]="square",e["TRIANGLE"]="triangle",e["HEXAGON"]="hexagon",e["PENTAGON"]="pentagon"}(Oe||(Oe={}));var Ve=(Me={},S()(Me,Oe.CIRCLE,Ne),S()(Me,Oe.HEXAGON,Be),S()(Me,Oe.TRIANGLE,Fe),S()(Me,Oe.SQUARE,je),S()(Me,Oe.PENTAGON,Ue),S()(Me,Pe.CYLINDER,Ne),S()(Me,Pe.HEXAGONCOLUMN,Be),S()(Me,Pe.TRIANGLECOLUMN,Fe),S()(Me,Pe.SQUARECOLUMN,je),S()(Me,Pe.PENTAGONCOLUMN,Ue),Me),Ge={};function qe(e){var t=we(e.coordinates);return{vertices:[].concat(ge()(t),ge()(t),ge()(t),ge()(t)),indices:[0,1,2,2,3,0],size:t.length}}function Ze(e){var t=e.shape,n=Je(t,!1),r=n.positions,i=n.index,o=n.normals;return{vertices:r,indices:i,normals:o,size:5}}function He(e){var t=we(e.coordinates);return{vertices:ge()(t),indices:[0],size:t.length}}function We(e){var t=e.coordinates,n=t;Array.isArray(n[0][0])&&(n=t[0]);var r=Le(n,!1,0);return{vertices:r.attrPos,indices:r.attrIndex,normals:r.normals,size:6}}function Ye(e){var t=e.coordinates,n=ye.a.flatten(t),r=n.vertices,i=n.dimensions,o=n.holes;return{indices:ye()(r,o,i),vertices:r,size:i}}function Xe(e){var t=e.coordinates,n=Re(t,!0),r=n.positions,i=n.index,o=n.normals;return{vertices:r,indices:i,normals:o,size:5}}function Ke(e){for(var t=30,n=e.coordinates,r=[],i=[],o=function(e){r.push(e,1,e,n[0][0],n[0][1],n[1][0],n[1][1],e,-1,e,n[0][0],n[0][1],n[1][0],n[1][1]),e!==t-1&&i.push.apply(i,ge()([0,1,2,1,3,2].map((function(t){return 2*e+t}))))},a=0;a<t;a++)o(a);return{vertices:r,indices:i,size:7}}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Ge&&Ge[e])return Ge[e];var n=Ve[e]?Ve[e]():Ve.cylinder(),r=Re([n],t);return Ge[e]=r,r}function Qe(e){return function(){var t,n=_()(e);if($e()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function $e(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var et='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nvarying vec2 v_normal;\nvarying vec2 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n  if(u_line_type == LineTypeDash) {\n    gl_FragColor.a *= (1.0- step(v_dash_array.x, mod(v_distance_ratio, v_dash_array.x +v_dash_array.y)));\n  }\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',tt='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec2 u_dash_array: [10.0, 5.];\nvarying vec2 v_dash_array;\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat bezier3(vec3 arr, float t) {\n  float ut = 1. - t;\n  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;\n}\nvec2 midPoint(vec2 source, vec2 target) {\n  vec2 center = target - source;\n  float r = length(center);\n  float theta = atan(center.y, center.x);\n  float thetaOffset = 0.314;\n  float r2 = r / 2.0 / cos(thetaOffset);\n  float theta2 = theta + thetaOffset;\n  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);\n  return mid;\n}\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\nvec2 interpolate (vec2 source, vec2 target, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  vec2 mid = midPoint(source, target);\n  vec3 x = vec3(source.x, mid.x, target.x);\n  vec3 y = vec3(source.y, mid.y, target.y);\n  return vec2(bezier3(x ,t), bezier3(y,t));\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * a_Size / 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n  vec2 source = a_Instance.rg;\n  vec2 target =  a_Instance.ba;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  if(u_line_type == LineTypeDash) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n    }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));\n  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));\n  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));\n  setPickingColor(a_PickingColor);\n}\n',nt={solid:0,dash:1},rt=function(e){m()(n,e);var t=Qe(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.lineType,r=void 0===n?"solid":n,i=e.dashArray,o=void 0===i?[10,5]:i;return{u_opacity:t||1,segmentNumber:30,u_line_type:nt[r||"solid"],u_dash_array:o,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig(),t=e.animateOption;return{u_aimate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:tt,fragmentShader:et,triangulation:Ke,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Instance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}(de);function it(e){return function(){var t,n=_()(e);if(ot()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function ot(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var at='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform mat4 u_ModelMatrix;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec2 u_dash_array: [10.0, 5.];\n\nvarying vec2 v_dash_array;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;\n\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\n\nvoid main() {\n  v_color = a_Color;\n  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;\n  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n\n   if(u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n    if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  vec3 curr = getPos(source, target, segmentRatio);\n  vec3 next = getPos(source, target, nextSegmentRatio);\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);\n  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));\n  setPickingColor(a_PickingColor);\n}\n',st='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nvarying vec2 v_normal;\nvarying vec2 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n  if(u_line_type == LineTypeDash) {\n    gl_FragColor.a *= (1.0- step(v_dash_array.x, mod(v_distance_ratio, v_dash_array.x +v_dash_array.y)));\n  }\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',ut={solid:0,dash:1},ct=function(e){m()(n,e);var t=it(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.lineType,r=void 0===n?"solid":n,i=e.dashArray,o=void 0===i?[10,5]:i;return{u_opacity:t||1,segmentNumber:30,u_line_type:ut[r]||0,u_dash_array:o}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig(),t=e.animateOption;return{u_aimate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:at,fragmentShader:st,triangulation:Ke,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Instance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}(de);function lt(e){return function(){var t,n=_()(e);if(pt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function pt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ft='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nuniform float u_opacity;\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nvarying vec2 v_normal;\nvarying vec2 v_dash_array;\nvarying float v_distance_ratio;\nvarying vec4 v_color;\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n  if(u_line_type == LineTypeDash) {\n    gl_FragColor.a *= (1.0- step(v_dash_array.x, mod(v_distance_ratio, v_dash_array.x +v_dash_array.y)));\n  }\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',ht='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec4 a_Instance;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform float segmentNumber;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\nvarying float v_distance_ratio;\nuniform float u_line_type: 0.0;\nuniform vec2 u_dash_array: [10.0, 5.];\nvarying vec2 v_dash_array;\n\n#pragma include "projection"\n#pragma include "project"\n#pragma include "picking"\n\nfloat maps (float value, float start1, float stop1, float start2, float stop2) {\n    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));\n}\n\nfloat getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));\n}\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n    vec2 x = mix(source, target, ratio);\n    vec2 center = mix(source, target, 0.5);\n    float dSourceCenter = distance(source, center);\n    float dXCenter = distance(x, center);\n    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n     float vertex_height = paraboloid(source, target, segmentRatio);\n\n    return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n    );\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;\n  return offset;\n}\nvec2 getNormal(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace);\n  // rotate by 90 degrees\n   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 delta = source - target;\n  vec2 sin_half_delta = sin(delta / 2.0);\n  float a =\n    sin_half_delta.y * sin_half_delta.y +\n    cos(source.y) * cos(target.y) *\n    sin_half_delta.x * sin_half_delta.x;\n  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));\n}\nvec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  if(abs(angularDist - PI) < 0.001) {\n    return (1.0 - t) * source + t * target;\n  }\n  float a = sin((1.0 - t) * angularDist) / sin(angularDist);\n  float b = sin(t * angularDist) / sin(angularDist);\n  vec2 sin_source = sin(source);\n  vec2 cos_source = cos(source);\n  vec2 sin_target = sin(target);\n  vec2 cos_target = cos(target);\n  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;\n  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;\n  float z = a * sin_source.y + b * sin_target.y;\n  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));\n}\n\nvoid main() {\n  v_color = a_Color;\n  vec2 source = radians(a_Instance.rg);\n  vec2 target = radians(a_Instance.ba);\n  float angularDist = getAngularDist(source, target);\n  float segmentIndex = a_Position.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  if(u_line_type == LineTypeDash) {\n    v_distance_ratio = segmentIndex / segmentNumber;\n    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);\n  }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = segmentIndex / segmentNumber;\n  }\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n  v_distance_ratio = segmentIndex / segmentNumber;\n  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));\n  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));\n  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);\n  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));\n  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));\n  setPickingColor(a_PickingColor);\n}\n\n',dt={solid:0,dash:1},mt=function(e){m()(n,e);var t=lt(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.lineType,r=void 0===n?"solid":n,i=e.dashArray,o=void 0===i?[10,5]:i;return{u_opacity:t||1,segmentNumber:30,u_line_type:dt[r]||0,u_dash_array:o}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig(),t=e.animateOption;return{u_aimate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:ht,fragmentShader:ft,triangulation:Ke,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Instance",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(e,t,n,r){return[n[3],n[4],n[5],n[6]]}}})}}]),n}(de);function gt(e){return function(){var t,n=_()(e);if(vt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function vt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var yt='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\nuniform float u_blur : 0.9;\nuniform float u_line_type: 0.0;\nuniform float u_opacity : 1.0;\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\n\n// dash\nuniform float u_dash_offset : 0.0;\nuniform float u_dash_ratio : 0.1;\nvarying float v_distance_ratio;\nvarying vec2 v_dash_array;\nvarying float v_side;\n\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n// [animate, duration, interval, trailLength],\nvoid main() {\n  gl_FragColor = v_color;\n  // anti-alias\n  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= u_opacity;\n\n  if(u_aimate.x == Animate) {\n      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n // dash line\n  if(u_line_type == LineTypeDash) {\n    gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, v_dash_array.x +v_dash_array.y)));\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',_t='#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\n// dash line\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform float u_line_type: 0.0;\nuniform vec2 u_dash_array: [10.0, 5.];\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec2 v_dash_array;\nvarying vec2 v_normal;\nvarying float v_distance_ratio;\nvarying float v_side;\n\n\nvoid main() {\n\n  if(u_line_type == LineTypeDash) {\n    v_distance_ratio = a_Distance / a_Total_Distance;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  }\n  if(u_aimate.x == Animate) {\n      v_distance_ratio = a_Distance / a_Total_Distance;\n  }\n  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));\n  v_color = a_Color;\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n  vec2 offset = project_pixel(size.xy);\n  v_side = a_Miter * a_Size.x;\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',bt={solid:0,dash:1},xt=function(e){m()(n,e);var t=gt(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=e.lineType,r=void 0===n?"solid":n,i=e.dashArray,o=void 0===i?[10,5]:i;return{u_opacity:t||1,u_line_type:bt[r],u_dash_array:o}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig(),t=e.animateOption;return{u_aimate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:_t,fragmentShader:yt,triangulation:We,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var e=this.layer.getLayerConfig();e.lineType;this.styleAttributeService.registerStyleAttribute({name:"distance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Distance",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){return[n[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:c["AttributeType"].Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){return[n[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(e,t,n,r){var i=e.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0],o[1]]:[o,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(e,t,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:c["AttributeType"].Attribute,descriptor:{name:"a_Miter",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){return[n[4]]}}})}}]),n}(de),wt={arc:rt,arc3d:ct,greatcircle:mt,line:xt},St=wt;function Et(e){return function(){var t,n=_()(e);if(Tt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Tt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var kt=function(e){m()(n,e);var t=Et(n);function n(){var e;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.type="LineLayer",e}return h()(n,[{key:"buildModels",value:function(){var e=this.getModelType();this.layerModel=new St[e](this),this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var e=this.getModelType(),t={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return t[e]}},{key:"getModelType",value:function(){var e,t=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null===t||void 0===t||null===(e=t.scale)||void 0===e?void 0:e.field;return n||"line"}}]),n}(he);function At(e){return function(){var t,n=_()(e);if(Ct()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Ct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var It='varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a *= u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Mt='precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform mat4 u_ModelMatrix;\nvarying vec4 v_color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec3 size = a_Size * a_Position;\n\n  vec2 offset = project_pixel(size.xy);\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);\n\n  float lightWeight = calc_lighting(pos);\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  gl_Position = project_common_position_to_clipspace(pos);\n  setPickingColor(a_PickingColor);\n}\n',Pt=function(e){m()(n,e);var t=At(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity;return{u_opacity:t||1}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:Mt,fragmentShader:It,triangulation:Ze,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(e,t,n,r){var i=e.size;if(i){var o=[];return Array.isArray(i)&&(o=2===i.length?[i[0],i[0],i[1]]:i),Array.isArray(i)||(o=[i]),o}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(e,t,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:c["AttributeType"].Attribute,descriptor:{name:"a_Pos",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(e,t){var n=we(e.coordinates);return[n[0],n[1],0]}}})}}]),n}(de);function Ot(e){return function(){var t,n=_()(e);if(Lt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Lt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Rt="#define Animate 0.0\n\nuniform float u_blur : 0;\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 1;\nuniform vec4 u_stroke_color : [0, 0, 0, 0];\nuniform float u_stroke_opacity : 1;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  lowp float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  // gl_FragColor = v_color * color_t;\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n  if(u_aimate.x == Animate) {\n    float d = length(v_data.xy);\n    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);\n    gl_FragColor = vec4(gl_FragColor.xyz, intensity);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n",Dt='attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec2 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\nuniform mat4 u_ModelMatrix;\n\nuniform float u_stroke_width : 2;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // unpack color(vec2)\n  v_color = a_Color;\n  vec2 extrude = a_Extrude;\n\n  float shape_type = a_Shape;\n\n  float newSize = setPickingSize(a_Size);\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width));\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  // TODO: billboard\n  // anti-alias\n  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);\n\n  // construct point coords\n  v_data = vec4(extrude, antialiasblur,shape_type);\n\n  setPickingColor(a_PickingColor);\n}\n',zt=function(e){m()(n,e);var t=Ot(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t,r=e.stroke,i=void 0===r?"rgb(0,0,0,0)":r,o=e.strokeWidth,a=void 0===o?1:o,s=e.strokeOpacity,u=void 0===s?1:s;return{u_opacity:n,u_stroke_width:a,u_stroke_color:Object(D["q"])(i),u_stroke_opacity:u}}},{key:"getAnimateUniforms",value:function(){var e=this.layer.getLayerConfig(),t=e.animateOption;return{u_aimate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),qe)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:Dt,fragmentShader:Rt,triangulation:qe,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(e){return[e.enable?0:1,e.speed||1,e.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:c["AttributeType"].Attribute,descriptor:{name:"a_Extrude",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(e,t,n,r){var i=[1,1,-1,1,-1,-1,1,-1],o=r%4*2;return[i[o],i[o+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?5:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:c["AttributeType"].Attribute,descriptor:{name:"a_Shape",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(t,n,r,i){var o=t.shape,a=void 0===o?2:o,s=e.layer.getLayerConfig().shape2d,u=s.indexOf(a);return[u]}}})}}]),n}(de);function Nt(e){return function(){var t,n=_()(e);if(jt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function jt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ft='\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_stroke_width : 1;\nuniform vec4 u_stroke_color : [1, 1, 1, 1];\nuniform float u_stroke_opacity : 1;\nuniform float u_opacity : 1;\n\nvarying float v_size;\n#pragma include "picking"\nvoid main(){\nvec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\nvec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;\nfloat distance = length(fragmentPosition);\nfloat distanceSqrd = distance * distance;\nfloat radius = 1.;\nfloat r = 1.0 - smoothstep(radius-(radius*0.01),\n                         radius+(radius*0.01),\n                         distanceSqrd);\n  vec4 textureColor=texture2D(u_texture,pos);\n  if(v_color == vec4(1.0)){\n        gl_FragColor= vec4(textureColor.xyz, textureColor.w);\n  }else {\n        gl_FragColor= step(0.01, textureColor.z) * v_color;\n  }\n  gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Bt='precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform float u_stroke_width : 1;\nvarying float v_size;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   v_size = a_Size;\n\n   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',Ut=function(e){m()(n,e);var t=Nt(n);function n(){var e;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.texture=void 0,e}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity;return{u_opacity:t||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"buildModels",value:function(){var e=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",(function(){e.updateTexture(),e.layer.render()})),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Bt,fragmentShader:Ft,triangulation:He,primitive:c["gl"].POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size;return Array.isArray(i)?[i[0]]:[i]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,n,r,i){var o=e.fontService.mapping,a=t.shape,s=e.fontService.getGlyph(a),u=o[s],c=u.x,l=u.y;return[c,l]}}})}},{key:"updateTexture",value:function(){var e=this.rendererService.createTexture2D,t=this.fontService.canvas;this.texture=e({data:t,mag:c["gl"].LINEAR,min:c["gl"].LINEAR,width:t.width,height:t.height})}},{key:"initIconFontGlyphs",value:function(){var e=this,t=this.layer.getLayerConfig(),n=t.fontWeight,r=void 0===n?"normal":n,i=t.fontFamily,o=void 0===i?"sans-serif":i,a=this.layer.getEncodedData(),s=[];a.forEach((function(t){var n=t.shape,r=void 0===n?"":n;r=r.toString();var i=e.fontService.getGlyph(r);-1===s.indexOf(i)&&s.push(i)})),this.fontService.setFontOptions({characterSet:s,fontWeight:r,fontFamily:o,fontSize:48})}}]),n}(de);function Vt(e){return function(){var t,n=_()(e);if(Gt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Gt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var qt='\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_stroke_width : 1;\nuniform vec4 u_stroke_color : [1, 1, 1, 1];\nuniform float u_stroke_opacity : 1;\nuniform float u_opacity : 1;\n\nvarying float v_size;\n#pragma include "picking"\nvoid main(){\nvec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\nvec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;\nfloat distance = length(fragmentPosition);\nfloat distanceSqrd = distance * distance;\nfloat radius = 1.;\nfloat r = 1.0 - smoothstep(radius-(radius*0.01),\n                         radius+(radius*0.01),\n                         distanceSqrd);\n  vec4 textureColor=texture2D(u_texture,pos);\n  if(v_color == vec4(1.0)){\n        gl_FragColor= vec4(textureColor.xyz, textureColor.w);\n  }else {\n        gl_FragColor= step(0.01, textureColor.z) * v_color;\n  }\n  gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Zt='precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform float u_stroke_width : 1;\nvarying float v_size;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   v_size = a_Size;\n\n   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',Ht=function(e){m()(n,e);var t=Vt(n);function n(){var e;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.texture=void 0,e}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity;return this.rendererService.getDirty()&&this.texture.update(),{u_opacity:t||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"buildModels",value:function(){var e=this;return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",(function(){e.updateTexture(),e.layer.render()})),[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Zt,fragmentShader:qt,triangulation:He,primitive:c["gl"].POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var e=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?5:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:c["AttributeType"].Attribute,descriptor:{name:"a_Uv",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(t,n,r,i){var o=e.iconService.getIconMap(),a=t.shape,s=o[a]||{x:0,y:0},u=s.x,c=s.y;return[u,c]}}})}},{key:"updateTexture",value:function(){var e=this.rendererService.createTexture2D;this.texture=e({data:this.iconService.getCanvas(),mag:c["gl"].LINEAR,min:c["gl"].LINEAR,width:1024,height:this.iconService.canvasHeight||128})}}]),n}(de);function Wt(e){return function(){var t,n=_()(e);if(Yt()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Yt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Xt='\nuniform float u_opacity : 1;\nvarying vec4 v_color;\n#pragma include "picking"\nvoid main() {\n  gl_FragColor = v_color;\n  gl_FragColor.a =gl_FragColor.a * u_opacity;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Kt='\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n#pragma include "projection"\n#pragma include "picking"\nvoid main() {\n  v_color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n  gl_Position = project_common_position_to_clipspace(project_pos);\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n    setPickingColor(a_PickingColor);\n}\n';function Jt(e){var t=e.coordinates;return{vertices:ge()(t),indices:[0],size:t.length}}var Qt=function(e){m()(n,e);var t=Wt(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t,r=e.stroke,i=void 0===r?"rgb(0,0,0,0)":r,o=e.strokeWidth,a=void 0===o?1:o;return{u_opacity:n,u_stroke_width:a,u_stroke_color:Object(D["q"])(i)}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:Kt,fragmentShader:Xt,triangulation:Jt,depth:{enable:!1},primitive:c["gl"].POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?1:i;return Array.isArray(o)?[o[0]]:[o]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:c["BlendType"].additive}}}]),n}(de);function $t(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=en(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function en(e,t){if(e){if("string"===typeof e)return tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(e,t):void 0}}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nn=function(){function e(t,n,r){p()(this,e),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var i=this.boxCells;this.xCellCount=Math.ceil(t/r),this.yCellCount=Math.ceil(n/r);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=t,this.height=n,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/n,this.boxUid=0}return h()(e,[{key:"insert",value:function(e,t,n,r,i){this.forEachCell(t,n,r,i,this.insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}},{key:"query",value:function(e,t,n,r,i){return this.queryHitTest(e,t,n,r,!1,i)}},{key:"hitTest",value:function(e,t,n,r,i){return this.queryHitTest(e,t,n,r,!0,i)}},{key:"insertBoxCell",value:function(e,t,n,r,i,o){this.boxCells[i].push(o)}},{key:"queryHitTest",value:function(e,t,n,r,i,o){if(n<0||e>this.width||r<0||t>this.height)return!i&&[];var a=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});return o?a.filter(o):a}var u={hitTest:i,seenUids:{box:{},circle:{}}};return this.forEachCell(e,t,n,r,this.queryCell,a,u,o),i?a.length>0:a}},{key:"queryCell",value:function(e,t,n,r,i,o,a,s){var u=a.seenUids,c=this.boxCells[i];if(null!==c){var l,p=this.bboxes,f=$t(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;if(!u.box[h]){u.box[h]=!0;var d=4*h;if(e<=p[d+2]&&t<=p[d+3]&&n>=p[d+0]&&r>=p[d+1]&&(!s||s(this.boxKeys[h]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[h],x1:p[d],y1:p[d+1],x2:p[d+2],y2:p[d+3]})}}}}catch(m){f.e(m)}finally{f.f()}}return!1}},{key:"forEachCell",value:function(e,t,n,r,i,o,a,s){for(var u=this.convertToXCellCoord(e),c=this.convertToYCellCoord(t),l=this.convertToXCellCoord(n),p=this.convertToYCellCoord(r),f=u;f<=l;f++)for(var h=c;h<=p;h++){var d=this.xCellCount*h+f;if(i.call(this,e,t,n,r,d,o,a,s))return}}},{key:"convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}}]),e}(),rn=nn,on=function(){function e(t,n){p()(this,e),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=t,this.height=n,this.viewportPadding=Math.max(t,n),this.grid=new rn(t+this.viewportPadding,n+this.viewportPadding,25),this.screenRightBoundary=t+this.viewportPadding,this.screenBottomBoundary=n+this.viewportPadding,this.gridRightBoundary=t+2*this.viewportPadding,this.gridBottomBoundary=n+2*this.viewportPadding}return h()(e,[{key:"placeCollisionBox",value:function(e){var t=e.x1+e.anchorPointX+this.viewportPadding,n=e.y1+e.anchorPointY+this.viewportPadding,r=e.x2+e.anchorPointX+this.viewportPadding,i=e.y2+e.anchorPointY+this.viewportPadding;return!this.isInsideGrid(t,n,r,i)||this.grid.hitTest(t,n,r,i)?{box:[]}:{box:[t,n,r,i]}}},{key:"insertCollisionBox",value:function(e,t){var n={featureIndex:t};this.grid.insert(n,e[0],e[1],e[2],e[3])}},{key:"project",value:function(e,t,n){var r=_e["d"].fromValues(t,n,0,1),i=_e["d"].create(),o=_e["a"].fromValues.apply(_e["a"],ge()(e));return _e["d"].transformMat4(i,r,o),{x:(i[0]/i[3]+1)/2*this.width+this.viewportPadding,y:(-i[1]/i[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary}}]),e}();function an(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=sn(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function sn(e,t){if(e){if("string"===typeof e)return un(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?un(e,t):void 0}}function un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cn(e){var t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0;break;default:n=.5}return{horizontalAlign:t,verticalAlign:n}}function ln(e,t,n,r,i){if(i){var o=e[r],a=o.glyph;if(a)for(var s=t[a].advance*o.scale,u=(e[r].x+s)*i,c=n;c<=r;c++)e[c].x-=u}}function pn(e,t,n,r,i,o,a){var s,u=(t-n)*i,c=(-r*a+.5)*o,l=an(e);try{for(l.s();!(s=l.n()).done;){var p=s.value;p.x+=u,p.y+=c}}catch(f){l.e(f)}finally{l.f()}}function fn(e,t,n,r,i,o,a){var s=-8,u=0,c=s,l=0,p=e.positionedGlyphs,f="right"===o?1:"left"===o?0:.5,h=p.length;n.forEach((function(e){if(e.split("").forEach((function(e){var n=t[e],r=0;n&&(p.push({glyph:e,x:u,y:c+r,vertical:!1,scale:1,metrics:n}),u+=n.advance+a)})),p.length!==h){var n=u-a;l=Math.max(n,l),ln(p,t,h,p.length-1,f)}u=0,c+=r}));var d=cn(i),m=d.horizontalAlign,g=d.verticalAlign;pn(p,f,m,g,l,r,n.length);var v=c-s;e.top+=-g*v,e.bottom=e.top+v,e.left+=-m*l,e.right=e.left+l}function hn(e,t,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],s=e.split("\n"),u=[],c={positionedGlyphs:u,top:a[1],bottom:a[1],left:a[0],right:a[0],lineCount:s.length,text:e};return fn(c,t,s,n,r,i,o),!!u.length&&c}function dn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=arguments.length>2?arguments[2]:void 0,i=e.positionedGlyphs,o=void 0===i?[]:i,a=[],s=an(o);try{for(s.s();!(t=s.n()).done;){var u=t.value,c=u.metrics,l=4,p=c.advance*u.scale/2,f=r?[u.x+p,u.y]:[0,0],h=r?[0,0]:[u.x+p+n[0],u.y+n[1]],d=(0-l)*u.scale-p+h[0],m=(0-l)*u.scale+h[1],g=d+c.width*u.scale,v=m+c.height*u.scale,y={x:d,y:m},_={x:g,y:m},b={x:d,y:v},x={x:g,y:v};a.push({tl:y,tr:_,bl:b,br:x,tex:c,glyphOffset:f})}}catch(w){s.e(w)}finally{s.f()}return a}function mn(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=gn(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function gn(e,t){if(e){if("string"===typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vn(e,t):void 0}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yn(e){return function(){var t,n=_()(e);if(_n()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function _n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var bn='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform float u_stroke_opacity: 1.0;\nuniform vec4 u_stroke : [0, 0, 0, 1];\nuniform float u_strokeWidth : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\n#pragma include "picking"\nvoid main() {\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',xn='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // \u6587\u672c\u7f29\u653e\u6bd4\u4f8b\n  float fontScale = a_Size / FONT_SIZE;\n   v_fontScale = fontScale;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n\n  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  gl_Position = vec4(projected_position.xy / projected_position.w\n    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function wn(e){var t=this,n=e.id,r=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[n])return{vertices:[],indices:[],size:7};var o=t.glyphInfoMap[n].centroid,a=2===o.length?[o[0],o[1],0]:o;return t.glyphInfoMap[n].glyphQuads.forEach((function(e,t){r.push.apply(r,ge()(a).concat([e.tex.x,e.tex.y+e.tex.height,e.tl.x,e.tl.y],ge()(a),[e.tex.x+e.tex.width,e.tex.y+e.tex.height,e.tr.x,e.tr.y],ge()(a),[e.tex.x+e.tex.width,e.tex.y,e.br.x,e.br.y],ge()(a),[e.tex.x,e.tex.y,e.bl.x,e.bl.y])),i.push(0+4*t,1+4*t,2+4*t,2+4*t,3+4*t,0+4*t)})),{vertices:r,indices:i,size:7}}var Sn=function(e){m()(n,e);var t=yn(n);function n(){var e;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.glyphInfo=void 0,e.glyphInfoMap={},e.texture=void 0,e.currentZoom=-1,e.extent=void 0,e.textureHeight=0,e.textCount=0,e.preTextStyle={},e}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t,r=e.stroke,i=void 0===r?"#fff":r,o=e.strokeWidth,a=void 0===o?0:o,s=e.strokeOpacity,u=void 0===s?1:s,c=e.textAnchor,l=void 0===c?"center":c,p=e.textAllowOverlap,f=void 0!==p&&p,h=e.halo,d=void 0===h?.5:h,m=e.gamma,g=void 0===m?2:m,v=this.fontService,y=v.canvas,_=v.mapping;return Object.keys(_).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(_).length),this.preTextStyle={textAnchor:l,textAllowOverlap:f},{u_opacity:n,u_stroke_opacity:u,u_sdf_map:this.texture,u_stroke:Object(D["q"])(i),u_halo_blur:d,u_gamma_scale:g,u_sdf_map_size:[y.width,y.height],u_strokeWidth:a}}},{key:"buildModels",value:function(){var e=this;this.layer.on("remapping",(function(){e.initGlyph(),e.updateTexture(),e.reBuildModel()})),this.extent=this.textExtent();var t=this.layer.getLayerConfig(),n=t.textAnchor,r=void 0===n?"center":n,i=t.textAllowOverlap,o=void 0===i||i;return this.preTextStyle={textAnchor:r,textAllowOverlap:o},this.initGlyph(),this.updateTexture(),this.filterGlyphs(),[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:xn,fragmentShader:bn,triangulation:wn.bind(this),depth:{enable:!1},blend:this.getBlend()})]}},{key:"needUpdate",value:function(){var e=this.layer.getLayerConfig(),t=e.textAllowOverlap,n=void 0!==t&&t,r=this.mapService.getZoom(),i=this.mapService.getBounds(),o=Object(D["i"])(this.extent,i);return(!n&&(Math.abs(this.currentZoom-r)>1||!o)||n!==this.preTextStyle.textAllowOverlap)&&(this.reBuildModel(),!0)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:c["AttributeType"].Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(e,t,n,r){return[n[5],n[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?12:i;return Array.isArray(o)?[o[0]]:[o]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:c["AttributeType"].Attribute,descriptor:{name:"a_tex",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:2,update:function(e,t,n,r){return[n[3],n[4]]}}})}},{key:"textExtent",value:function(){var e=this.mapService.getBounds();return Object(D["p"])(e,.5)}},{key:"initTextFont",value:function(){var e=this.layer.getLayerConfig(),t=e.fontWeight,n=void 0===t?"400":t,r=e.fontFamily,i=void 0===r?"sans-serif":r,o=this.layer.getEncodedData(),a=[];o.forEach((function(e){var t=e.shape,n=void 0===t?"":t;n=n.toString();var r,i=mn(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;-1===a.indexOf(o)&&a.push(o)}}catch(s){i.e(s)}finally{i.f()}})),this.fontService.setFontOptions({characterSet:a,fontWeight:n,fontFamily:i})}},{key:"generateGlyphLayout",value:function(){var e=this,t=this.fontService.mapping,n=this.layer.getLayerConfig(),r=n.spacing,i=void 0===r?2:r,o=n.textAnchor,a=void 0===o?"center":o,s=n.textOffset,u=this.layer.getEncodedData();this.glyphInfo=u.map((function(n){var r=n.shape,o=void 0===r?"":r,u=n.coordinates,c=n.id,l=n.size,p=void 0===l?1:l,f=hn(o.toString(),t,p,a,"center",i,s),h=dn(f,s,!1);return n.shaping=f,n.glyphQuads=h,n.centroid=we(u),e.glyphInfoMap[c]={shaping:f,glyphQuads:h,centroid:we(u)},n}))}},{key:"filterGlyphs",value:function(){var e=this,t=this.layer.getLayerConfig(),n=t.padding,r=void 0===n?[4,4]:n,i=t.textAllowOverlap,o=void 0!==i&&i;if(!o){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var a=this.rendererService.getViewportSize(),s=a.width,u=a.height,c=new on(s,u),l=this.glyphInfo.filter((function(t){var n=t.shaping,i=t.id,o=void 0===i?0:i,a=t.centroid,s=t.size,u=s/24,l=e.mapService.lngLatToContainer(a),p=c.placeCollisionBox({x1:n.left*u-r[0],x2:n.right*u+r[0],y1:n.top*u-r[1],y2:n.bottom*u+r[1],anchorPointX:l.x,anchorPointY:l.y}),f=p.box;return!(!f||!f.length)&&(c.insertCollisionBox(f,o),!0)}));l.forEach((function(t){e.glyphInfoMap[t.id]=t}))}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var e=this.rendererService.createTexture2D,t=this.fontService.canvas;this.textureHeight=t.height,this.texture=e({data:t,mag:c["gl"].LINEAR,min:c["gl"].LINEAR,width:t.width,height:t.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:xn,fragmentShader:bn,triangulation:wn.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),n}(de),En={fill:zt,image:Ht,normal:Qt,extrude:Pt,text:Sn,icon:Ut},Tn=En;function kn(e){return function(){var t,n=_()(e);if(An()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function An(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Cn=function(e){m()(n,e);var t=kn(n);function n(){var e;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.type="PointLayer",e}return h()(n,[{key:"buildModels",value:function(){var e=this.getModelType();this.layerModel=new Tn[e](this),this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var e=this.getModelType(),t={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return t[e]}},{key:"getModelType",value:function(){var e=this.getEncodedData(),t=this.getLayerConfig(),n=t.shape2d,r=t.shape3d,i=this.iconService.getIconMap(),o=e.find((function(e){return e.hasOwnProperty("shape")}));if(o){var a=o.shape;return"dot"===a?"normal":-1!==(null===n||void 0===n?void 0:n.indexOf(a))?"fill":-1!==(null===r||void 0===r?void 0:r.indexOf(a))?"extrude":i.hasOwnProperty(a)?"image":""!==this.fontService.getGlyph(a)?"icon":"text"}return"normal"}}]),n}(he);function In(e){return function(){var t,n=_()(e);if(Mn()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Mn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Pn='uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_Color;\n  gl_FragColor.a *= u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',On='precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\n\nvarying vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',Ln=function(e){m()(n,e);var t=In(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t;return{u_opacity:n}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:On,fragmentShader:Pn,triangulation:Xe})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:c["AttributeType"].Attribute,descriptor:{name:"a_Normal",buffer:{usage:c["gl"].STATIC_DRAW,data:[],type:c["gl"].FLOAT},size:3,update:function(e,t,n,r,i){return i}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:c["AttributeType"].Attribute,descriptor:{name:"a_Size",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t,n,r){var i=e.size,o=void 0===i?10:i;return Array.isArray(o)?[o[0]]:[o]}}})}}]),n}(de);function Rn(e){return function(){var t,n=_()(e);if(Dn()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Dn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var zn='uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\n\n#pragma include "picking"\n\nvoid main() {\n  gl_FragColor = v_Color;\n  gl_FragColor.a *= u_opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',Nn='attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\n\nvarying vec4 v_Color;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n\n',jn=function(e){m()(n,e);var t=Rn(n);function n(){return p()(this,n),t.apply(this,arguments)}return h()(n,[{key:"getUninforms",value:function(){var e=this.layer.getLayerConfig(),t=e.opacity,n=void 0===t?1:t;return{u_opacity:n}}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:Nn,fragmentShader:zn,triangulation:Ye,depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),n}(de),Fn={fill:jn,line:xt,extrude:Ln,text:Sn,point_fill:zt,point_image:Ht,point_normal:Qt,point_extrude:Pt},Bn=Fn;function Un(e){return function(){var t,n=_()(e);if(Vn()){var r=_()(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v()(this,t)}}function Vn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Gn,qn,Zn,Hn,Wn,Yn,Xn,Kn,Jn=function(e){m()(n,e);var t=Un(n);function n(){var e;p()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.type="PolygonLayer",e}return h()(n,[{key:"buildModels",value:function(){var e=this.getModelType();this.layerModel=new Bn[e](this),this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var e,t=this.styleAttributeService.getLayerStyleAttribute("shape"),n=null===t||void 0===t||null===(e=t.scale)||void 0===e?void 0:e.field;return"fill"===n?"fill":"extrude"===n?"extrude":"line"===n?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var e=this.getEncodedData(),t=this.getLayerConfig(),n=t.shape2d,r=t.shape3d,i=this.iconService.getIconMap(),o=e.find((function(e){return e.hasOwnProperty("shape")}));if(o){var a=o.shape;return"dot"===a?"point_normal":-1!==(null===n||void 0===n?void 0:n.indexOf(a))?"point_fill":-1!==(null===r||void 0===r?void 0:r.indexOf(a))?"point_extrude":i.hasOwnProperty(a)?"point_image":"text"}return"fill"}}]),n}(he);function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var er,tr,nr,rr=(Gn=Object(F["injectable"])(),qn=Object(F["inject"])(c["TYPES"].IGlobalConfigService),Zn=Object(F["inject"])(c["TYPES"].ILogService),Gn((Kn=function(){function e(){p()(this,e),T()(this,"configService",Yn,this),T()(this,"logger",Xn,this)}return h()(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("DataMappingPlugin",(function(){n.generateMaping(e,{styleAttributeService:r})})),e.hooks.beforeRenderData.tap("DataMappingPlugin",(function(){return e.dataState.dataMappingNeedUpdate=!1,n.generateMaping(e,{styleAttributeService:r}),!0})),e.hooks.beforeRender.tap("DataMappingPlugin",(function(){var t=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter"),o=e.getSource().data.dataArray,a=t.filter((function(e){return e.needRemapping})),s=o;(null===i||void 0===i?void 0:i.needRemapping)&&(null===i||void 0===i?void 0:i.scale)&&(s=o.filter((function(e){return n.applyAttributeMapping(i,e)[0]}))),a.length&&((null===i||void 0===i?void 0:i.needRemapping)?(e.setEncodedData(n.mapping(t,s)),i.needRemapping=!1):e.setEncodedData(n.mapping(a,s,e.getEncodedData())),n.logger.debug("remapping finished"),e.emit("remapping",null))}))}},{key:"generateMaping",value:function(e,t){var n=this,r=t.styleAttributeService,i=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter"),a=e.getSource().data.dataArray,s=a;(null===o||void 0===o?void 0:o.scale)&&(s=a.filter((function(e){return n.applyAttributeMapping(o,e)[0]}))),e.setEncodedData(this.mapping(i,s))}},{key:"mapping",value:function(e,t,n){var r=this;return t.map((function(t,i){var o=n?n[i]:{},a=$n({id:t._id,coordinates:t.coordinates},o);return e.filter((function(e){return void 0!==e.scale})).forEach((function(e){var n=r.applyAttributeMapping(e,t);e.needRemapping=!1,"color"===e.name&&(n=n.map((function(e){return Object(D["q"])(e)}))),a[e.name]=Array.isArray(n)&&1===n.length?n[0]:n})),a}))}},{key:"applyAttributeMapping",value:function(e,t){var n;if(!e.scale)return[];var r=(null===e||void 0===e||null===(n=e.scale)||void 0===n?void 0:n.scalers)||[],i=[];return r.forEach((function(n){var r,o=n.field;(t.hasOwnProperty(o)||"variable"===(null===(r=e.scale)||void 0===r?void 0:r.type))&&i.push(t[o])})),e.mapping?e.mapping(i):[]}}]),e}(),Wn=Kn,Yn=I()(Wn.prototype,"configService",[qn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xn=I()(Wn.prototype,"logger",[Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=Wn))||Hn),ir=n("rlAn"),or=(er=Object(F["injectable"])(),er((nr=function(){function e(){p()(this,e),this.mapService=void 0}return h()(e,[{key:"apply",value:function(e){var t=this;this.mapService=e.getContainer().get(c["TYPES"].IMapService),e.hooks.init.tap("DataSourcePlugin",(function(){var n=e.sourceOption,r=n.data,i=n.options;e.setSource(new ir["default"](r,i)),t.updateClusterData(e)})),e.hooks.beforeRenderData.tap("DataSourcePlugin",(function(){var n=t.updateClusterData(e),r=e.dataState.dataSourceNeedUpdate;return e.dataState.dataSourceNeedUpdate=!1,n||r}))}},{key:"updateClusterData",value:function(e){var t=e.getSource(),n=t.cluster,r=t.clusterOptions,i=r.zoom,o=void 0===i?0:i,a=r.maxZoom,s=void 0===a?16:a,u=this.mapService.getZoom()-1;return!!(n&&Math.abs(o-u)>1&&s>o)&&(t.updateClusterData(Math.floor(u)),!0)}}]),e}(),tr=nr))||tr),ar=n("7tbW"),sr=n.n(ar),ur=n("4qC0"),cr=n.n(ur),lr=n("J2iB"),pr=n.n(lr),fr=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},hr=function(e){return 1===e.length&&(e=dr(e)),{left:function(t,n,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r},right:function(t,n,r,i){null==r&&(r=0),null==i&&(i=t.length);while(r<i){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}};function dr(e){return function(t,n){return fr(e(t),n)}}var mr=hr(fr),gr=mr.right,vr=(mr.left,gr);var yr=function(e){return null===e?NaN:+e},_r=function(e,t){var n,r,i,o=e.length,a=-1;if(null==t){while(++a<o)if(null!=(n=e[a])&&n>=n){r=i=n;while(++a<o)null!=(n=e[a])&&(r>n&&(r=n),i<n&&(i=n))}}else while(++a<o)if(null!=(n=t(e[a],a,e))&&n>=n){r=i=n;while(++a<o)null!=(n=t(e[a],a,e))&&(r>n&&(r=n),i<n&&(i=n))}return[r,i]},br=Array.prototype,xr=(br.slice,br.map,Math.sqrt(50)),wr=Math.sqrt(10),Sr=Math.sqrt(2),Er=function(e,t,n){var r,i,o,a,s=-1;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(a=Tr(e,t,n))||!isFinite(a))return[];if(a>0){e=Math.ceil(e/a),t=Math.floor(t/a),o=new Array(i=Math.ceil(t-e+1));while(++s<i)o[s]=(e+s)*a}else{e=Math.floor(e*a),t=Math.ceil(t*a),o=new Array(i=Math.ceil(e-t+1));while(++s<i)o[s]=(e-s)/a}return r&&o.reverse(),o};function Tr(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=xr?10:o>=wr?5:o>=Sr?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=xr?10:o>=wr?5:o>=Sr?2:1)}function kr(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=xr?i*=10:o>=wr?i*=5:o>=Sr&&(i*=2),t<e?-i:i}var Ar=function(e,t,n){if(null==n&&(n=yr),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}};function Cr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}var Ir="$";function Mr(){}function Pr(e,t){var n=new Mr;if(e instanceof Mr)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var r,i=-1,o=e.length;if(null==t)while(++i<o)n.set(i,e[i]);else while(++i<o)n.set(t(r=e[i],i,e),r)}else if(e)for(var a in e)n.set(a,e[a]);return n}Mr.prototype=Pr.prototype={constructor:Mr,has:function(e){return Ir+e in this},get:function(e){return this[Ir+e]},set:function(e,t){return this[Ir+e]=t,this},remove:function(e){var t=Ir+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===Ir&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===Ir&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===Ir&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===Ir&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===Ir&&++e;return e},empty:function(){for(var e in this)if(e[0]===Ir)return!1;return!0},each:function(e){for(var t in this)t[0]===Ir&&e(this[t],t.slice(1),this)}};var Or=Pr;function Lr(){}var Rr=Or.prototype;function Dr(e,t){var n=new Lr;if(e instanceof Lr)e.each((function(e){n.add(e)}));else if(e){var r=-1,i=e.length;if(null==t)while(++r<i)n.add(e[r]);else while(++r<i)n.add(t(e[r],r,e))}return n}Lr.prototype=Dr.prototype={constructor:Lr,has:Rr.has,add:function(e){return e+="",this[Ir+e]=e,this},remove:Rr.remove,clear:Rr.clear,values:Rr.keys,size:Rr.size,empty:Rr.empty,each:Rr.each};var zr=Array.prototype,Nr=zr.map,jr=zr.slice,Fr={name:"implicit"};function Br(){var e=Or(),t=[],n=[],r=Fr;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==Fr)return r;e.set(o,a=t.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=Or();var r,o,a=-1,s=n.length;while(++a<s)e.has(o=(r=n[a])+"")||e.set(o,t.push(r));return i},i.range=function(e){return arguments.length?(n=jr.call(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Br(t,n).unknown(r)},Cr.apply(i,arguments),i}var Ur=n("FmoU");function Vr(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}var Gr=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return Vr((n-r/t)*t,a,i,o,s)}},qr=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],a=e[(r+1)%t],s=e[(r+2)%t];return Vr((n-r/t)*t,i,o,a,s)}},Zr=function(e){return function(){return e}};function Hr(e,t){return function(n){return e+n*t}}function Wr(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Yr(e){return 1===(e=+e)?Xr:function(t,n){return n-t?Wr(t,n,e):Zr(isNaN(t)?n:t)}}function Xr(e,t){var n=t-e;return n?Hr(e,n):Zr(isNaN(e)?t:e)}var Kr=function e(t){var n=Yr(t);function r(e,t){var r=n((e=Object(Ur["b"])(e)).r,(t=Object(Ur["b"])(t)).r),i=n(e.g,t.g),o=n(e.b,t.b),a=Xr(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function Jr(e){return function(t){var n,r,i=t.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Object(Ur["b"])(t[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=e(o),a=e(a),s=e(s),r.opacity=1,function(e){return r.r=o(e),r.g=a(e),r.b=s(e),r+""}}}Jr(Gr),Jr(qr);var Qr=function(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}};function $r(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ei(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=ci(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<i;++n)a[n]=o[n](e);return a}}var ti=function(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}},ni=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},ri=function(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=ci(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}},ii=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oi=new RegExp(ii.source,"g");function ai(e){return function(){return e}}function si(e){return function(t){return e(t)+""}}var ui=function(e,t){var n,r,i,o=ii.lastIndex=oi.lastIndex=0,a=-1,s=[],u=[];e+="",t+="";while((n=ii.exec(e))&&(r=oi.exec(t)))(i=r.index)>o&&(i=t.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:ni(n,r)})),o=oi.lastIndex;return o<t.length&&(i=t.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?si(u[0].x):ai(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})},ci=function(e,t){var n,r=typeof t;return null==t||"boolean"===r?Zr(t):("number"===r?ni:"string"===r?(n=Object(Ur["a"])(t))?(t=n,Kr):ui:t instanceof Ur["a"]?Kr:t instanceof Date?ti:$r(t)?Qr:Array.isArray(t)?ei:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?ri:ni)(e,t)},li=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}},pi=function(e){return function(){return e}},fi=function(e){return+e},hi=[0,1];function di(e){return e}function mi(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:pi(isNaN(t)?NaN:.5)}function gi(e){var t,n=e[0],r=e[e.length-1];return n>r&&(t=n,n=r,r=t),function(e){return Math.max(n,Math.min(r,e))}}function vi(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=mi(i,r),o=n(a,o)):(r=mi(r,i),o=n(o,a)),function(e){return o(r(e))}}function yi(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++a<r)i[a]=mi(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(t){var n=vr(e,t,1,r)-1;return o[n](i[n](t))}}function _i(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bi(){var e,t,n,r,i,o,a=hi,s=hi,u=ci,c=di;function l(){return r=Math.min(a.length,s.length)>2?yi:vi,i=o=null,p}function p(t){return isNaN(t=+t)?n:(i||(i=r(a.map(e),s,u)))(e(c(t)))}return p.invert=function(n){return c(t((o||(o=r(s,a.map(e),ni)))(n)))},p.domain=function(e){return arguments.length?(a=Nr.call(e,fi),c===di||(c=gi(a)),l()):a.slice()},p.range=function(e){return arguments.length?(s=jr.call(e),l()):s.slice()},p.rangeRound=function(e){return s=jr.call(e),u=li,l()},p.clamp=function(e){return arguments.length?(c=e?gi(a):di,p):c!==di},p.interpolate=function(e){return arguments.length?(u=e,l()):u},p.unknown=function(e){return arguments.length?(n=e,p):n},function(n,r){return e=n,t=r,l()}}function xi(e,t){return bi()(e,t)}var wi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Si(e){if(!(t=wi.exec(e)))throw new Error("invalid format: "+e);var t;return new Ei({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Ei(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}Si.prototype=Ei.prototype,Ei.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ti,ki,Ai,Ci,Ii=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},Mi=function(e){return e=Ii(Math.abs(e)),e?e[1]:NaN},Pi=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Mi(t)/3)))-Mi(Math.abs(e)))},Oi=function(e,t){return function(n,r){var i=n.length,o=[],a=0,s=e[0],u=0;while(i>0&&s>0){if(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),(u+=s+1)>r)break;s=e[a=(a+1)%e.length]}return o.reverse().join(t)}},Li=function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}},Ri=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(t+1):e},Di=function(e,t){var n=Ii(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(Ti=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Ii(e,Math.max(0,t+o-1))[0]},zi=function(e,t){var n=Ii(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Ni={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return zi(100*e,t)},r:zi,s:Di,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},ji=function(e){return e},Fi=Array.prototype.map,Bi=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],Ui=function(e){var t=void 0===e.grouping||void 0===e.thousands?ji:Oi(Fi.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",r=void 0===e.currency?"":e.currency[1]+"",i=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?ji:Li(Fi.call(e.numerals,String)),a=void 0===e.percent?"%":e.percent+"",s=void 0===e.minus?"-":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function c(e){e=Si(e);var c=e.fill,l=e.align,p=e.sign,f=e.symbol,h=e.zero,d=e.width,m=e.comma,g=e.precision,v=e.trim,y=e.type;"n"===y?(m=!0,y="g"):Ni[y]||(void 0===g&&(g=12),v=!0,y="g"),(h||"0"===c&&"="===l)&&(h=!0,c="0",l="=");var _="$"===f?n:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===f?r:/[%p]/.test(y)?a:"",x=Ni[y],w=/[defgprs%]/.test(y);function S(e){var n,r,a,f=_,S=b;if("c"===y)S=x(e)+S,e="";else{e=+e;var E=e<0||1/e<0;if(e=isNaN(e)?u:x(Math.abs(e),g),v&&(e=Ri(e)),E&&0===+e&&"+"!==p&&(E=!1),f=(E?"("===p?p:s:"-"===p||"("===p?"":p)+f,S=("s"===y?Bi[8+Ti/3]:"")+S+(E&&"("===p?")":""),w){n=-1,r=e.length;while(++n<r)if(a=e.charCodeAt(n),48>a||a>57){S=(46===a?i+e.slice(n+1):e.slice(n))+S,e=e.slice(0,n);break}}}m&&!h&&(e=t(e,1/0));var T=f.length+e.length+S.length,k=T<d?new Array(d-T+1).join(c):"";switch(m&&h&&(e=t(k+e,k.length?d-S.length:1/0),k=""),l){case"<":e=f+e+S+k;break;case"=":e=f+k+e+S;break;case"^":e=k.slice(0,T=k.length>>1)+f+e+S+k.slice(T);break;default:e=k+f+e+S;break}return o(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}function l(e,t){var n=c((e=Si(e),e.type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Mi(t)/3))),i=Math.pow(10,-r),o=Bi[8+r/3];return function(e){return n(i*e)+o}}return{format:c,formatPrefix:l}};function Vi(e){return ki=Ui(e),Ai=ki.format,Ci=ki.formatPrefix,ki}Vi({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var Gi=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Mi(t)-Mi(e))+1},qi=function(e){return Math.max(0,-Mi(Math.abs(e)))},Zi=function(e,t,n,r){var i,o=kr(e,t,n);switch(r=Si(null==r?",f":r),r.type){case"s":var a=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=Pi(o,a))||(r.precision=i),Ci(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Gi(o,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=qi(o))||(r.precision=i-2*("%"===r.type));break}return Ai(r)};function Hi(e){var t=e.domain;return e.ticks=function(e){var n=t();return Er(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Zi(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i=t(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),r=Tr(s,u,n),r>0?(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,r=Tr(s,u,n)):r<0&&(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,r=Tr(s,u,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,t(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,t(i)),e},e}function Wi(){var e=xi(di,di);return e.copy=function(){return _i(e,Wi())},Cr.apply(e,arguments),Hi(e)}function Yi(e){var t;function n(e){return isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Nr.call(t,fi),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Yi(e).unknown(t)},e=arguments.length?Nr.call(e,fi):[0,1],Hi(n)}var Xi=function(e,t){e=e.slice();var n,r=0,i=e.length-1,o=e[r],a=e[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),e[r]=t.floor(o),e[i]=t.ceil(a),e};function Ki(e){return Math.log(e)}function Ji(e){return Math.exp(e)}function Qi(e){return-Math.log(-e)}function $i(e){return-Math.exp(-e)}function eo(e){return isFinite(e)?+("1e"+e):e<0?0:e}function to(e){return 10===e?eo:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function no(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function ro(e){return function(t){return-e(-t)}}function io(e){var t,n,r=e(Ki,Ji),i=r.domain,o=10;function a(){return t=no(o),n=to(o),i()[0]<0?(t=ro(t),n=ro(n),e(Qi,$i)):e(Ki,Ji),r}return r.base=function(e){return arguments.length?(o=+e,a()):o},r.domain=function(e){return arguments.length?(i(e),a()):i()},r.ticks=function(e){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(f=s,s=u,u=f);var c,l,p,f=t(s),h=t(u),d=null==e?10:+e,m=[];if(!(o%1)&&h-f<d){if(f=Math.round(f)-1,h=Math.round(h)+1,s>0){for(;f<h;++f)for(l=1,c=n(f);l<o;++l)if(p=c*l,!(p<s)){if(p>u)break;m.push(p)}}else for(;f<h;++f)for(l=o-1,c=n(f);l>=1;--l)if(p=c*l,!(p<s)){if(p>u)break;m.push(p)}}else m=Er(f,h,Math.min(h-f,d)).map(n);return r?m.reverse():m},r.tickFormat=function(e,i){if(null==i&&(i=10===o?".0e":","),"function"!==typeof i&&(i=Ai(i)),e===1/0)return i;null==e&&(e=10);var a=Math.max(1,o*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*o<o-.5&&(r*=o),r<=a?i(e):""}},r.nice=function(){return i(Xi(i(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function oo(){var e=io(bi()).domain([1,10]);return e.copy=function(){return _i(e,oo()).base(e.base())},Cr.apply(e,arguments),e}function ao(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function so(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function uo(e){return e<0?-e*e:e*e}function co(e){var t=e(di,di),n=1;function r(){return 1===n?e(di,di):.5===n?e(so,uo):e(ao(n),ao(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},Hi(t)}function lo(){var e=co(bi());return e.copy=function(){return _i(e,lo()).exponent(e.exponent())},Cr.apply(e,arguments),e}function po(){var e,t=[],n=[],r=[];function i(){var e=0,i=Math.max(1,n.length);r=new Array(i-1);while(++e<i)r[e-1]=Ar(t,e/i);return o}function o(t){return isNaN(t=+t)?e:n[vr(r,t)]}return o.invertExtent=function(e){var i=n.indexOf(e);return i<0?[NaN,NaN]:[i>0?r[i-1]:t[0],i<r.length?r[i]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var n,r=0,o=e.length;r<o;++r)n=e[r],null==n||isNaN(n=+n)||t.push(n);return t.sort(fr),i()},o.range=function(e){return arguments.length?(n=jr.call(e),i()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return r.slice()},o.copy=function(){return po().domain(t).range(n).unknown(e)},Cr.apply(o,arguments)}function fo(){var e,t=0,n=1,r=1,i=[.5],o=[0,1];function a(t){return t<=t?o[vr(i,t,0,r)]:e}function s(){var e=-1;i=new Array(r);while(++e<r)i[e]=((e+1)*n-(e-r)*t)/(r+1);return a}return a.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],s()):[t,n]},a.range=function(e){return arguments.length?(r=(o=jr.call(e)).length-1,s()):o.slice()},a.invertExtent=function(e){var a=o.indexOf(e);return a<0?[NaN,NaN]:a<1?[t,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return fo().domain([t,n]).range(o).unknown(e)},Cr.apply(Hi(a),arguments)}function ho(){var e,t=[.5],n=[0,1],r=1;function i(i){return i<=i?n[vr(t,i,0,r)]:e}return i.domain=function(e){return arguments.length?(t=jr.call(e),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(e){return arguments.length?(n=jr.call(e),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return ho().domain(t).range(n).unknown(e)},Cr.apply(i,arguments)}var mo=new Date,go=new Date;function vo(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return s;do{s.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<r);return s},i.filter=function(n){return vo((function(t){if(t>=t)while(e(t),!n(t))t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)while(++r<=0)while(t(e,-1),!n(e));else while(--r>=0)while(t(e,1),!n(e));}))},n&&(i.count=function(t,r){return mo.setTime(+t),go.setTime(+r),e(mo),e(go),Math.floor(n(mo,go))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?function(t){return r(t)%e===0}:function(t){return i.count(0,t)%e===0}):i:null}),i}var yo=vo((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));yo.every=function(e){return isFinite(e=Math.floor(e))&&e>0?vo((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var _o=yo,bo=(yo.range,vo((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),xo=bo,wo=(bo.range,1e3),So=6e4,Eo=36e5,To=864e5,ko=6048e5;function Ao(e){return vo((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*So)/ko}))}var Co=Ao(0),Io=Ao(1),Mo=Ao(2),Po=Ao(3),Oo=Ao(4),Lo=Ao(5),Ro=Ao(6),Do=(Co.range,Io.range,Mo.range,Po.range,Oo.range,Lo.range,Ro.range,vo((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*So)/To}),(function(e){return e.getDate()-1}))),zo=Do,No=(Do.range,vo((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*wo-e.getMinutes()*So)}),(function(e,t){e.setTime(+e+t*Eo)}),(function(e,t){return(t-e)/Eo}),(function(e){return e.getHours()}))),jo=No,Fo=(No.range,vo((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*wo)}),(function(e,t){e.setTime(+e+t*So)}),(function(e,t){return(t-e)/So}),(function(e){return e.getMinutes()}))),Bo=Fo,Uo=(Fo.range,vo((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*wo)}),(function(e,t){return(t-e)/wo}),(function(e){return e.getUTCSeconds()}))),Vo=Uo,Go=(Uo.range,vo((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));Go.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?vo((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Go:null};var qo=Go;Go.range;function Zo(e){return vo((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/ko}))}var Ho=Zo(0),Wo=Zo(1),Yo=Zo(2),Xo=Zo(3),Ko=Zo(4),Jo=Zo(5),Qo=Zo(6),$o=(Ho.range,Wo.range,Yo.range,Xo.range,Ko.range,Jo.range,Qo.range,vo((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/To}),(function(e){return e.getUTCDate()-1}))),ea=$o,ta=($o.range,vo((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));ta.every=function(e){return isFinite(e=Math.floor(e))&&e>0?vo((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var na=ta;ta.range;function ra(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ia(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function oa(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function aa(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,c=ma(i),l=ga(i),p=ma(o),f=ga(o),h=ma(a),d=ga(a),m=ma(s),g=ga(s),v=ma(u),y=ga(u),_={a:L,A:R,b:D,B:z,c:null,d:Na,e:Na,f:Va,H:ja,I:Fa,j:Ba,L:Ua,m:Ga,M:qa,p:N,q:j,Q:ys,s:_s,S:Za,u:Ha,U:Wa,V:Ya,w:Xa,W:Ka,x:null,X:null,y:Ja,Y:Qa,Z:$a,"%":vs},b={a:F,A:B,b:U,B:V,c:null,d:es,e:es,f:os,H:ts,I:ns,j:rs,L:is,m:as,M:ss,p:G,q:q,Q:ys,s:_s,S:us,u:cs,U:ls,V:ps,w:fs,W:hs,x:null,X:null,y:ds,Y:ms,Z:gs,"%":vs},x={a:k,A:A,b:C,B:I,c:M,d:Aa,e:Aa,f:La,H:Ia,I:Ia,j:Ca,L:Oa,m:ka,M:Ma,p:T,q:Ta,Q:Da,s:za,S:Pa,u:ya,U:_a,V:ba,w:va,W:xa,x:P,X:O,y:Sa,Y:wa,Z:Ea,"%":Ra};function w(e,t){return function(n){var r,i,o,a=[],s=-1,u=0,c=e.length;n instanceof Date||(n=new Date(+n));while(++s<c)37===e.charCodeAt(s)&&(a.push(e.slice(u,s)),null!=(i=ca[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(e.slice(u,s)),a.join("")}}function S(e,t){return function(n){var r,i,o=oa(1900,void 0,1),a=E(o,e,n+="",0);if(a!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=ia(oa(o.y,0,1)),i=r.getUTCDay(),r=i>4||0===i?Wo.ceil(r):Wo(r),r=ea.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=ra(oa(o.y,0,1)),i=r.getDay(),r=i>4||0===i?Io.ceil(r):Io(r),r=zo.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?ia(oa(o.y,0,1)).getUTCDay():ra(oa(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,ia(o)):ra(o)}}function E(e,t,n,r){var i,o,a=0,s=t.length,u=n.length;while(a<s){if(r>=u)return-1;if(i=t.charCodeAt(a++),37===i){if(i=t.charAt(a++),o=x[i in ca?t.charAt(a++):i],!o||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function T(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l[r[0].toLowerCase()],n+r[0].length):-1}function k(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1}function A(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=f[r[0].toLowerCase()],n+r[0].length):-1}function C(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1}function I(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1}function M(e,n,r){return E(e,t,n,r)}function P(e,t,r){return E(e,n,t,r)}function O(e,t,n){return E(e,r,t,n)}function L(e){return a[e.getDay()]}function R(e){return o[e.getDay()]}function D(e){return u[e.getMonth()]}function z(e){return s[e.getMonth()]}function N(e){return i[+(e.getHours()>=12)]}function j(e){return 1+~~(e.getMonth()/3)}function F(e){return a[e.getUTCDay()]}function B(e){return o[e.getUTCDay()]}function U(e){return u[e.getUTCMonth()]}function V(e){return s[e.getUTCMonth()]}function G(e){return i[+(e.getUTCHours()>=12)]}function q(e){return 1+~~(e.getUTCMonth()/3)}return _.x=w(n,_),_.X=w(r,_),_.c=w(t,_),b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),{format:function(e){var t=w(e+="",_);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}var sa,ua,ca={"-":"",_:" ",0:"0"},la=/^\s*\d+/,pa=/^%/,fa=/[\\^$*+?|[\]().{}]/g;function ha(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function da(e){return e.replace(fa,"\\$&")}function ma(e){return new RegExp("^(?:"+e.map(da).join("|")+")","i")}function ga(e){var t={},n=-1,r=e.length;while(++n<r)t[e[n].toLowerCase()]=n;return t}function va(e,t,n){var r=la.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ya(e,t,n){var r=la.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function _a(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function ba(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function xa(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function wa(e,t,n){var r=la.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Sa(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ea(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ta(e,t,n){var r=la.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function ka(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Aa(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Ca(e,t,n){var r=la.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ia(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Ma(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Pa(e,t,n){var r=la.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Oa(e,t,n){var r=la.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function La(e,t,n){var r=la.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ra(e,t,n){var r=pa.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Da(e,t,n){var r=la.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function za(e,t,n){var r=la.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Na(e,t){return ha(e.getDate(),t,2)}function ja(e,t){return ha(e.getHours(),t,2)}function Fa(e,t){return ha(e.getHours()%12||12,t,2)}function Ba(e,t){return ha(1+zo.count(_o(e),e),t,3)}function Ua(e,t){return ha(e.getMilliseconds(),t,3)}function Va(e,t){return Ua(e,t)+"000"}function Ga(e,t){return ha(e.getMonth()+1,t,2)}function qa(e,t){return ha(e.getMinutes(),t,2)}function Za(e,t){return ha(e.getSeconds(),t,2)}function Ha(e){var t=e.getDay();return 0===t?7:t}function Wa(e,t){return ha(Co.count(_o(e)-1,e),t,2)}function Ya(e,t){var n=e.getDay();return e=n>=4||0===n?Oo(e):Oo.ceil(e),ha(Oo.count(_o(e),e)+(4===_o(e).getDay()),t,2)}function Xa(e){return e.getDay()}function Ka(e,t){return ha(Io.count(_o(e)-1,e),t,2)}function Ja(e,t){return ha(e.getFullYear()%100,t,2)}function Qa(e,t){return ha(e.getFullYear()%1e4,t,4)}function $a(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ha(t/60|0,"0",2)+ha(t%60,"0",2)}function es(e,t){return ha(e.getUTCDate(),t,2)}function ts(e,t){return ha(e.getUTCHours(),t,2)}function ns(e,t){return ha(e.getUTCHours()%12||12,t,2)}function rs(e,t){return ha(1+ea.count(na(e),e),t,3)}function is(e,t){return ha(e.getUTCMilliseconds(),t,3)}function os(e,t){return is(e,t)+"000"}function as(e,t){return ha(e.getUTCMonth()+1,t,2)}function ss(e,t){return ha(e.getUTCMinutes(),t,2)}function us(e,t){return ha(e.getUTCSeconds(),t,2)}function cs(e){var t=e.getUTCDay();return 0===t?7:t}function ls(e,t){return ha(Ho.count(na(e)-1,e),t,2)}function ps(e,t){var n=e.getUTCDay();return e=n>=4||0===n?Ko(e):Ko.ceil(e),ha(Ko.count(na(e),e)+(4===na(e).getUTCDay()),t,2)}function fs(e){return e.getUTCDay()}function hs(e,t){return ha(Wo.count(na(e)-1,e),t,2)}function ds(e,t){return ha(e.getUTCFullYear()%100,t,2)}function ms(e,t){return ha(e.getUTCFullYear()%1e4,t,4)}function gs(){return"+0000"}function vs(){return"%"}function ys(e){return+e}function _s(e){return Math.floor(+e/1e3)}function bs(e){return sa=aa(e),ua=sa.format,sa.parse,sa.utcFormat,sa.utcParse,sa}bs({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var xs=1e3,ws=60*xs,Ss=60*ws,Es=24*Ss,Ts=7*Es,ks=30*Es,As=365*Es;function Cs(e){return new Date(e)}function Is(e){return e instanceof Date?+e:+new Date(+e)}function Ms(e,t,n,r,i,o,a,s,u){var c=xi(di,di),l=c.invert,p=c.domain,f=u(".%L"),h=u(":%S"),d=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),v=u("%b %d"),y=u("%B"),_=u("%Y"),b=[[a,1,xs],[a,5,5*xs],[a,15,15*xs],[a,30,30*xs],[o,1,ws],[o,5,5*ws],[o,15,15*ws],[o,30,30*ws],[i,1,Ss],[i,3,3*Ss],[i,6,6*Ss],[i,12,12*Ss],[r,1,Es],[r,2,2*Es],[n,1,Ts],[t,1,ks],[t,3,3*ks],[e,1,As]];function x(s){return(a(s)<s?f:o(s)<s?h:i(s)<s?d:r(s)<s?m:t(s)<s?n(s)<s?g:v:e(s)<s?y:_)(s)}function w(t,n,r,i){if(null==t&&(t=10),"number"===typeof t){var o=Math.abs(r-n)/t,a=hr((function(e){return e[2]})).right(b,o);a===b.length?(i=kr(n/As,r/As,t),t=e):a?(a=b[o/b[a-1][2]<b[a][2]/o?a-1:a],i=a[1],t=a[0]):(i=Math.max(kr(n,r,t),1),t=s)}return null==i?t:t.every(i)}return c.invert=function(e){return new Date(l(e))},c.domain=function(e){return arguments.length?p(Nr.call(e,Is)):p().map(Cs)},c.ticks=function(e,t){var n,r=p(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=w(e,i,o,t),n=n?n.range(i,o+1):[],a?n.reverse():n},c.tickFormat=function(e,t){return null==t?x:u(t)},c.nice=function(e,t){var n=p();return(e=w(e,n[0],n[n.length-1],t))?p(Xi(n,e)):c},c.copy=function(){return _i(c,Ms(e,t,n,r,i,o,a,s,u))},c}var Ps,Os,Ls,Rs,Ds,zs,Ns,js,Fs,Bs=function(){return Cr.apply(Ms(_o,xo,Co,zo,jo,Bo,Vo,qo,ua).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Us=vo((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),Vs=(Us.range,vo((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Eo)}),(function(e,t){return(t-e)/Eo}),(function(e){return e.getUTCHours()}))),Gs=(Vs.range,vo((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*So)}),(function(e,t){return(t-e)/So}),(function(e){return e.getUTCMinutes()})));Gs.range;var qs,Zs,Hs,Ws,Ys,Xs,Ks,Js,Qs=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,$s=(Ps={},S()(Ps,c["ScaleTypes"].LINEAR,Wi),S()(Ps,c["ScaleTypes"].POWER,lo),S()(Ps,c["ScaleTypes"].LOG,oo),S()(Ps,c["ScaleTypes"].IDENTITY,Yi),S()(Ps,c["ScaleTypes"].TIME,Bs),S()(Ps,c["ScaleTypes"].QUANTILE,po),S()(Ps,c["ScaleTypes"].QUANTIZE,fo),S()(Ps,c["ScaleTypes"].THRESHOLD,ho),S()(Ps,c["ScaleTypes"].CAT,Br),Ps),eu=(Os=Object(F["injectable"])(),Ls=Object(F["inject"])(c["TYPES"].IGlobalConfigService),Rs=Object(F["inject"])(c["TYPES"].ILogService),Os((Fs=function(){function e(){p()(this,e),T()(this,"configService",Ns,this),T()(this,"logger",js,this),this.scaleCache={},this.scaleOptions={}}return h()(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("FeatureScalePlugin",(function(){n.scaleOptions=e.getScaleOptions();var t=r.getLayerStyleAttributes(),i=e.getSource().data.dataArray;n.caculateScalesForAttributes(t||[],i)})),e.hooks.beforeRenderData.tap("FeatureScalePlugin",(function(){n.scaleOptions=e.getScaleOptions();var t=r.getLayerStyleAttributes(),i=e.getSource().data.dataArray;return n.caculateScalesForAttributes(t||[],i),!0})),e.hooks.beforeRender.tap("FeatureScalePlugin",(function(){n.scaleOptions=e.getScaleOptions();var t=r.getLayerStyleAttributes();if(t){var i=e.getSource().data.dataArray,o=t.filter((function(e){return e.needRescale}));o.length&&(n.caculateScalesForAttributes(o,i),n.logger.debug("rescale finished"))}}))}},{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},{key:"caculateScalesForAttributes",value:function(e,t){var n=this;this.scaleCache={},e.forEach((function(e){if(e.scale){var r=e.scale,i=e.name;r.names=n.parseFields(e.scale.field||[]);var o=[];r.names.forEach((function(r){o.push(n.getOrCreateScale(r,e,t))})),o.some((function(e){return e.type===c["StyleScaleType"].VARIABLE}))?(r.type=c["StyleScaleType"].VARIABLE,o.forEach((function(e){var t;if(!r.callback)if(r.values&&"text"!==r.values){var n;if("linear"===(null===(n=e.option)||void 0===n?void 0:n.type)&&r.values.length>2){var o=e.scale.ticks(r.values.length);"color"===i&&e.scale.domain(o)}e.scale.range(r.values)}else"cat"===(null===(t=e.option)||void 0===t?void 0:t.type)&&e.scale.range(e.option.domain)}))):(r.type=c["StyleScaleType"].CONSTANT,r.values=o.map((function(e,t){return e.scale(r.names[t])}))),r.scalers=o.map((function(e){return{field:e.field,func:e.scale,option:e.option}})),e.needRescale=!1}}))}},{key:"getOrCreateScale",value:function(e,t,n){[e,t.name].join("_");var r,i=null===(r=t.scale)||void 0===r?void 0:r.values,o=this.createScale(e,t.name,i,n);return o}},{key:"parseFields",value:function(e){return Array.isArray(e)?e:cr()(e)?e.split("*"):[e]}},{key:"createScale",value:function(e,t,n,r){var i,o=this.scaleOptions[t]&&this.scaleOptions[t].field===e?this.scaleOptions[t]:this.scaleOptions[e],a={field:e,scale:void 0,type:c["StyleScaleType"].VARIABLE,option:o};if(!r||!r.length)return o&&o.type?a.scale=this.createDefaultScale(o):(a.scale=Br([e]),a.type=c["StyleScaleType"].CONSTANT),a;var s=null===(i=r.find((function(t){return!pr()(t[e])})))||void 0===i?void 0:i[e];if(this.isNumber(e)||pr()(s)&&!o)a.scale=Br([e]),a.type=c["StyleScaleType"].CONSTANT;else{var u=o&&o.type||this.getDefaultType(s);"text"===n&&(u=c["ScaleTypes"].CAT);var l=this.createDefaultScaleConfig(u,e,r);Object.assign(l,o),a.scale=this.createDefaultScale(l),a.option=l}return a}},{key:"getDefaultType",value:function(e){var t=c["ScaleTypes"].LINEAR;return"string"===typeof e&&(t=Qs.test(e)?c["ScaleTypes"].TIME:c["ScaleTypes"].CAT),t}},{key:"createDefaultScaleConfig",value:function(e,t,n){var r={type:e},i=(null===n||void 0===n?void 0:n.map((function(e){return e[t]})))||[];return e!==c["ScaleTypes"].CAT&&e!==c["ScaleTypes"].QUANTILE?r.domain=_r(i):e===c["ScaleTypes"].CAT?r.domain=sr()(i):e===c["ScaleTypes"].QUANTILE&&(r.domain=i),r}},{key:"createDefaultScale",value:function(e){var t=e.type,n=e.domain,r=$s[t]();return n&&r.domain(n),r}}]),e}(),zs=Fs,Ns=I()(zs.prototype,"configService",[Ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),js=I()(zs.prototype,"logger",[Rs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ds=zs))||Ds);function tu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tu(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ru,iu,ou,au,su,uu,cu=(qs=Object(F["injectable"])(),Zs=Object(F["inject"])(c["TYPES"].ICameraService),Hs=Object(F["inject"])(c["TYPES"].IRendererService),qs((Js=function(){function e(){p()(this,e),T()(this,"cameraService",Xs,this),T()(this,"rendererService",Ks,this)}return h()(e,[{key:"apply",value:function(e){e.hooks.beforeRender.tap("LayerAnimateStylePlugin",(function(){e.models.forEach((function(t){t.addUniforms(nu({},e.layerModel.getAnimateUniforms()))}))}))}}]),e}(),Ys=Js,Xs=I()(Ys.prototype,"cameraService",[Zs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ks=I()(Ys.prototype,"rendererService",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ws=Ys))||Ws),lu=(ru=Object(F["injectable"])(),ru(iu=function(){function e(){p()(this,e)}return h()(e,[{key:"apply",value:function(e){e.hooks.init.tap("LayerModelPlugin",(function(){e.prepareBuildModel(),e.buildModels()})),e.hooks.beforeRenderData.tap("DataSourcePlugin",(function(){return e.prepareBuildModel(),e.buildModels(),e.layerModelNeedUpdate=!1,!1}))}}]),e}())||iu),pu=(ou=Object(F["injectable"])(),ou(au=function(){function e(){p()(this,e)}return h()(e,[{key:"apply",value:function(e){e.hooks.afterInit.tap("LayerStylePlugin",(function(){e.updateLayerConfig({});var t=e.getLayerConfig(),n=t.autoFit,r=t.fitBoundsOptions;n&&setTimeout((function(){e.fitBounds(r)}),100)}))}}]),e}())||au);function fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var du={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},mu={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},gu={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},vu={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function yu(e){var t={u_DirectionalLights:new Array(3).fill(hu({},gu)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(hu({},vu)),u_NumOfSpotLights:0};return e&&e.length||(e=[mu]),e.forEach((function(e,n){var r=e.type,i=void 0===r?"directional":r,o=x()(e,["type"]),a=du[i].lights,s=du[i].num,u=t[s];t[a][u]=hu({},t[a][u],{},o),t[s]++})),t}var _u,bu,xu,wu,Su,Eu,Tu,ku,Au,Cu,Iu,Mu,Pu,Ou,Lu,Ru,Du,zu,Nu,ju,Fu,Bu,Uu,Vu,Gu,qu,Zu=(su=Object(F["injectable"])(),su(uu=function(){function e(){p()(this,e)}return h()(e,[{key:"apply",value:function(e){e.hooks.beforeRender.tap("LightingPlugin",(function(){var t=e.getLayerConfig(),n=t.enableLighting;n&&e.models.forEach((function(e){return e.addUniforms(hu({},yu()))}))}))}}]),e}())||uu),Hu={NONE:0,ENCODE:1,HIGHLIGHT:2},Wu=(_u=Object(F["injectable"])(),_u(bu=function(){function e(){p()(this,e)}return h()(e,[{key:"apply",value:function(e,t){t.rendererService;var n=t.styleAttributeService;e.hooks.init.tap("PixelPickingPlugin",(function(){var t=e.getLayerConfig(),r=t.enablePicking;n.registerStyleAttribute({name:"pickingColor",type:c["AttributeType"].Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:c["gl"].FLOAT},size:3,update:function(e,t){var n=e.id;return r?Object(D["k"])(n):[0,0,0]}}})})),e.hooks.beforePickingEncode.tap("PixelPickingPlugin",(function(){var t=e.getLayerConfig(),n=t.enablePicking;n&&e.isVisible()&&e.models.forEach((function(e){return e.addUniforms({u_PickingStage:Hu.ENCODE})}))})),e.hooks.afterPickingEncode.tap("PixelPickingPlugin",(function(){var t=e.getLayerConfig(),n=t.enablePicking;n&&e.isVisible()&&e.models.forEach((function(e){return e.addUniforms({u_PickingStage:Hu.HIGHLIGHT})}))})),e.hooks.beforeHighlight.tap("PixelPickingPlugin",(function(t){var n=e.getLayerConfig(),r=n.highlightColor,i="string"===typeof r?Object(D["q"])(r):r||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:Object(D["j"])(new Uint8Array(t))}),e.models.forEach((function(e){return e.addUniforms({u_PickingStage:Hu.HIGHLIGHT,u_PickingColor:t,u_HighlightColor:i.map((function(e){return 255*e}))})}))})),e.hooks.beforeSelect.tap("PixelPickingPlugin",(function(t){var n=e.getLayerConfig(),r=n.selectColor,i="string"===typeof r?Object(D["q"])(r):r||[1,0,0,1];e.updateLayerConfig({pickedFeatureID:Object(D["j"])(new Uint8Array(t))}),e.models.forEach((function(e){return e.addUniforms({u_PickingStage:Hu.HIGHLIGHT,u_PickingColor:t,u_HighlightColor:i.map((function(e){return 255*e}))})}))}))}}]),e}())||bu),Yu=(xu=Object(F["injectable"])(),wu=Object(F["inject"])(c["TYPES"].ILogService),xu((ku=function(){function e(){p()(this,e),T()(this,"logger",Tu,this)}return h()(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("RegisterStyleAttributePlugin",(function(){n.registerBuiltinAttributes(r)}))}},{key:"registerBuiltinAttributes",value:function(e){e.registerStyleAttribute({name:"position",type:c["AttributeType"].Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:c["gl"].FLOAT},size:3,update:function(e,t,n){return 2===n.length?[n[0],n[1],0]:[n[0],n[1],n[2]]}}}),e.registerStyleAttribute({name:"filter",type:c["AttributeType"].Attribute,descriptor:{name:"filter",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:1,update:function(e,t){var n=e.filter;return n?[1]:[0]}}}),e.registerStyleAttribute({name:"color",type:c["AttributeType"].Attribute,descriptor:{name:"a_Color",buffer:{usage:c["gl"].DYNAMIC_DRAW,data:[],type:c["gl"].FLOAT},size:4,update:function(e,t){var n=e.color;return n&&n.length?n:[1,1,1,1]}}})}}]),e}(),Eu=ku,Tu=I()(Eu.prototype,"logger",[wu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=Eu))||Su),Xu=(Au=Object(F["injectable"])(),Cu=Object(F["inject"])(c["TYPES"].ICameraService),Iu=Object(F["inject"])(c["TYPES"].ICoordinateSystemService),Mu=Object(F["inject"])(c["TYPES"].IRendererService),Au((zu=function(){function e(){p()(this,e),T()(this,"cameraService",Lu,this),T()(this,"coordinateSystemService",Ru,this),T()(this,"rendererService",Du,this)}return h()(e,[{key:"apply",value:function(e){var t=this;e.hooks.beforeRender.tap("ShaderUniformPlugin",(function(){t.coordinateSystemService.refresh();var n=t.rendererService.getViewportSize(),r=n.width,i=n.height;e.models.forEach((function(n){var o;return n.addUniforms((o={},S()(o,c["CameraUniform"].ProjectionMatrix,t.cameraService.getProjectionMatrix()),S()(o,c["CameraUniform"].ViewMatrix,t.cameraService.getViewMatrix()),S()(o,c["CameraUniform"].ViewProjectionMatrix,t.cameraService.getViewProjectionMatrix()),S()(o,c["CameraUniform"].Zoom,t.cameraService.getZoom()),S()(o,c["CameraUniform"].ZoomScale,t.cameraService.getZoomScale()),S()(o,c["CameraUniform"].FocalDistance,t.cameraService.getFocalDistance()),S()(o,c["CameraUniform"].CameraPosition,t.cameraService.getCameraPosition()),S()(o,c["CoordinateUniform"].CoordinateSystem,t.coordinateSystemService.getCoordinateSystem()),S()(o,c["CoordinateUniform"].ViewportCenter,t.coordinateSystemService.getViewportCenter()),S()(o,c["CoordinateUniform"].ViewportCenterProjection,t.coordinateSystemService.getViewportCenterProjection()),S()(o,c["CoordinateUniform"].PixelsPerDegree,t.coordinateSystemService.getPixelsPerDegree()),S()(o,c["CoordinateUniform"].PixelsPerDegree2,t.coordinateSystemService.getPixelsPerDegree2()),S()(o,c["CoordinateUniform"].PixelsPerMeter,t.coordinateSystemService.getPixelsPerMeter()),S()(o,"u_ViewportSize",[r,i]),S()(o,"u_DevicePixelRatio",window.devicePixelRatio),S()(o,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),S()(o,"u_PickingBuffer",e.getLayerConfig().pickingBuffer||0),o))}))}))}}]),e}(),Ou=zu,Lu=I()(Ou.prototype,"cameraService",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ru=I()(Ou.prototype,"coordinateSystemService",[Iu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Du=I()(Ou.prototype,"rendererService",[Mu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=Ou))||Pu),Ku=(Nu=Object(F["injectable"])(),Nu(ju=function(){function e(){p()(this,e)}return h()(e,[{key:"apply",value:function(e){e.hooks.beforeRender.tap("UpdateModelPlugin",(function(){e.layerModel&&e.layerModel.needUpdate()}))}}]),e}())||ju),Ju=(Fu=Object(F["injectable"])(),Bu=Object(F["inject"])(c["TYPES"].ILogService),Fu((qu=function(){function e(){p()(this,e),T()(this,"logger",Gu,this)}return h()(e,[{key:"apply",value:function(e,t){var n=this,r=t.styleAttributeService;e.hooks.init.tap("UpdateStyleAttributePlugin",(function(){n.initStyleAttribute(e,{styleAttributeService:r})})),e.hooks.beforeRenderData.tap("styleAttributeService",(function(){return e.layerModelNeedUpdate=!0,!0})),e.hooks.beforeRender.tap("UpdateStyleAttributePlugin",(function(){e.layerModelNeedUpdate||n.updateStyleAtrribute(e,{styleAttributeService:r})}))}},{key:"updateStyleAtrribute",value:function(e,t){var n=this,r=t.styleAttributeService,i=r.getLayerStyleAttributes()||[],o=r.getLayerStyleAttribute("filter"),a=r.getLayerStyleAttribute("shape");if(o&&o.needRegenerateVertices||a&&a.needRegenerateVertices)return e.layerModelNeedUpdate=!0,void i.forEach((function(e){return e.needRegenerateVertices=!1}));i.filter((function(e){return e.needRegenerateVertices})).forEach((function(t){r.updateAttributeByFeatureRange(t.name,e.getEncodedData(),t.featureRange.startIndex,t.featureRange.endIndex),t.needRegenerateVertices=!1,n.logger.debug("regenerate vertex attributes: ".concat(t.name," finished"))}))}},{key:"initStyleAttribute",value:function(e,t){var n=this,r=t.styleAttributeService,i=r.getLayerStyleAttributes()||[];i.filter((function(e){return e.needRegenerateVertices})).forEach((function(t){r.updateAttributeByFeatureRange(t.name,e.getEncodedData(),t.featureRange.startIndex,t.featureRange.endIndex),t.needRegenerateVertices=!1,n.logger.debug("init vertex attributes: ".concat(t.name," finished"))}))}}]),e}(),Vu=qu,Gu=I()(Vu.prototype,"logger",[Bu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uu=Vu))||Uu);c["container"].bind(c["TYPES"].ILayerPlugin).to(or).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Yu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(eu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(rr).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(pu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Ju).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Ku).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(K).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Xu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(cu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Zu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(Wu).inRequestScope(),c["container"].bind(c["TYPES"].ILayerPlugin).to(lu).inRequestScope()},u6S6:function(e,t,n){var r=n("6acW"),i=n("sgoq"),o=i((function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t)}));e.exports=o},uhBA:function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,o){if("function"!==typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,o),u=i?i+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function u(e,t){0===--e._eventsCount?e._events=new o:delete e._events[t]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},c.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,r,o,a){var s=i?i+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(c=1,u=new Array(p-1);c<p;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),p){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(p-1);f<p;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&u(this,t)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,e.exports=c},ujMp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("MON2");function i(e){if("function"===typeof e){var t=e;return t.name}if("symbol"===typeof e)return e.toString();t=e;return t}function o(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=l(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r}function a(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||a(e.parentRequest,t))}function s(e){function t(e,n){void 0===n&&(n=[]);var r=i(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}var n=t(e);return n.reverse().join(" --\x3e ")}function u(e){e.childRequests.forEach((function(e){if(a(e,e.serviceIdentifier)){var t=s(e);throw new Error(r.CIRCULAR_DEPENDENCY+" "+t)}u(e)}))}function c(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}function l(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=i,t.listRegisteredBindingsForServiceIdentifier=o,t.circularDependencyToException=u,t.listMetadataForTarget=c,t.getFunctionName=l},"vN+2":function(e,t){function n(){}e.exports=n},"w/wX":function(e,t,n){var r=n("QqLw"),i=n("ExA7"),o="[object Set]";function a(e){return i(e)&&r(e)==o}e.exports=a},w26f:function(e,t,n){(function(t){var n=200,r="__lodash_hash_undefined__",i=1/0,o="[object Function]",a="[object GeneratorFunction]",s=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,c="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,p=c||l||Function("return this")();function f(e,t){var n=e?e.length:0;return!!n&&m(e,t,0)>-1}function h(e,t,n){var r=-1,i=e?e.length:0;while(++r<i)if(n(t,e[r]))return!0;return!1}function d(e,t,n,r){var i=e.length,o=n+(r?1:-1);while(r?o--:++o<i)if(t(e[o],o,e))return o;return-1}function m(e,t,n){if(t!==t)return d(e,g,n);var r=n-1,i=e.length;while(++r<i)if(e[r]===t)return r;return-1}function g(e){return e!==e}function v(e,t){return e.has(t)}function y(e,t){return null==e?void 0:e[t]}function _(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function b(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var x=Array.prototype,w=Function.prototype,S=Object.prototype,E=p["__core-js_shared__"],T=function(){var e=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),k=w.toString,A=S.hasOwnProperty,C=S.toString,I=RegExp("^"+k.call(A).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=x.splice,P=ae(p,"Map"),O=ae(p,"Set"),L=ae(Object,"create");function R(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function D(){this.__data__=L?L(null):{}}function z(e){return this.has(e)&&delete this.__data__[e]}function N(e){var t=this.__data__;if(L){var n=t[e];return n===r?void 0:n}return A.call(t,e)?t[e]:void 0}function j(e){var t=this.__data__;return L?void 0!==t[e]:A.call(t,e)}function F(e,t){var n=this.__data__;return n[e]=L&&void 0===t?r:t,this}function B(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function U(){this.__data__=[]}function V(e){var t=this.__data__,n=te(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():M.call(t,n,1),!0}function G(e){var t=this.__data__,n=te(t,e);return n<0?void 0:t[n][1]}function q(e){return te(this.__data__,e)>-1}function Z(e,t){var n=this.__data__,r=te(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}function H(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function W(){this.__data__={hash:new R,map:new(P||B),string:new R}}function Y(e){return oe(this,e)["delete"](e)}function X(e){return oe(this,e).get(e)}function K(e){return oe(this,e).has(e)}function J(e,t){return oe(this,e).set(e,t),this}function Q(e){var t=-1,n=e?e.length:0;this.__data__=new H;while(++t<n)this.add(e[t])}function $(e){return this.__data__.set(e,r),this}function ee(e){return this.__data__.has(e)}function te(e,t){var n=e.length;while(n--)if(pe(e[n][0],t))return n;return-1}function ne(e){if(!he(e)||ue(e))return!1;var t=fe(e)||_(e)?I:u;return t.test(ce(e))}function re(e,t,r){var i=-1,o=f,a=e.length,s=!0,u=[],c=u;if(r)s=!1,o=h;else if(a>=n){var l=t?null:ie(e);if(l)return b(l);s=!1,o=v,c=new Q}else c=t?[]:u;e:while(++i<a){var p=e[i],d=t?t(p):p;if(p=r||0!==p?p:0,s&&d===d){var m=c.length;while(m--)if(c[m]===d)continue e;t&&c.push(d),u.push(p)}else o(c,d,r)||(c!==u&&c.push(d),u.push(p))}return u}R.prototype.clear=D,R.prototype["delete"]=z,R.prototype.get=N,R.prototype.has=j,R.prototype.set=F,B.prototype.clear=U,B.prototype["delete"]=V,B.prototype.get=G,B.prototype.has=q,B.prototype.set=Z,H.prototype.clear=W,H.prototype["delete"]=Y,H.prototype.get=X,H.prototype.has=K,H.prototype.set=J,Q.prototype.add=Q.prototype.push=$,Q.prototype.has=ee;var ie=O&&1/b(new O([,-0]))[1]==i?function(e){return new O(e)}:de;function oe(e,t){var n=e.__data__;return se(t)?n["string"==typeof t?"string":"hash"]:n.map}function ae(e,t){var n=y(e,t);return ne(n)?n:void 0}function se(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function ue(e){return!!T&&T in e}function ce(e){if(null!=e){try{return k.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function le(e){return e&&e.length?re(e):[]}function pe(e,t){return e===t||e!==e&&t!==t}function fe(e){var t=he(e)?C.call(e):"";return t==o||t==a}function he(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function de(){}e.exports=le}).call(this,n("yLpj"))},wnjb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("xfSm"),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(r.PARAM_TYPES,e),n=Reflect.getMetadata(r.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},e.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(r.TAGGED_PROP,e)||[];return t},e}();t.MetadataReader=i},wrZu:function(e,t,n){var r=n("+K+b"),i=n("XYm9"),o=n("b2z7"),a=n("otv/"),s=n("yP5f"),u="[object Boolean]",c="[object Date]",l="[object Map]",p="[object Number]",f="[object RegExp]",h="[object Set]",d="[object String]",m="[object Symbol]",g="[object ArrayBuffer]",v="[object DataView]",y="[object Float32Array]",_="[object Float64Array]",b="[object Int8Array]",x="[object Int16Array]",w="[object Int32Array]",S="[object Uint8Array]",E="[object Uint8ClampedArray]",T="[object Uint16Array]",k="[object Uint32Array]";function A(e,t,n){var A=e.constructor;switch(t){case g:return r(e);case u:case c:return new A(+e);case v:return i(e,n);case y:case _:case b:case x:case w:case S:case E:case T:case k:return s(e,n);case l:return new A;case p:case d:return new A(e);case f:return o(e);case h:return new A;case m:return a(e)}}e.exports=A},xfSm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},xfeJ:function(e,t){function n(e){return-1!==Function.toString.call(e).indexOf("[native code]")}e.exports=n},xiII:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("d9O0"),i=function(){function e(e,t,n,i,o){this.id=r.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();t.Request=i},xp6e:function(e,t,n){"use strict";(function(e){function r(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r["throw"](e))}catch(t){o(t)}}function u(e){e.done?n(e.value):i(e.value).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function i(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return u([e,t])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function o(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{while((void 0===t||t-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a}function a(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function u(e,t){return t={exports:{}},e(t,t.exports),t.exports}n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return D})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return R}));var c=u((function(e,t){function n(e){return e&&"number"===typeof e.length&&e.length>=0&&e.length%1===0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t["default"]}));s(c);var l=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var r=t.pop();return e.call(this,t,r)}},e.exports=t["default"]}));s(l);var p=u((function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.fallback=a,n.wrap=s;var r,i=n.hasSetImmediate="function"===typeof setImmediate&&setImmediate,o=n.hasNextTick="object"===typeof e&&"function"===typeof e.nextTick;function a(e){setTimeout(e,0)}function s(e){return function(t){var n=[],r=arguments.length-1;while(r-- >0)n[r]=arguments[r+1];return e((function(){return t.apply(void 0,n)}))}}r=i?setImmediate:o?e.nextTick:a,n.default=s(r)}));s(p);p.fallback,p.wrap,p.hasSetImmediate,p.hasNextTick;var f=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=i(l),r=i(p);function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return(0,h.isAsync)(e)?function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var r=t.pop(),i=e.apply(this,t);return a(i,r)}:(0,n.default)((function(t,n){var r;try{r=e.apply(this,t)}catch(i){return n(i)}if(r&&"function"===typeof r.then)return a(r,n);n(null,r)}))}function a(e,t){return e.then((function(e){s(t,null,e)}),(function(e){s(t,e&&e.message?e:new Error(e))}))}function s(e,t,n){try{e(t,n)}catch(i){(0,r.default)((function(e){throw e}),i)}}e.exports=t["default"]}));s(f);var h=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=t.isAsyncGenerator=t.isAsync=void 0;var n=r(f);function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return"AsyncFunction"===e[Symbol.toStringTag]}function o(e){return"AsyncGenerator"===e[Symbol.toStringTag]}function a(e){return"function"===typeof e[Symbol.asyncIterator]}function s(e){if("function"!==typeof e)throw new Error("expected a function");return i(e)?(0,n.default)(e):e}t.default=s,t.isAsync=i,t.isAsyncGenerator=o,t.isAsyncIterable=a}));s(h);h.isAsyncIterable,h.isAsyncGenerator,h.isAsync;var d=u((function(e,t){function n(e,t){if(void 0===t&&(t=e.length),!t)throw new Error("arity is undefined");function n(){var n=this,r=[],i=arguments.length;while(i--)r[i]=arguments[i];return"function"===typeof r[t-1]?e.apply(this,r):new Promise((function(i,o){r[t-1]=function(e){var t=[],n=arguments.length-1;while(n-- >0)t[n]=arguments[n+1];if(e)return o(e);i(t.length>1?t:t[0])},e.apply(n,r)}))}return Object.defineProperty(n,"name",{configurable:!0,value:"awaitable("+e.name+")"}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t["default"]}));s(d);var m=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(c),r=o(h),i=o(d);function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)((function(e,t,i){var o=(0,n.default)(t)?[]:{};e(t,(function(e,t,n){(0,r.default)(e)((function(e){var r,i=[],a=arguments.length-1;while(a-- >0)i[a]=arguments[a+1];i.length<2&&(r=i,i=r[0]),o[t]=i,n(e)}))}),(function(e){return i(e,o)}))}),3),e.exports=t["default"]}));s(m);var g=u((function(e,t){function n(e){function t(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];if(null!==e){var r=e;e=null,r.apply(this,t)}}return Object.assign(t,e),t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t["default"]}));s(g);var v=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()},e.exports=t["default"]}));s(v);var y=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var n=i(c),r=i(v);function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}function a(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}function s(e){var t=e?Object.keys(e):[],n=-1,r=t.length;return function(){var i=t[++n];return n<r?{value:e[i],key:i}:null}}function u(e){if((0,n.default)(e))return o(e);var t=(0,r.default)(e);return t?a(t):s(e)}e.exports=t["default"]}));s(y);var _=u((function(e,t){function n(e){return function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];if(null===e)throw new Error("Callback was already called.");var r=e;e=null,r.apply(this,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t["default"]}));s(_);var b=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={};t.default=n,e.exports=t["default"]}));s(b);var x=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=r(b);function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r,i){var o=!1,a=!1,s=!1,u=0,c=0;function l(){u>=t||s||o||(s=!0,e.next().then((function(e){var t=e.value,n=e.done;if(!a&&!o){if(s=!1,n)return o=!0,void(u<=0&&i(null));u++,r(t,c,p),c++,l()}})).catch(f))}function p(e,t){if(u-=1,!a)return e?f(e):!1===e?(o=!0,void(a=!0)):t===n.default||o&&u<=0?(o=!0,i(null)):void l()}function f(e){a||(s=!1,o=!0,i(e))}l()}e.exports=t["default"]}));s(x);var w=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=s(g),r=s(y),i=s(_),o=s(x),a=s(b);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(t,s,u){if(u=(0,n.default)(u),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return u(null);if((0,h.isAsyncGenerator)(t))return(0,o.default)(t,e,s,u);if((0,h.isAsyncIterable)(t))return(0,o.default)(t[Symbol.asyncIterator](),e,s,u);var c=(0,r.default)(t),l=!1,p=!1,f=0,d=!1;function m(e,t){if(!p)if(f-=1,e)l=!0,u(e);else if(!1===e)l=!0,p=!0;else{if(t===a.default||l&&f<=0)return l=!0,u(null);d||g()}}function g(){d=!0;while(f<e&&!l){var t=c();if(null===t)return l=!0,void(f<=0&&u(null));f+=1,s(t.value,t.key,(0,i.default)(m))}d=!1}g()}},e.exports=t["default"]}));s(w);var S=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=o(w),r=o(h),i=o(d);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i,o){return(0,n.default)(t)(e,(0,r.default)(i),o)}t.default=(0,i.default)(a,4),e.exports=t["default"]}));s(S);var E=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=i(S),r=i(d);function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return(0,n.default)(e,1,t,r)}t.default=(0,r.default)(o,3),e.exports=t["default"]}));s(E);var T=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=i(m),r=i(E);function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return(0,n.default)(r.default,e,t)}e.exports=t["default"]})),k=s(T),A=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return this.args=t,k(this.tasks)},e.prototype.tap=function(e,t){var n=this;this.tasks.push((function(r){t.apply(void 0,a(n.args)),r(null,e)}))},e}(),C=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=l(c),r=l(b),i=l(S),o=l(g),a=l(_),s=l(h),u=l(d);function l(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){n=(0,o.default)(n);var i=0,s=0,u=e.length,c=!1;function l(e,t){!1===e&&(c=!0),!0!==c&&(e?n(e):++s!==u&&t!==r.default||n(null))}for(0===u&&n(null);i<u;i++)t(e[i],i,(0,a.default)(l))}function f(e,t,n){return(0,i.default)(e,1/0,t,n)}function m(e,t,r){var i=(0,n.default)(e)?p:f;return i(e,(0,s.default)(t),r)}t.default=(0,u.default)(m,3),e.exports=t["default"]}));s(C);var I=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=i(C),r=i(m);function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return(0,r.default)(n.default,e,t)}e.exports=t["default"]})),M=s(I),P=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.promise=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return M(this.tasks)},e.prototype.tapPromise=function(e,t){var n=this;this.tasks.push((function(o){return r(n,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return n.sent(),o(null,e),[2]}}))}))}))},e}(),O=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=a(g),r=a(_),i=a(h),o=a(d);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(t=(0,n.default)(t),!Array.isArray(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var o=0;function a(t){var n=(0,i.default)(e[o++]);n.apply(void 0,t.concat([(0,r.default)(s)]))}function s(n){var r=[],i=arguments.length-1;while(i-- >0)r[i]=arguments[i+1];if(!1!==n)return n||o===e.length?t.apply(void 0,[n].concat(r)):void a(r)}a([])}t.default=(0,o.default)(s),e.exports=t["default"]})),L=s(O),R=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return L(this.tasks)},e.prototype.tap=function(e,t){0===this.tasks.length?this.tasks.push((function(e){var n=t();e(!!n&&null,n)})):this.tasks.push((function(n,r){var i=t();r(!!i&&null,e)}))},e}(),D=function(){function e(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];this.tasks=[]}return e.prototype.call=function(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];return k(this.tasks)},e.prototype.tap=function(e,t){this.tasks.push((function(n){var r=t();n(r,e)}))},e}()}).call(this,n("Q2Ig"))},yG8O:function(e,t){function n(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}e.exports=n},yHx3:function(e,t){var n=Object.prototype,r=n.hasOwnProperty;function i(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n}e.exports=i},yLV6:function(e,t,n){var r;(function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),p="function",f=Math.round,h=Math.abs,d=Date.now;function m(e,t,n){return setTimeout(w(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(v(e,n[t],n),!0)}function v(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s){r=0;while(r<e.length)t.call(n,e[r],r,e),r++}else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function y(e,t,n){var r="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),e.apply(this,arguments)}}u="function"!==typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign;var _=y((function(e,t,n){var r=Object.keys(t),i=0;while(i<r.length)(!n||n&&e[r[i]]===s)&&(e[r[i]]=t[r[i]]),i++;return e}),"extend","Use `assign`."),b=y((function(e,t){return _(e,t,!0)}),"merge","Use `assign`.");function x(e,t,n){var r,i=t.prototype;r=e.prototype=Object.create(i),r.constructor=e,r._super=i,n&&u(r,n)}function w(e,t){return function(){return e.apply(t,arguments)}}function S(e,t){return typeof e==p?e.apply(t&&t[0]||s,t):e}function E(e,t){return e===s?t:e}function T(e,t,n){v(I(t),(function(t){e.addEventListener(t,n,!1)}))}function k(e,t,n){v(I(t),(function(t){e.removeEventListener(t,n,!1)}))}function A(e,t){while(e){if(e==t)return!0;e=e.parentNode}return!1}function C(e,t){return e.indexOf(t)>-1}function I(e){return e.trim().split(/\s+/g)}function M(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);var r=0;while(r<e.length){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function O(e,t,n){var r=[],i=[],o=0;while(o<e.length){var a=t?e[o][t]:e[o];M(i,a)<0&&r.push(e[o]),i[o]=a,o++}return n&&(r=t?r.sort((function(e,n){return e[t]>n[t]})):r.sort()),r}function L(e,t){var n,r,i=t[0].toUpperCase()+t.slice(1),o=0;while(o<c.length){if(n=c[o],r=n?n+i:t,r in e)return r;o++}return s}var R=1;function D(){return R++}function z(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var N=/mobile|tablet|ip(ad|hone|od)|android/i,j="ontouchstart"in i,F=L(i,"PointerEvent")!==s,B=j&&N.test(navigator.userAgent),U="touch",V="pen",G="mouse",q="kinect",Z=25,H=1,W=2,Y=4,X=8,K=1,J=2,Q=4,$=8,ee=16,te=J|Q,ne=$|ee,re=te|ne,ie=["x","y"],oe=["clientX","clientY"];function ae(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){S(e.options.enable,[e])&&n.handler(t)},this.init()}function se(e){var t,n=e.options.inputClass;return t=n||(F?Ce:B?ze:j?Be:Se),new t(e,ue)}function ue(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,o=t&H&&r-i===0,a=t&(Y|X)&&r-i===0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,ce(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ce(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=fe(t)),i>1&&!n.firstMultiple?n.firstMultiple=fe(t):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=t.center=he(r);t.timeStamp=d(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=ve(s,u),t.distance=ge(s,u),le(n,t),t.offsetDirection=me(t.deltaX,t.deltaY);var c=de(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=h(c.x)>h(c.y)?c.x:c.y,t.scale=a?_e(a.pointers,r):1,t.rotation=a?ye(a.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,pe(n,t);var l=e.element;A(t.srcEvent.target,l)&&(l=t.srcEvent.target),t.target=l}function le(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};t.eventType!==H&&o.eventType!==Y||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}function pe(e,t){var n,r,i,o,a=e.lastInterval||t,u=t.timeStamp-a.timeStamp;if(t.eventType!=X&&(u>Z||a.velocity===s)){var c=t.deltaX-a.deltaX,l=t.deltaY-a.deltaY,p=de(u,c,l);r=p.x,i=p.y,n=h(p.x)>h(p.y)?p.x:p.y,o=me(c,l),e.lastInterval=t}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=o}function fe(e){var t=[],n=0;while(n<e.pointers.length)t[n]={clientX:f(e.pointers[n].clientX),clientY:f(e.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:t,center:he(t),deltaX:e.deltaX,deltaY:e.deltaY}}function he(e){var t=e.length;if(1===t)return{x:f(e[0].clientX),y:f(e[0].clientY)};var n=0,r=0,i=0;while(i<t)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:f(n/t),y:f(r/t)}}function de(e,t,n){return{x:t/e||0,y:n/e||0}}function me(e,t){return e===t?K:h(e)>=h(t)?e<0?J:Q:t<0?$:ee}function ge(e,t,n){n||(n=ie);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function ve(e,t,n){n||(n=ie);var r=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}function ye(e,t){return ve(t[1],t[0],oe)+ve(e[1],e[0],oe)}function _e(e,t){return ge(t[0],t[1],oe)/ge(e[0],e[1],oe)}ae.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(z(this.element),this.evWin,this.domHandler)}};var be={mousedown:H,mousemove:W,mouseup:Y},xe="mousedown",we="mousemove mouseup";function Se(){this.evEl=xe,this.evWin=we,this.pressed=!1,ae.apply(this,arguments)}x(Se,ae,{handler:function(e){var t=be[e.type];t&H&&0===e.button&&(this.pressed=!0),t&W&&1!==e.which&&(t=Y),this.pressed&&(t&Y&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:G,srcEvent:e}))}});var Ee={pointerdown:H,pointermove:W,pointerup:Y,pointercancel:X,pointerout:X},Te={2:U,3:V,4:G,5:q},ke="pointerdown",Ae="pointermove pointerup pointercancel";function Ce(){this.evEl=ke,this.evWin=Ae,ae.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ke="MSPointerDown",Ae="MSPointerMove MSPointerUp MSPointerCancel"),x(Ce,ae,{handler:function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=Ee[r],o=Te[e.pointerType]||e.pointerType,a=o==U,s=M(t,e.pointerId,"pointerId");i&H&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):i&(Y|X)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var Ie={touchstart:H,touchmove:W,touchend:Y,touchcancel:X},Me="touchstart",Pe="touchstart touchmove touchend touchcancel";function Oe(){this.evTarget=Me,this.evWin=Pe,this.started=!1,ae.apply(this,arguments)}function Le(e,t){var n=P(e.touches),r=P(e.changedTouches);return t&(Y|X)&&(n=O(n.concat(r),"identifier",!0)),[n,r]}x(Oe,ae,{handler:function(e){var t=Ie[e.type];if(t===H&&(this.started=!0),this.started){var n=Le.call(this,e,t);t&(Y|X)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:e})}}});var Re={touchstart:H,touchmove:W,touchend:Y,touchcancel:X},De="touchstart touchmove touchend touchcancel";function ze(){this.evTarget=De,this.targetIds={},ae.apply(this,arguments)}function Ne(e,t){var n=P(e.touches),r=this.targetIds;if(t&(H|W)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=P(e.changedTouches),s=[],u=this.target;if(o=n.filter((function(e){return A(e.target,u)})),t===H){i=0;while(i<o.length)r[o[i].identifier]=!0,i++}i=0;while(i<a.length)r[a[i].identifier]&&s.push(a[i]),t&(Y|X)&&delete r[a[i].identifier],i++;return s.length?[O(o.concat(s),"identifier",!0),s]:void 0}x(ze,ae,{handler:function(e){var t=Re[e.type],n=Ne.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:U,srcEvent:e})}});var je=2500,Fe=25;function Be(){ae.apply(this,arguments);var e=w(this.handler,this);this.touch=new ze(this.manager,e),this.mouse=new Se(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ue(e,t){e&H?(this.primaryTouch=t.changedPointers[0].identifier,Ve.call(this,t)):e&(Y|X)&&Ve.call(this,t)}function Ve(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var r=this.lastTouches,i=function(){var e=r.indexOf(n);e>-1&&r.splice(e,1)};setTimeout(i,je)}}function Ge(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(t-i.x),a=Math.abs(n-i.y);if(o<=Fe&&a<=Fe)return!0}return!1}x(Be,ae,{handler:function(e,t,n){var r=n.pointerType==U,i=n.pointerType==G;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)Ue.call(this,t,n);else if(i&&Ge.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var qe=L(l.style,"touchAction"),Ze=qe!==s,He="compute",We="auto",Ye="manipulation",Xe="none",Ke="pan-x",Je="pan-y",Qe=tt();function $e(e,t){this.manager=e,this.set(t)}function et(e){if(C(e,Xe))return Xe;var t=C(e,Ke),n=C(e,Je);return t&&n?Xe:t||n?t?Ke:Je:C(e,Ye)?Ye:We}function tt(){if(!Ze)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||i.CSS.supports("touch-action",n)})),e}$e.prototype={set:function(e){e==He&&(e=this.compute()),Ze&&this.manager.element.style&&Qe[e]&&(this.manager.element.style[qe]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,(function(t){S(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),et(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=C(r,Xe)&&!Qe[Xe],o=C(r,Je)&&!Qe[Je],a=C(r,Ke)&&!Qe[Ke];if(i){var s=1===e.pointers.length,u=e.distance<2,c=e.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&te||a&&n&ne?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var nt=1,rt=2,it=4,ot=8,at=ot,st=16,ut=32;function ct(e){this.options=u({},this.defaults,e||{}),this.id=D(),this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=nt,this.simultaneous={},this.requireFail=[]}function lt(e){return e&st?"cancel":e&ot?"end":e&it?"move":e&rt?"start":""}function pt(e){return e==ee?"down":e==$?"up":e==J?"left":e==Q?"right":""}function ft(e,t){var n=t.manager;return n?n.get(e):e}function ht(){ct.apply(this,arguments)}function dt(){ht.apply(this,arguments),this.pX=null,this.pY=null}function mt(){ht.apply(this,arguments)}function gt(){ct.apply(this,arguments),this._timer=null,this._input=null}function vt(){ht.apply(this,arguments)}function yt(){ht.apply(this,arguments)}function _t(){ct.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function bt(e,t){return t=t||{},t.recognizers=E(t.recognizers,bt.defaults.preset),new St(e,t)}ct.prototype={defaults:{},set:function(e){return u(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=ft(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=ft(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return e=ft(e,this),-1===M(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=ft(e,this);var t=M(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function r(n){t.manager.emit(n,e)}n<ot&&r(t.options.event+lt(n)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),n>=ot&&r(t.options.event+lt(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=ut},canEmit:function(){var e=0;while(e<this.requireFail.length){if(!(this.requireFail[e].state&(ut|nt)))return!1;e++}return!0},recognize:function(e){var t=u({},e);if(!S(this.options.enable,[this,t]))return this.reset(),void(this.state=ut);this.state&(at|st|ut)&&(this.state=nt),this.state=this.process(t),this.state&(rt|it|ot|st)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},x(ht,ct,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,r=t&(rt|it),i=this.attrTest(e);return r&&(n&X||!i)?t|st:r||i?n&Y?t|ot:t&rt?t|it:rt:ut}}),x(dt,ht,{defaults:{event:"pan",threshold:10,pointers:1,direction:re},getTouchAction:function(){var e=this.options.direction,t=[];return e&te&&t.push(Je),e&ne&&t.push(Ke),t},directionTest:function(e){var t=this.options,n=!0,r=e.distance,i=e.direction,o=e.deltaX,a=e.deltaY;return i&t.direction||(t.direction&te?(i=0===o?K:o<0?J:Q,n=o!=this.pX,r=Math.abs(e.deltaX)):(i=0===a?K:a<0?$:ee,n=a!=this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&i&t.direction},attrTest:function(e){return ht.prototype.attrTest.call(this,e)&&(this.state&rt||!(this.state&rt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=pt(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),x(mt,ht,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&rt)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),x(gt,ct,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[We]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!r||!n||e.eventType&(Y|X)&&!i)this.reset();else if(e.eventType&H)this.reset(),this._timer=m((function(){this.state=at,this.tryEmit()}),t.time,this);else if(e.eventType&Y)return at;return ut},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===at&&(e&&e.eventType&Y?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),x(vt,ht,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xe]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&rt)}}),x(yt,ht,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:te|ne,pointers:1},getTouchAction:function(){return dt.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(te|ne)?t=e.overallVelocity:n&te?t=e.overallVelocityX:n&ne&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&h(t)>this.options.velocity&&e.eventType&Y},emit:function(e){var t=pt(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),x(_t,ct,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ye]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),e.eventType&H&&0===this.count)return this.failTimeout();if(r&&i&&n){if(e.eventType!=Y)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||ge(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e;var s=this.count%t.taps;if(0===s)return this.hasRequireFailures()?(this._timer=m((function(){this.state=at,this.tryEmit()}),t.interval,this),rt):at}return ut},failTimeout:function(){return this._timer=m((function(){this.state=ut}),this.options.interval,this),ut},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==at&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),bt.VERSION="2.0.7",bt.defaults={domEvents:!1,touchAction:He,enable:!0,inputTarget:null,inputClass:null,preset:[[vt,{enable:!1}],[mt,{enable:!1},["rotate"]],[yt,{direction:te}],[dt,{direction:te},["swipe"]],[_t],[_t,{event:"doubletap",taps:2},["tap"]],[gt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var xt=1,wt=2;function St(e,t){this.options=u({},bt.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=se(this),this.touchAction=new $e(this,this.options.touchAction),Et(this,!0),v(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Et(e,t){var n,r=e.element;r.style&&(v(e.options.cssProps,(function(i,o){n=L(r.style,o),t?(e.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}function Tt(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}St.prototype={set:function(e){return u(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?wt:xt},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&i.state&at)&&(i=t.curRecognizer=null);var o=0;while(o<r.length)n=r[o],t.stopped===wt||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&n.state&(rt|it|ot)&&(i=t.curRecognizer=n),o++}},get:function(e){if(e instanceof ct)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e),e){var t=this.recognizers,n=M(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return v(I(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==s){var n=this.handlers;return v(I(e),(function(e){t?n[e]&&n[e].splice(M(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&Tt(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};var r=0;while(r<n.length)n[r](t),r++}},destroy:function(){this.element&&Et(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(bt,{INPUT_START:H,INPUT_MOVE:W,INPUT_END:Y,INPUT_CANCEL:X,STATE_POSSIBLE:nt,STATE_BEGAN:rt,STATE_CHANGED:it,STATE_ENDED:ot,STATE_RECOGNIZED:at,STATE_CANCELLED:st,STATE_FAILED:ut,DIRECTION_NONE:K,DIRECTION_LEFT:J,DIRECTION_RIGHT:Q,DIRECTION_UP:$,DIRECTION_DOWN:ee,DIRECTION_HORIZONTAL:te,DIRECTION_VERTICAL:ne,DIRECTION_ALL:re,Manager:St,Input:ae,TouchAction:$e,TouchInput:ze,MouseInput:Se,PointerEventInput:Ce,TouchMouseInput:Be,SingleTouchInput:Oe,Recognizer:ct,AttrRecognizer:ht,Tap:_t,Pan:dt,Swipe:yt,Pinch:mt,Rotate:vt,Press:gt,on:T,off:k,each:v,merge:b,extend:_,assign:u,inherit:x,bindFn:w,prefixed:L});var kt="undefined"!==typeof i?i:"undefined"!==typeof self?self:{};kt.Hammer=bt,r=function(){return bt}.call(t,n,t,e),r===s||(e.exports=r)})(window,document)},yMAV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.parentContext=e,this.rootRequest=t}return e}();t.Plan=r},yU0y:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){var e=0,t=arguments.length;while(t--)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},yXPU:function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,u,"next",e)}function u(e){n(a,i,o,s,u,"throw",e)}s(void 0)}))}}e.exports=r},ycre:function(e,t,n){var r=n("711d"),i=r("length");e.exports=i},z4Hk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("406g"),i=n("RR/i"),o=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=i.namedConstraint(e),new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){var t=null!==e.target&&!e.target.isNamed()&&!e.target.isTagged();return t},new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=i.taggedConstraint(e)(t),new r.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return i.typeConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return i.namedConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return i.taggedConstraint(e)(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=o},zEVN:function(e,t,n){var r=n("Gi0A"),i=n("sEf8"),o=n("mdPL"),a=o&&o.isMap,s=a?i(a):r;e.exports=s},zZPE:function(e,t){var n="[object Object]";function r(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function i(e,t){return function(n){return e(t(n))}}var o=Function.prototype,a=Object.prototype,s=o.toString,u=a.hasOwnProperty,c=s.call(Object),l=a.toString,p=i(Object.getPrototypeOf,Object);function f(e){return!!e&&"object"==typeof e}function h(e){if(!f(e)||l.call(e)!=n||r(e))return!1;var t=p(e);if(null===t)return!0;var i=u.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&s.call(i)==c}e.exports=h},zxMA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=r}}]);